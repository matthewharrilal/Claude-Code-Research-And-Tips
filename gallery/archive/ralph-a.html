<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ralph Pattern - Direction A (Refactoring.guru Style)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/gallery.css">
  <style>
    /* Direction A specific overrides */
    .direction-indicator {
      position: fixed;
      top: var(--space-md);
      right: var(--space-md);
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: var(--space-sm) var(--space-md);
      font-size: var(--text-sm);
      color: var(--text-muted);
      z-index: 100;
    }

    .page-header {
      padding: var(--space-2xl) 0;
      text-align: center;
      border-bottom: 1px solid var(--border-subtle);
    }

    .page-header h1 {
      margin-bottom: var(--space-sm);
    }

    .page-header .subtitle {
      color: var(--text-secondary);
      font-size: var(--text-lg);
    }

    .illustration-area {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-2xl);
      background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-code) 100%);
      border-radius: var(--radius-lg);
      margin: var(--space-lg) 0;
    }

    .ralph-character {
      font-size: 4rem;
      margin-right: var(--space-lg);
    }

    .illustration-text {
      max-width: 400px;
    }

    .lang-toggle {
      display: inline-flex;
      background: var(--bg-elevated);
      border-radius: var(--radius-sm);
      padding: 2px;
      margin-top: var(--space-md);
    }

    .lang-toggle button {
      padding: var(--space-xs) var(--space-sm);
      background: none;
      border: none;
      font-family: var(--font-mono);
      font-size: var(--text-sm);
      color: var(--text-muted);
      cursor: pointer;
      border-radius: var(--radius-sm);
    }

    .lang-toggle button.active {
      background: var(--accent-primary);
      color: var(--bg-primary);
    }

    .flowchart {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-md);
      justify-content: center;
      padding: var(--space-xl);
      background: var(--bg-code);
      border-radius: var(--radius-lg);
      margin: var(--space-lg) 0;
    }

    .flowchart-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .flowchart-box {
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: var(--space-sm) var(--space-md);
      font-size: var(--text-sm);
      min-width: 120px;
    }

    .flowchart-arrow {
      color: var(--accent-primary);
      font-family: var(--font-mono);
      margin: 0 var(--space-sm);
      align-self: center;
    }

    .related-patterns {
      display: flex;
      gap: var(--space-md);
      padding: var(--space-lg) 0;
    }

    .pattern-card {
      flex: 1;
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      transition: all var(--transition-fast);
    }

    .pattern-card:hover {
      border-color: var(--accent-primary);
      transform: translateY(-2px);
    }

    .pattern-card h4 {
      margin-bottom: var(--space-sm);
    }

    .pattern-card p {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      margin: 0;
    }
  </style>
</head>
<body class="direction-a">
  <!-- Direction indicator -->
  <div class="direction-indicator">Direction A: Refactoring.guru Style</div>

  <!-- Navigation -->
  <nav class="nav-header">
    <a href="#" class="nav-back">
      <span>&larr;</span> Back to Patterns
    </a>
    <span class="maturity-badge evergreen">
      <span>ðŸŒ³</span> Evergreen
    </span>
  </nav>

  <!-- Page Header -->
  <header class="page-header container">
    <h1>Ralph Wiggum Pattern</h1>
    <p class="subtitle">The Infinite Loop of Fresh Context</p>
  </header>

  <main class="container">
    <!-- THE PROBLEM -->
    <section class="section">
      <h2 class="section-title">The Problem</h2>
      <div class="problem-box">
        <p>Your AI agent loses context after 40K tokens. It starts repeating itself, forgetting instructions, making mistakes it didn't make earlier.</p>
        <p style="margin-bottom: 0;">You're watching in frustration as the quality degrades right before your eyes. The longer the session, the worse it gets.</p>
      </div>
      <p class="mt-lg text-secondary">This isn't a bug in your prompts. It's <strong>context rot</strong>&mdash;the inevitable degradation that happens when LLMs accumulate too much context. Every model has this problem.</p>
    </section>

    <!-- THE SOLUTION -->
    <section class="section">
      <h2 class="section-title">The Solution</h2>

      <div class="illustration-area">
        <div class="ralph-character">ðŸ‘¦</div>
        <div class="illustration-text">
          <p><strong>Think of your AI as Ralph Wiggum</strong>&mdash;that eager kid from The Simpsons who happily does ONE thing at a time without overthinking it.</p>
          <p style="margin-bottom: 0;">Give him a task. Let him finish. Start fresh. Repeat.</p>
        </div>
      </div>

      <div class="solution-box">
        <p><strong>The counterintuitive insight:</strong> Don't try to keep the session alive. Kill it. Start fresh. Every single time.</p>
        <p style="margin-bottom: 0;">Memory doesn't live in the model&mdash;it lives in external artifacts. Git history. JSON files. Progress logs. The filesystem IS the memory.</p>
      </div>
    </section>

    <!-- THE STRUCTURE -->
    <section class="section">
      <h2 class="section-title">The Structure</h2>

      <div class="flowchart">
        <div class="flowchart-step">
          <div class="flowchart-box">Fresh Context</div>
        </div>
        <span class="flowchart-arrow">&rarr;</span>
        <div class="flowchart-step">
          <div class="flowchart-box">Read State</div>
        </div>
        <span class="flowchart-arrow">&rarr;</span>
        <div class="flowchart-step">
          <div class="flowchart-box">Find Task</div>
        </div>
        <span class="flowchart-arrow">&rarr;</span>
        <div class="flowchart-step">
          <div class="flowchart-box">Implement</div>
        </div>
        <span class="flowchart-arrow">&rarr;</span>
        <div class="flowchart-step">
          <div class="flowchart-box">Verify</div>
        </div>
        <span class="flowchart-arrow">&rarr;</span>
        <div class="flowchart-step">
          <div class="flowchart-box">Commit</div>
        </div>
        <span class="flowchart-arrow">&rarr;</span>
        <div class="flowchart-step">
          <div class="flowchart-box" style="border-color: var(--accent-primary);">Loop</div>
        </div>
      </div>

      <p class="text-secondary">Each iteration spawns a completely new Claude instance. No accumulated context. No degradation. Just fresh capacity applied to the next small task.</p>
    </section>

    <!-- THE CODE -->
    <section class="section">
      <h2 class="section-title">The Code</h2>

      <div class="essence-block">
        <button class="copy-btn" onclick="copyCode(this)">
          <span>Copy</span>
        </button>
        <div class="essence-code" id="code-bash">while :; do cat PROMPT.md | claude ; done</div>
        <div class="essence-code" id="code-zsh" style="display: none;">while true; do cat PROMPT.md | claude; done</div>
        <div class="essence-code" id="code-fish" style="display: none;">while true; cat PROMPT.md | claude; end</div>
        <div class="essence-caption">That's it. Everything else is scaffolding around this one-liner.</div>

        <div class="lang-toggle">
          <button class="active" onclick="switchLang('bash', this)">bash</button>
          <button onclick="switchLang('zsh', this)">zsh</button>
          <button onclick="switchLang('fish', this)">fish</button>
        </div>
      </div>

      <p>The loop reads from <code>PROMPT.md</code>, which tells Claude:</p>
      <ol style="margin-left: var(--space-lg); color: var(--text-secondary);">
        <li>Read the PRD to find incomplete tasks</li>
        <li>Pick the highest priority task</li>
        <li>Implement it</li>
        <li>Verify it (tests, typecheck)</li>
        <li>Mark it complete</li>
        <li>Append learnings to progress.txt</li>
        <li>Exit (loop restarts with fresh context)</li>
      </ol>
    </section>

    <!-- WHEN TO USE -->
    <section class="section">
      <h2 class="section-title">When to Use</h2>

      <div class="comparison-grid">
        <div>
          <h4 style="color: var(--success); margin-bottom: var(--space-md);">Good Candidates</h4>
          <ul class="check-list">
            <li><span class="check">&#10003;</span> Feature development with clear specs</li>
            <li><span class="check">&#10003;</span> API endpoint implementation</li>
            <li><span class="check">&#10003;</span> Database migrations</li>
            <li><span class="check">&#10003;</span> Refactoring with test coverage</li>
            <li><span class="check">&#10003;</span> Overnight builds</li>
            <li><span class="check">&#10003;</span> Tasks that benefit from retry</li>
          </ul>
        </div>
        <div>
          <h4 style="color: var(--error); margin-bottom: var(--space-md);">Poor Candidates</h4>
          <ul class="check-list">
            <li><span class="cross">&#10007;</span> Subjective tasks ("make it pretty")</li>
            <li><span class="cross">&#10007;</span> Security-critical code</li>
            <li><span class="cross">&#10007;</span> Exploratory work</li>
            <li><span class="cross">&#10007;</span> Legacy code without tests</li>
            <li><span class="cross">&#10007;</span> Design decisions</li>
            <li><span class="cross">&#10007;</span> One-shot operations</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- WHAT'S UNUSUAL -->
    <section class="section">
      <h2 class="section-title">What's Unusual About This Pattern</h2>

      <blockquote>
        "Kill sessions, don't preserve them."
        <cite>&mdash; Matt Pocock</cite>
      </blockquote>

      <p>Most developers try to extend sessions. They invest in maintaining context. Ralph does the opposite:</p>

      <ul style="margin-left: var(--space-lg); margin-top: var(--space-md);">
        <li><strong>Fresh context beats accumulated context.</strong> Each iteration starts clean.</li>
        <li><strong>Memory lives outside the model.</strong> Git, JSON, filesystem.</li>
        <li><strong>Failure is data, not defeat.</strong> Each failure refines the next attempt.</li>
        <li><strong>Small + verifiable = reliable.</strong> Tasks must fit one context window.</li>
      </ul>

      <p class="mt-lg text-secondary">The transformation: You become the Product Manager. The AI becomes the Implementation Army. 25-30 minutes of planning yields 8 hours of grinding.</p>
    </section>

    <!-- RELATED PATTERNS -->
    <section class="section">
      <h2 class="section-title">Related Patterns</h2>

      <div class="related-patterns">
        <a href="#" class="pattern-card">
          <h4>Gas Town</h4>
          <p>When you need multiple Ralphs working in parallel across different domains.</p>
        </a>
        <a href="#" class="pattern-card">
          <h4>CC Mirror</h4>
          <p>Hidden multi-agent orchestration for coordinating Ralph instances.</p>
        </a>
        <a href="#" class="pattern-card">
          <h4>Fresh Context</h4>
          <p>The underlying principle that makes Ralph work.</p>
        </a>
      </div>
    </section>
  </main>

  <!-- Footer connections -->
  <footer class="connections">
    <span class="connection-label">Combines with:</span>
    <a href="#" class="tag">Hooks</a>
    <a href="#" class="tag">Playwright</a>
    <a href="#" class="tag">Git Worktrees</a>
    <span class="connection-label" style="margin-left: var(--space-lg);">Competes with:</span>
    <a href="#" class="tag">Gas Town</a>
    <a href="#" class="tag">Extended Sessions</a>
  </footer>

  <script>
    function copyCode(btn) {
      const activeCode = document.querySelector('.essence-code:not([style*="display: none"])');
      navigator.clipboard.writeText(activeCode.textContent.trim());
      btn.querySelector('span').textContent = 'Copied!';
      btn.classList.add('copied');
      setTimeout(() => {
        btn.querySelector('span').textContent = 'Copy';
        btn.classList.remove('copied');
      }, 2000);
    }

    function switchLang(lang, btn) {
      // Hide all code variants
      document.querySelectorAll('.essence-code').forEach(el => el.style.display = 'none');
      // Show selected
      document.getElementById('code-' + lang).style.display = 'block';
      // Update button states
      document.querySelectorAll('.lang-toggle button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
  </script>
</body>
</html>
