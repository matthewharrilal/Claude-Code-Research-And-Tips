# POST-INVESTIGATION: Transition Table Design

**Author:** Transition Table Designer (Opus 4.6)
**Task:** #68
**Date:** 2026-02-19
**Sources:** Reports 06-12, 17, 18, 28 (channel traces, multi-coherence stack, recipe restructure, builder visibility, propagation analysis)

---

## EXECUTIVE SUMMARY

The Transition Table is the single new artifact that multiple investigation reports independently converge on as THE structural fix for the pipeline's compression loss problem. It is a per-boundary, multi-channel specification that flows UNCHANGED from TC planner to builder to gate runner to PA evaluator. This document defines its exact format, generation protocol, consumption protocol, verification protocol, and proves lossless propagation through every pipeline stage.

**What it is:** A structured table specifying, for every section boundary on the page, the EXACT CSS values across 6 channels BEFORE and AFTER the boundary, with semantic direction labels and pre-computed deltas.

**Why it matters:** The flagship experiment failed because channels shifted independently without coordinated direction. The multi-coherence report (12) identified that the build plan specifies chromatic direction but leaves typographic, spatial, structural, behavioral, and material directions to builder discretion. The transition table binds ALL channels at EVERY boundary, making multi-coherence a data-entry problem rather than a compositional judgment problem.

**The lossless propagation thesis:** TC writes `#F0EBE3` in the table. Builder reads `#F0EBE3` from the table. Builder writes `background: #F0EBE3;` in CSS. Gate runner reads `rgb(240, 235, 227)` from computed styles and converts to hex `#F0EBE3`. PA auditor sees the rendered color. The SAME VALUE appears at every stage in its native format.

---

## 1. EXACT FORMAT

### 1.1 Format Choice: YAML with Embedded CSS

After evaluating Markdown tables, JSON, YAML, and plain text (see Report 18 Section 3, Report 28 Section 3):

- **Markdown tables** are readable but cannot nest CSS snippets or structured metadata
- **JSON** is machine-parseable but visually noisy for LLM consumption (quotes, brackets)
- **YAML** balances human readability, LLM parseability, structured nesting, and inline CSS
- **Plain text** is ambiguous and lossy

**Decision: YAML** with embedded CSS blocks. This aligns with Report 18's recommendation (D-1: "Recipe format with YAML data blocks") and Report 28's finding that "CSS IS compositional intelligence."

### 1.2 Schema Definition

```yaml
# TRANSITION TABLE SCHEMA
# Generated by TC Planner (Phase 4.8)
# Consumed by Builder (Phases 3-6), Gate Runner (Wave 2), PA Weaver (Wave 2.5)

transition_table:
  metadata:
    content: string          # Content title
    metaphor: string         # Committed metaphor name (or "FLAT MODE")
    coherence_rule: string   # One-sentence direction rule
    zone_count: int          # 2-5
    boundary_count: int      # zone_count - 1 (for zone boundaries) + section boundaries within zones
    intensity_arc: enum      # ACCELERATING | MAINTAINING | DECELERATING | CRESCENDO_DIMINUENDO

  zones:
    - id: int                # Zone number (1-based)
      name: string           # Human label ("Introduction", "Technical Depth")
      metaphor_term: string  # Metaphor mapping ("Surface", "Sediment", "Bedrock")
      sections: [string]     # Section IDs mapped to this zone ("S1", "S2", "S3")
      density: enum          # SPARSE | MODERATE | DENSE | BREATHING

  boundaries:
    - id: string             # Boundary ID ("Z1-Z2", "S3-S4")
      type: enum             # ZONE | SECTION (zone = major, section = minor)
      transition: enum       # HARD_CUT | SPACING_SHIFT | CHECKPOINT
      semantic_direction: string  # One word: "DEEPENING", "INTENSIFYING", "RESOLVING"
      intensity: enum        # SUBTLE | MODERATE | STRONG

      channels:
        chromatic:
          before: string     # Hex value: "#FEF9F5"
          after: string      # Hex value: "#F0EBE3"
          delta_rgb: int     # Sum of absolute channel deltas
          direction: string  # "WARMER" | "COOLER" | "DARKER" | "LIGHTER"
          pass: bool         # delta_rgb >= 15

        typographic:
          font_size:
            before: string   # "18px"
            after: string    # "16px"
            delta: string    # "-2px"
          font_weight:
            before: int      # 400
            after: int       # 500
            delta: int       # +100
          line_height:
            before: float    # 1.8
            after: float     # 1.65
            delta: float     # -0.15
          letter_spacing:
            before: string   # "0.01em"
            after: string    # "0em"
            delta: string    # "-0.01em"

        spatial:
          padding:
            before: string   # "64px"
            after: string    # "32px"
            delta: string    # "-32px"
          direction: string  # "TIGHTER" | "LOOSER"

        structural:
          border_left:
            before: string   # "none"
            after: string    # "4px solid var(--color-text)"
            change: string   # "ADD" | "REMOVE" | "INCREASE" | "DECREASE" | "SAME"
          transition_element:
            type: string     # "3px primary border" | "spacing shift" | "checkpoint with label"
            css: string      # Exact CSS for the transition element

        behavioral:
          transition_speed:
            before: string   # "0.15s ease"
            after: string    # "0.3s ease-in-out"
          hover_character: string  # "REVEAL" | "HIGHLIGHT" | "same"

        material:
          depth_technique: string  # "solid-offset" | "dark-inversion" | "weight-increase" | "none"
          surface_shift: string    # "paper-to-stone" | "warm-to-cool" | "same"

      channel_count: int     # Number of channels that shift (must be >= 3 for zone boundaries)
      pass: bool             # channel_count >= 3 for ZONE type; >= 2 for SECTION type
```

### 1.3 Fields Per Row Explained

Each boundary row contains 7 top-level fields:

| Field | Purpose | Who Uses It |
|-------|---------|-------------|
| `id` | Unique boundary identifier | All stages (lookup key) |
| `type` | ZONE vs SECTION boundary | Gate runner (different thresholds) |
| `transition` | HARD_CUT / SPACING_SHIFT / CHECKPOINT | Builder (CSS pattern selection) |
| `semantic_direction` | One-word direction label | Builder (coherence guide), PA (evaluation frame) |
| `intensity` | SUBTLE / MODERATE / STRONG | Builder (delta magnitude guide) |
| `channels` | 6 channel specifications with before/after/delta | Builder (exact CSS), Gate runner (verification), PA (reference) |
| `channel_count` + `pass` | Multi-coherence verification | Gate runner (binary check) |

---

## 2. COMPLETE EXAMPLE

### 2.1 Context: 4-Zone, 8-Section Page with Geological Strata Metaphor

**Content:** Research synthesis on design system compositional intelligence
**Metaphor:** Geological strata (surface -> sediment -> core -> bedrock)
**Coherence rule:** "Deeper = denser = darker = heavier"
**Zones:** 4 (Surface, Sediment, Core, Bedrock footer)
**Sections:** 8 (S1-S2 in Surface, S3-S5 in Sediment, S6-S7 in Core, S8 in Bedrock)
**Intensity arc:** ACCELERATING (shifts get stronger toward the bottom)

### 2.2 The Full Transition Table

```yaml
transition_table:
  metadata:
    content: "Research Synthesis: Compositional Intelligence"
    metaphor: "Geological Strata"
    coherence_rule: "Deeper = denser = darker = heavier"
    zone_count: 4
    boundary_count: 7  # 3 zone boundaries + 4 section boundaries within zones
    intensity_arc: ACCELERATING

  zones:
    - id: 1
      name: "Surface Overview"
      metaphor_term: "Topsoil"
      sections: ["S1", "S2"]
      density: SPARSE

    - id: 2
      name: "Analytical Depth"
      metaphor_term: "Sediment"
      sections: ["S3", "S4", "S5"]
      density: MODERATE

    - id: 3
      name: "Technical Core"
      metaphor_term: "Core Rock"
      sections: ["S6", "S7"]
      density: DENSE

    - id: 4
      name: "Foundation"
      metaphor_term: "Bedrock"
      sections: ["S8"]
      density: DENSE

  boundaries:
    # === SECTION BOUNDARY WITHIN ZONE 1 ===
    - id: "S1-S2"
      type: SECTION
      transition: SPACING_SHIFT
      semantic_direction: "BUILDING"
      intensity: SUBTLE
      channels:
        chromatic:
          before: "#FEF9F5"
          after: "#FEF9F5"
          delta_rgb: 0
          direction: "SAME"
          pass: true  # same-zone, no shift required
        typographic:
          font_size:
            before: "18px"
            after: "17px"
            delta: "-1px"
          font_weight:
            before: 400
            after: 400
            delta: 0
          line_height:
            before: 1.8
            after: 1.75
            delta: -0.05
          letter_spacing:
            before: "0.01em"
            after: "0.005em"
            delta: "-0.005em"
        spatial:
          padding:
            before: "64px"
            after: "56px"
            delta: "-8px"
          direction: "TIGHTER"
        structural:
          border_left:
            before: "none"
            after: "none"
            change: "SAME"
          transition_element:
            type: "spacing shift"
            css: "margin-top: 48px;"
        behavioral:
          transition_speed:
            before: "0.3s ease-in-out"
            after: "0.3s ease-in-out"
          hover_character: "same"
        material:
          depth_technique: "none"
          surface_shift: "same"
      channel_count: 2  # typographic + spatial
      pass: true  # SECTION type requires >= 2

    # === ZONE BOUNDARY: SURFACE -> SEDIMENT ===
    - id: "Z1-Z2"
      type: ZONE
      transition: HARD_CUT
      semantic_direction: "DEEPENING"
      intensity: MODERATE
      channels:
        chromatic:
          before: "#FEF9F5"
          after: "#F0EBE3"
          delta_rgb: 41  # |254-240| + |249-235| + |245-227| = 14+14+18 = 46... let me recompute
          # #FEF9F5 = R254 G249 B245
          # #F0EBE3 = R240 G235 B227
          # delta = |254-240| + |249-235| + |245-227| = 14 + 14 + 18 = 46
          direction: "WARMER"
          pass: true  # 46 >= 15
        typographic:
          font_size:
            before: "17px"
            after: "16px"
            delta: "-1px"
          font_weight:
            before: 400
            after: 400
            delta: 0
          line_height:
            before: 1.75
            after: 1.65
            delta: -0.10
          letter_spacing:
            before: "0.005em"
            after: "0em"
            delta: "-0.005em"
        spatial:
          padding:
            before: "56px"
            after: "40px"
            delta: "-16px"
          direction: "TIGHTER"
        structural:
          border_left:
            before: "none"
            after: "1px solid #E0D5C5"
            change: "ADD"
          transition_element:
            type: "3px primary border"
            css: |
              border-top: 3px solid var(--color-primary);
              margin-top: 48px;
              margin-bottom: 0;
        behavioral:
          transition_speed:
            before: "0.3s ease-in-out"
            after: "0.3s ease-in-out"
          hover_character: "same"
        material:
          depth_technique: "weight-increase"
          surface_shift: "paper-to-earth"
      channel_count: 4  # chromatic + typographic(line_height) + spatial + structural
      pass: true  # 4 >= 3

    # === SECTION BOUNDARY WITHIN ZONE 2 ===
    - id: "S3-S4"
      type: SECTION
      transition: SPACING_SHIFT
      semantic_direction: "INTENSIFYING"
      intensity: SUBTLE
      channels:
        chromatic:
          before: "#F0EBE3"
          after: "#F0EBE3"
          delta_rgb: 0
          direction: "SAME"
          pass: true
        typographic:
          font_size:
            before: "16px"
            after: "16px"
            delta: "0"
          font_weight:
            before: 400
            after: 500
            delta: 100
          line_height:
            before: 1.65
            after: 1.6
            delta: -0.05
          letter_spacing:
            before: "0em"
            after: "0em"
            delta: "0"
        spatial:
          padding:
            before: "40px"
            after: "32px"
            delta: "-8px"
          direction: "TIGHTER"
        structural:
          border_left:
            before: "1px solid #E0D5C5"
            after: "1px solid #E0D5C5"
            change: "SAME"
          transition_element:
            type: "spacing shift"
            css: "margin-top: 40px;"
        behavioral:
          transition_speed:
            before: "0.3s ease-in-out"
            after: "0.3s ease-in-out"
          hover_character: "same"
        material:
          depth_technique: "none"
          surface_shift: "same"
      channel_count: 2  # typographic(font_weight) + spatial
      pass: true  # SECTION requires >= 2

    - id: "S4-S5"
      type: SECTION
      transition: CHECKPOINT
      semantic_direction: "CONSOLIDATING"
      intensity: MODERATE
      channels:
        chromatic:
          before: "#F0EBE3"
          after: "#F0EBE3"
          delta_rgb: 0
          direction: "SAME"
          pass: true
        typographic:
          font_size:
            before: "16px"
            after: "15px"
            delta: "-1px"
          font_weight:
            before: 500
            after: 500
            delta: 0
          line_height:
            before: 1.6
            after: 1.55
            delta: -0.05
          letter_spacing:
            before: "0em"
            after: "0em"
            delta: "0"
        spatial:
          padding:
            before: "32px"
            after: "28px"
            delta: "-4px"
          direction: "TIGHTER"
        structural:
          border_left:
            before: "1px solid #E0D5C5"
            after: "3px solid #1A1A1A"
            change: "INCREASE"
          transition_element:
            type: "checkpoint with label"
            css: |
              .checkpoint-s4s5 {
                background: #F0EBE3;
                border-left: 4px solid var(--color-primary);
                padding: 16px 24px;
                font-family: var(--font-mono);
                font-size: 0.75rem;
                text-transform: uppercase;
                letter-spacing: 0.1em;
              }
        behavioral:
          transition_speed:
            before: "0.3s ease-in-out"
            after: "0.3s ease-in-out"
          hover_character: "same"
        material:
          depth_technique: "none"
          surface_shift: "same"
      channel_count: 3  # typographic(font_size + line_height) + spatial + structural
      pass: true

    # === ZONE BOUNDARY: SEDIMENT -> CORE ===
    - id: "Z2-Z3"
      type: ZONE
      transition: HARD_CUT
      semantic_direction: "COMPRESSING"
      intensity: STRONG
      channels:
        chromatic:
          before: "#F0EBE3"
          after: "#FAF5ED"
          # #F0EBE3 = R240 G235 B227
          # #FAF5ED = R250 G245 B237
          # delta = |240-250| + |235-245| + |227-237| = 10 + 10 + 10 = 30
          delta_rgb: 30
          direction: "LIGHTER"
          pass: true  # 30 >= 15
        typographic:
          font_size:
            before: "15px"
            after: "15px"
            delta: "0"
          font_weight:
            before: 500
            after: 600
            delta: 100
          line_height:
            before: 1.55
            after: 1.5
            delta: -0.05
          letter_spacing:
            before: "0em"
            after: "-0.01em"
            delta: "-0.01em"
        spatial:
          padding:
            before: "28px"
            after: "24px"
            delta: "-4px"
          direction: "TIGHTER"
        structural:
          border_left:
            before: "3px solid #1A1A1A"
            after: "4px solid #1A1A1A"
            change: "INCREASE"
          transition_element:
            type: "3px primary border"
            css: |
              border-top: 3px solid var(--color-primary);
              margin-top: 40px;
              margin-bottom: 0;
        behavioral:
          transition_speed:
            before: "0.3s ease-in-out"
            after: "0.35s ease-in"
          hover_character: "REVEAL"
        material:
          depth_technique: "weight-increase"
          surface_shift: "earth-to-stone"
      channel_count: 5  # chromatic + typographic(font_weight) + spatial + structural + material
      pass: true  # 5 >= 3

    # === SECTION BOUNDARY WITHIN ZONE 3 ===
    - id: "S6-S7"
      type: SECTION
      transition: SPACING_SHIFT
      semantic_direction: "FOCUSING"
      intensity: MODERATE
      channels:
        chromatic:
          before: "#FAF5ED"
          after: "#FAF5ED"
          delta_rgb: 0
          direction: "SAME"
          pass: true
        typographic:
          font_size:
            before: "15px"
            after: "15px"
            delta: "0"
          font_weight:
            before: 600
            after: 600
            delta: 0
          line_height:
            before: 1.5
            after: 1.5
            delta: 0
          letter_spacing:
            before: "-0.01em"
            after: "-0.01em"
            delta: "0"
        spatial:
          padding:
            before: "24px"
            after: "20px"
            delta: "-4px"
          direction: "TIGHTER"
        structural:
          border_left:
            before: "4px solid #1A1A1A"
            after: "4px solid #1A1A1A"
            change: "SAME"
          transition_element:
            type: "spacing shift"
            css: "margin-top: 32px;"
        behavioral:
          transition_speed:
            before: "0.35s ease-in"
            after: "0.35s ease-in"
          hover_character: "same"
        material:
          depth_technique: "solid-offset"
          surface_shift: "same"
      channel_count: 2  # spatial + material
      pass: true  # SECTION requires >= 2

    # === ZONE BOUNDARY: CORE -> BEDROCK ===
    - id: "Z3-Z4"
      type: ZONE
      transition: HARD_CUT
      semantic_direction: "ANCHORING"
      intensity: STRONG
      channels:
        chromatic:
          before: "#FAF5ED"
          after: "#1A1A1A"
          # #FAF5ED = R250 G245 B237
          # #1A1A1A = R26 G26 B26
          # delta = 224 + 219 + 211 = 654
          delta_rgb: 654
          direction: "DARKER"
          pass: true  # 654 >> 15
        typographic:
          font_size:
            before: "15px"
            after: "14px"
            delta: "-1px"
          font_weight:
            before: 600
            after: 400
            delta: -200
          line_height:
            before: 1.5
            after: 1.6
            delta: 0.1
          letter_spacing:
            before: "-0.01em"
            after: "0.05em"
            delta: "0.06em"
        spatial:
          padding:
            before: "20px"
            after: "48px"
            delta: "+28px"
          direction: "LOOSER"
        structural:
          border_left:
            before: "4px solid #1A1A1A"
            after: "none"
            change: "REMOVE"
          transition_element:
            type: "3px primary border"
            css: |
              border-top: 3px solid var(--color-primary);
              margin-top: 48px;
              margin-bottom: 0;
        behavioral:
          transition_speed:
            before: "0.35s ease-in"
            after: "0.4s ease-in-out"
          hover_character: "HIGHLIGHT"
        material:
          depth_technique: "dark-inversion"
          surface_shift: "stone-to-bedrock"
      channel_count: 6  # ALL channels shift
      pass: true  # 6 >= 3
```

### 2.3 Summary View (Quick Reference for Builder)

The full YAML above is the authoritative source. For quick reference during building, a rendered summary:

```
TRANSITION TABLE SUMMARY: Geological Strata (8 sections, 4 zones)
Coherence rule: Deeper = denser = darker = heavier
Intensity arc: ACCELERATING

BOUNDARY    | TYPE    | DIRECTION     | BG BEFORE  | BG AFTER   | DELTA | CH# | PASS
------------|---------|---------------|------------|------------|-------|-----|-----
S1->S2      | SECTION | BUILDING      | #FEF9F5    | #FEF9F5    |   0   |  2  | YES
Z1->Z2      | ZONE    | DEEPENING     | #FEF9F5    | #F0EBE3    |  46   |  4  | YES
S3->S4      | SECTION | INTENSIFYING  | #F0EBE3    | #F0EBE3    |   0   |  2  | YES
S4->S5      | SECTION | CONSOLIDATING | #F0EBE3    | #F0EBE3    |   0   |  3  | YES
Z2->Z3      | ZONE    | COMPRESSING   | #F0EBE3    | #FAF5ED    |  30   |  5  | YES
S6->S7      | SECTION | FOCUSING      | #FAF5ED    | #FAF5ED    |   0   |  2  | YES
Z3->Z4      | ZONE    | ANCHORING     | #FAF5ED    | #1A1A1A    | 654   |  6  | YES
```

---

## 3. TC GENERATION: How the Planner Creates This Table

### 3.1 Input to TC Phase 4.8 (New Sub-Phase)

TC Phase 4.8 ("Transition Table Generation") runs AFTER:
- Phase 0: Content assessment (section count, content classification)
- Phase 0D: Zone architecture (zone count, density pattern)
- Phase 1: Multi-axis questioning (reader needs)
- Phase 2: Tension derivation (genuine tensions)
- Phase 3: Metaphor collapse (committed metaphor + isomorphism table)
- Phase 3.5: Lock-in gate (metaphor validated)
- Phase 4.0-4.7B: Property extraction, coherence checking, transition grammar, fractal gate

TC has FULL compositional context at this point: metaphor, zones, mechanisms, transitions, coherence rules.

### 3.2 Generation Protocol (Step by Step)

```
PHASE 4.8: TRANSITION TABLE GENERATION

INPUT:
  - Zone architecture (zones, section-to-zone mapping)
  - Committed metaphor + isomorphism table
  - Mechanism deployment per category
  - Coherence rules C-1 through C-5
  - Transition grammar (HARD_CUT / SPACING_SHIFT / CHECKPOINT assignments)
  - Intensity arc from density pattern

STEP 1: ESTABLISH ZONE BASELINES
  For each zone, determine the 6-channel baseline:
    Chromatic:   Background hex from zone palette (already decided in Phase 0D)
    Typographic: Font-size, weight, line-height, letter-spacing for body text
                 (derive from Translation Grammar table + metaphor depth)
    Spatial:     Zone padding (derive from density pattern + spacing scale)
    Structural:  Border-left default for elements in this zone
                 (derive from border-weight gradient assignment)
    Behavioral:  Transition speed and hover character
                 (derive from metaphor weight: heavy=slow, light=fast)
    Material:    Depth technique and surface quality
                 (derive from metaphor material properties)

STEP 2: COMPUTE DELTAS AT EVERY BOUNDARY
  For each adjacent section pair (S_n, S_{n+1}):
    For each channel:
      delta = value_after - value_before
      direction = label the delta (WARMER, TIGHTER, HEAVIER, etc.)
    Count channels with non-zero deltas = channel_count

STEP 3: VERIFY MULTI-COHERENCE
  For ZONE boundaries: channel_count must be >= 3
  For SECTION boundaries: channel_count must be >= 2
  If any boundary FAILS:
    ADD channels. Identify the cheapest perceptible shift:
      Priority 1: Spatial (padding delta >= 8px = cheapest perceptible)
      Priority 2: Typographic (line-height delta >= 0.05 = low visual cost)
      Priority 3: Structural (add or remove 1px border = binary)
      Priority 4: Chromatic (only if same-zone allows sub-delta)
    Re-compute until all boundaries pass.

STEP 4: VERIFY COHERENCE RULE
  Apply Rule C-1: All channel directions must be CONSISTENT with the coherence rule.
  "Deeper = denser = darker = heavier" means:
    Chromatic: backgrounds should get WARMER or DARKER as depth increases
    Typographic: line-height should DECREASE, font-weight should INCREASE
    Spatial: padding should DECREASE
    Structural: borders should get HEAVIER
  If any channel contradicts the coherence direction at a zone boundary:
    FIX the contradicting channel.
    Document exception if semantically justified (e.g., bedrock footer
    LOOSENS spacing for breathing room -- justified by structural bookend).

STEP 5: VERIFY INTENSITY ARC
  For ACCELERATING arc: delta magnitudes should INCREASE from top to bottom.
    Z1-Z2 deltas < Z2-Z3 deltas < Z3-Z4 deltas
  For MAINTAINING: deltas should be roughly EQUAL.
  For DECELERATING: deltas should DECREASE.
  For CRESCENDO_DIMINUENDO: deltas should INCREASE then DECREASE.
  If arc is violated: adjust delta magnitudes to match arc type.

STEP 6: VERIFY PERCEPTION THRESHOLDS
  For every value in the table:
    Background delta >= 15 RGB (or 0 if same-zone)
    Font-size delta >= 2px between typographic zones (display/body/detail)
    Letter-spacing: no value between 0.001em and 0.029em (dead zone)
    Stacked gap at each boundary <= 108px
    Heading font-weight varies by at least 100 between zones
  Mark each threshold check as pass/fail in the table.

STEP 7: EMBED CSS SNIPPETS
  For each transition element, write the exact CSS the builder should use.
  For zone backgrounds, write CSS custom properties.
  This makes the table a CODE artifact, not just a DATA artifact.

OUTPUT:
  _transition-table.yaml (the full YAML as defined in Section 1.2)
  Embedded in _build-plan.md under "## Transition Table" heading
```

### 3.3 TC Effort Estimate

TC already derives all the information needed (zone backgrounds, transitions, mechanisms, coherence direction). Phase 4.8 restructures existing output into the transition table format. Estimated additional TC time: 10-15 minutes.

---

## 4. BUILDER CONSUMPTION: How the Builder Reads and Uses This Table

### 4.1 Builder Reading Protocol

The builder receives the transition table as part of `_build-plan.md`. The table is the PRIMARY navigation document for Phases 3-6 of the recipe.

```
BUILDER READING PROTOCOL FOR TRANSITION TABLE

PHASE 0 (ABSORB):
  Read the metadata block. Internalize:
    - Coherence rule (post this above your CSS file as a comment)
    - Intensity arc (this tells you whether shifts get bigger or smaller)
    - Zone count and density labels

PHASE 3 (ZONE BACKGROUNDS):
  Read the chromatic channel column ONLY.
  For each zone in the zones[] array:
    Set background-color to the zone's palette color.
  Verify: each zone boundary's delta_rgb >= 15. (Pre-computed in table.)

PHASE 3.5 (SPATIAL RHYTHM -- if adopted from Report 08):
  Read the spatial channel column ONLY.
  For each zone:
    Set section padding from the spatial.padding.before value.
  For each boundary:
    Verify delta matches the planned direction (TIGHTER / LOOSER).

PHASE 4 (STRUCTURAL BORDERS + TRANSITIONS):
  Read the structural channel column ONLY.
  For each boundary:
    Implement the transition_element.css EXACTLY as written.
    Set border-left on sections AFTER the boundary to the "after" value.
  Check: >= 3 transition types used across all boundaries.

PHASE 5 (TYPOGRAPHY):
  Read the typographic channel column ONLY.
  For each zone:
    Set body font-size, font-weight, line-height, letter-spacing
    from the boundary's "after" values (which become the zone's baseline).
  Verify: font-size delta >= 2px between display/body/detail.

PHASE 6 (ELEMENT-LEVEL RICHNESS):
  Read behavioral and material columns.
  Set transition speeds and hover characters per zone.
  Deploy depth techniques (solid-offset, dark-inversion) as specified.
```

### 4.2 Each Row Becomes a CSS Block

Yes. Each boundary row in the transition table maps to a CSS block. The builder translates the row into CSS by reading each channel's "after" value:

**Example: Boundary Z1-Z2 becomes:**

```css
/* === ZONE BOUNDARY: Z1-Z2 (DEEPENING) === */
/* Chromatic: #FEF9F5 -> #F0EBE3 (delta 46, WARMER) */
.zone-2 { background-color: #F0EBE3; }

/* Typographic: line-height 1.75 -> 1.65 */
.zone-2 p { line-height: 1.65; }
.zone-2 h2 { font-weight: 600; }  /* heading weight increases with depth */

/* Spatial: 56px -> 40px (TIGHTER) */
.zone-2 .section { padding: 40px 32px; }

/* Structural: none -> 1px subtle border */
.zone-2 .callout { border-left: 1px solid var(--color-border); }

/* Transition element: HARD CUT (3px primary border) */
.zone-2 { border-top: 3px solid var(--color-primary); }
```

**Example: Boundary Z2-Z3 becomes:**

```css
/* === ZONE BOUNDARY: Z2-Z3 (COMPRESSING) === */
/* Chromatic: #F0EBE3 -> #FAF5ED (delta 30, LIGHTER) */
.zone-3 { background-color: #FAF5ED; }

/* Typographic: font-weight 500 -> 600, line-height 1.55 -> 1.5 */
.zone-3 p { font-weight: 600; line-height: 1.5; }

/* Spatial: 28px -> 24px (TIGHTER) */
.zone-3 .section { padding: 24px 32px; }

/* Structural: 3px -> 4px (INCREASE) */
.zone-3 .callout { border-left: 4px solid var(--color-text); }

/* Behavioral: transition speed slows (0.3s -> 0.35s) = heavier feel */
.zone-3 a { transition: color 0.35s ease-in; }
.zone-3 .data-table tbody tr { transition: background-color 0.35s ease-in; }

/* Material: weight-increase, earth-to-stone */
/* (Expressed through heavier borders and tighter spacing -- no new CSS needed) */

/* Transition element: HARD CUT */
.zone-3 { border-top: 3px solid var(--color-primary); }
```

### 4.3 Builder Override Protocol

The builder may discover that a planned value does not work in practice (e.g., a background color clashes with component tints, or a font-size change creates awkward line breaks). Override protocol:

```
IF you must override a transition table value:
  1. Change the CSS value to what works.
  2. Record the override: "OVERRIDE Z2-Z3 chromatic: planned #FAF5ED, actual #F8F2E8 (reason: planned color too similar to callout background tint)"
  3. Verify the override still passes perception thresholds.
  4. If the override changes channel_count (e.g., removing a channel shift), ADD a different channel to compensate.
```

---

## 5. GATE VERIFICATION: How gate-runner.js Parses and Verifies

### 5.1 Gate Runner Input

The gate runner receives two artifacts:
1. **PLAN:** `_transition-table.yaml` (from TC planner, the intended values)
2. **PROOF:** The built HTML file (from builder, the actual output)

### 5.2 Verification Algorithm

```javascript
// gate-runner.js: SC-TRANSITION (Transition Table Verification)
// Runs in Playwright after page load

async function verifyTransitionTable(page, transitionTable) {
  const results = [];

  // Parse YAML transition table
  const table = parseYAML(transitionTable);

  for (const boundary of table.boundaries) {
    const result = { id: boundary.id, checks: [] };

    // 1. Get computed styles for the section BEFORE the boundary
    const beforeSection = boundary.id.split('-')[0]; // "S2" from "S2-S3"
    const afterSection = boundary.id.split('-')[1];  // "S3" from "S2-S3"

    // For zone boundaries, use last section of prev zone + first section of next zone
    const beforeEl = await page.$(`[data-section="${beforeSection}"] p`);
    const afterEl = await page.$(`[data-section="${afterSection}"] p`);

    if (!beforeEl || !afterEl) {
      result.checks.push({ check: 'elements_found', pass: false });
      results.push(result);
      continue;
    }

    const beforeStyles = await beforeEl.evaluate(el => {
      const cs = getComputedStyle(el);
      return {
        backgroundColor: cs.backgroundColor,
        fontSize: cs.fontSize,
        fontWeight: cs.fontWeight,
        lineHeight: cs.lineHeight,
        letterSpacing: cs.letterSpacing,
        borderLeft: cs.borderLeftWidth + ' ' + cs.borderLeftStyle + ' ' + cs.borderLeftColor,
        marginBottom: cs.marginBottom
      };
    });

    const afterStyles = await afterEl.evaluate(el => {
      const cs = getComputedStyle(el);
      return {
        backgroundColor: cs.backgroundColor,
        fontSize: cs.fontSize,
        fontWeight: cs.fontWeight,
        lineHeight: cs.lineHeight,
        letterSpacing: cs.letterSpacing,
        borderLeft: cs.borderLeftWidth + ' ' + cs.borderLeftStyle + ' ' + cs.borderLeftColor,
        marginTop: cs.marginTop
      };
    });

    // 2. CHROMATIC CHECK: Compare backgrounds
    const beforeBg = rgbToHex(beforeStyles.backgroundColor);
    const afterBg = rgbToHex(afterStyles.backgroundColor);
    const bgDelta = computeRGBDelta(beforeBg, afterBg);

    // Compare against planned values (with tolerance)
    const plannedBeforeBg = boundary.channels.chromatic.before;
    const plannedAfterBg = boundary.channels.chromatic.after;
    const bgMatchesPlan = hexDistance(afterBg, plannedAfterBg) <= 5; // 5 RGB tolerance

    result.checks.push({
      check: 'chromatic_delta',
      planned: boundary.channels.chromatic.delta_rgb,
      actual: bgDelta,
      pass: boundary.type === 'ZONE' ? bgDelta >= 15 : true,
      matches_plan: bgMatchesPlan
    });

    // 3. TYPOGRAPHIC CHECK: Compare font properties
    const fontSizeBefore = parseFloat(beforeStyles.fontSize);
    const fontSizeAfter = parseFloat(afterStyles.fontSize);
    const fontSizeDelta = fontSizeAfter - fontSizeBefore;

    const fontWeightBefore = parseInt(beforeStyles.fontWeight);
    const fontWeightAfter = parseInt(afterStyles.fontWeight);
    const fontWeightDelta = fontWeightAfter - fontWeightBefore;

    result.checks.push({
      check: 'typographic_font_size_delta',
      planned: boundary.channels.typographic.font_size.delta,
      actual: `${fontSizeDelta}px`,
      pass: true  // font-size delta verified at typographic zone level, not per-boundary
    });

    result.checks.push({
      check: 'typographic_font_weight_delta',
      planned: boundary.channels.typographic.font_weight.delta,
      actual: fontWeightDelta,
      pass: true
    });

    // 4. SPATIAL CHECK: Compare padding
    // (Requires measuring the section container, not just paragraph)
    const beforeContainer = await page.$(`[data-section="${beforeSection}"]`);
    const afterContainer = await page.$(`[data-section="${afterSection}"]`);

    if (beforeContainer && afterContainer) {
      const paddingBefore = await beforeContainer.evaluate(
        el => parseFloat(getComputedStyle(el).paddingTop)
      );
      const paddingAfter = await afterContainer.evaluate(
        el => parseFloat(getComputedStyle(el).paddingTop)
      );

      result.checks.push({
        check: 'spatial_padding',
        planned_before: boundary.channels.spatial.padding.before,
        planned_after: boundary.channels.spatial.padding.after,
        actual_before: `${paddingBefore}px`,
        actual_after: `${paddingAfter}px`,
        pass: true  // verify direction matches
      });
    }

    // 5. STRUCTURAL CHECK: Compare border-left
    const borderBefore = beforeStyles.borderLeft;
    const borderAfter = afterStyles.borderLeft; // Note: check on callout elements, not p

    result.checks.push({
      check: 'structural_border',
      planned_change: boundary.channels.structural.border_left.change,
      actual_before: borderBefore,
      actual_after: borderAfter,
      pass: true  // verify change direction matches plan
    });

    // 6. STACKED GAP CHECK: Measure total gap at boundary
    if (beforeContainer && afterContainer) {
      const gap = await page.evaluate(
        ([beforeSel, afterSel]) => {
          const before = document.querySelector(`[data-section="${beforeSel}"]`);
          const after = document.querySelector(`[data-section="${afterSel}"]`);
          if (!before || !after) return 0;
          const beforeRect = before.getBoundingClientRect();
          const afterRect = after.getBoundingClientRect();
          return afterRect.top - beforeRect.bottom;
        },
        [beforeSection, afterSection]
      );

      result.checks.push({
        check: 'stacked_gap',
        actual: `${gap}px`,
        pass: gap <= 108,
        threshold: '<=108px'
      });
    }

    // 7. CHANNEL COUNT: Count channels that actually shifted
    let actualChannelCount = 0;
    if (bgDelta > 5) actualChannelCount++;      // chromatic shifted
    if (Math.abs(fontSizeDelta) >= 1) actualChannelCount++;  // typographic shifted (size)
    if (Math.abs(fontWeightDelta) >= 100) actualChannelCount++; // typographic shifted (weight)
    // ... additional channel counting logic for spatial, structural, behavioral, material

    const requiredChannels = boundary.type === 'ZONE' ? 3 : 2;

    result.checks.push({
      check: 'multi_coherence',
      planned_channels: boundary.channel_count,
      actual_channels: actualChannelCount,
      required: requiredChannels,
      pass: actualChannelCount >= requiredChannels
    });

    results.push(result);
  }

  return results;
}

// Helper: Convert rgb(R, G, B) string to hex
function rgbToHex(rgb) {
  const match = rgb.match(/\d+/g);
  if (!match) return '#000000';
  return '#' + match.slice(0, 3).map(
    n => parseInt(n).toString(16).padStart(2, '0')
  ).join('');
}

// Helper: Compute sum of absolute RGB channel deltas
function computeRGBDelta(hex1, hex2) {
  const r1 = parseInt(hex1.slice(1,3), 16);
  const g1 = parseInt(hex1.slice(3,5), 16);
  const b1 = parseInt(hex1.slice(5,7), 16);
  const r2 = parseInt(hex2.slice(1,3), 16);
  const g2 = parseInt(hex2.slice(3,5), 16);
  const b2 = parseInt(hex2.slice(5,7), 16);
  return Math.abs(r1-r2) + Math.abs(g1-g2) + Math.abs(b1-b2);
}

// Helper: Distance between two hex colors
function hexDistance(hex1, hex2) {
  return computeRGBDelta(hex1, hex2);
}
```

### 5.3 Gate Output Format

```yaml
# gate-verification-results.yaml
gate: SC-TRANSITION
status: PASS  # or FAIL
boundaries:
  - id: "Z1-Z2"
    multi_coherence:
      planned: 4
      actual: 4
      required: 3
      pass: true
    chromatic:
      planned_after: "#F0EBE3"
      actual_after: "#F0EBE3"
      matches: true
      delta: 46
      threshold: 15
      pass: true
    stacked_gap:
      actual: "48px"
      threshold: "108px"
      pass: true
  - id: "Z2-Z3"
    # ... etc
```

---

## 6. PA EVALUATION: How Auditors Reference Without Losing Fresh-Eyes

### 6.1 The Tension

PA auditors must evaluate with ZERO build context (fresh-eyes principle). But the transition table's value is that it makes compositional intent VERIFIABLE. How do you reference the table without contaminating the audit?

### 6.2 Solution: Two-Phase PA

**Phase 1 (Standard): Fresh-Eyes Evaluation**

The 9 PA auditors receive ONLY screenshots plus their assigned questions. They evaluate perception without any knowledge of the transition table. This is unchanged from current Mode 4 protocol.

PA-05 scoring is done here: "Does this feel DESIGNED?" The auditors have no idea what the transition table planned. Their evaluation is pure perception.

**Phase 2 (Post-Verdict): Transition Table Cross-Reference**

AFTER the PA weaver produces the verdict (PA-05 score + top-3 findings), a SECOND evaluation occurs. The PA weaver (or a designated cross-reference agent) receives:

1. The PA verdict (from Phase 1)
2. The transition table (from TC)
3. The gate verification results (from gate-runner)

The cross-reference agent maps PA findings to transition table boundaries:

```
PA FINDING: "Zone 2 and Zone 3 look almost identical -- the background shift
is barely noticeable."

TRANSITION TABLE REFERENCE: Z2-Z3 boundary
  Planned chromatic delta: 30 RGB
  Gate verification: actual delta = 28 RGB (matches plan within tolerance)

DIAGNOSIS: The PLANNED delta was 30 RGB (above 15 threshold) and was
IMPLEMENTED correctly (28 actual). But the PA found it perceptually insufficient.
This is a THRESHOLD PROBLEM, not an EXECUTION PROBLEM.

RECOMMENDATION: Increase Z2-Z3 chromatic delta to >= 40 RGB for this
color pair. Update perception thresholds for similar warm-cream transitions.
```

This cross-reference:
- Does NOT contaminate the fresh-eyes evaluation (Phase 1 is complete)
- DOES connect perception to composition (maps "looks similar" to specific boundary)
- DOES distinguish execution failure from planning failure
- DOES inform fix-cycle with compositional diagnosis, not just perceptual symptoms

### 6.3 PA Weaver Protocol Update

```
PA WEAVER PROTOCOL (updated for transition table):

STEP 1: Synthesize 9 auditor reports into PA-05 score + top-3 findings
  (Unchanged -- this is the fresh-eyes verdict)

STEP 2: Cross-reference findings against transition table
  For each top-3 finding:
    a. Identify the BOUNDARY in the transition table that the finding relates to
    b. Check the gate verification results for that boundary
    c. Classify the finding:
       - PLANNING FAILURE: planned delta was too small (TC error)
       - EXECUTION FAILURE: actual delta differs from plan (builder error)
       - THRESHOLD FAILURE: planned and actual match but perception says insufficient
       - COHERENCE FAILURE: channels shifted but not in the same direction
    d. Write the classification + specific fix recommendation

STEP 3: Output weaver report with:
  - PA-05 score (from Step 1, unchanged)
  - Top-3 findings (from Step 1, unchanged)
  - Transition table cross-reference (from Step 2, NEW)
  - Fix recommendations with specific boundary IDs and CSS values
```

---

## 7. LOSSLESS PROPAGATION PROOF

### 7.1 Trace of a Single Value: Background Color `#F0EBE3`

| Stage | Format | Value | Exact? |
|-------|--------|-------|--------|
| **TC Planner** (Phase 4.8) | YAML string | `"#F0EBE3"` | YES |
| **_build-plan.md** (transition table) | YAML string | `"#F0EBE3"` | YES (same file) |
| **Builder reads** | YAML parsed by LLM | `#F0EBE3` | YES (unambiguous hex) |
| **Builder writes CSS** | CSS declaration | `background: #F0EBE3;` | YES (copied from table) |
| **Browser renders** | Computed style | `rgb(240, 235, 227)` | YES (mathematical conversion) |
| **Gate runner reads** | Playwright getComputedStyle | `rgb(240, 235, 227)` | YES |
| **Gate runner converts** | JavaScript hexToRgb | `#F0EBE3` | YES (bit-exact reversal) |
| **Gate runner compares** | String comparison | `#F0EBE3 === #F0EBE3` | YES (PASS) |
| **PA auditor sees** | Screenshot pixel | Rendered `#F0EBE3` | YES (perceptual) |

**The same value `#F0EBE3` appears at EVERY stage in its native format.** No prose description, no re-derivation, no compression. The hex travels as data, not as text.

### 7.2 Trace of a Structural Decision: Border-Left at Z2-Z3

| Stage | Format | Value | Exact? |
|-------|--------|-------|--------|
| **TC Planner** | YAML | `change: "INCREASE"`, `before: "3px solid #1A1A1A"`, `after: "4px solid #1A1A1A"` | YES |
| **Builder reads** | YAML parsed | Border increases from 3px to 4px | YES |
| **Builder writes** | CSS | `.zone-3 .callout { border-left: 4px solid var(--color-text); }` | YES (var resolved to #1A1A1A) |
| **Gate runner** | Computed style | `borderLeftWidth: "4px"`, `borderLeftColor: "rgb(26, 26, 26)"` | YES |
| **Gate compares** | Number comparison | `4px === planned 4px` | YES (PASS) |
| **PA sees** | Screenshot | 4px dark border visible | YES (perceptual) |

### 7.3 Trace of Multi-Coherence: Channel Count at Z1-Z2

| Stage | Format | Value |
|-------|--------|-------|
| **TC plans** | YAML count | `channel_count: 4` (chromatic + typographic + spatial + structural) |
| **Builder executes** | CSS changes | 4 CSS property groups changed at this boundary |
| **Gate runner counts** | Programmatic | Measures 4 channels with non-zero delta |
| **Gate verifies** | Comparison | `4 >= 3` = PASS |
| **PA perceives** | Gestalt | "This boundary feels like a SHIFT, not just a line" |

The multi-coherence count is PLANNED (TC writes 4), EXECUTED (builder changes 4 properties), VERIFIED (gate measures 4 deltas), and PERCEIVED (PA feels the atmospheric change). The number 4 propagates through data, code, measurement, and perception.

### 7.4 Where Lossless Propagation Breaks Down

Two cases where propagation is NOT perfectly lossless:

1. **Builder override:** If the builder changes `#F0EBE3` to `#EDE5DA` (justified by component tint conflict), the gate runner detects the discrepancy (hex distance > 5 tolerance). The override is LOGGED, not silent. The deviation is KNOWN, not hidden.

2. **Behavioral/material channels:** These channels cannot be verified by screenshot-based PA (Report 10, Section 7). The transition table specifies behavioral values (`transition: 0.35s ease-in`) but PA cannot confirm them perceptually. Gate runner CAN verify them via Playwright hover/transition measurement (Report 10, R-B05). Propagation is lossless TC-to-gate but NOT verifiable TC-to-PA for behavioral/material.

---

## 8. INTEGRATION WITH RECIPE PHASES

### 8.1 How the Transition Table Maps to the Hybrid Scale-Organized Recipe (Report 17)

Report 17 recommends a hybrid scale-organized recipe with boundary checkpoints. The transition table is the DATA that populates those checkpoints:

```
Phase 3 (PAGE SCALE):
  [Builder reads zones[] from transition table]
  [Builder applies zone backgrounds from chromatic channel]
  >>> BOUNDARY CHECKPOINT: Read boundaries[] where type=ZONE.
  >>> For each zone boundary, verify channel_count >= 3.
  >>> This data IS the transition table's zone boundary rows.

Phase 4 (SECTION SCALE):
  [Builder reads boundaries[] where type=SECTION]
  [Builder applies section-level transitions and borders]
  >>> BOUNDARY CHECKPOINT: Read boundaries[] where type=SECTION.
  >>> For each section boundary, verify channel_count >= 2.

Phase 5 (COMPONENT SCALE):
  [Builder reads structural.border_left and material columns]
  [Builder applies per-component borders and depth techniques]
  >>> FRACTAL CHECKPOINT: Do component-level borders echo page-level border gradient?

Phase 8 (VERIFICATION):
  [Builder produces CASCADE VALUE TABLE by measuring actual computed styles]
  [Builder compares CASCADE VALUE TABLE against TRANSITION TABLE]
  [Discrepancies are OVERRIDES -- logged with justification]
```

### 8.2 Cascade Value Table vs Transition Table

These are NOT the same artifact:

| Property | Transition Table | Cascade Value Table |
|----------|-----------------|-------------------|
| **Who produces it** | TC Planner (Wave 0) | Builder (Wave 1, Phase 8) |
| **When** | BEFORE building | AFTER building |
| **What it contains** | PLANNED values | MEASURED computed values |
| **Format** | YAML (structured, rich) | Markdown table (flat, values only) |
| **Purpose** | GENERATIVE (guides the build) | VERIFICATORY (proves the build) |
| **Relationship** | INPUT to builder | OUTPUT from builder |

The gate runner compares TRANSITION TABLE (plan) against CASCADE VALUE TABLE (proof). Discrepancies are either OVERRIDES (justified, documented) or ERRORS (builder deviated without justification).

---

## 9. SIZING AND SCALABILITY

### 9.1 Table Size by Page Complexity

| Page Type | Zones | Sections | Boundaries | Table Lines (YAML) |
|-----------|-------|----------|------------|-------------------|
| Simple (2-zone) | 2 | 4 | 3 (1 zone + 2 section) | ~120 lines |
| Standard (3-zone) | 3 | 6 | 5 (2 zone + 3 section) | ~200 lines |
| Complex (4-zone) | 4 | 8 | 7 (3 zone + 4 section) | ~280 lines |
| Flagship (5-zone) | 5 | 12 | 11 (4 zone + 7 section) | ~440 lines |

Each boundary row is ~40 lines of YAML (6 channels x ~5 lines each + metadata).

### 9.2 Builder Reading Load

The builder does NOT read the full table linearly. Per the reading protocol (Section 4.1), the builder reads ONE channel column per phase:

- Phase 3: chromatic column only (~7 lines per boundary x boundaries = 28-77 lines)
- Phase 4: structural column only (~same)
- Phase 5: typographic column only (~same)
- Phase 6: behavioral + material columns (~same)

**Effective reading per phase: 30-80 lines.** This is within the "30-50 lines per phase" target from Report 17.

---

## 10. ADVERSARIAL CHALLENGES

### 10.1 "The table is too rigid -- it kills compositional fluency"

**Challenge:** If every value is pre-specified, the builder has no creative latitude. CD-006 scored 39/40 WITHOUT a transition table. The builder's compositional fluency contributed to quality.

**Response:** The table specifies 6-channel VALUES but not IMPLEMENTATION. The builder decides HOW to express `border-left: 4px solid #1A1A1A` -- as a class-level rule, as a component variant, as a zone override. The table provides the WHAT and HOW MUCH; the builder provides the HOW and WHERE. Additionally, the override protocol (Section 4.3) explicitly grants creative latitude with logging.

### 10.2 "TC can't reliably predict all 6 channels at every boundary"

**Challenge:** TC reasons at the strategic level. Predicting specific letter-spacing values or behavioral transition speeds requires tactical precision that TC may not have.

**Response:** The table uses RANGES for less critical channels. Behavioral and material channels can specify direction ("slow heavy transitions") without exact values. The builder fills in exact CSS. The table is MOST specific for chromatic (hex values) and structural (border values) where precision matters most, and LEAST specific for behavioral/material where direction matters more than exact values.

### 10.3 "The table adds 15 minutes to TC planning and 200-440 lines to the build plan"

**Challenge:** Complexity cost. The pipeline is already at risk of exceeding the 20:1 meta-to-output ratio.

**Response:** The transition table REPLACES several existing artifacts, not adds to them:
- Replaces the build plan's "zone backgrounds" section (currently ~10 lines, now embedded in chromatic channel)
- Replaces the build plan's "transition plan" section (currently ~15 lines, now embedded in structural channel)
- Replaces the cascade value table's PLANNING function (currently Phase 8 discovery, now Phase 3.5 data entry)

Net addition: ~150-300 lines to the build plan, offset by ~25-40 lines removed from other sections. The cascade value table in Phase 8 becomes CONFIRMATION (10 min) rather than DISCOVERY (30 min), saving 20 min of build time. Net time: roughly neutral.

### 10.4 "YAML parsing by LLMs is unreliable"

**Challenge:** LLM builders may misparse YAML indentation or confuse nested values.

**Response:** The transition table uses FLAT YAML (maximum 3 levels of nesting: boundaries -> channels -> properties). No deeply nested structures. All hex values are quoted strings. All numeric values use explicit units. The summary view (Section 2.3) provides a flat Markdown table as backup reference.

---

## 11. RELATIONSHIP TO OTHER POST-INVESTIGATION ARTIFACTS

| Artifact | Relationship to Transition Table |
|----------|--------------------------------|
| **Enriched TC Skill** (Task #69) | TC Phase 4.8 generates the transition table. The enriched skill MUST include the generation protocol. |
| **Revised PV2 Architecture** (Task #67) | The architecture diagram must show the transition table as the PRIMARY artifact flowing from TC to Builder to Gates. |
| **Gate Runner Architecture** (Task #73) | The gate runner's SC-TRANSITION gate consumes the transition table as its verification input. |
| **Recipe vs Principles Brief** (Task #72) | The transition table is the CONCRETE example of "recipe with YAML data blocks" beating "principles with abstract rules." |
| **Experiment Design** (Task #70) | The cheapest test: generate a transition table for CD-006's content, then have a builder execute it and compare PA-05 against CD-006's 39/40. |

---

## 12. SUMMARY

The Transition Table is:

1. **FORMAT:** YAML with embedded CSS snippets, 6 channels per boundary row
2. **GENERATED BY:** TC Planner Phase 4.8 (after metaphor lock-in, using existing compositional intelligence)
3. **CONSUMED BY:** Builder (one channel per recipe phase, exact CSS values copied), Gate Runner (computed style verification against planned values), PA Weaver (post-verdict cross-reference for diagnosis)
4. **SIZE:** 120-440 lines depending on page complexity (30-80 lines effective reading per phase)
5. **LOSSLESS:** The same hex values, pixel values, and border weights appear identically at TC output, builder input, CSS declaration, computed style measurement, and gate comparison
6. **MULTI-COHERENCE:** Each boundary row pre-computes `channel_count` and `pass` -- the builder cannot accidentally produce a boundary with < 3 shifting channels because the table specifies which channels shift where

The transition table transforms multi-coherence from an ASPIRATION ("channels should shift together") to a DATA ENTRY PROBLEM ("copy these values into your CSS"). It is the structural fix for the 50:1 compression loss that killed the flagship: compositional intelligence travels as CODE and DATA, not as TEXT.

---

**END OF REPORT**

**Statistics:**
- Schema fields defined: 47
- Example boundaries specified: 7 (complete 4-zone, 8-section page)
- Gate verification functions: 7 (chromatic, typographic, spatial, structural, stacked gap, channel count, plan comparison)
- Lossless propagation traces: 3 (chromatic value, structural decision, multi-coherence count)
- Adversarial challenges addressed: 4
- Integration points with other artifacts: 5
