{
  "items": [
    {
      "id": "inv-1",
      "type": "inversion",
      "linkedSection": "essence",
      "title": "What if Claude Code had no extension mechanism?",
      "content": "<strong>You'd design:</strong> Fork Claude Code for every custom behavior. Maintain your own version.<br>\n          <strong>Why this fails:</strong> Updates from Anthropic require manual merging. Custom forks drift and break.<br>\n          <strong>Hidden constraint revealed:</strong> Plugins are the contract that lets customization survive upgrades."
    },
    {
      "id": "min-2",
      "type": "minimal",
      "linkedSection": "essence",
      "title": "The irreducible plugin",
      "content": "<code style=\"background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;\">.claude-plugin/plugin.json + commands/run.md</code><br>\n          <strong>Essential:</strong> Manifest + one command.<br>\n          <strong>Everything else:</strong> Organization and capability expansion."
    },
    {
      "id": "ana-3",
      "type": "analogy",
      "linkedSection": "essence",
      "title": "Plugins = VS Code Extensions",
      "content": "Manifest (plugin.json) = package.json<br>\n          Commands = contributes.commands<br>\n          Hooks = activation events<br>\n          Skills = language services<br><br>\n          <em>If you've built VS Code extensions, you already understand Claude Code plugins.</em>"
    },
    {
      "id": "con-4",
      "type": "constraint",
      "linkedSection": "core",
      "title": "One primitive hierarchy -> FIVE benefits",
      "content": "<strong>ROOT:</strong> Plugin contains capabilities in defined hierarchy<br>\n          -&gt; Commands provide user-facing entry points<br>\n          -&gt; Skills provide domain knowledge injection<br>\n          -&gt; Hooks provide lifecycle integration<br>\n          -&gt; Agents provide specialized workers<br>\n          -&gt; Scripts provide setup automation"
    },
    {
      "id": "inv-5",
      "type": "invariant",
      "linkedSection": "core",
      "title": "Plugins, MCP, and CLAUDE.md all share INV-002",
      "content": "<strong>INV-002:</strong> External configuration &gt; internal state<br>\n          All three extend Claude Code through external files, not internal modification. The same principle enables all three extension mechanisms."
    },
    {
      "id": "exp-6",
      "type": "expertise",
      "linkedSection": "core",
      "title": "How deep is your plugin understanding?",
      "content": "<strong>Beginner:</strong> \"What's a plugin?\" -&gt; A package of capabilities<br>\n          <strong>Intermediate:</strong> \"What goes in manifest?\" -&gt; Commands, skills, hooks, agents<br>\n          <strong>Advanced:</strong> \"Why this hierarchy?\" -&gt; Each primitive has distinct trigger<br>\n          <strong>Staff:</strong> \"How do plugins compose?\" -&gt; The 6 composition rules<br>\n          <strong>Expert:</strong> \"When NOT to plugin?\" -&gt; Use CLAUDE.md for project-specific"
    },
    {
      "id": "war-7",
      "type": "warstory",
      "linkedSection": "core",
      "title": "Jarrod Watts: Claude HUD adoption",
      "content": "Open source visualization plugin. Shows how community plugins spread: real-time context bar became essential for power users debugging context management issues."
    },
    {
      "id": "vio-8",
      "type": "violation",
      "linkedSection": "decisions",
      "title": "If you skip the manifest",
      "content": "<strong>IF:</strong> You add commands without manifest entries<br>\n          <strong>THEN:</strong> Claude Code doesn't know the command exists<br>\n          <strong>THEN:</strong> <code>/plugin:command</code> fails silently<br>\n          <strong>THEN:</strong> You debug for hours wondering why<br>\n          <strong>FINALLY:</strong> Discovery: manifest is the contract<br><br>\n          <em>The fix: Every capability must be declared in plugin.json.</em>"
    },
    {
      "id": "trade-9",
      "type": "tradeoff",
      "linkedSection": "decisions",
      "title": "The Hook Granularity Dilemma",
      "content": "<strong>Coarse hooks:</strong> Simpler to reason about, but less control<br>\n          <strong>Fine hooks:</strong> Precise control, but complex interactions<br>\n          <strong>More hooks:</strong> More power, but more conflict potential<br><br>\n          <em>Claude Code chose 5 hooks. Enough for most cases, not so many they conflict.</em>"
    },
    {
      "id": "hor-10",
      "type": "horizon",
      "linkedSection": "decisions",
      "title": "How plugin perception evolves",
      "content": "<strong>Day 1:</strong> \"Plugins seem like overkill\"<br>\n          <strong>Week 2:</strong> \"I keep copying the same CLAUDE.md sections\"<br>\n          <strong>Month 1:</strong> \"This should be a plugin\"<br>\n          <strong>Month 3:</strong> \"My plugin workflow is faster than typing\"<br><br>\n          <em>Don't judge plugins by day 1. Judge them by month 3.</em>"
    },
    {
      "id": "inv-11",
      "type": "inversion",
      "linkedSection": "decisions",
      "title": "What if hooks were untyped?",
      "content": "<strong>You'd design:</strong> Generic \"onEvent\" with string matching<br>\n          <strong>Why this fails:</strong> No guarantee about available data. Plugins break on version updates.<br>\n          <strong>Hidden constraint revealed:</strong> Typed hooks (PreToolUse, PostToolUse, etc.) are the API contract."
    },
    {
      "id": "eff-12",
      "type": "effect",
      "linkedSection": "types",
      "title": "Memory plugins compound across sessions",
      "content": "<strong>At session 1:</strong> Memory plugin has nothing to inject<br>\n          <strong>At session 10:</strong> Memory plugin accelerates context setup<br>\n          <strong>At session 50:</strong> Memory plugin IS your institutional knowledge<br><br>\n          <em>Memory plugins show their value at scale, not at first use.</em>"
    },
    {
      "id": "comp-13",
      "type": "composition",
      "linkedSection": "types",
      "title": "Workflow Plugin + Memory Plugin",
      "content": "<strong>Works:</strong> Memory recalls context before workflow runs.<br>\n          <strong>Pattern:</strong> claude-mem:recall -&gt; workflow:execute -&gt; claude-mem:store<br>\n          <strong>Danger:</strong> Memory injection bloats context. Keep recall focused."
    },
    {
      "id": "grad-14",
      "type": "gradient",
      "linkedSection": "types",
      "title": "How security plugins degrade",
      "content": "<strong>100%:</strong> Every dangerous operation caught<br>\n          <strong>80%:</strong> New patterns slip through<br>\n          <strong>50%:</strong> False confidence (\"plugin will catch it\")<br>\n          <strong>CLIFF:</strong> Real attack uses uncovered vector<br><br>\n          <em>Security plugins are layers, not guarantees.</em>"
    },
    {
      "id": "ana-15",
      "type": "analogy",
      "linkedSection": "types",
      "title": "Plugin Types = Infrastructure Layers",
      "content": "Visualization = Monitoring (Datadog, Prometheus)<br>\n          Memory = Database (Postgres, Redis)<br>\n          Workflow = Orchestration (Airflow, Temporal)<br>\n          Security = Auth/Firewall (OAuth, WAF)<br><br>\n          <em>Same separation of concerns, different domain.</em>"
    },
    {
      "id": "inv-16",
      "type": "invariant",
      "linkedSection": "composition",
      "title": "All 6 rules share INV-006: Explicit over implicit",
      "content": "Each composition rule requires explicit invocation. Plugins don't magically compose - you declare how they interact. This is the same principle as dependency injection."
    },
    {
      "id": "vio-17",
      "type": "violation",
      "linkedSection": "composition",
      "title": "If you compose plugins without rules",
      "content": "<strong>IF:</strong> Two plugins both hook PostToolUse<br>\n          <strong>THEN:</strong> Execution order is undefined<br>\n          <strong>THEN:</strong> One plugin's output clobbers other's input<br>\n          <strong>THEN:</strong> Debugging nightmare (\"works sometimes\")<br>\n          <strong>FINALLY:</strong> Disable one, lose its value<br><br>\n          <em>The fix: Sequence hooks intentionally in settings.json</em>"
    },
    {
      "id": "comp-18",
      "type": "composition",
      "linkedSection": "composition",
      "title": "Ralph + Code-Review Plugin",
      "content": "<strong>Works:</strong> Each Ralph iteration runs code-review before commit.<br>\n          <strong>Pattern:</strong> implement -&gt; /code-review -&gt; fix-issues -&gt; commit<br>\n          <strong>Danger:</strong> Code-review spawns 5 agents. May exceed iteration time budget."
    },
    {
      "id": "trade-19",
      "type": "tradeoff",
      "linkedSection": "composition",
      "title": "The Plugin Chain Length Dilemma",
      "content": "<strong>Short chains:</strong> Easy to debug, but limited power<br>\n          <strong>Medium chains:</strong> Balanced, but more failure points<br>\n          <strong>Long chains:</strong> Maximum capability, but any failure breaks all<br><br>\n          <em>Heuristic: If you can't diagram the chain from memory, it's too long.</em>"
    },
    {
      "id": "fron-20",
      "type": "frontier",
      "linkedSection": "composition",
      "title": "UNSOLVED: Plugin dependency management",
      "content": "<strong>The question:</strong> How should plugin A declare dependency on plugin B?<br>\n          <strong>Why it's hard:</strong> Version conflicts, optional dependencies, circular references<br>\n          <strong>Current practice:</strong> Document dependencies manually. No automatic resolution."
    },
    {
      "id": "con-21",
      "type": "constraint",
      "linkedSection": "extension",
      "title": "5 hooks -> Complete lifecycle coverage",
      "content": "<strong>ROOT:</strong> Claude Code has predictable lifecycle<br>\n          -&gt; PreToolUse: Before action (security, validation)<br>\n          -&gt; PostToolUse: After action (formatting, metrics)<br>\n          -&gt; SessionStart: Context setup (memory injection)<br>\n          -&gt; SessionEnd: Context persistence (state saving)<br>\n          -&gt; Stop: Exit control (loop continuation)"
    },
    {
      "id": "inf-22",
      "type": "inflection",
      "linkedSection": "extension",
      "title": "When hooks flip from help to overhead",
      "content": "<strong>0-3 hooks:</strong> Pure benefit (targeted enhancement)<br>\n          <strong>4-6 hooks:</strong> Diminishing returns (interaction complexity)<br>\n          <strong>7+ hooks:</strong> Net negative (debugging exceeds value)<br><br>\n          <strong>THE INFLECTION:</strong> ~5 active hooks per session<br>\n          <em>Detection: If you're debugging hook interactions, you've crossed it.</em>"
    },
    {
      "id": "exp-23",
      "type": "expertise",
      "linkedSection": "extension",
      "title": "Hook understanding depth",
      "content": "<strong>Beginner:</strong> \"What's a hook?\" -&gt; Event handler<br>\n          <strong>Intermediate:</strong> \"Which hook for X?\" -&gt; Pre vs Post vs Session<br>\n          <strong>Advanced:</strong> \"How to debug hooks?\" -&gt; Echo commands, check matchers<br>\n          <strong>Staff:</strong> \"How to sequence hooks?\" -&gt; Array order in settings.json<br>\n          <strong>Expert:</strong> \"Hook vs MCP?\" -&gt; Hooks for lifecycle, MCP for tools"
    },
    {
      "id": "war-24",
      "type": "warstory",
      "linkedSection": "extension",
      "title": "Ralph's Stop hook: The key innovation",
      "content": "Matt Pocock's Ralph pattern depends on Stop hook to prevent Claude from exiting. Without this hook, autonomous loops would be impossible. The Stop hook enables \"check completion, restart if not done.\""
    },
    {
      "id": "inv-25",
      "type": "inversion",
      "linkedSection": "gotchas",
      "title": "Why exact matcher names?",
      "content": "<strong>What if matchers were fuzzy?</strong><br>\n          \"edit\" matching \"Edit\", \"EDIT\", \"editor\"... Hook fires on unintended tools. Chaos.<br>\n          <strong>Hidden constraint:</strong> Exact matching prevents accidental interception. The strictness is a feature."
    },
    {
      "id": "vio-26",
      "type": "violation",
      "linkedSection": "gotchas",
      "title": "If you don't test server manually",
      "content": "<strong>IF:</strong> Configure MCP server without testing<br>\n          <strong>THEN:</strong> \"Server not found\" at runtime<br>\n          <strong>THEN:</strong> Debug settings.json for hours<br>\n          <strong>THEN:</strong> Discover: missing npx package<br>\n          <strong>FINALLY:</strong> One manual test would have caught it<br><br>\n          <em>The fix: Always <code>npx -y @package/server</code> before configuring.</em>"
    },
    {
      "id": "hor-27",
      "type": "horizon",
      "linkedSection": "gotchas",
      "title": "Plugin conflict perception over time",
      "content": "<strong>Plugin 1:</strong> \"Everything works!\"<br>\n          <strong>Plugin 3:</strong> \"Weird intermittent failures...\"<br>\n          <strong>Plugin 5:</strong> \"Something's definitely conflicting\"<br>\n          <strong>Plugin 7:</strong> \"I need to audit all my hooks\"<br><br>\n          <em>The more plugins, the more conflict potential. Audit early.</em>"
    },
    {
      "id": "alt-28",
      "type": "alternative",
      "linkedSection": "when",
      "title": "If plugins aren't right for your use case",
      "content": "<strong>Project-specific behavior?</strong> -&gt; CLAUDE.md<br>\n          <strong>External tool access?</strong> -&gt; MCP server directly<br>\n          <strong>One-time automation?</strong> -&gt; Shell script<br>\n          <strong>Team knowledge?</strong> -&gt; Shared CLAUDE.md in repo"
    },
    {
      "id": "trade-29",
      "type": "tradeoff",
      "linkedSection": "when",
      "title": "Plugin vs CLAUDE.md",
      "content": "<strong>Plugin:</strong> Portable, versioned, but overhead to create<br>\n          <strong>CLAUDE.md:</strong> Fast to write, project-local, but not shareable<br><br>\n          <em>Heuristic: If you'd use it in 3+ projects, make it a plugin. Otherwise, CLAUDE.md.</em>"
    },
    {
      "id": "eff-30",
      "type": "effect",
      "linkedSection": "when",
      "title": "Plugin ecosystem network effects",
      "content": "<strong>At 10 plugins:</strong> Each solves isolated problem<br>\n          <strong>At 100 plugins:</strong> Plugins compose with each other<br>\n          <strong>At 1000 plugins:</strong> Ecosystem becomes self-reinforcing<br><br>\n          <em>Sharing plugins creates value beyond personal use.</em>"
    },
    {
      "id": "ana-31",
      "type": "analogy",
      "linkedSection": "when",
      "title": "Decision Heuristic = npm publish",
      "content": "Would you publish this as an npm package?<br>\n          <strong>No:</strong> Too project-specific -&gt; CLAUDE.md<br>\n          <strong>Maybe:</strong> Useful but niche -&gt; Local plugin<br>\n          <strong>Yes:</strong> Generally useful -&gt; Marketplace plugin<br><br>\n          <em>Same bar: Is this valuable to others?</em>"
    }
  ]
}