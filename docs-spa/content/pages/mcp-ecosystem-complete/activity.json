{
  "items": [
    {
      "id": "inv-1",
      "type": "inversion",
      "linkedSection": "essence",
      "title": "What if every AI app built custom integrations?",
      "content": "<strong>You'd have:</strong> N apps x M integrations = N*M custom codebases.<br>\n          <strong>Why this fails:</strong> Updates break everywhere. No portability. Massive duplication.<br>\n          <strong>Hidden constraint revealed:</strong> MCP's value IS the standardization. One implementation works everywhere."
    },
    {
      "id": "min-2",
      "type": "minimal",
      "linkedSection": "essence",
      "title": "The irreducible MCP server",
      "content": "<code style=\"background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;\">mcp = FastMCP(\"Name\"); @mcp.tool() def f(): pass; mcp.run()</code><br>\n          <strong>Essential:</strong> Server instance, one tool, transport.<br>\n          <strong>Everything else:</strong> Schema validation, resources, prompts, auth - all optional refinement."
    },
    {
      "id": "ana-3",
      "type": "analogy",
      "linkedSection": "essence",
      "title": "MCP = USB-C for AI",
      "content": "Device = AI Application<br>\n          Port = MCP Protocol<br>\n          Cable = Transport (stdio/HTTP)<br>\n          Peripheral = External System<br><br>\n          <em>Before USB-C: proprietary connectors everywhere. After: one port rules all.</em>"
    },
    {
      "id": "con-4",
      "type": "constraint",
      "linkedSection": "core",
      "title": "Why three primitives, not two or four?",
      "content": "<strong>ROOT:</strong> AI needs to (1) act, (2) read, (3) be guided<br>\n          <strong>Tools:</strong> Model decides when (actions)<br>\n          <strong>Resources:</strong> App decides when (data)<br>\n          <strong>Prompts:</strong> User decides when (workflows)<br><br>\n          <em>Three control patterns = three primitives. Complete coverage, minimal overlap.</em>"
    },
    {
      "id": "inv-5",
      "type": "invariant",
      "linkedSection": "core",
      "title": "JSON-RPC 2.0: The protocol DNA",
      "content": "MCP builds on JSON-RPC 2.0, not REST or GraphQL.<br>\n          <strong>Why:</strong> JSON-RPC is RPC-native (procedure calls), not resource-native.<br>\n          <strong>Implication:</strong> Tools ARE procedures. This alignment is why MCP feels natural for function calls."
    },
    {
      "id": "exp-6",
      "type": "expertise",
      "linkedSection": "core",
      "title": "How deep is your MCP understanding?",
      "content": "<strong>Beginner:</strong> \"What are tools?\" (primitives)<br>\n          <strong>Intermediate:</strong> \"Why resources vs tools?\" (control patterns)<br>\n          <strong>Advanced:</strong> \"When stdio vs HTTP?\" (transport selection)<br>\n          <strong>Staff:</strong> \"How does sampling work?\" (server-initiated LLM calls)<br>\n          <strong>Expert:</strong> \"What's the task API?\" (experimental features)"
    },
    {
      "id": "hor-7",
      "type": "horizon",
      "linkedSection": "core",
      "title": "MCP adoption trajectory",
      "content": "<strong>2024:</strong> \"What is MCP?\" (awareness)<br>\n          <strong>2025:</strong> \"How do I build servers?\" (adoption)<br>\n          <strong>2026:</strong> \"Which servers should I use?\" (ecosystem maturity)<br>\n          <strong>2027+:</strong> \"MCP is assumed\" (infrastructure)<br><br>\n          <em>We're in the adoption phase. Build now, be ahead.</em>"
    },
    {
      "id": "trade-8",
      "type": "tradeoff",
      "linkedSection": "sdks",
      "title": "Python vs TypeScript SDK",
      "content": "<strong>Python (FastMCP):</strong> Fastest prototyping, ML ecosystem access, decorator syntax<br>\n          <strong>TypeScript:</strong> Type safety at compile time, browser compat, reference implementation<br><br>\n          <strong>Heuristic:</strong> Data science / backend? Python. Claude Desktop / VS Code? TypeScript."
    },
    {
      "id": "grad-9",
      "type": "gradient",
      "linkedSection": "sdks",
      "title": "How SDK errors manifest",
      "content": "<strong>100% (works):</strong> Tool executes, returns content<br>\n          <strong>90% (degraded):</strong> Tool works but logs to stdout (corrupts stream intermittently)<br>\n          <strong>70% (flaky):</strong> Schema mismatch - sometimes validates, sometimes fails<br>\n          <strong>50% (broken):</strong> Wrong return structure - empty results<br>\n          <strong>0% (crash):</strong> Server doesn't start<br><br>\n          <em>The 90-70% range is most dangerous - appears to work.</em>"
    },
    {
      "id": "war-10",
      "type": "warstory",
      "linkedSection": "sdks",
      "title": "FastMCP: 21.2K stars, decorator magic",
      "content": "The Python SDK's decorator pattern (<code>@mcp.tool()</code>) emerged from Flask/FastAPI influence. Type hints become schemas automatically. Pydantic handles validation. Result: 10x less boilerplate than raw JSON-RPC."
    },
    {
      "id": "comp-11",
      "type": "composition",
      "linkedSection": "sdks",
      "title": "MCP + Ralph = Verification Tools",
      "content": "<strong>Works:</strong> Ralph loops gain custom verification (run_tests, verify_database_state)<br>\n          <strong>Pattern:</strong> Build MCP server with verification tools, reference in prompt.md<br>\n          <strong>Danger:</strong> Too many tools bloat context. Keep Ralph servers focused."
    },
    {
      "id": "fron-12",
      "type": "frontier",
      "linkedSection": "sdks",
      "title": "Task-Based Execution (Experimental)",
      "content": "v2 SDK introduces \"call-now, fetch-later\" pattern for long-running operations. Tool returns task ID, client polls for completion. Not yet stable but solves timeout issues."
    },
    {
      "id": "inv-13",
      "type": "inversion",
      "linkedSection": "agentmail",
      "title": "What if agents used real-time chat instead?",
      "content": "<strong>You'd need:</strong> Always-on connections, instant responses, interruption handling<br>\n          <strong>Why this fails:</strong> Agents work in chunks. Interruptions break flow. Missed messages = lost coordination.<br>\n          <strong>Hidden insight:</strong> Email metaphor works BECAUSE it's async. Agents check mail when convenient."
    },
    {
      "id": "vio-14",
      "type": "violation",
      "linkedSection": "agentmail",
      "title": "If you skip file reservations",
      "content": "<strong>IF:</strong> Agent A and B both edit api/routes.py<br>\n          <strong>THEN:</strong> B commits, unaware of A's changes<br>\n          <strong>THEN:</strong> A's work is overwritten<br>\n          <strong>THEN:</strong> A panics on unexpected diffs<br>\n          <strong>FINALLY:</strong> Human spends hours reconciling<br><br>\n          <em>One reservation check prevents hours of manual work.</em>"
    },
    {
      "id": "ana-15",
      "type": "analogy",
      "linkedSection": "agentmail",
      "title": "Agent Mail = Village Post Office",
      "content": "<strong>Craftsperson</strong> = Agent (GreenCastle, RedCat)<br>\n          <strong>Mailbox</strong> = Inbox/Outbox<br>\n          <strong>Post Office</strong> = Server routing messages<br>\n          <strong>Land Registry</strong> = File reservations<br><br>\n          <em>Agents don't need to know WHERE others are. Just send to names.</em>"
    },
    {
      "id": "war-16",
      "type": "warstory",
      "linkedSection": "agentmail",
      "title": "Jeffrey Emanuel's Agentic Tooling Flywheel",
      "content": "Agent Mail is part of a larger ecosystem: NTM (tmux manager), Beads (task planning), CASS (memory search), DCG (command gating). Thread IDs align with Beads issue IDs for full audit trail."
    },
    {
      "id": "inf-17",
      "type": "inflection",
      "linkedSection": "agentmail",
      "title": "When coordination becomes essential",
      "content": "<strong>1 agent:</strong> No coordination needed<br>\n          <strong>2 agents:</strong> Occasional conflict, manual resolution OK<br>\n          <strong>4 agents:</strong> Regular conflicts, coordination helps<br>\n          <strong>8+ agents:</strong> Chaos without infrastructure<br><br>\n          <strong>THE INFLECTION:</strong> ~4 concurrent agents<br>\n          <em>At Level 5+, Agent Mail isn't optional.</em>"
    },
    {
      "id": "con-18",
      "type": "constraint",
      "linkedSection": "path",
      "title": "Why this integration order?",
      "content": "<strong>ROOT:</strong> You need working tools before coordination<br>\n          Step 1-3: Build the capability (SDK)<br>\n          Step 4-5: Verify it works (Inspector, registration)<br>\n          Step 6: Use in orchestration<br>\n          Step 7-8: Add coordination when multi-agent<br><br>\n          <em>Each step depends on the previous. Can't coordinate tools that don't exist.</em>"
    },
    {
      "id": "exp-19",
      "type": "expertise",
      "linkedSection": "path",
      "title": "Integration skill levels",
      "content": "<strong>Beginner:</strong> Use existing MCP servers (filesystem, git)<br>\n          <strong>Intermediate:</strong> Build custom tool server<br>\n          <strong>Advanced:</strong> Integrate with Ralph/Gas Town<br>\n          <strong>Staff:</strong> Multi-agent coordination with Agent Mail<br>\n          <strong>Expert:</strong> Factory-scale orchestration (Level 7)"
    },
    {
      "id": "comp-20",
      "type": "composition",
      "linkedSection": "path",
      "title": "MCP + Gas Town = Specialized Role Tools",
      "content": "<strong>Deacon:</strong> Architecture analysis tools<br>\n          <strong>Dogs:</strong> Linting and test coverage tools<br>\n          <strong>Refinery:</strong> Deploy and merge queue tools<br>\n          <strong>Polecats:</strong> Domain-specific implementation tools<br><br>\n          <em>Each Gas Town role gets tailored MCP capabilities.</em>"
    },
    {
      "id": "alt-21",
      "type": "alternative",
      "linkedSection": "path",
      "title": "What if you don't need MCP?",
      "content": "<strong>Built-in tools suffice?</strong> Use Bash, Read, Write<br>\n          <strong>One-time task?</strong> Manual work faster than building server<br>\n          <strong>Simple automation?</strong> Hooks might be enough<br>\n          <strong>Single agent forever?</strong> Skip Agent Mail"
    },
    {
      "id": "vio-22",
      "type": "violation",
      "linkedSection": "gotchas",
      "title": "If you log to stdout in stdio server",
      "content": "<strong>IF:</strong> <code>print(\"debug\")</code> in Python<br>\n          <strong>THEN:</strong> \"debug\" goes to stdout, mixed with JSON-RPC<br>\n          <strong>THEN:</strong> Client receives malformed JSON<br>\n          <strong>THEN:</strong> Parse error, server appears crashed<br>\n          <strong>FINALLY:</strong> Intermittent failures that are hard to reproduce<br><br>\n          <em>This is the #1 stdio debugging issue. Use stderr.</em>"
    },
    {
      "id": "grad-23",
      "type": "gradient",
      "linkedSection": "gotchas",
      "title": "Return structure errors (subtle to severe)",
      "content": "<strong>100% (correct):</strong> <code>{content: [{type: \"text\", text: \"...\"}]}</code><br>\n          <strong>70% (partial):</strong> <code>{content: \"string\"}</code> - sometimes works<br>\n          <strong>50% (wrong):</strong> <code>\"just a string\"</code> - empty results<br>\n          <strong>0% (crash):</strong> Exception thrown - server dies<br><br>\n          <em>The 70% case is worst - appears to work until it doesn't.</em>"
    },
    {
      "id": "inv-24",
      "type": "inversion",
      "linkedSection": "gotchas",
      "title": "What if config paths were relative?",
      "content": "<strong>You'd have:</strong> \"Works on my machine\" syndrome<br>\n          <strong>Why it fails:</strong> Claude Code's working directory isn't your project directory<br>\n          <strong>Hidden insight:</strong> Absolute paths are annoying but deterministic. Relative paths seem simpler but break across contexts."
    },
    {
      "id": "min-25",
      "type": "minimal",
      "linkedSection": "gotchas",
      "title": "The fastest path to \"is my server working?\"",
      "content": "<code style=\"background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 11px;\">echo '{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"tools/list\"}' | uv run server.py</code><br><br>\n          If you get JSON back with your tools listed, the server works. If not, fix that before touching Claude Code config."
    },
    {
      "id": "trade-26",
      "type": "tradeoff",
      "linkedSection": "hard",
      "title": "Context cost vs. capability",
      "content": "<strong>THE DILEMMA:</strong><br>\n          More tools = more capabilities<br>\n          More tools = larger schema in context<br>\n          Larger context = degraded quality<br><br>\n          <strong>NO PERFECT ANSWER:</strong> Tool profiles help (70% reduction). But you must choose: breadth or depth."
    },
    {
      "id": "hor-27",
      "type": "horizon",
      "linkedSection": "hard",
      "title": "How transport choice ages",
      "content": "<strong>Day 1:</strong> \"stdio is simpler\"<br>\n          <strong>Week 2:</strong> \"I need remote access...\"<br>\n          <strong>Month 1:</strong> \"HTTP auth is complex\"<br>\n          <strong>Month 3:</strong> \"Glad I invested in HTTP setup\"<br><br>\n          <em>Short-term: stdio wins. Long-term: HTTP investment pays off.</em>"
    },
    {
      "id": "fron-28",
      "type": "frontier",
      "linkedSection": "hard",
      "title": "UNSOLVED: Optimal tool count per context",
      "content": "How many tools before quality degrades? Depends on tool schema complexity, task type, model. No formula exists. Heuristic: start with 5-10 tools, add as needed, monitor quality."
    },
    {
      "id": "war-29",
      "type": "warstory",
      "linkedSection": "hard",
      "title": "Advisory locks in distributed systems",
      "content": "Agent Mail's advisory reservations mirror database advisory locks. They work when participants respect them. The alternative (enforced locks) causes deadlocks. Trust + TTL expiry = practical coordination."
    },
    {
      "id": "inv-30",
      "type": "inversion",
      "linkedSection": "when",
      "title": "What if you built MCP for a one-time task?",
      "content": "<strong>Time to build server:</strong> 30-60 minutes<br>\n          <strong>Time to do task manually:</strong> 10 minutes<br>\n          <strong>Result:</strong> 6x overhead for no future benefit<br><br>\n          <strong>When it flips:</strong> 3+ uses of the same capability = MCP investment worthwhile"
    },
    {
      "id": "exp-31",
      "type": "expertise",
      "linkedSection": "when",
      "title": "Decision-making at different skill levels",
      "content": "<strong>Beginner:</strong> \"Should I use MCP?\" (capability question)<br>\n          <strong>Intermediate:</strong> \"Which SDK?\" (implementation question)<br>\n          <strong>Advanced:</strong> \"How many tools?\" (context question)<br>\n          <strong>Staff:</strong> \"When Agent Mail?\" (coordination question)<br>\n          <strong>Expert:</strong> \"Build or buy server?\" (ecosystem question)"
    },
    {
      "id": "alt-32",
      "type": "alternative",
      "linkedSection": "when",
      "title": "If MCP isn't right for your use case",
      "content": "<strong>Need quick automation?</strong> Hooks (pre/post commit)<br>\n          <strong>Need knowledge injection?</strong> Skills / CLAUDE.md<br>\n          <strong>Need one-time data access?</strong> Copy-paste works<br>\n          <strong>Need tight control?</strong> Custom script, not AI"
    },
    {
      "id": "inf-33",
      "type": "inflection",
      "linkedSection": "when",
      "title": "When to add Agent Mail to MCP setup",
      "content": "<strong>1 Claude instance:</strong> Never<br>\n          <strong>2 instances, different files:</strong> Probably not<br>\n          <strong>2 instances, same files:</strong> Yes<br>\n          <strong>3+ instances:</strong> Definitely<br><br>\n          <strong>THE SIGNAL:</strong> First time you manually resolve a file conflict, add Agent Mail."
    }
  ]
}