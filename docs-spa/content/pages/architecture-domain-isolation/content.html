

<!--
═══════════════════════════════════════════════════════════════════════════════
INLINE THREADING HEADER — Phase 2B
File: docs-spa/content/pages/architecture-domain-isolation/content.html
Tier: C | Batch: 13 | Generated: 2026-02-06

1. WHY THIS EXISTS
Rendered HTML content page for the architecture-domain-isolation synthesis document.

3. STATUS
ACTIVE

5. BUILT ON
Extracted from synthesis/architecture-domain-isolation.md by content extraction scripts.

8. CONSUMED BY
docs-spa/app/(docs)/synthesis/architecture-domain-isolation/page.tsx renders this content via dangerouslySetInnerHTML.

═══════════════════════════════════════════════════════════════════════════════
END INLINE THREADING HEADER
═══════════════════════════════════════════════════════════════════════════════
-->
      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Isolated domains with separate Claude instances prevent context pollution while enabling parallel life-system management.</div>
        </div>

        <div class="quote-block">
          "The feeling is hard to name. It is the violent gap between how blind you were and how obvious everything feels now with an observer that reads all the feeds, catches what you've unconsciously dropped, notices patterns across domains you'd kept stubbornly separate, and---crucially---tells you what to do about it."
          <div class="quote-attribution">-- Molly Cantillon, Personal Panopticon</div>
        </div>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Abstraction
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"Each domain gets its own Claude instance, its own directory, its own context. No cross-contamination."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'cd ~/$domain &amp;&amp; claude')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>cd ~/trades &amp;&amp; claude  # Domain-isolated instance</code>
          </div>

          <div class="core-anchor">Directory isolation IS context isolation. That's the whole pattern.</div>
        </div>

        <p class="text-text-secondary mb-6">
          The Panopticon architecture runs 8 parallel Claude instances, each confined to its own directory. The health agent knows nothing about trades. The email agent knows nothing about code. This isn't a bug---it's the feature. Isolation prevents context pollution and enables specialized optimization.
        </p>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="panopticon">The 8 Parallel Isolated Domains</h3>

        <div class="domain-grid">
          <div class="domain-card">
            <code>~/nox</code>
            <span>Company/Product</span>
          </div>
          <div class="domain-card">
            <code>~/metrics</code>
            <span>Analytics/Data</span>
          </div>
          <div class="domain-card">
            <code>~/email</code>
            <span>Communications</span>
          </div>
          <div class="domain-card">
            <code>~/growth</code>
            <span>Marketing</span>
          </div>
          <div class="domain-card">
            <code>~/trades</code>
            <span>Finance/Trading</span>
          </div>
          <div class="domain-card">
            <code>~/health</code>
            <span>Fitness/Wellness</span>
          </div>
          <div class="domain-card">
            <code>~/writing</code>
            <span>Content Creation</span>
          </div>
          <div class="domain-card">
            <code>~/personal</code>
            <span>Life Admin</span>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">How Isolation Works</h3>

        <table class="principle-table">
          <thead>
            <tr>
              <th>Principle</th>
              <th>Implementation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Directory isolation</td>
              <td>Each instance runs in its own <code>~/{domain}</code> directory</td>
            </tr>
            <tr>
              <td>No cross-contamination</td>
              <td>Agents cannot read/write outside their directory</td>
            </tr>
            <tr>
              <td>Independent context</td>
              <td>Each instance has fresh context, no shared conversation history</td>
            </tr>
            <tr>
              <td>Domain-specific memory</td>
              <td>Each directory contains its own notes, data, and history</td>
            </tr>
            <tr>
              <td>Explicit handoffs</td>
              <td>Information crosses domains only through deliberate file-based handoffs</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-context-isolation" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Design Decisions
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY CONTEXT ISOLATION?</div>
          <div class="decision-reasoning">
            Claude's context window is finite. When a single instance handles everything---finances, health, code, personal admin---the context becomes diluted. "Context rot" means the model forgets early instructions, contradicts itself, loses track of goals. Isolation means each domain agent maintains a focused, specialized context that deepens over time.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Never run a "master" Claude that handles everything. If you're asking Claude about your portfolio AND your workout AND your code in the same session, you've already lost. Split domains, split instances.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-filesystem-separation">
          <div class="decision-why">WHY FILESYSTEM SEPARATION?</div>
          <div class="decision-reasoning">
            Different domains need different tools (brokerage APIs vs WHOOP integration), different schedules (overnight trading data vs post-workout health sync), different models (Opus for complex reasoning vs Sonnet for drafting), and different verification levels (strict testing for production code vs loose for personal notes).
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Create a separate <code>CLAUDE.md</code> for each domain with domain-specific rules. <code>~/trades/CLAUDE.md</code> says "never execute actual trades." <code>~/email/CLAUDE.md</code> says "drafts require approval, never auto-send." Filesystem IS configuration.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-explicit-handoffs">
          <div class="decision-why">WHY EXPLICIT HANDOFFS?</div>
          <div class="decision-reasoning">
            Despite strict isolation, some scenarios require cross-domain awareness: morning brief synthesis, schedule conflicts, pattern recognition (sleep quality affecting productivity). But implicit sharing breaks isolation. The handoff pattern creates controlled, auditable information flow.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Use <code>~/shared/handoff-{source}-to-{target}.json</code> for cross-domain communication. The receiving domain reads handoffs explicitly. No magic sharing. Every cross-domain data flow is visible and deliberate.
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: FILE STRUCTURE -->
      <section id="file-structure" data-activity="files">
        <h2 class="section-title">
          <span class="section-number">4</span>
          Implementation
        </h2>

        <h3 class="font-semibold text-lg mb-4">Directory Structure</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>~/
<span class="comment">├── nox/                        # Company/product domain</span>
│   ├── CLAUDE.md               <span class="comment"># Company-specific rules</span>
│   ├── .claude/
│   │   ├── settings.json       <span class="comment"># Domain permissions</span>
│   │   └── commands/           <span class="comment"># Domain slash commands</span>
│   └── [project files]
│
<span class="comment">├── trades/                     # Finance domain</span>
│   ├── CLAUDE.md               <span class="comment"># Finance rules, risk limits</span>
│   ├── briefs/                 <span class="comment"># Daily morning briefs</span>
│   ├── data/                   <span class="comment"># Market data pulls</span>
│   └── .secrets/               <span class="comment"># Brokerage credentials</span>
│
<span class="comment">├── health/                     # Wellness domain</span>
│   ├── CLAUDE.md               <span class="comment"># Health tracking rules</span>
│   ├── workouts/               <span class="comment"># Generated workout plans</span>
│   └── integrations/           <span class="comment"># WHOOP, Apple Health exports</span>
│
<span class="comment">├── shared/                     # Cross-domain handoffs</span>
│   ├── handoff-trades-to-personal.json
│   ├── handoff-health-to-nox.json
│   └── daily-synthesis.md
│
<span class="comment">└── correlation/                # Meta-observer domain</span>
    ├── CLAUDE.md               <span class="comment"># Read-only cross-domain rules</span>
    ├── feeds/                  <span class="comment"># Symlinks to domain outputs</span>
    └── output/
        └── daily-synthesis.md</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="domain-claude-md">Domain-Specific CLAUDE.md</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># ~/trades/CLAUDE.md</span>

<span class="comment">## Domain: Personal Finance &amp; Trading</span>

<span class="comment">### Data Sources</span>
- Brokerage exports in ./data/
- Congressional disclosures from House API
- Polymarket odds via MCP
- X sentiment from firehose

<span class="comment">### Morning Brief Protocol</span>
1. Pull overnight data
2. Cross-reference against positions
3. Flag material changes
4. Output to ./briefs/YYYY-MM-DD.md

<span class="comment">### Risk Rules</span>
- <span class="keyword">NEVER</span> execute actual trades
- Flag any position &gt;5% of portfolio
- Always note data freshness</pre>
        </div>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># ~/health/CLAUDE.md</span>

<span class="comment">## Domain: Fitness &amp; Wellness</span>

<span class="comment">### Integrations</span>
- WHOOP exports in ./data/whoop/
- Apple Health exports in ./data/apple-health/

<span class="comment">### Workout Generation</span>
- Account for travel schedule in ./calendar/
- Adapt to recovery scores
- Prefer bodyweight when traveling

<span class="comment">### Sleep Protocol</span>
- If recovery &lt;66%, suggest lighter day
- Track sleep debt across week</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="process-isolation">Process Isolation with tmux</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment">#!/bin/bash</span>
<span class="comment"># start-domains.sh - Launch all domain instances</span>

<span class="variable">DOMAINS</span>=<span class="string">"nox metrics email growth trades health writing personal"</span>

<span class="keyword">for</span> domain <span class="keyword">in</span> $DOMAINS; <span class="keyword">do</span>
    cd ~/$domain
    tmux new-session -d -s $domain <span class="string">"claude"</span>
<span class="keyword">done</span>

<span class="keyword">echo</span> <span class="string">"All domains launched. Use 'tmux attach -t <domain>' to connect."</domain></span></pre>
        </div>

        <p class="text-text-secondary mb-6">
          Each domain runs in its own tmux session. Use <code>tmux ls</code> to see all domains, <code>tmux attach -t trades</code> to connect to a specific domain, and <code>Ctrl-b d</code> to detach (keeps running).
        </p>
      </section>

      <!-- Section 5: PATH OF A DOMAIN -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Path of a Domain
        </h2>

        <p class="text-text-secondary mb-6">
          Follow how a domain operates in isolation and coordinates with others:
        </p>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content">You create <code>~/{domain}/</code> directory with its own <code>CLAUDE.md</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content">Launch domain: <code>cd ~/{domain} &amp;&amp; claude</code> in its own tmux session</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content">Claude reads domain-specific <code>CLAUDE.md</code> (fresh context, domain rules only)</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content">Agent operates within directory boundaries, reading domain-specific data</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content">Agent writes outputs to domain directory (briefs, plans, analysis)</div>
          </div>
          <div class="path-step">
            <div class="path-number">6</div>
            <div class="path-content">When cross-domain info needed: agent writes to <code>~/shared/handoff-{domain}-to-*.json</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">7</div>
            <div class="path-content">Other domains check <code>~/shared/</code> for handoffs per their <code>CLAUDE.md</code> instructions</div>
          </div>
          <div class="path-step">
            <div class="path-number">8</div>
            <div class="path-content">Correlation agent (optional) reads all handoffs, synthesizes daily brief</div>
          </div>
          <div class="path-step">
            <div class="path-number">9</div>
            <div class="path-content">Cron schedules domain runs (6 AM trades brief, post-workout health sync)</div>
          </div>
          <div class="path-step">
            <div class="path-number">10</div>
            <div class="path-content">All domains run in parallel, no context sharing, maximum focus</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="cross-domain">Cross-Domain Coordination</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Handoff file structure</span>
{
  <span class="string">"from"</span>: <span class="string">"trades"</span>,
  <span class="string">"to"</span>: <span class="string">"personal"</span>,
  <span class="string">"timestamp"</span>: <span class="string">"2026-01-26T06:30:00Z"</span>,
  <span class="string">"summary"</span>: <span class="string">"Portfolio up 2.3% overnight. No action required."</span>,
  <span class="string">"flags"</span>: [],
  <span class="string">"data_freshness"</span>: <span class="string">"2026-01-26T06:00:00Z"</span>
}</pre>
        </div>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Scheduled cross-domain synthesis (cron)</span>
0 6 * * * cd ~/trades &amp;&amp; claude <span class="string">"Generate morning brief"</span> &gt; briefs/$(date +%Y-%m-%d).md
5 6 * * * cd ~/health &amp;&amp; claude <span class="string">"Analyze overnight recovery"</span> &gt; status/current.json
10 6 * * * cd ~/correlation &amp;&amp; claude <span class="string">"Synthesize daily brief from all domains"</span></pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          Real problems you'll hit when implementing domain isolation:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Agent accesses wrong directory
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Agent reads/writes files outside its domain directory</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Missing directory constraints or agent started from wrong path</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Always start agents with explicit <code>cd ~/domain &amp;&amp; claude</code>. Add path restrictions in CLAUDE.md: "This agent operates ONLY within ~/trades/"</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Handoffs not being read
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Receiving domain ignores handoff files; no cross-domain awareness</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Handoff files not mentioned in CLAUDE.md or wrong path</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Add explicit handoff instruction: "Before any task, check ~/shared/ for handoffs from other domains."</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            tmux sessions lost after reboot
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> All domain sessions gone; must manually restart</div>
          <div class="gotcha-detail"><strong>Cause:</strong> tmux sessions don't persist across system restarts</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Create startup script that recreates sessions. Add to login items or use tmux-resurrect plugin.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Context pollution despite isolation
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Agent behavior suggests knowledge from other domains</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Shared ~/.claude/ config or global CLAUDE.md bleeding through</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use domain-specific <code>.claude/</code> directories. Check ~/.claude/CLAUDE.md for generic instructions.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Cron jobs fail silently
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Scheduled domain runs don't produce expected output</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Environment differences between cron and interactive shell</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use full paths in cron: <code>/usr/local/bin/claude</code>. Log stderr: <code>2&gt;&amp;1 | tee /tmp/cron-trades.log</code></div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          Fundamental tensions in domain isolation architecture:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Over-Isolation vs. Under-Isolation
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Too isolated = domains become silos with no awareness, duplicate work, conflicting decisions. Too connected = context pollution returns, isolation benefits lost.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Over-isolation: Trading decision ignores health crash. Under-isolation: Generic, unfocused outputs.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> The correlation engine pattern provides read-only cross-domain awareness without violating isolation. Schedule cross-domain synthesis at specific times.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Domain Sprawl
          </div>
          <div class="hard-detail"><strong>The tension:</strong> It's tempting to create micro-domains for every concern. But managing 15+ instances creates overhead that exceeds the isolation benefit.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Unclear domain boundaries, constant handoffs for simple tasks, overhead of context-switching between too many domains.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Start with 3-5 core domains. Use subagents within domains instead of creating new domains. Consolidate related concerns.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            The Anthropic Trade-off
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Domain isolation provides local privacy (domains don't see each other), but Anthropic's API sees all domains. You get isolation from yourself, not from Anthropic.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> N/A - this is a known, accepted trade-off, not a solvable problem.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Accept the trade-off: "Their visibility into your thinking for access to a thousand-clone attention span. In this case, chosen beats imposed."</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Goodhart's Law in Life Optimization
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Optimizing domain metrics can lead to hollow victories. WHOOP says recovered but you feel like death. The system says productive but life feels empty.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Trusting the brief over lived experience, gaming your own metrics, losing sight of actual goals.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Maintain a "meta-level outside the system." Periodic human review. Be ready to delete a domain if it stops serving. "We must continue to live outside it."</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO USE -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Use / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              USE DOMAIN ISOLATION WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Managing 3+ distinct life/work areas with different tools and rules</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Need parallel execution without context interference</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Privacy boundaries matter (health data separate from work code)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Want "self-legibility" - AI observer across multiple life domains</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Can invest in per-domain CLAUDE.md and startup scripts</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              DON'T USE DOMAIN ISOLATION WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Single project focus - Just use one Claude instance</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Need constant cross-domain reasoning - Use correlation engine instead</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Quick exploration - Overhead of setup not worth it</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Team shared context needed - Use shared workspace pattern</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Domains highly interdependent - Isolation creates friction</span>
            </div>
          </div>
        </div>
      </section>

    