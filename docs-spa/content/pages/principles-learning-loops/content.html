

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Systems that learn from previous runs outperform systems that start fresh every time.</div>
        </div>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Compounding Pattern
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"What's amazing is I can ask it to look at previous runs to learn what worked or didn't work. So every time I run Ralph, it gets better and better." — Ryan Carson</div>

          <div class="diagram-box">Run 1: Initial attempt
  -&gt; Archive prd.json, learnings

Run 2: References Run 1 archives
  -&gt; Better prompts, fewer failures
  -&gt; Archive this run too

Run 3: References Runs 1+2
  -&gt; Even better performance
  -&gt; Continues compounding...</div>

          <div class="core-anchor">Each run benefits from all previous runs. This is the compounding advantage.</div>
        </div>

        <p class="text-text-secondary mb-6">
          Traditional workflows start fresh each session. Compounding adds three crucial layers: <strong>archived PRDs</strong> from previous runs, <strong>archived learnings</strong> (what worked, what broke), and <strong>agent references</strong> to past successes AND failures.
        </p>

        <p class="text-text-secondary mb-6">
          This is counterintuitive. Why archive when you can just start over? Because Run 10 without compounding is no better than Run 1. Run 10 WITH compounding benefits from 9 runs of accumulated wisdom. The agent knows your patterns, your gotchas, your project's quirks.
        </p>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-archive" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Design Decisions
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY ARCHIVE EVERYTHING?</div>
          <div class="decision-reasoning">
            Runs that disappear teach nothing. If your learnings exist only in context (which gets wiped), you're rebuilding knowledge from scratch every time. Archives persist the KNOWLEDGE separately from the SESSION.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              After every significant run, archive: prd.json (what was attempted), progress.txt (what was learned), and optionally a synthesized learnings.md. Store in <code>archives/run-YYYY-MM-DD/</code>. Make archiving a habit, not an afterthought.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-reference">
          <div class="decision-why">WHY REFERENCE PRIOR RUNS?</div>
          <div class="decision-reasoning">
            Knowledge unused is knowledge wasted. Archives sitting in a folder help nobody. The agent must be INSTRUCTED to read archives before starting. This explicit instruction is what makes compounding work.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              In your prompt.md, add: "Before starting, review archives/ folder. Read learnings.md from most recent 2-3 runs. Note patterns that worked AND failed. Apply these insights." Without this instruction, archives are dead weight.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-promote">
          <div class="decision-why">WHY PROMOTE PATTERNS?</div>
          <div class="decision-reasoning">
            Session learnings (progress.txt) are transient. Permanent learnings (CLAUDE.md) persist across all future sessions. Promoting patterns from session to permanent knowledge prevents re-learning the same lessons.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              After each feature completes, review progress.txt. Patterns that apply to all future work (not just this task) get promoted to CLAUDE.md. This is curation, not duplication. Keep CLAUDE.md under 500 tokens.
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: FEEDBACK LOOP TYPES -->
      <section id="loops" data-activity="loops">
        <h2 class="section-title">
          <span class="section-number">4</span>
          The Four Feedback Loops
        </h2>

        <p class="text-text-secondary mb-6">
          Learning happens at four levels. Master level 1-3 before attempting level 4.
        </p>

        <div class="loop-level" id="within-session">
          <div class="loop-level-header">
            <div class="loop-level-number">1</div>
            <div class="loop-level-title">Within-Session Learning</div>
            <div class="loop-level-mechanism">progress.txt</div>
          </div>
          <p class="text-text-secondary text-sm mb-4">
            Each iteration within a Ralph loop builds on the previous. progress.txt accumulates with a <strong>Codebase Patterns</strong> section at the TOP that the agent reads FIRST.
          </p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre><span class="comment"># Progress Log - Append Only (NEVER UPDATE)</span>

<span class="comment">## Codebase Patterns</span>
<span class="comment">- [Accumulated patterns here - grows over time]</span>
- Migrations: IF NOT EXISTS
- React: useRef&lt;Timeout | null&gt;(null)
- Zod: .optional() for nullable fields

<span class="comment">## 2026-01-09 - US-001</span>
- <span class="keyword">What:</span> Created tool skeleton with Zod schema
- <span class="keyword">Files:</span> src/tools/upsert.ts
- <span class="keyword">Learnings:</span> Use orange for visibility on dark backgrounds</pre>
          </div>
        </div>

        <div class="loop-level" id="cross-session">
          <div class="loop-level-header">
            <div class="loop-level-number">2</div>
            <div class="loop-level-title">Cross-Session Learning</div>
            <div class="loop-level-mechanism">CLAUDE.md, AGENTS.md, git</div>
          </div>
          <p class="text-text-secondary text-sm mb-4">
            Knowledge that persists beyond a single Ralph loop. CLAUDE.md for project-level patterns, AGENTS.md for agent-specific documentation, git history as the ultimate persistent memory.
          </p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre><span class="comment"># CLAUDE.md - Project-Level Knowledge</span>

<span class="keyword">## Tech Stack</span>
- Next.js 14, TypeScript, Prisma, PostgreSQL

<span class="keyword">## Commands</span>
- <span class="string">`npm run dev`</span> - Dev server (port 3000)
- <span class="string">`npm test`</span> - Run Jest tests

<span class="keyword">## Known Gotchas</span>
- Migrations need DEFAULT for existing data
- Use .optional() for nullable Zod fields</pre>
          </div>
        </div>

        <div class="loop-level" id="cross-run">
          <div class="loop-level-header">
            <div class="loop-level-number">3</div>
            <div class="loop-level-title">Cross-Run Learning (Compounding Ralph)</div>
            <div class="loop-level-mechanism">archives/</div>
          </div>
          <p class="text-text-secondary text-sm mb-4">
            The pattern that makes each run better than the last. Archive PRDs, progress logs, and synthesized learnings after each run. Instruct the agent to reference archives before starting new runs.
          </p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre>archives/
<span class="comment">├── run-2026-01-05/</span>
│   ├── prd.json
│   ├── progress.txt
│   └── learnings.md
<span class="comment">├── run-2026-01-06/</span>
│   ├── prd.json
│   ├── progress.txt
│   └── learnings.md
└── run-2026-01-08/
    └── ...</pre>
          </div>
        </div>

        <div class="loop-level" id="cross-project">
          <div class="loop-level-header">
            <div class="loop-level-number">4</div>
            <div class="loop-level-title">Cross-Project Learning</div>
            <div class="loop-level-mechanism">Claude-Mem</div>
          </div>
          <p class="text-text-secondary text-sm mb-4">
            Knowledge that spans multiple projects. Claude-Mem captures session events, compresses them into semantic summaries, and auto-injects relevant context into new sessions.
          </p>
          <div class="diagram-box">┌─────────────────────────────────────────────┐
│  Claude Code Session                        │
│  └─ Lifecycle Hooks                         │
│       └─ Capture events                     │
└─────────────────────────────────────────────┘
              │
              v
┌─────────────────────────────────────────────┐
│  Worker Service                             │
│  ├─ SQLite DB (raw data)                    │
│  ├─ Chroma Vector DB (embeddings)           │
│  └─ Claude Agent SDK (compression)          │
└─────────────────────────────────────────────┘
              │
              v
┌─────────────────────────────────────────────┐
│  Future Session                             │
│  └─ Auto-inject relevant context            │
└─────────────────────────────────────────────┘</div>
        </div>
      </section>

      <!-- Section 5: IMPLEMENTATION -->
      <section id="implementation" data-activity="implementation">
        <h2 class="section-title">
          <span class="section-number">5</span>
          Implementation Patterns
        </h2>

        <p class="text-text-secondary mb-6">
          Three copy-paste patterns that make compounding work.
        </p>

        <h3 class="font-semibold text-lg mb-4" id="progress-txt">The progress.txt Pattern</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Progress Log - Append Only (NEVER UPDATE)</span>

<span class="keyword">## Codebase Patterns</span>
<span class="comment">- [Accumulated patterns here - grows over time]</span>
- Migrations: IF NOT EXISTS
- React: useRef&lt;Timeout | null&gt;(null)
- Zod: .optional() for nullable fields

<span class="keyword">## Key Files</span>
- db/schema.ts
- app/auth/actions.ts

---

<span class="keyword">## 2026-01-09 - US-001</span>
- <span class="variable">What:</span> Created tool skeleton with Zod schema
- <span class="variable">Files:</span> src/tools/upsert.ts
- <span class="variable">Learnings:</span>
  - Use orange for visibility on dark backgrounds
  - Pattern: Validate inputs before database operations

---

<span class="keyword">## 2026-01-09 - US-002</span>
- <span class="variable">What:</span> Added category mapping
- <span class="variable">Files:</span> src/tools/categories.ts, src/types/index.ts
- <span class="variable">Issue:</span> Zod schema needed adjustment for optional fields
- <span class="variable">Pattern:</span> Added ".optional() for nullable" to Codebase Patterns</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="archive-pattern">The Archive Script</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment">#!/bin/bash</span>
<span class="comment"># archive-run.sh - Run after Ralph completes</span>

<span class="variable">DATE</span>=$(date +%Y-%m-%d)
<span class="variable">RUN_ID</span>=$(date +%H%M%S)
<span class="variable">ARCHIVE_DIR</span>="archives/run-$DATE-$RUN_ID"

mkdir -p "$ARCHIVE_DIR"

<span class="comment"># Copy artifacts</span>
cp plans/prd.json "$ARCHIVE_DIR/"
cp plans/progress.txt "$ARCHIVE_DIR/"

<span class="comment"># Generate learnings summary</span>
<span class="keyword">echo</span> <span class="string">"# Learnings from Run $DATE-$RUN_ID"</span> &gt; "$ARCHIVE_DIR/learnings.md"
<span class="keyword">echo</span> <span class="string">""</span> &gt;&gt; "$ARCHIVE_DIR/learnings.md"
<span class="keyword">echo</span> <span class="string">"## Patterns Discovered"</span> &gt;&gt; "$ARCHIVE_DIR/learnings.md"
head -20 plans/progress.txt | grep -A 100 "## Codebase Patterns" &gt;&gt; "$ARCHIVE_DIR/learnings.md"

<span class="comment"># Git log for this run</span>
git log --oneline --since="$(date -v-1d +%Y-%m-%d)" &gt;&gt; "$ARCHIVE_DIR/commits.log"

<span class="keyword">echo</span> <span class="string">"Archived to $ARCHIVE_DIR"</span></pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">The Reference Pattern</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># prompt.md - Instructions for Ralph</span>

<span class="keyword">## Before You Start</span>

1. Review <span class="string">`archives/`</span> folder for recent runs
2. Look at <span class="string">`learnings.md`</span> for patterns that worked
3. Check what failed and why
4. Apply these learnings to current work

<span class="keyword">## Archive Analysis Checklist</span>
- What database patterns were used?
- What validation approaches worked?
- Were there any repeated failures?
- What gotchas were discovered?

<span class="keyword">## Current Task</span>
[Your PRD here]</pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Anti-Patterns in Learning
        </h2>

        <p class="text-text-secondary mb-6">
          Six ways learning loops break, with fixes.
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Not Archiving
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Every run starts from zero. Same mistakes repeated across runs.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Archives seem like overhead until you need them.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Archive after every significant run: <code>./archive-run.sh</code>. Make it automatic.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Not Referencing Prior Work
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Agent doesn't read archives. Knowledge exists but isn't used.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Prompt doesn't explicitly instruct archive review.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Add explicit instruction: "Before implementing, read: archives/*/learnings.md"</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Over-relying on Session Memory
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Using context compaction instead of external files. Detail lost.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Trusting LLM memory over file persistence.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Externalize everything: progress.txt for learnings, prd.json for state, git for code.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Bloated CLAUDE.md
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> CLAUDE.md exceeds 500 tokens. Context budget consumed.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Promoting everything without pruning.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> CLAUDE.md is for permanent, project-wide patterns ONLY. Prune quarterly.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            progress.txt Editing
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Editing previous entries. History lost. Can't trace what happened when.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Treating progress.txt like a document instead of a log.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> APPEND ONLY. Never modify. The log is the log.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            No Verification Loop
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Agent marks tasks complete without testing. False completion compounds.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Missing verification in acceptance criteria.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Always include: "npm run typecheck passes" and "npm run test passes" in acceptance criteria.</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          Fundamental tensions that have no perfect solutions.
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Context Rot vs. Memory Loss
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Fresh context avoids rot but loses learnings. progress.txt helps but grows unbounded. No perfect solution exists.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Quality drops in late iterations (rot), OR early iterations repeat mistakes from archived runs (memory loss).</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Keep progress.txt under 20KB. Start fresh runs from AGENTS.md (permanent), not progress.txt (session). Accept that some re-learning is the cost of fresh context.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Archive Retrieval Quality
          </div>
          <div class="hard-detail"><strong>The tension:</strong> More archives = more wisdom, but also more noise. The agent may read irrelevant old patterns.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Agent applies patterns from a different project type. Learnings from Run 1 conflict with learnings from Run 15.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Reference only most recent 2-3 runs. Synthesize learnings.md to filter signal from noise. Delete archives older than 30 days.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Verification Dependency
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Compounding only works if learnings are TRUE. Without verification, false completions pollute archives.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Bad patterns get archived. Future runs learn from failures, not successes.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Never archive without verification passing. Review archives periodically for corrupted learnings.</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO USE -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Use / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              USE LEARNING LOOPS WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Running multiple Ralph loops over days/weeks (pattern accumulation pays off)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Working on a codebase with consistent patterns (learnings transfer)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Team shares archives (multiplied learning across people)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You have verification in place (only true learnings get archived)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You want iteration 20 to be dramatically better than iteration 1</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              DON'T USE LEARNING LOOPS WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>One-off tasks (archiving overhead exceeds benefit)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Highly varied work (learnings don't transfer across domains)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>No verification layer (bad learnings compound)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Exploratory work with no repeatable patterns</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Already using Claude-Mem (redundant with semantic memory)</span>
            </div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">The Learning Commandments</h3>

        <ol class="commandment-list">
          <li class="commandment-item">
            <span><strong>Archive everything.</strong> Runs that disappear teach nothing.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Reference archives.</strong> Knowledge unused is knowledge wasted.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Append, never edit.</strong> progress.txt is sacred history.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Verify before logging.</strong> False completions corrupt learning.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Promote patterns.</strong> Session learnings become permanent knowledge.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Prune regularly.</strong> Context is finite; keep only what matters.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Measure improvement.</strong> If you can't track it, you can't improve it.</span>
          </li>
          <li class="commandment-item">
            <span><strong>Compound daily.</strong> Each run should benefit from all previous runs.</span>
          </li>
          <li class="commandment-item">
            <span><strong>External over internal.</strong> Files outlast context windows.</span>
          </li>
          <li class="commandment-item">
            <span><strong>The agent is stateless.</strong> Memory is architecture, not magic.</span>
          </li>
        </ol>

        <h3 class="font-semibold text-lg mb-4 mt-8">Metrics That Matter</h3>

        <table class="content-table">
          <thead>
            <tr>
              <th>Metric</th>
              <th>How to Measure</th>
              <th>Good Signal</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Iterations per task</td>
              <td>Count Ralph loops</td>
              <td>Decreasing over time</td>
            </tr>
            <tr>
              <td>First-attempt success rate</td>
              <td>Tasks passing first try</td>
              <td>Increasing</td>
            </tr>
            <tr>
              <td>Time to completion</td>
              <td>Wall clock time</td>
              <td>Decreasing</td>
            </tr>
            <tr>
              <td>Pattern reuse</td>
              <td>References to Codebase Patterns</td>
              <td>Increasing</td>
            </tr>
            <tr>
              <td>Failure repetition</td>
              <td>Same error appearing</td>
              <td>Decreasing</td>
            </tr>
          </tbody>
        </table>
      </section>

    