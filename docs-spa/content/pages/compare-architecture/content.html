

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Four agent architectures: Single, Subagents, Swarm, Hierarchical. Choose by scale, parallelism, and complexity needs.</div>
        </div>
      </section>

      <!-- Section 2: CORE ABSTRACTION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Same Goal, Four Approaches
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"All agent architectures transform requirements into working code. The difference is how they distribute cognitive load, manage context, enable parallelism, and scale."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'Requirements --> [Architecture] --> Working Code')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>Requirements --&gt; [Architecture] --&gt; Working Code</code>
          </div>

          <div class="core-anchor">Pick the architecture that matches your constraints. Not the most complex. Not the simplest. The one that fits.</div>
        </div>

        <p class="text-text-secondary mb-6">
          Whether you are building a feature, shipping overnight, or running a development team simulation, all agent architectures aim to complete complex multi-part work. The choice depends on:
        </p>

        <ul class="list-disc list-inside text-text-secondary mb-6 space-y-2">
          <li><strong>Scale:</strong> How much work? How many components?</li>
          <li><strong>Parallelism:</strong> Can tasks run simultaneously?</li>
          <li><strong>Specialization:</strong> Do different tasks need different expertise?</li>
          <li><strong>Budget:</strong> How much are you willing to spend on tokens?</li>
          <li><strong>Time:</strong> Is speed or cost efficiency more important?</li>
        </ul>
      </section>

      <!-- Section 3: THE FOUR ARCHITECTURES -->
      <section id="architectures" data-activity="architectures">
        <h2 class="section-title">
          <span class="section-number">3</span>
          The Four Architectures
        </h2>

        <!-- Architecture 1: Single Agent -->
        <div class="arch-card" id="single-agent">
          <div class="arch-card-header">
            <div class="arch-card-icon">
              <i data-lucide="user" class="w-5 h-5"></i>
            </div>
            <div>
              <div class="arch-card-title">Architecture 1: Single Agent</div>
              <div class="arch-card-subtitle">The baseline. One context, one agent.</div>
            </div>
          </div>

          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre>Human --&gt; Agent --&gt; Output
            |
            +---&gt; Tools (Read, Write, Bash, etc.)</pre>
          </div>

          <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="font-semibold text-green-800 mb-2">Pros</div>
              <ul class="text-sm text-green-700 space-y-1">
                <li>Simple - No coordination overhead</li>
                <li>Full context awareness</li>
                <li>Interactive - Human in the loop</li>
                <li>Fast for small tasks</li>
              </ul>
            </div>
            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
              <div class="font-semibold text-red-800 mb-2">Cons</div>
              <ul class="text-sm text-red-700 space-y-1">
                <li>Context limits (128K-200K tokens)</li>
                <li>No parallelism</li>
                <li>Jack of all trades</li>
                <li>Context rot in long sessions</li>
              </ul>
            </div>
          </div>

          <div class="text-sm text-text-muted">
            <strong>Best For:</strong> Small tasks, debugging, code review, learning, quick fixes. Tasks completable in under 2 hours.
          </div>
        </div>

        <!-- Architecture 2: Subagents -->
        <div class="arch-card" id="subagents">
          <div class="arch-card-header">
            <div class="arch-card-icon">
              <i data-lucide="users" class="w-5 h-5"></i>
            </div>
            <div>
              <div class="arch-card-title">Architecture 2: Subagents</div>
              <div class="arch-card-subtitle">Parent agent delegates to children in isolated contexts.</div>
            </div>
          </div>

          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre>Main Agent (maintains overall context)
|
+-- spawns --&gt; Subagent A (research task)
|                   |
|                   +---&gt; Returns summary
|
+-- spawns --&gt; Subagent B (validation task)
                    |
                    +---&gt; Returns result</pre>
          </div>

          <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="font-semibold text-green-800 mb-2">Pros</div>
              <ul class="text-sm text-green-700 space-y-1">
                <li>Delegation without losing main context</li>
                <li>Context isolation per subagent</li>
                <li>Summarized returns (distilled results)</li>
                <li>Built into Claude Code</li>
              </ul>
            </div>
            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
              <div class="font-semibold text-red-800 mb-2">Cons</div>
              <ul class="text-sm text-red-700 space-y-1">
                <li>Sequential (mostly)</li>
                <li>Main context still fills over time</li>
                <li>2-5 subagents practical limit</li>
                <li>Spawn overhead per subagent</li>
              </ul>
            </div>
          </div>

          <div class="text-sm text-text-muted">
            <strong>Best For:</strong> Medium complexity, research that pollutes main context, adversarial validation, 2-5 distinct subtasks.
          </div>
        </div>

        <!-- Architecture 3: Swarm -->
        <div class="arch-card" id="swarm">
          <div class="arch-card-header">
            <div class="arch-card-icon">
              <i data-lucide="network" class="w-5 h-5"></i>
            </div>
            <div>
              <div class="arch-card-title">Architecture 3: Swarm (CC Mirror Pattern)</div>
              <div class="arch-card-subtitle">Central orchestrator dispatches to parallel workers.</div>
            </div>
          </div>

          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre>            +---------------------+
            |    ORCHESTRATOR     |
            |    (Opus 4.5)       |
            |  NEVER writes code  |
            +----------+----------+
                       |
                       | Task(run_in_background=True)
                       |
       +---------------+---------------+
       |               |               |
       v               v               v
+----------+    +----------+    +----------+
| Worker 1 |    | Worker 2 |    | Worker 3 |
| (Sonnet) |    | (Sonnet) |    | (Haiku)  |
|  Coder   |    |  Tester  |    |   Docs   |
+----------+    +----------+    +----------+
  (parallel execution)</pre>
          </div>

          <div class="iron-law-box">
            <div class="iron-law-text">
              An agent that ORCHESTRATES must NEVER directly EXECUTE.<br>
              An agent that EXECUTES must NEVER directly ORCHESTRATE.
            </div>
          </div>

          <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="font-semibold text-green-800 mb-2">Pros</div>
              <ul class="text-sm text-green-700 space-y-1">
                <li>Full parallelism</li>
                <li>Specialization per worker</li>
                <li>Model efficiency (expensive only where needed)</li>
                <li>Clear separation of concerns</li>
              </ul>
            </div>
            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
              <div class="font-semibold text-red-800 mb-2">Cons</div>
              <ul class="text-sm text-red-700 space-y-1">
                <li>Coordination overhead</li>
                <li>More setup required</li>
                <li>Worker conflicts possible</li>
                <li>Higher cost (parallel consumption)</li>
              </ul>
            </div>
          </div>

          <h4 class="font-semibold text-text-primary mb-3">Tool Ownership Rules</h4>
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Role</th>
                <th>Tools Used</th>
                <th>Tools NEVER Used</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Orchestrator</td>
                <td>Read (minimal), Task*, AskUser</td>
                <td>Write, Edit, Bash, Glob, Grep</td>
              </tr>
              <tr>
                <td>Worker</td>
                <td>Read, Write, Edit, Bash, Glob, Grep</td>
                <td>Task*, sub-spawning</td>
              </tr>
            </tbody>
          </table>

          <div class="text-sm text-text-muted">
            <strong>Best For:</strong> Large features, team simulation, parallel development, when time matters more than cost.
          </div>
        </div>

        <!-- Architecture 4: Hierarchical -->
        <div class="arch-card" id="hierarchical">
          <div class="arch-card-header">
            <div class="arch-card-icon">
              <i data-lucide="building-2" class="w-5 h-5"></i>
            </div>
            <div>
              <div class="arch-card-title">Architecture 4: Hierarchical (Gas Town Model)</div>
              <div class="arch-card-subtitle">Full agent town with specialized persistent roles.</div>
            </div>
          </div>

          <div class="code-block">
            <button class="copy-btn" onclick="copyCodeBlock(this)">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <pre>                    +-------------+
                    |  OVERSEER   |  &lt;-- Human (inbox-based)
                    |    (YOU)    |
                    +------+------+
                           |
                    +------+------+
                    |    MAYOR    |  &lt;-- Town coordination
                    +------+------+
                           |
     +---------------------+---------------------+
     |           |           |           |       |
+--------+ +----------+ +--------+ +--------+ +--------+
| DEACON | | REFINERY | |  DOGS  | | POLECAT| | WITNESS|
|(quality)| | (planning)| | (code) | | (test) | |(monitor)|
+--------+ +----------+ +--------+ +--------+ +--------+</pre>
          </div>

          <h4 class="font-semibold text-text-primary mb-3">The 7 Specialized Roles</h4>
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Role</th>
                <th>Function</th>
                <th>Persistence</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Mayor</td>
                <td>Town-level coordination, resource allocation</td>
                <td>Persistent</td>
              </tr>
              <tr>
                <td>Deacon</td>
                <td>Monitoring, health checks, handshakes</td>
                <td>Persistent</td>
              </tr>
              <tr>
                <td>Dogs</td>
                <td>Quality gates, watchdogs, enforcement</td>
                <td>Persistent</td>
              </tr>
              <tr>
                <td>Refinery</td>
                <td>Task decomposition, story breakdown</td>
                <td>On-demand</td>
              </tr>
              <tr>
                <td>Polecat</td>
                <td>Named workers with specific expertise</td>
                <td>Persistent</td>
              </tr>
              <tr>
                <td>Crew</td>
                <td>Ephemeral workers for one-off tasks</td>
                <td>Ephemeral</td>
              </tr>
              <tr>
                <td>Witness</td>
                <td>Per-rig observer, audit trail</td>
                <td>Persistent</td>
              </tr>
            </tbody>
          </table>

          <div class="grid grid-cols-2 gap-4 mb-4 mt-4">
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="font-semibold text-green-800 mb-2">Pros</div>
              <ul class="text-sm text-green-700 space-y-1">
                <li>Maximum specialization</li>
                <li>Built-in quality gates</li>
                <li>Persistent memory per role</li>
                <li>Self-improving system</li>
                <li>Human as async inbox</li>
              </ul>
            </div>
            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
              <div class="font-semibold text-red-800 mb-2">Cons</div>
              <ul class="text-sm text-red-700 space-y-1">
                <li>Significant infrastructure</li>
                <li>High overhead</li>
                <li>Budget intensive</li>
                <li>Steep learning curve</li>
                <li>Requires tmux mastery</li>
              </ul>
            </div>
          </div>

          <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
            <div class="font-semibold text-amber-800 mb-2">Prerequisites</div>
            <ul class="text-sm text-amber-700 space-y-1">
              <li>Stage 7+ in Claude Code evolution (comfortable with 10+ agents)</li>
              <li>Significant budget (multiple Claude accounts)</li>
              <li>Comfort with chaos</li>
              <li>tmux mastery</li>
              <li>Willingness to invest in the ecosystem</li>
            </ul>
          </div>

          <div class="text-sm text-text-muted mt-4">
            <strong>Best For:</strong> Production systems at enterprise scale, 10+ parallel agents, continuous dev operations.
          </div>
        </div>
      </section>

      <!-- Section 4: COMPARISON MATRIX -->
      <section id="matrix" data-activity="matrix">
        <h2 class="section-title">
          <span class="section-number">4</span>
          Comparison Matrix
        </h2>

        <div class="overflow-x-auto">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Factor</th>
                <th>Single</th>
                <th>Subagents</th>
                <th>Swarm</th>
                <th>Hierarchical</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Complexity</td>
                <td>Low</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>High</td>
              </tr>
              <tr>
                <td>Parallelism</td>
                <td>None</td>
                <td>Limited</td>
                <td>Full</td>
                <td>Full</td>
              </tr>
              <tr>
                <td>Specialization</td>
                <td>None</td>
                <td>Some</td>
                <td>Good</td>
                <td>Maximum</td>
              </tr>
              <tr>
                <td>Scale</td>
                <td>Small</td>
                <td>Medium</td>
                <td>Large</td>
                <td>Enterprise</td>
              </tr>
              <tr>
                <td>Setup Time</td>
                <td>Zero</td>
                <td>Minutes</td>
                <td>Hours</td>
                <td>Days</td>
              </tr>
              <tr>
                <td>Cost</td>
                <td>$</td>
                <td>$$</td>
                <td>$$$</td>
                <td>$$$$</td>
              </tr>
              <tr>
                <td>Human Involvement</td>
                <td>High</td>
                <td>Medium</td>
                <td>Low</td>
                <td>Async</td>
              </tr>
              <tr>
                <td>Context Isolation</td>
                <td>None</td>
                <td>Per-subagent</td>
                <td>Per-worker</td>
                <td>Per-role</td>
              </tr>
              <tr>
                <td>Failure Recovery</td>
                <td>Manual</td>
                <td>Parent retries</td>
                <td>Orchestrator</td>
                <td>Self-healing</td>
              </tr>
              <tr>
                <td>Debugging</td>
                <td>Easy</td>
                <td>Medium</td>
                <td>Hard</td>
                <td>Complex</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">Extended Comparison</h3>
        <div class="overflow-x-auto">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Dimension</th>
                <th>Single</th>
                <th>Subagents</th>
                <th>Swarm</th>
                <th>Hierarchical</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Context Window</td>
                <td>Shared</td>
                <td>Isolated returns</td>
                <td>Isolated workers</td>
                <td>Fully isolated</td>
              </tr>
              <tr>
                <td>Model Selection</td>
                <td>Fixed</td>
                <td>Can vary</td>
                <td>Role-based</td>
                <td>Role + tier</td>
              </tr>
              <tr>
                <td>Coordination</td>
                <td>N/A</td>
                <td>Parent-child</td>
                <td>Hub-and-spoke</td>
                <td>Multi-level</td>
              </tr>
              <tr>
                <td>Persistence</td>
                <td>Session</td>
                <td>Session</td>
                <td>Task-based</td>
                <td>Named agents</td>
              </tr>
              <tr>
                <td>Conflict Handling</td>
                <td>N/A</td>
                <td>Sequential</td>
                <td>Orchestrator</td>
                <td>Specialized roles</td>
              </tr>
              <tr>
                <td>Quality Gates</td>
                <td>Manual</td>
                <td>Ad-hoc</td>
                <td>Can include</td>
                <td>Built-in (Dogs)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Section 5: DECISION FRAMEWORK -->
      <section id="decisions" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">5</span>
          Decision Framework
        </h2>

        <h3 class="font-semibold text-lg mb-4" id="decision-tree">Decision Tree</h3>

        <div class="decision-tree">
          <div class="decision-tree-node font-semibold">
            START: "I need agents to complete complex work"
          </div>

          <div class="decision-tree-arrow">
            <i data-lucide="corner-down-right" class="w-4 h-4"></i>
            How long will it take?
          </div>

          <div class="ml-8">
            <div class="decision-tree-arrow">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              Less than 2 hours
            </div>
            <div class="decision-tree-node decision-tree-result ml-8">SINGLE AGENT</div>

            <div class="decision-tree-arrow mt-4">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              2-8 hours or overnight/days: Continue...
            </div>
          </div>

          <div class="decision-tree-arrow mt-4">
            <i data-lucide="corner-down-right" class="w-4 h-4"></i>
            Need parallel execution?
          </div>

          <div class="ml-8">
            <div class="decision-tree-arrow">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              No, sequential is fine
            </div>
            <div class="decision-tree-node decision-tree-result ml-8">SUBAGENTS</div>

            <div class="decision-tree-arrow mt-4">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              Yes, speed matters: Continue...
            </div>
          </div>

          <div class="decision-tree-arrow mt-4">
            <i data-lucide="corner-down-right" class="w-4 h-4"></i>
            How many specialists needed?
          </div>

          <div class="ml-8">
            <div class="decision-tree-arrow">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              2-5 workers
            </div>
            <div class="decision-tree-node decision-tree-result ml-8">SWARM (CC Mirror)</div>

            <div class="decision-tree-arrow mt-4">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              7+ roles: Continue...
            </div>
          </div>

          <div class="decision-tree-arrow mt-4">
            <i data-lucide="corner-down-right" class="w-4 h-4"></i>
            Production scale? Quality gates?
          </div>

          <div class="ml-8">
            <div class="decision-tree-arrow">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              No
            </div>
            <div class="decision-tree-node decision-tree-result ml-8">SWARM (simpler)</div>

            <div class="decision-tree-arrow mt-4">
              <i data-lucide="arrow-right" class="w-4 h-4"></i>
              Yes
            </div>
            <div class="decision-tree-node decision-tree-result ml-8">HIERARCHICAL (Gas Town)</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="selection-criteria">Selection Criteria Checklists</h3>

        <div class="grid grid-cols-2 gap-4">
          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Choose Single Agent When:</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Task completable in one session (under 2 hours)
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                No need for parallel work
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Exploring or debugging
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Learning the codebase
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Quick fixes and investigations
              </li>
            </ul>
          </div>

          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Choose Subagents When:</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Need isolated research/exploration
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Want adversarial validation
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Main context getting polluted
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                2-5 distinct subtasks
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Medium complexity, single session
              </li>
            </ul>
          </div>

          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Choose Swarm When:</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Parallel work needed for speed
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Different specialists required
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Large feature with multiple components
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Team simulation beneficial
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Budget allows higher token consumption
              </li>
            </ul>
          </div>

          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Choose Hierarchical When:</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Running 10+ agents regularly
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Production system requiring quality gates
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Continuous development operations
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Ready for significant infrastructure
              </li>
              <li class="flex items-start gap-2">
                <i data-lucide="check-square" class="w-4 h-4 text-accent flex-shrink-0 mt-0.5"></i>
                Need persistent agent memory
              </li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          Real problems you'll hit with each architecture, with concrete symptoms and fixes:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Context Window Exhaustion (Single Agent)
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Claude starts forgetting instructions, repeating itself, or producing lower-quality output mid-session.</div>
          <div class="gotcha-detail"><strong>Threshold:</strong> Typically &gt; 150K tokens accumulated</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use <code>/compact</code> to summarize context, start a fresh session, or migrate to subagents to isolate work.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Subagent Spawn Overhead
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Tasks take much longer than expected; lots of "starting subagent" messages.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Too many subagents spawned for small tasks (each spawn has initialization cost).</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Batch small tasks together or complete them in main agent. Reserve subagents for substantial work (&gt; 5-10 minute tasks).</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Worker Conflicts in Swarm
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Multiple workers editing same files; merge conflicts; inconsistent code state.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Parallel workers assigned overlapping file domains without coordination.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Ensure orchestrator assigns non-overlapping file boundaries. Use git worktrees for full isolation if needed.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Gas Town Runaway Costs
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> API costs spike dramatically; many agents running but little progress.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Workers spawning sub-workers (violates Iron Law), or inefficient task decomposition.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Audit worker preambles to ensure "DO NOT spawn sub-agents" rule. Check Refinery task sizing. Start minimal before scaling.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Architecture Over-Engineering
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Spending more time configuring multi-agent systems than doing actual work.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Chose hierarchical architecture for a task that only needed single agent or subagents.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Start simple. Only upgrade architecture when simpler approach demonstrably fails. Most tasks can be done with single agent or basic subagents.</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          These are fundamental tensions across all architectures, not bugs to fix:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            The Coordination vs. Autonomy Paradox
          </div>
          <div class="hard-detail"><strong>The tension:</strong> More agents = more parallelism = faster. But more agents = more coordination = more overhead. At some point, coordination costs exceed parallelism gains.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Adding workers doesn't speed things up, or makes them slower. Orchestrator becomes bottleneck.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> There's an optimal agent count for each task type. Start with 2-3 workers, add incrementally, measure time-to-completion. Stop when adding workers doesn't help.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Context Isolation vs. Shared Understanding
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Isolated contexts prevent pollution but mean workers don't know what other workers have done. Shared context enables coordination but fills quickly.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Worker B undoes what Worker A just did. OR orchestrator context fills with all worker outputs.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Summaries are the bridge. Workers return summaries, not full context. Orchestrator maintains high-level state. Accept some information loss as the cost of isolation.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Debugging Distributed Failures
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Single agent is easy to debug: one context, one flow. Multi-agent is hard: which agent caused the bug? When? What was its context?</div>
          <div class="hard-detail"><strong>Symptoms:</strong> "Something went wrong somewhere" without clear trace. Hours spent reconstructing failure path.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Logging is essential. Every agent must output to a traceable log. Gas Town's Witness role exists for this reason. Build observability before you need it.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Architecture Selection Under Uncertainty
          </div>
          <div class="hard-detail"><strong>The tension:</strong> You need to pick an architecture before you know how complex the task really is. Over-engineer: wasted setup. Under-engineer: painful migration mid-task.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Regretting architecture choice mid-project. "Should have started with X."</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Default to simpler. Single agent until you hit context limits. Then subagents. Then swarm. Upgrade architectures, don't guess them. The cost of upgrading is lower than the cost of over-engineering.</div>
        </div>
      </section>

      <!-- Section 8: MIGRATION PATH -->
      <section id="migration" data-activity="migration">
        <h2 class="section-title">
          <span class="section-number">8</span>
          Migration Path
        </h2>

        <p class="text-text-secondary mb-6">
          The natural evolution path. Don't skip levels unless you have strong reason:
        </p>

        <div class="code-block">
          <pre>SINGLE --&gt; SUBAGENTS --&gt; SWARM --&gt; HIERARCHICAL
  |            |            |            |
  |  "I need   |  "Need     |  "Running  |
  |  to offload|  parallel  |  10+ agents|
  |  research" |  workers"  |  daily"    |
  |            |            |            |
  v            v            v            v
Hours       Hours-Days    Days       Weeks</pre>
        </div>

        <div class="grid grid-cols-2 gap-4 mt-6">
          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Migration Trigger: Single to Subagents</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li><strong>Signal:</strong> Main context filling with research that doesn't need to persist</li>
              <li><strong>Example:</strong> "Survey existing patterns" pollutes context with 50K tokens of examples</li>
              <li><strong>Migration:</strong> Put research in a subagent that returns a summary</li>
            </ul>
          </div>

          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Migration Trigger: Subagents to Swarm</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li><strong>Signal:</strong> Sequential subagents taking too long; obvious parallelism opportunities</li>
              <li><strong>Example:</strong> Tests, docs, and code can all run at once</li>
              <li><strong>Migration:</strong> Set up orchestrator with Task(run_in_background=True)</li>
            </ul>
          </div>

          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Migration Trigger: Swarm to Hierarchical</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li><strong>Signal:</strong> Running 10+ agents daily; need persistent memory; need quality gates</li>
              <li><strong>Example:</strong> Continuous development with overnight runs, human review in morning</li>
              <li><strong>Migration:</strong> Commit to Gas Town infrastructure investment</li>
            </ul>
          </div>

          <div class="arch-card">
            <h4 class="font-semibold text-text-primary mb-3">Anti-Pattern: Premature Hierarchy</h4>
            <ul class="text-sm text-text-secondary space-y-2">
              <li><strong>Signal:</strong> Setting up Gas Town for a weekend project</li>
              <li><strong>Example:</strong> "I want to try the cool architecture" without scale needs</li>
              <li><strong>Reality:</strong> Most tasks fit in single agent or subagents. Hierarchy is for organizations, not experiments.</li>
            </ul>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">Quick Reference</h3>

        <table class="comparison-table">
          <thead>
            <tr>
              <th>Architecture</th>
              <th>Best Example</th>
              <th>Key Command/Pattern</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Single</td>
              <td>Debug session</td>
              <td><code>claude "fix bug in auth.py"</code></td>
            </tr>
            <tr>
              <td>Subagents</td>
              <td>Research + implement</td>
              <td><code>Task(subagent_type="researcher")</code></td>
            </tr>
            <tr>
              <td>Swarm</td>
              <td>Feature development</td>
              <td>CC Mirror orchestrator pattern</td>
            </tr>
            <tr>
              <td>Hierarchical</td>
              <td>Production ops</td>
              <td>Gas Town with full role cast</td>
            </tr>
          </tbody>
        </table>
      </section>

    