<!-- ═══════════════════════════════════════════════════════════════════════
     OD-004: Confidence-Based Structure — GEOLOGICAL + CRESCENDO
     Organizational Exploration — Certainty Stratification Pattern

     Hypothesis: "What if documentation was organized by confidence level —
     from established facts to open questions — creating natural geological
     stratification where density correlates inversely with confidence?"
     Density Pairing: GEOLOGICAL (primary) + CRESCENDO (secondary)
     DD Sources: DD-004 (GEOLOGICAL, 35/40), DD-002 (CRESCENDO, 35/40),
                 DD-006 (FRACTAL — mandatory DD-F-006)
     Research: R1 PRIMARY (R1-001, R1-003, R1-004, R1-006)
               External: 12 resources from OD-004-EXTERNAL-RESEARCH.md

     Applied Research:
       R1-001 (Density Rhythm) — certain=sparse, uncertain=dense (THE defining rhythm)
       R1-003 (Viewport Principle) — each stratum transition at viewport boundary
       R1-004 (Three-Column Doctrine) — certain/uncertain side-by-side comparison
       R1-006 (Horizontal Comparison Break) — established vs speculative approaches
       R1-016 (Typography-First Hierarchy) — Size > Weight > Color
       R1-019 (Tech Spec Aesthetic) — Sharp edges, monospace accents
       DD-F-002 (CRESCENDO) — Progressive density increase as confidence decreases
       DD-F-004 (GEOLOGICAL) — Layered depth model with stratum boundaries
       DD-F-006 (FRACTAL) — Self-similar at 4 scales (MANDATORY)
       DD-F-010 (Org serves density) — Confidence organization serves GEOLOGICAL layers
       EXT-CONF-001 (NNG Progressive Disclosure) — Max 4 strata; strong info scent at boundaries
       EXT-CONF-002 (Confidence Visualization) — Inverse density-confidence relationship
       EXT-CONF-003 (Agentic Categorical Labels) — Words not percentages
       EXT-CONF-004 (Gwern Kesselman Vocabulary) — Per-section confidence tags
       EXT-CONF-005 (Appleton Epistemic Disclosure) — "You Are Reading" markers
       EXT-CONF-006 (Diataxis) — Confidence maps to documentation type
       EXT-CONF-007 (Layered Architecture) — Layer isolation, bounded zones
       EXT-CONF-008 (GitBook Adaptive) — Progressive stratum revelation
       EXT-CONF-009 (AI Agents Progressive Disclosure) — Survey header always visible
       EXT-CONF-010 (NNG Information Scent) — Strong scent at boundaries
       EXT-CONF-011 (EA Forum Epistemic) — Evidence DNA; crux transparency
       EXT-CONF-012 (Stripe Docs) — Confidence-level switcher control
       EXT-CONF-013 (Border-Weight Confidence Encoding) — 4px/3px/2px/1px gradient [NEW v3]
       EXT-CONF-014 (Stratum Transition Spacing) — 48px + 3px rule + label [NEW v3]
       EXT-CONF-015 (Dark Header as Geological Survey Map) — Convention unification [NEW v3]
       EXT-CONF-016 (Zone Tokens) — Dual-semantic density naming [NEW v3]
       EXT-CONF-017 (Comprehensive Reduced-Motion) — Prophylactic single rule [NEW v3]
       EXT-CONF-018 (Stratum-Internal Micro-Pacing) — Fractal at section scale [NEW v3]

     Anti-Patterns Avoided:
       DD-F-015 Traffic-light — no green+red adjacent callouts
       DD-F-016 Border inconsistency — standardized 4px borders
       DD-F-017 Uniform density — MUST vary per GEOLOGICAL + CRESCENDO
       DD-F-018 Fighting the pattern — sparse strata stay sparse, dense strata stay dense
       DD-F-014 Callout stacking — max 2 callouts per viewport

     DD-F-006 Fractal Compliance:
       PAGE SCALE: ESTABLISHED(sparse) -> PROBABLE(moderate) -> SPECULATIVE(dense) -> OPEN(densest)
       SECTION SCALE: Within each stratum, intro(sparse) / detail(moderate) / evidence(dense)
       COMPONENT SCALE: Callout label(sparse) / callout body(dense)
       CHARACTER SCALE: Confident assertions(sparse, terse) / hedged language(dense, caveated)
     ═══════════════════════════════════════════════════════════════════════ -->

<!-- ═══════════════════════════════════════════════════════════════════════
     INLINE THREADING HEADER — OD Execution Phase
     File: docs-spa/app/showcase/explorations/organizational/OD-004-confidence.html
     Tier: B | Stage: 3 (Organization OD) | Generated: 2026-02-07
     ═══════════════════════════════════════════════════════════════════════

1. WHY THIS EXISTS
OD-004-confidence.html is the fourth organizational exploration, testing the
hypothesis that documentation organized by confidence level — from established
facts to open questions — creates natural GEOLOGICAL stratification where
density correlates inversely with confidence. Uses GEOLOGICAL (primary) for
layered certainty strata and CRESCENDO (secondary) for progressive density
increase as certainty decreases. Content topic: API Best Practices & Stability
Guide showing stable practices vs emerging vs speculative approaches.

2. THE QUESTION THIS ANSWERS
"Can a confidence-based organizational structure — where content is stratified
by certainty level (established/probable/speculative/open) — create natural
GEOLOGICAL density rhythm while maintaining DD-F-006 fractal self-similarity
at all four structural scales? Does inverse density-confidence correlation
(certain=sparse, uncertain=dense) serve reader comprehension?"

3. STATUS
ACTIVE — INCLUDE (v3 re-enriched, Wave 5 audit PASS). 34/40. Soul compliance 100%.
Wave 5: CLEANEST OD — 8/8 systematic PASS, 0 rgba, 0 opacity violations. Standards 16/17.
applied (EXT-CONF-013 through EXT-CONF-018). 5 builder discoveries (B3A-001..005).
DD-F-006 fractal compliance verified at 4 scales. Convention spec aligned.

4. SOUL ALIGNMENT
  Soul Piece                     | Implementation                      | Evidence
  -------------------------------|-------------------------------------|--------
  1. Sharp Edges                 | --border-radius: 0 in :root        | Line ~172
  2. No Shadows                  | --box-shadow: none; solid offset    | Lines ~173, ~290
  3. Serif = Wisdom              | Instrument Serif for titles,        | Throughout
                                 | stratum headers, essence callouts   |
  4. Callout Family DNA          | 6 callouts, 2-zone (label+body),   | CSS callout section
                                 | 4px left border, 5 color variants  |
  5. Squares Signal System       | Square progress markers, square     | .progress-square,
                                 | inventory markers, square checks    | .strata-inventory__marker

5. BUILT ON
  Source                          | Role                              | Key Values Taken                                  | Path
  --------------------------------|-----------------------------------|---------------------------------------------------|-----
  DD-004-geological.html          | GEOLOGICAL density (primary)      | Layered depth model, stratum boundaries           | explorations/density/DD-004-geological.html
  DD-002-gradient.html            | CRESCENDO density (secondary)     | Progressive density increase validated            | explorations/density/DD-002-gradient.html
  DD-006-fractal.html             | DD-F-006 fractal (mandatory)      | 4-scale self-similarity constraint                | explorations/density/DD-006-fractal.html
  OD-001-conversational.html      | OD series predecessor             | Solid offset, scroll animations, callout system   | explorations/organizational/OD-001-conversational.html
  OD-003-task-based.html          | OD series predecessor             | ISLANDS structure, code block styling              | explorations/organizational/OD-003-task-based.html
  OD-004-EXTERNAL-RESEARCH.md     | External research (12 resources)  | Geological confidence model, epistemic markers    | knowledge-architecture/OD-004-EXTERNAL-RESEARCH.md
  ACCUMULATED-IDENTITY-v1.md      | Full inherited identity (539 lines)| Soul, findings, constraints, identity statement  | knowledge-architecture/ACCUMULATED-IDENTITY-v1.md
  MASTER-SOUL-SYNTHESIS.md        | Soul authority (T1 LOCKED)        | 5 soul pieces, 6 Universal Rules                  | perceptual-audit-v2/synthesis/MASTER-SOUL-SYNTHESIS.md
  DESIGN-TOKEN-SUMMARY.md         | Locked token source (T1 LOCKED)   | Complete :root block (colors, fonts, geometry)    | perceptual-audit-v2/synthesis/DESIGN-TOKEN-SUMMARY.md

6. MUST HONOR
  Constraint                      | Source                              | Consequence if Violated
  --------------------------------|-------------------------------------|-------------------------------------
  DD-F-006 fractal at 4 scales    | DD-006-fractal.html                 | Exploration INVALID — mandatory for all OD/AD/CD
  GEOLOGICAL strata (4 layers)    | DD-F-004 + R1-001                   | Core hypothesis fails
  CRESCENDO density progression   | DD-F-002                            | Density rhythm absent
  border-radius: 0 everywhere     | DESIGN-TOKEN-SUMMARY.md             | Soul violation
  box-shadow: none everywhere     | DESIGN-TOKEN-SUMMARY.md             | Soul violation (solid offset OK)
  Max 2 callouts per viewport     | DD-F-014 / R5-T4                    | Callout cacophony anti-pattern
  Inverse density-confidence      | R1-001                              | Defining rhythm of OD-004 destroyed

7. WHAT BREAKS IF THIS CHANGES
BLAST RADIUS: LOW-MEDIUM (fourth OD artifact, limited downstream consumers yet)
  - OD-CHECKPOINT.md (OD-004 state row)
  - RESEARCH-ACTIVE.md (findings marked APPLIED via this file)
  - Future OD-005, OD-006 (may reference OD-004 lessons)
  - organizational-patterns.md (will catalog CONFIDENCE-BASED pattern)
  - OD-SYNTHESIS.md (will synthesize across all OD explorations)

8. CONSUMED BY
  Consumer                                                        | How It Uses This File
  ----------------------------------------------------------------|-------------------------------------
  OD-CHECKPOINT.md                                                | Tracks OD-004 status, score, threading state
  RESEARCH-ACTIVE.md                                              | Findings marked APPLIED via this file
  organizational-patterns.md                                      | Extracts CONFIDENCE-BASED pattern definition
  OD-SYNTHESIS.md                                                 | Synthesizes OD-004 lessons with OD-001-006
  OD-outbound-findings.md                                         | Wave 3 validation data (34/40, 5 discoveries)
  EXT-RESEARCH-REGISTRY.md                                        | EXT-CONF-013..018 registered, numeric IDs CANONICAL
  research-package-od-004.md                                      | Source research consumed by builder-3a

9. RESEARCH DEBT
  RD-1: No quantitative density measurement (sparse vs dense ratio per stratum).
  RD-2: Content is API best practices. No non-API validation yet.
  RD-3: Scroll-driven animations are Chromium-only. Firefox/Safari get static fallback.
  RD-4: Confidence switcher is visual-only; no JS state persistence or filtering.
  RD-5: Evidence DNA markers are static text. No dynamic data source.

10. DIAGNOSTIC QUESTIONS
  Q1: Does the :root block match DESIGN-TOKEN-SUMMARY.md exactly?
  Q2: Are all 4 fractal scales demonstrated?
  Q3: Does density increase as confidence decreases (R1-001)?
  Q4: Is the geological survey header always visible?
  Q5: Do stratum boundaries carry strong information scent (EXT-CONF-010)?
  Q6: Is each stratum independently valuable (EXT-CONF-007)?
  Q7: Are confidence labels categorical — words not percentages (EXT-CONF-003)?
  Q8: Does solid offset respect box-shadow: none constraint?

     ═══════════════════════════════════════════════════════════════════════
     END INLINE THREADING HEADER
     ═══════════════════════════════════════════════════════════════════════ -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OD-004: Confidence-Based Structure</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%23E83025'/><text x='50%25' y='50%25' dominant-baseline='central' text-anchor='middle' fill='white' font-family='serif' font-size='20'>K</text></svg>">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

  <style>
    /* ═══════════════════════════════════════════════════════════════════════════
       LOCKED DESIGN TOKENS — From DESIGN-TOKEN-SUMMARY.md
       DD-004 Lessons: Visual system at top, multiple usage paths
       DD-002 Lessons: CRESCENDO progressive density validated
       DD-006 Lessons: Fractal self-similarity at all scales
       OD-001 Lessons: Solid offset depth, scroll animations, callout system
       OD-003 Lessons: ISLANDS structure, code block styling, task steps
       ═══════════════════════════════════════════════════════════════════════════ */
    :root {
      /* Colors */
      --color-primary: #E83025;
      --color-background: #FEF9F5;
      --color-text: #1A1A1A;
      --color-text-secondary: #666666;
      --color-border: #E0D5C5;
      --color-border-subtle: #F0EBE3;

      /* Typography */
      --font-display: 'Instrument Serif', Georgia, serif;
      --font-body: 'Inter', system-ui, sans-serif;
      --font-mono: 'JetBrains Mono', 'SF Mono', monospace;

      /* 5-level typographic cascade (~1.5x ratio) — OD-CONVENTION-SPEC Section 5 */
      --type-page: 2.5rem;
      --type-section: 1.625rem;
      --type-subsection: 1.375rem; /* Convention name; was --type-stratum */
      --type-body: 1rem;
      --type-code: 0.875rem;
      --type-meta: 0.75rem; /* 12px — convention spec fix from 10px */

      /* Geometry — LOCKED */
      --border-radius: 0;
      --box-shadow: none;

      /* Spacing scale */
      --space-1: 4px;
      --space-2: 8px;
      --space-3: 12px;
      --space-4: 16px;
      --space-5: 20px;
      --space-6: 24px;
      --space-8: 32px;
      --space-10: 40px;
      --space-12: 48px;
      --space-16: 64px;
      --space-20: 80px;
      --space-24: 96px;

      /* Zone backgrounds — EXT-CONF-016: dual-semantic (spatial + density) */
      --color-zone-sparse: #FEF9F5;    /* Established — sparse, confident */
      --color-zone-moderate: #FFFFFF;   /* Probable — moderate density */
      --color-zone-dense: #FFFFFF;      /* Speculative — dense */
      --color-zone-densest: #FAF5ED;   /* Open — densest, breathing warmth */
      --color-zone-breathing: #FAF5ED; /* Chapter dividers, mode transitions */

      /* Gestalt Semantic Aliases — OD-CONVENTION-SPEC Section 6 */
      --space-within: var(--space-2);    /* 8px — within related elements */
      --space-between: var(--space-8);   /* 32px — between distinct elements */
      --space-chapter: var(--space-16);  /* 64px — between chapters/strata */

      /* Callout Accents */
      --accent-blue: #4A90D9;
      --accent-green: #4A9D6B;
      --accent-coral: #C97065;
      --accent-amber: #D97706;
      --accent-purple: #7C3AED;

      /* Standardized Border */
      --border-left-width: 4px;

      /* Confidence Stratum Spacing — R1-001: certain=sparse, uncertain=dense */
      --stratum-established-padding: var(--space-10);
      --stratum-probable-padding: var(--space-8);
      --stratum-speculative-padding: var(--space-5);
      --stratum-open-padding: var(--space-4);

      /* Solid Offset (EXT-CREATIVE-001 from OD-001) */
      --offset-x: 4px;
      --offset-y: 4px;
      --offset-color: #1A1A1A;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-body);
      background: var(--color-background);
      color: var(--color-text);
      line-height: 1.7;
      font-size: var(--type-body);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       SCROLL-DRIVEN REVEAL — EXT-CREATIVE-004 (THE ARRIVING WISDOM)
       Chromium-only with static fallback for Firefox/Safari
       ═══════════════════════════════════════════════════════════════════════════ */
    @keyframes arrive {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: none; }
    }

    .reveal {
      animation: arrive 0.5s ease-out both;
      animation-timeline: view();
      animation-range: entry 10% entry 40%;
    }

    .reveal-delay-1 {
      animation: arrive 0.5s ease-out both;
      animation-timeline: view();
      animation-range: entry 15% entry 45%;
    }

    /* EXT-CONF-017: Comprehensive reduced-motion — prophylactic single rule */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
      .reveal, .reveal-delay-1 {
        opacity: 1;
        transform: none;
      }
    }

    @supports not (animation-timeline: view()) {
      .reveal, .reveal-delay-1 {
        opacity: 1;
        transform: none;
      }
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       EXPLORATION HEADER — EXT-CONF-015: Dark header as geological survey map
       OD-CONVENTION-SPEC Section 4: Full-bleed dark header
       Cross-validated by OD-001, OD-003, OD-005 research packages
       ═══════════════════════════════════════════════════════════════════════════ */
    .exploration-header {
      border-bottom: 3px solid var(--color-primary);
      padding: var(--space-16) var(--space-8);
      background: var(--color-text); /* #1A1A1A — dark header */
      margin-bottom: 0;
    }

    .exploration-header__inner {
      max-width: 860px;
      margin: 0 auto;
    }

    .exploration-id {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-bottom: var(--space-2);
    }

    .exploration-title {
      font-family: var(--font-display);
      font-size: var(--type-page);
      font-style: italic;
      margin-bottom: var(--space-4);
      line-height: 1.15;
      color: #FAFAF5;
    }

    .exploration-hypothesis {
      font-size: var(--type-body);
      color: var(--color-text-secondary);
      max-width: 70ch;
      line-height: 1.6;
    }

    .exploration-meta {
      display: flex;
      gap: var(--space-6);
      margin-top: var(--space-4);
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--color-text-secondary);
      flex-wrap: wrap;
    }

    .exploration-meta span {
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .exploration-meta__value {
      color: var(--color-primary);
    }

    /* EXT-CONF-015: Miniature geological column in dark header */
    .geological-column {
      display: flex;
      gap: var(--space-4);
      margin-top: var(--space-6);
      padding-top: var(--space-4);
      border-top: 1px solid #333333; /* Cat 3 micro within dark header */
    }

    .geological-column__stratum {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    /* EXT-CONF-013: Border-weight indicators in minimap */
    .geological-column__bar--established {
      width: 24px;
      height: 4px; /* 4px = Established */
      background: #FAFAF5;
    }
    .geological-column__bar--probable {
      width: 24px;
      height: 3px; /* 3px = Probable */
      background: var(--accent-blue);
    }
    .geological-column__bar--speculative {
      width: 24px;
      height: 2px; /* 2px = Speculative — INTENTIONAL semantic */
      background: var(--accent-amber);
    }
    .geological-column__bar--open {
      width: 24px;
      height: 1px; /* 1px = Open — INTENTIONAL semantic per Rule 5 inversion */
      background: var(--accent-purple);
    }

    .geological-column__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       PAGE CONTAINER — max-width 860px, centered
       ═══════════════════════════════════════════════════════════════════════════ */
    .page-container {
      max-width: 860px;
      margin: 0 auto;
      padding: 0 var(--space-6);
      padding-bottom: var(--space-24);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       GEOLOGICAL SURVEY HEADER — EXT-CONF-009 (AI Agents Progressive Disclosure)
       Always-visible content inventory by confidence level
       "This page contains 4 established, 3 probable, 2 speculative, 2 open"
       ═══════════════════════════════════════════════════════════════════════════ */
    .geological-survey {
      background: white;
      border: 3px solid var(--color-border);
      border-left: var(--border-left-width) solid var(--color-primary);
      padding: var(--space-8);
      margin-top: var(--space-12);
      margin-bottom: var(--space-10);
      position: relative;
    }

    /* Solid offset — EXT-CREATIVE-001 neobrutalist depth */
    .geological-survey::after {
      content: '';
      position: absolute;
      top: var(--offset-y);
      left: var(--offset-x);
      width: 100%;
      height: 100%;
      background: var(--offset-color);
      z-index: -1;
    }

    .geological-survey__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--color-primary);
      margin-bottom: var(--space-5);
    }

    .geological-survey__title {
      font-family: var(--font-display);
      font-style: italic;
      font-size: var(--type-section);
      margin-bottom: var(--space-6);
    }

    .geological-survey__description {
      color: var(--color-text-secondary);
      font-size: 15px;
      line-height: 1.7;
      margin-bottom: var(--space-8);
      max-width: 640px;
    }

    /* Strata inventory — content counts per confidence level */
    .strata-inventory {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-6);
      margin-bottom: var(--space-8);
    }

    @media (max-width: 640px) {
      .strata-inventory { grid-template-columns: 1fr; }
    }

    .strata-inventory__item {
      display: flex;
      gap: var(--space-3);
      align-items: flex-start;
    }

    .strata-inventory__marker {
      /* Soul Piece 5: Squares Signal System */
      width: 10px;
      height: 10px;
      min-width: 10px;
      margin-top: 6px;
    }

    .strata-inventory__marker--established { background: var(--color-text); }
    .strata-inventory__marker--probable { background: var(--accent-blue); }
    .strata-inventory__marker--speculative { background: var(--accent-amber); }
    .strata-inventory__marker--open { background: var(--accent-purple); }

    .strata-inventory__text { font-size: 14px; }

    .strata-inventory__text strong {
      font-weight: 600;
      display: block;
      margin-bottom: var(--space-1); /* 4px */
    }

    .strata-inventory__text span {
      color: var(--color-text-secondary);
      font-size: 13px;
    }

    /* Survey meta row */
    .survey-meta {
      display: flex;
      gap: var(--space-8);
      padding-top: var(--space-5);
      border-top: 3px solid var(--color-border); /* Cat 1 structural — was 2px */
      flex-wrap: wrap;
    }

    .survey-meta__item {
      display: flex;
      flex-direction: column;
      gap: var(--space-1);
    }

    .survey-meta__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta); /* 12px — convention spec */
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--color-text-secondary);
    }

    .survey-meta__value {
      font-weight: 600;
      font-size: 14px;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       CONFIDENCE SWITCHER — EXT-CONF-012 (Stripe Docs)
       Visual toggle: "Facts Only" / "Full Analysis" / "Everything"
       ═══════════════════════════════════════════════════════════════════════════ */
    .confidence-switcher {
      display: flex;
      gap: 3px; /* Cat 1 structural grid gap — was 2px */
      margin: var(--space-6) 0;
      background: var(--color-border);
    }

    .confidence-switcher__option {
      flex: 1;
      text-align: center;
      padding: var(--space-3) var(--space-4);
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      background: white;
      cursor: pointer;
      color: var(--color-text-secondary);
      border: none;
      border-radius: 0;
    }

    .confidence-switcher__option--active {
      color: var(--color-primary);
      font-weight: 600;
      border-bottom: 3px solid var(--color-primary);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       GEOLOGICAL STRATA — The 4 confidence layers
       R1-001: certain=sparse, uncertain=dense (the defining rhythm)
       DD-F-004: Geological depth model
       DD-F-002: CRESCENDO progressive density increase
       ═══════════════════════════════════════════════════════════════════════════ */

    /* --- STRATUM BASE --- */
    .stratum {
      margin-bottom: var(--space-16);
    }

    .stratum__header {
      margin-bottom: var(--space-8);
    }

    .stratum__depth-label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-bottom: var(--space-2);
    }

    .stratum__title {
      font-family: var(--font-display);
      font-style: italic;
      font-size: var(--type-subsection);
      line-height: 1.3;
      margin-bottom: var(--space-3);
    }

    /* EXT-CONF-005 (Appleton Epistemic Disclosure): "You Are Reading" marker */
    .stratum__epistemic {
      font-size: 13px;
      color: var(--color-text-secondary);
      line-height: 1.6;
      max-width: 600px;
      padding-left: var(--space-5);
      border-left: var(--border-left-width) solid var(--color-border);
    }

    /* EXT-CONF-011 (EA Forum): Evidence DNA per stratum */
    .evidence-dna {
      display: flex;
      gap: var(--space-6);
      margin-top: var(--space-4);
      flex-wrap: wrap;
    }

    .evidence-dna__item {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--color-text-secondary);
    }

    .evidence-dna__value {
      color: var(--color-text);
      font-weight: 500;
    }

    /* --- STRATUM 1: ESTABLISHED (SPARSE) ---
       EXT-CONF-013: 4px border-left = highest confidence (bedrock)
       EXT-CONF-016: --color-zone-sparse background
       EXT-CONF-018: Micro-pacing — sparse intro / dense body / sparse bridge */
    .stratum--established {
      padding: var(--stratum-established-padding) 0;
      border-left: 4px solid var(--color-text); /* EXT-CONF-013: Established = 4px */
      padding-left: var(--space-6);
      background: var(--color-zone-sparse);
    }
    .stratum--established .stratum__depth-label { color: var(--color-text); }

    .stratum--established .content-block {
      padding: var(--space-8) 0;
      max-width: 720px; /* Narrower = sparse, confident feel */
    }

    .stratum--established .content-block + .content-block {
      border-top: 1px solid var(--color-border-subtle); /* Cat 2 data separator */
    }

    .stratum--established h3 {
      font-family: var(--font-display);
      font-style: italic;
      font-size: 1.25rem;
      margin-bottom: var(--space-6);
    }

    .stratum--established p {
      font-size: 15px;
      line-height: 1.8; /* Extra generous — sparse, confident */
      margin-bottom: var(--space-5);
    }

    /* --- STRATUM 2: PROBABLE (MODERATE) ---
       EXT-CONF-013: 3px border-left = strong but contested */
    .stratum--probable {
      padding: var(--stratum-probable-padding) 0;
      border-left: 3px solid var(--accent-blue); /* EXT-CONF-013: Probable = 3px */
      padding-left: var(--space-6);
      background: var(--color-zone-moderate);
    }
    .stratum--probable .stratum__depth-label { color: var(--accent-blue); }

    .stratum--probable .content-block { padding: var(--space-6) 0; }

    .stratum--probable .content-block + .content-block {
      border-top: 1px solid var(--color-border-subtle); /* Cat 2 data separator */
    }

    .stratum--probable h3 {
      font-family: var(--font-display);
      font-style: italic;
      font-size: 1.2rem;
      margin-bottom: var(--space-5);
    }

    .stratum--probable p {
      font-size: 15px;
      line-height: 1.7;
      margin-bottom: var(--space-4);
    }

    /* --- STRATUM 3: SPECULATIVE (DENSE) ---
       EXT-CONF-013: 2px border-left = INTENTIONAL semantic thin border (Rule 5 inversion)
       This is NOT an anti-pattern — thin border deliberately signals lower confidence */
    .stratum--speculative {
      padding: var(--stratum-speculative-padding) 0;
      border-left: 2px solid var(--accent-amber); /* EXT-CONF-013: Speculative = 2px INTENTIONAL */
      padding-left: var(--space-6);
      background: var(--color-zone-dense);
    }
    .stratum--speculative .stratum__depth-label { color: var(--accent-amber); }

    .stratum--speculative .content-block { padding: var(--space-5) 0; }

    .stratum--speculative .content-block + .content-block {
      border-top: 1px solid var(--color-border-subtle); /* Cat 2 data separator */
    }

    .stratum--speculative h3 {
      font-family: var(--font-display);
      font-style: italic;
      font-size: 1.125rem;
      margin-bottom: var(--space-4);
    }

    .stratum--speculative p {
      font-size: 14px;
      line-height: 1.65;
      margin-bottom: var(--space-3);
    }

    /* --- STRATUM 4: OPEN QUESTIONS (DENSEST) ---
       EXT-CONF-013: 1px border-left = INTENTIONAL semantic (Rule 5 inversion)
       1px borders here deliberately signal lowest certainty — the Unhurried Editor
       is confident about what is uncertain */
    .stratum--open {
      padding: var(--stratum-open-padding) 0;
      border-left: 1px solid var(--accent-purple); /* EXT-CONF-013: Open = 1px INTENTIONAL */
      padding-left: var(--space-6);
      background: var(--color-zone-densest);
    }
    .stratum--open .stratum__depth-label { color: var(--accent-purple); }

    .stratum--open .content-block { padding: var(--space-4) 0; }

    .stratum--open .content-block + .content-block {
      border-top: 1px solid var(--color-border-subtle); /* Cat 2 data separator */
    }

    .stratum--open h3 {
      font-family: var(--font-display);
      font-style: italic;
      font-size: 1.0625rem;
      margin-bottom: var(--space-3);
    }

    .stratum--open p {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: var(--space-3);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       STRATUM BOUNDARY MARKER — EXT-CONF-010 (NNG Information Scent)
       Strong scent at every stratum transition
       Progress indicators across strata
       R1-003: Viewport-aligned transitions
       ═══════════════════════════════════════════════════════════════════════════ */
    /* EXT-CONF-014: Stratum Transition Spacing System
       3-component boundary: 48px whitespace + 3px rule + stratum label
       Geological unconformity signal at each certainty level shift */
    .stratum-boundary {
      padding: var(--space-12) 0; /* 48px — chapter-level Gestalt spacing */
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-4);
    }

    .stratum-boundary__line {
      width: 100%;
      height: 3px; /* Cat 1 structural */
      background: var(--color-border);
    }

    /* EXT-CONF-014: Stratum label with geological field notation feel */
    .stratum-boundary__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--color-text-secondary);
    }

    .stratum-boundary__scent {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--color-text-secondary);
      text-align: center;
      max-width: 500px;
      line-height: 1.6;
    }

    /* Progress indicator — Soul Piece 5: Squares */
    .stratum-boundary__progress {
      display: flex;
      gap: var(--space-2);
      align-items: center;
    }

    .progress-square {
      width: 10px;
      height: 10px;
      border: 1px solid var(--color-border); /* Cat 3 micro-element */
    }

    .progress-square--filled {
      background: var(--color-primary);
      border-color: var(--color-primary);
    }

    .stratum-boundary__progress-label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-left: var(--space-2);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       CALLOUT SYSTEM — Soul Piece 4: Callout Family DNA
       2-zone structure (label + body), 4px left border, color differentiation
       6 variants: Essence(red), Tip(green), Checkpoint(green), Warning(amber),
                   Gotcha(coral), Note(blue)
       Applying DD-F-014: Max 2 callouts per viewport
       ═══════════════════════════════════════════════════════════════════════════ */
    .callout {
      border-left: var(--border-left-width) solid var(--color-border);
      background: var(--color-border-subtle);
      margin: var(--space-6) 0;
    }

    .callout__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      padding: var(--space-3) var(--space-5);
      border-bottom: 1px solid var(--color-border); /* Cat 2 data separator */
    }

    .callout__body {
      padding: var(--space-4) var(--space-5);
      font-size: 14px;
      line-height: 1.7;
    }

    .callout__body p + p { margin-top: var(--space-3); }

    .callout__body code {
      font-family: var(--font-mono);
      font-size: var(--type-code);
      background: var(--color-border-subtle); /* Solid — no semi-transparent */
      padding: 1px 5px;
      border: 1px solid var(--color-border); /* Cat 3 micro */
    }

    /* Callout label — consolidated color (Fix #4: audit finding) */
    .callout .callout__label {
      color: var(--color-text);
      font-weight: 600;
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    /* Callout variants — border color differentiation only (Soul Piece 4) */
    .callout--essence { border-left-color: var(--color-primary); }
    .callout--essence .callout__body {
      font-family: var(--font-display);
      font-style: italic;
      font-size: 15px;
    }

    .callout--tip { border-left-color: var(--accent-green); }

    .callout--checkpoint { border-left-color: var(--accent-green); background: #F4FAF6; }

    .callout--warning { border-left-color: var(--accent-amber); }

    .callout--gotcha { border-left-color: var(--accent-coral); }

    .callout--note { border-left-color: var(--accent-blue); }

    /* ═══════════════════════════════════════════════════════════════════════════
       COMPARISON GRID — R1-004 (Three-Column Doctrine)
       R1-006 (Horizontal Comparison Break)
       Side-by-side comparison of established vs speculative approaches
       ═══════════════════════════════════════════════════════════════════════════ */
    .comparison-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3px; /* Cat 1 structural grid gap — was 2px */
      margin: var(--space-8) 0;
      background: var(--color-border);
    }

    @media (max-width: 720px) {
      .comparison-grid { grid-template-columns: 1fr; }
    }

    .comparison-column {
      background: white;
      padding: var(--space-6);
    }

    .comparison-column__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: var(--space-4);
      padding-bottom: var(--space-3);
      border-bottom: 3px solid var(--color-border); /* Cat 1 structural — was 2px */
    }

    .comparison-column--established .comparison-column__label {
      color: var(--color-text);
      border-bottom-color: var(--color-text);
    }

    .comparison-column--probable .comparison-column__label {
      color: var(--accent-blue);
      border-bottom-color: var(--accent-blue);
    }

    .comparison-column--speculative .comparison-column__label {
      color: var(--accent-amber);
      border-bottom-color: var(--accent-amber);
    }

    .comparison-column p {
      font-size: 14px;
      line-height: 1.7;
      margin-bottom: var(--space-3);
    }

    .comparison-column ul {
      margin: var(--space-3) 0;
      padding-left: var(--space-5);
      font-size: 14px;
      line-height: 1.7;
    }

    .comparison-column ul li {
      margin-bottom: var(--space-2);
      list-style-type: square; /* Soul Piece 5 */
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       CODE BLOCKS — OD-CONVENTION-SPEC Section 3: Dark theme
       DD-F-006 CHARACTER SCALE: comments(sparse) -> logic(dense)
       ═══════════════════════════════════════════════════════════════════════════ */
    .code-block {
      background: #1A1A1A; /* Dark theme per convention */
      color: #FAFAF5;
      border: 3px solid var(--color-border); /* Cat 1 structural */
      padding: var(--space-6) var(--space-8);
      font-family: var(--font-mono);
      font-size: var(--type-code);
      line-height: 1.5;
      overflow-x: auto;
      margin: var(--space-4) 0;
    }

    .code-block__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #666666; /* Secondary text on dark bg */
      margin-bottom: var(--space-3);
      padding-bottom: var(--space-2);
      border-bottom: 1px solid #333333; /* Cat 3 micro within dark block */
    }

    .code-block pre {
      white-space: pre;
      overflow-x: auto;
    }

    .code-block code {
      font-family: var(--font-mono);
      font-size: var(--type-code);
      color: #FAFAF5;
    }

    .code-comment {
      color: #666666; /* Convention syntax palette: comments */
      font-style: italic;
    }

    /* Inline code — within prose */
    p code, li code {
      font-family: var(--font-mono);
      font-size: var(--type-code);
      background: var(--color-border-subtle);
      padding: 1px 5px;
      border: 1px solid var(--color-border);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       CRUX BLOCK — EXT-CONF-011 (EA Forum Epistemic)
       "What would change this confidence level?"
       ═══════════════════════════════════════════════════════════════════════════ */
    .crux-block {
      margin: var(--space-6) 0;
      padding: var(--space-5) var(--space-6);
      border: 3px solid var(--color-border);
      background: white;
    }

    .crux-block__label {
      font-family: var(--font-mono);
      font-size: var(--type-meta);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--accent-purple);
      margin-bottom: var(--space-3);
    }

    .crux-block__text {
      font-size: 14px;
      line-height: 1.7;
      color: var(--color-text-secondary);
    }

    .crux-block__text strong { color: var(--color-text); }

    /* ═══════════════════════════════════════════════════════════════════════════
       TROUBLESHOOTING — Collapsed <details> with coral accent
       ═══════════════════════════════════════════════════════════════════════════ */
    .troubleshoot {
      border: 3px solid var(--accent-coral);
      margin: var(--space-6) 0;
    }

    .troubleshoot summary {
      background: #FEF6F5;
      padding: var(--space-4) var(--space-5);
      cursor: pointer;
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 500;
      color: var(--accent-coral);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      list-style: none;
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .troubleshoot summary::-webkit-details-marker { display: none; }

    .troubleshoot summary::before {
      content: '+';
      font-size: 16px;
      font-weight: 600;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--accent-coral); /* Cat 3 micro-element */
      flex-shrink: 0;
    }

    .troubleshoot[open] summary::before { content: '-'; }

    .troubleshoot__body {
      padding: var(--space-5);
      font-size: 14px;
      line-height: 1.7;
      border-top: 1px solid var(--accent-coral);
    }

    .troubleshoot__body p + p { margin-top: var(--space-3); }

    .troubleshoot__body code {
      font-family: var(--font-mono);
      font-size: var(--type-code);
      background: var(--color-border-subtle); /* Solid — no semi-transparent */
      padding: 1px 5px;
      border: 1px solid var(--color-border); /* Cat 3 micro */
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       LISTS — Square markers (Soul Piece 5)
       ═══════════════════════════════════════════════════════════════════════════ */
    ul {
      list-style-type: square;
      padding-left: var(--space-6);
      margin: var(--space-3) 0;
    }

    ul li {
      margin-bottom: var(--space-2);
      font-size: 14px;
      line-height: 1.7;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       VERIFICATION CHECKLIST — Soul Piece 5: Square checkboxes
       ═══════════════════════════════════════════════════════════════════════════ */
    .verification-list {
      list-style: none;
      margin: var(--space-6) 0;
      padding: 0;
    }

    .verification-list li {
      display: flex;
      align-items: flex-start;
      gap: var(--space-4);
      padding: var(--space-3) 0;
      border-bottom: 1px solid var(--color-border-subtle);
      font-size: 14px;
    }

    .verification-list li:last-child { border-bottom: none; }

    .verification-list__check {
      width: 18px;
      height: 18px;
      min-width: 18px;
      border: 1px solid var(--accent-green); /* Cat 3 micro-element */
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--accent-green);
      margin-top: 2px;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       WHAT'S NEXT — final navigation
       ═══════════════════════════════════════════════════════════════════════════ */
    .whats-next {
      margin-top: var(--space-8);
      padding: var(--space-6);
      border: 3px solid var(--color-border);
      border-left: var(--border-left-width) solid var(--color-primary);
    }

    .whats-next__title {
      font-family: var(--font-display);
      font-style: italic;
      font-size: var(--type-section);
      margin-bottom: var(--space-4);
    }

    .whats-next p {
      font-size: 14px;
      line-height: 1.7;
      color: var(--color-text-secondary);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       SECTION HEADINGS — h2 consistent serif italic
       ═══════════════════════════════════════════════════════════════════════════ */
    h2 {
      font-family: var(--font-display);
      font-style: italic;
      font-size: var(--type-section);
      margin-bottom: var(--space-5);
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       ACCESSIBILITY — WCAG keyboard focus
       ═══════════════════════════════════════════════════════════════════════════ */
    :focus-visible {
      outline: 3px solid var(--color-primary);
      outline-offset: 2px;
    }

    summary:focus-visible {
      outline: 3px solid var(--color-primary);
      outline-offset: 2px;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       RESPONSIVE — works at 1440px and 768px
       ═══════════════════════════════════════════════════════════════════════════ */
    @media (max-width: 768px) {
      .exploration-meta { flex-direction: column; gap: var(--space-2); }
      .survey-meta { flex-direction: column; gap: var(--space-4); }
      .comparison-grid { grid-template-columns: 1fr; }
      .strata-inventory { grid-template-columns: 1fr; }
      .stratum--established .content-block { max-width: 100%; }
    }

    /* Fix #12: Skip-to-content link */
    .skip-link {
      position: absolute;
      top: -100%;
      left: 0;
      background: var(--color-primary);
      color: var(--bg-warm, var(--color-background));
      padding: 8px 16px;
      z-index: 1000;
      font-family: var(--font-body);
      font-size: 14px;
      text-decoration: none;
      border: none;
    }
    .skip-link:focus { top: 0; }

    /* Fix #13: Inline code font */
    code { font-family: var(--font-mono); font-size: 0.9em; }

    /* Fix #15: Selection styling */
    ::selection { background: var(--color-primary); color: var(--color-background); }

    /* Fix #16: Print styles */
    @media print {
      body { background: white; color: black; }
      .skip-link, .scroll-witness, nav { display: none; }
      a[href]::after { content: " (" attr(href) ")"; font-size: 0.8em; }
      * { box-shadow: none !important; }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       EXPLORATION HEADER — R1-019 (Tech Spec Aesthetic)
       ═══════════════════════════════════════════════════════════════════════════ -->
  <header class="exploration-header">
    <div class="exploration-header__inner">
      <div class="exploration-id">Exploration OD-004 &middot; Density: Geological + Crescendo</div>
      <h1 class="exploration-title">Confidence-Based Structure</h1>
      <p class="exploration-hypothesis">What if documentation was organized by certainty level — from established facts to open questions — creating natural geological stratification where density correlates inversely with confidence?</p>
      <div class="exploration-meta">
        <span>Status: <span class="exploration-meta__value">Active</span></span>
        <span>Pattern: <span class="exploration-meta__value">Certainty Strata</span></span>
        <span>Content: <span class="exploration-meta__value">API Best Practices</span></span>
      </div>

      <!-- EXT-CONF-015: Miniature geological column showing 4 strata with border-weight indicators -->
      <nav class="geological-column" aria-label="Geological column overview">
        <div class="geological-column__stratum">
          <div class="geological-column__bar--established"></div>
          <span class="geological-column__label">Established</span>
        </div>
        <div class="geological-column__stratum">
          <div class="geological-column__bar--probable"></div>
          <span class="geological-column__label">Probable</span>
        </div>
        <div class="geological-column__stratum">
          <div class="geological-column__bar--speculative"></div>
          <span class="geological-column__label">Speculative</span>
        </div>
        <div class="geological-column__stratum">
          <div class="geological-column__bar--open"></div>
          <span class="geological-column__label">Open</span>
        </div>
      </nav>
    </div>
  </header>

  <main id="main-content" class="page-container">

    <!-- ═══════════════════════════════════════════════════════════════════════
         GEOLOGICAL SURVEY — EXT-CONF-009 (AI Agents Progressive Disclosure)
         Always-visible content inventory by confidence level
         DD-F-006 PAGE SCALE: This is the sparse overview that begins the arc
         ═══════════════════════════════════════════════════════════════════════ -->
    <section class="geological-survey reveal" aria-label="Geological Survey">
      <div class="geological-survey__label">Geological Survey</div>
      <h2 class="geological-survey__title">API Best Practices &amp; Stability Guide</h2>
      <p class="geological-survey__description">
        This guide organizes API design knowledge by confidence level. Surface strata contain battle-tested conventions backed by years of production evidence. Deeper strata contain promising approaches with less validation. You decide how deep to dig.
      </p>

      <!-- Strata inventory — content counts per confidence level -->
      <div class="strata-inventory">
        <div class="strata-inventory__item">
          <div class="strata-inventory__marker strata-inventory__marker--established"></div>
          <div class="strata-inventory__text">
            <strong>Established (4 practices)</strong>
            <span>Proven conventions with deep industry consensus</span>
          </div>
        </div>
        <div class="strata-inventory__item">
          <div class="strata-inventory__marker strata-inventory__marker--probable"></div>
          <div class="strata-inventory__text">
            <strong>Probable (3 approaches)</strong>
            <span>Evidence-backed patterns gaining adoption</span>
          </div>
        </div>
        <div class="strata-inventory__item">
          <div class="strata-inventory__marker strata-inventory__marker--speculative"></div>
          <div class="strata-inventory__text">
            <strong>Speculative (2 techniques)</strong>
            <span>Emerging approaches not yet production-validated</span>
          </div>
        </div>
        <div class="strata-inventory__item">
          <div class="strata-inventory__marker strata-inventory__marker--open"></div>
          <div class="strata-inventory__text">
            <strong>Open Questions (2 inquiries)</strong>
            <span>Frontier territory with competing hypotheses</span>
          </div>
        </div>
      </div>

      <div class="survey-meta">
        <div class="survey-meta__item">
          <span class="survey-meta__label">Total Practices</span>
          <span class="survey-meta__value">11</span>
        </div>
        <div class="survey-meta__item">
          <span class="survey-meta__label">Confidence Range</span>
          <span class="survey-meta__value">Established to Open</span>
        </div>
        <div class="survey-meta__item">
          <span class="survey-meta__label">Reading Time</span>
          <span class="survey-meta__value">12-18 min</span>
        </div>
        <div class="survey-meta__item">
          <span class="survey-meta__label">Last Updated</span>
          <span class="survey-meta__value">2026-02-07</span>
        </div>
      </div>
    </section>

    <!-- Confidence Switcher — EXT-CONF-012 (Stripe Docs) -->
    <div class="confidence-switcher reveal" role="tablist" aria-label="Confidence filter">
      <button role="tab" id="tab-facts" class="confidence-switcher__option" aria-controls="panel-facts" aria-selected="false" tabindex="-1">Facts Only</button>
      <button role="tab" id="tab-analysis" class="confidence-switcher__option confidence-switcher__option--active" aria-controls="panel-analysis" aria-selected="true" tabindex="0">Full Analysis</button>
      <button role="tab" id="tab-everything" class="confidence-switcher__option" aria-controls="panel-everything" aria-selected="false" tabindex="-1">Everything</button>
    </div>
    <div role="tabpanel" id="panel-facts" aria-labelledby="tab-facts" hidden></div>
    <div role="tabpanel" id="panel-analysis" aria-labelledby="tab-analysis"></div>
    <div role="tabpanel" id="panel-everything" aria-labelledby="tab-everything" hidden></div>


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM 1: ESTABLISHED — Surface layer
         R1-001: SPARSE — generous whitespace, terse, confident
         DD-F-004: Atmosphere (basic facts, certain)
         DD-F-006 SECTION SCALE: intro(sparse) / detail(moderate) / evidence(dense)
         EXT-CONF-001: Frequently-needed features upfront
         EXT-CONF-003: Categorical label — "Established"
         EXT-CONF-005: Epistemic marker — "well-established practices"
         EXT-CONF-007: Layer isolation — self-contained interpretation zone
         ═══════════════════════════════════════════════════════════════════════ -->
    <section class="stratum stratum--established" id="established" aria-label="Established Practices">
      <div class="stratum__header reveal">
        <div class="stratum__depth-label">Stratum 1 — Established</div>
        <h2 class="stratum__title">Proven API Conventions</h2>
        <p class="stratum__epistemic">
          This section contains well-established practices backed by broad industry consensus, production deployment at scale across thousands of APIs, and years of community validation. You can treat these as facts.
        </p>
        <div class="evidence-dna">
          <span class="evidence-dna__item">Sources: <span class="evidence-dna__value">50+</span></span>
          <span class="evidence-dna__item">Validation: <span class="evidence-dna__value">Production-proven</span></span>
          <span class="evidence-dna__item">Consensus: <span class="evidence-dna__value">Industry-wide</span></span>
        </div>
      </div>

      <!-- ESTABLISHED PRACTICE 1: HTTP Status Codes -->
      <!-- DD-F-006 SECTION SCALE: intro(sparse) / code(moderate) -->
      <article class="content-block reveal">
        <h3>Use Standard HTTP Status Codes</h3>

        <p>
          Every API response carries a status code. Use the codes the HTTP specification defines. Do not invent new ones. Do not redefine existing ones. The status code is a contract between your API and every HTTP client ever written.
        </p>

        <p>
          Return <code>200</code> for success. Return <code>201</code> for resource creation. Return <code>204</code> when deleting succeeds and there is nothing to return. Return <code>400</code> for malformed requests, <code>401</code> when authentication is missing, <code>403</code> when authorization fails, <code>404</code> when the resource does not exist, and <code>500</code> when your server breaks.
        </p>

        <!-- DD-F-006 CHARACTER SCALE: comments(sparse) / logic(dense) -->
        <div class="code-block">
          <div class="code-block__label">Response Status Convention</div>
          <pre><code><span class="code-comment">// The status code IS the message</span>

GET /api/users/42        <span class="code-comment">&#8594; 200 OK</span>
POST /api/users          <span class="code-comment">&#8594; 201 Created</span>
DELETE /api/users/42     <span class="code-comment">&#8594; 204 No Content</span>
GET /api/users/99999     <span class="code-comment">&#8594; 404 Not Found</span>

<span class="code-comment">// Error body carries detail</span>
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Email address is required",
    "field": "email",
    "docs": "https://api.example.com/docs/errors#validation"
  }
}</code></pre>
        </div>
      </article>

      <!-- ESTABLISHED PRACTICE 2: Resource Naming -->
      <article class="content-block reveal">
        <h3>Name Resources as Plural Nouns</h3>

        <p>
          URLs identify resources. Resources are things, not actions. Name them with plural nouns. <code>/users</code>, not <code>/getUsers</code>. <code>/orders/42/items</code>, not <code>/fetchOrderItems?orderId=42</code>. The HTTP method already communicates the action. The URL communicates what you are acting upon.
        </p>

        <p>
          Nest resources to express relationships. An order's items live at <code>/orders/42/items</code>. A user's notifications at <code>/users/7/notifications</code>. Limit nesting to two levels; beyond that, use query parameters or top-level resources with filters.
        </p>
      </article>

      <!-- ESTABLISHED PRACTICE 3: Versioning -->
      <article class="content-block reveal">
        <h3>Version Your API from Day One</h3>

        <p>
          Put the version in the URL path: <code>/v1/users</code>. Not in headers. Not in query parameters. The URL is the most visible, most cacheable, most debuggable location. When you make breaking changes, increment the version and maintain the previous version until consumers migrate.
        </p>

        <div class="code-block">
          <div class="code-block__label">Versioning Pattern</div>
          <pre><code><span class="code-comment">// Current stable version</span>
GET /v2/users

<span class="code-comment">// Previous version &mdash; maintained until deprecation deadline</span>
GET /v1/users

<span class="code-comment">// Deprecation header on old version responses</span>
Sunset: Sat, 01 Nov 2026 00:00:00 GMT
Deprecation: true
Link: &lt;https://api.example.com/v2/users&gt;; rel="successor-version"</code></pre>
        </div>
      </article>

      <!-- ESTABLISHED PRACTICE 4: Pagination -->
      <article class="content-block reveal">
        <h3>Paginate All List Endpoints</h3>

        <p>
          Never return unbounded collections. Every list endpoint accepts <code>limit</code> and <code>offset</code> or uses cursor-based pagination. Default to a reasonable page size. Include total count and navigation links in the response.
        </p>
      </article>

      <!-- Essence callout — 1 of max 2 in this stratum -->
      <div class="callout callout--essence reveal">
        <div class="callout__label">Essence</div>
        <div class="callout__body">
          These four practices are bedrock. They have survived every API paradigm shift from SOAP to REST to GraphQL. The HTTP specification, URL conventions, versioning discipline, and pagination are the geology that does not move.
        </div>
      </div>

    </section><!-- END STRATUM 1: ESTABLISHED -->


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM BOUNDARY 1&#8594;2 — EXT-CONF-010 (NNG Information Scent)
         Strong scent: tells reader exactly what they will find below
         R1-003: Viewport-aligned transition
         ═══════════════════════════════════════════════════════════════════════ -->
    <div class="stratum-boundary reveal" role="separator" aria-label="Transition from Established to Probable">
      <div class="stratum-boundary__line"></div>
      <div class="stratum-boundary__label">Entering Stratum 2: Probable</div>
      <div class="stratum-boundary__scent">
        Below this point, practices are well-evidenced but have meaningful alternatives. Approaches here are common in modern APIs but have not achieved universal consensus.
      </div>
      <div class="stratum-boundary__progress" aria-label="Progress: 1 of 4 confidence levels completed">
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square" aria-hidden="true"></div>
        <div class="progress-square" aria-hidden="true"></div>
        <div class="progress-square" aria-hidden="true"></div>
        <span class="stratum-boundary__progress-label">1 of 4</span>
      </div>
    </div>


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM 2: PROBABLE — Middle layer
         R1-001: MODERATE density — evidence presented, alternatives noted
         DD-F-004: Surface to Topsoil (common patterns)
         DD-F-002: CRESCENDO — density increasing
         EXT-CONF-003: Categorical label — "Probable"
         EXT-CONF-011: Crux transparency — what would change this rating
         ═══════════════════════════════════════════════════════════════════════ -->
    <section class="stratum stratum--probable" id="probable" aria-label="Probable Approaches">
      <div class="stratum__header reveal">
        <div class="stratum__depth-label">Stratum 2 — Probable</div>
        <h2 class="stratum__title">Evidence-Backed Approaches</h2>
        <p class="stratum__epistemic">
          This section contains approaches with strong evidence from multiple production deployments and case studies, but which have meaningful alternatives or trade-offs that prevent universal consensus. Consider these seriously while understanding the caveats.
        </p>
        <div class="evidence-dna">
          <span class="evidence-dna__item">Sources: <span class="evidence-dna__value">10-20</span></span>
          <span class="evidence-dna__item">Validation: <span class="evidence-dna__value">Case studies</span></span>
          <span class="evidence-dna__item">Consensus: <span class="evidence-dna__value">Strong but contested</span></span>
        </div>
      </div>

      <!-- PROBABLE APPROACH 1: Structured Error Responses -->
      <article class="content-block reveal">
        <h3>Structured Error Responses with Problem Details</h3>

        <p>
          RFC 9457 (formerly RFC 7807) defines a standard format for error responses called "Problem Details." It provides a machine-readable structure with a type URI, title, status, detail message, and an instance identifier. Adopting this standard means your errors are self-documenting: any client that understands RFC 9457 can parse your errors without reading your documentation.
        </p>

        <p>
          The evidence is strong. Stripe, GitHub, and Microsoft Azure use structured error formats. The IETF has standardized it. But adoption is not universal. Many successful APIs use simpler custom formats. The trade-off: RFC 9457 adds verbosity and requires consumers to understand the standard. Simpler formats are easier to read in logs.
        </p>

        <div class="code-block">
          <div class="code-block__label">RFC 9457 Problem Details</div>
          <pre><code><span class="code-comment">// Standardized error response</span>
{
  "type": "https://api.example.com/errors/rate-limit",
  "title": "Rate Limit Exceeded",
  "status": 429,
  "detail": "You have exceeded 100 requests/min. Retry after 32 seconds.",
  "instance": "/api/users/42",
  "retryAfter": 32
}</code></pre>
        </div>

        <div class="callout callout--note reveal">
          <div class="callout__label">Why Not Established</div>
          <div class="callout__body">
            <p>RFC 9457 is well-defined but many production APIs predate it or use simpler formats that work equally well. The key principle &mdash; machine-readable, structured errors &mdash; is established. The specific format is probable.</p>
          </div>
        </div>
      </article>

      <!-- PROBABLE APPROACH 2: Rate Limiting Strategy -->
      <article class="content-block reveal">
        <h3>Sliding Window Rate Limiting</h3>

        <p>
          Rate limiting protects your API from abuse and ensures fair resource allocation. The question is not whether to rate limit &mdash; that is established. The question is how. Token bucket algorithms with sliding windows provide the best balance of accuracy and implementation complexity. They smooth out traffic spikes better than fixed-window counters while being simpler than leaky bucket implementations.
        </p>

        <p>
          The evidence supports this approach: Cloudflare, AWS API Gateway, and Kong all default to token bucket variants. However, fixed-window counting works perfectly well for most APIs, and some argue its simplicity outweighs the marginal accuracy improvement of sliding windows.
        </p>

        <!-- R1-006: Horizontal Comparison Break &mdash; established vs probable -->
        <div class="comparison-grid reveal">
          <div class="comparison-column comparison-column--established">
            <div class="comparison-column__label">Established: Fixed Window</div>
            <p>Simple counter per time window. Reset at window boundary. Easy to implement, easy to understand.</p>
            <ul>
              <li>100 requests per minute, counter resets at :00</li>
              <li>Implementation: single Redis INCR with TTL</li>
              <li>Downside: allows burst at window boundaries</li>
            </ul>
          </div>
          <div class="comparison-column comparison-column--probable">
            <div class="comparison-column__label">Probable: Sliding Window</div>
            <p>Weighted count across overlapping windows. No burst vulnerability at boundaries. More complex to implement.</p>
            <ul>
              <li>Weighted average of current and previous window</li>
              <li>Implementation: sorted set or multi-key tracking</li>
              <li>Downside: higher memory and computation cost</li>
            </ul>
          </div>
        </div>

        <!-- Crux block &mdash; EXT-CONF-011 -->
        <div class="crux-block reveal">
          <div class="crux-block__label">What Would Change This Rating</div>
          <div class="crux-block__text">
            <strong>Upgrade to Established:</strong> If the IETF standardized a rate limiting algorithm recommendation alongside the existing <code>RateLimit</code> header draft. <strong>Downgrade to Speculative:</strong> If distributed rate limiting proved unreliable across multi-region deployments at scale.
          </div>
        </div>
      </article>

      <!-- PROBABLE APPROACH 3: HATEOAS-Lite -->
      <article class="content-block reveal">
        <h3>Lightweight Hypermedia Links in Responses</h3>

        <p>
          Full HATEOAS (Hypermedia as the Engine of Application State) was a core REST constraint that most APIs have abandoned as impractical. However, a lighter version &mdash; including relevant navigation links in API responses &mdash; is gaining evidence as a genuine usability improvement. Rather than requiring clients to construct URLs from documentation, you embed the next logical actions directly in the response.
        </p>

        <p>
          GitHub's API includes pagination links in response headers. Stripe embeds <code>url</code> fields that point to related resources. This is not full HATEOAS &mdash; the client still needs documentation to understand the domain model. But the links reduce URL construction errors and make API exploration easier. The pattern works well for APIs with strong navigational relationships between resources.
        </p>

        <div class="code-block">
          <div class="code-block__label">Lightweight Hypermedia</div>
          <pre><code>{
  "id": "order_42",
  "status": "processing",
  "total": 129.99,
  <span class="code-comment">// Navigation links &mdash; client doesn't construct these</span>
  "links": {
    "self": "/v2/orders/42",
    "items": "/v2/orders/42/items",
    "customer": "/v2/customers/7",
    "cancel": "/v2/orders/42/cancel",
    "invoice": "/v2/orders/42/invoice"
  }
}</code></pre>
        </div>
      </article>

      <div class="callout callout--tip reveal">
        <div class="callout__label">Practical Guidance</div>
        <div class="callout__body">
          <p>If you are building a new API today, implement structured errors (RFC 9457 or similar), sliding window rate limiting, and basic hypermedia links. The evidence supports all three. But do not block your launch on any of them &mdash; simpler alternatives work fine for an initial release.</p>
        </div>
      </div>

    </section><!-- END STRATUM 2: PROBABLE -->


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM BOUNDARY 2&#8594;3 — EXT-CONF-010
         ═══════════════════════════════════════════════════════════════════════ -->
    <div class="stratum-boundary reveal" role="separator" aria-label="Transition from Probable to Speculative">
      <div class="stratum-boundary__line"></div>
      <div class="stratum-boundary__label">Entering Stratum 3: Speculative</div>
      <div class="stratum-boundary__scent">
        Below this point, approaches are emerging and promising but not yet validated in production at scale. Evidence is thinner, trade-offs less understood, and the community has not reached consensus.
      </div>
      <div class="stratum-boundary__progress" aria-label="Progress: 2 of 4 confidence levels completed">
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square" aria-hidden="true"></div>
        <div class="progress-square" aria-hidden="true"></div>
        <span class="stratum-boundary__progress-label">2 of 4</span>
      </div>
    </div>


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM 3: SPECULATIVE — Deep layer
         R1-001: DENSE — caveats, alternatives, evidence clusters
         DD-F-004: Subsoil (edge cases, uncertain)
         DD-F-002: CRESCENDO — density intensifying
         EXT-CONF-003: "Speculative" — non-alarming, curiosity not danger
         ═══════════════════════════════════════════════════════════════════════ -->
    <section class="stratum stratum--speculative" id="speculative" aria-label="Speculative Techniques">
      <div class="stratum__header reveal">
        <div class="stratum__depth-label">Stratum 3 — Speculative</div>
        <h2 class="stratum__title">Emerging Approaches</h2>
        <p class="stratum__epistemic">
          This section contains emerging patterns based on limited production data, conference talks, blog posts from early adopters, and theoretical analysis. These approaches may prove valuable or may prove misguided. The evidence is early and the trade-offs are not yet fully understood. Treat these as hypotheses worth testing, not prescriptions to follow.
        </p>
        <div class="evidence-dna">
          <span class="evidence-dna__item">Sources: <span class="evidence-dna__value">3-8</span></span>
          <span class="evidence-dna__item">Validation: <span class="evidence-dna__value">Early adopters</span></span>
          <span class="evidence-dna__item">Consensus: <span class="evidence-dna__value">Emerging, contested</span></span>
        </div>
      </div>

      <!-- SPECULATIVE TECHNIQUE 1: AI-Assisted API Schema Generation -->
      <article class="content-block reveal">
        <h3>AI-Assisted API Schema Generation from Natural Language</h3>

        <p>A small but growing number of teams are experimenting with generating OpenAPI schemas from natural language descriptions using large language models. The workflow: a product manager writes a plain English specification of the API contract. An LLM generates the OpenAPI schema. Engineers review and refine the schema. Code generation tools produce server stubs and client SDKs from the approved schema.</p>

        <p>The hypothesis: this inverts the traditional flow where engineers design the API and product managers review it, potentially producing APIs that better match business requirements because the specification language is closer to the problem domain.</p>

        <p>The evidence is thin but intriguing. A 2025 case study from a fintech startup reported 40% reduction in API design iteration cycles when using Claude to generate initial OpenAPI schemas from product requirement documents. However, the study had a sample size of one team over three months, and the quality improvement was self-reported. The generated schemas required significant manual correction for edge cases, error states, and authentication flows. Several engineering leads have publicly warned that AI-generated schemas encode the LLM's training data biases rather than reflecting the actual domain model.</p>

        <div class="code-block">
          <div class="code-block__label">AI-Assisted Schema Workflow (Experimental)</div>
          <pre><code><span class="code-comment">// Step 1: Natural language spec (product manager writes this)</span>
<span class="code-comment">//</span>
<span class="code-comment">// "Users can create projects. Each project has a name,</span>
<span class="code-comment">// description, and a list of members. Members have roles:</span>
<span class="code-comment">// owner, editor, viewer. Only owners can delete projects."</span>

<span class="code-comment">// Step 2: LLM generates OpenAPI schema (engineers review)</span>
paths:
  /v1/projects:
    post:
      summary: Create a new project
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                  maxLength: 100
                description:
                  type: string
                  maxLength: 500

<span class="code-comment">// Step 3: Human review catches what AI missed</span>
<span class="code-comment">// - Missing: rate limiting headers</span>
<span class="code-comment">// - Missing: idempotency key support</span>
<span class="code-comment">// - Missing: member invitation vs direct add</span>
<span class="code-comment">// - Wrong: AI defaulted to soft delete; spec implies hard</span></code></pre>
        </div>

        <div class="callout callout--warning reveal">
          <div class="callout__label">Caveat</div>
          <div class="callout__body">
            <p>AI-generated schemas tend to produce "generic REST" patterns. They excel at scaffolding standard CRUD operations but struggle with domain-specific nuances, complex authorization models, and non-obvious error states. Always treat the generated schema as a starting point requiring expert review, not a finished artifact.</p>
          </div>
        </div>

        <div class="crux-block reveal">
          <div class="crux-block__label">What Would Change This Rating</div>
          <div class="crux-block__text">
            <strong>Upgrade to Probable:</strong> If three or more independent teams published controlled studies showing measurable improvements in API quality or design velocity using AI-assisted schema generation. <strong>Downgrade to Open Question:</strong> If AI-generated schemas were shown to systematically produce security vulnerabilities not present in human-designed schemas.
          </div>
        </div>
      </article>

      <!-- SPECULATIVE TECHNIQUE 2: Edge-First API Architecture -->
      <article class="content-block reveal">
        <h3>Edge-First API Architecture</h3>

        <p>Traditional API architecture validates requests at the origin server. Edge-first architecture pushes validation, authentication, rate limiting, and even some business logic to edge nodes (CDN workers, edge functions). The hypothesis: by resolving most requests at the edge, you reduce latency by 50-200ms, reduce origin server load by 60-80%, and can provide geographically-aware responses without complex routing infrastructure.</p>

        <p>Early data from Cloudflare's developer relations team suggests that APIs running request validation at the edge reject 30-40% of invalid requests before they reach the origin server. This reduces origin load meaningfully. But the development experience is constrained: edge runtimes have limited APIs, cold start considerations, and debugging is harder than traditional server environments.</p>

        <p>Data consistency between edge nodes and origin databases introduces eventual consistency challenges that are well-understood in theory but painful in practice, particularly for financial or transactional APIs where strong consistency is a hard requirement.</p>

        <p>The counterargument is pragmatic: most APIs do not need sub-50ms response times. The complexity overhead of edge-first architecture is only justified at scale that most teams never reach. For the median API serving thousands (not millions) of requests per minute, a well-optimized origin server with appropriate caching provides comparable user experience at dramatically lower operational complexity.</p>

        <!-- R1-004: Three-Column Doctrine — side-by-side comparison -->
        <div class="comparison-grid reveal">
          <div class="comparison-column comparison-column--established">
            <div class="comparison-column__label">Established: Origin-First</div>
            <p>All validation and logic at the origin server. Simple deployment model, straightforward debugging, strong consistency by default.</p>
            <ul>
              <li>Single deployment target</li>
              <li>Full runtime capabilities</li>
              <li>Mature tooling and monitoring</li>
              <li>Latency: 80-300ms typical</li>
            </ul>
          </div>
          <div class="comparison-column comparison-column--speculative">
            <div class="comparison-column__label">Speculative: Edge-First</div>
            <p>Validation and partial logic at CDN edge nodes. Complex deployment, harder debugging, eventual consistency trade-offs.</p>
            <ul>
              <li>Multi-region edge deployment</li>
              <li>Constrained runtime APIs</li>
              <li>Cutting-edge tooling, sparse monitoring</li>
              <li>Latency: 10-50ms at edge</li>
            </ul>
          </div>
        </div>

        <div class="crux-block reveal">
          <div class="crux-block__label">What Would Change This Rating</div>
          <div class="crux-block__text">
            <strong>Upgrade to Probable:</strong> If a standardized edge runtime API emerged (like a W3C spec for edge workers) that provided consistent behavior across providers, eliminating vendor lock-in. <strong>Downgrade to Open Question:</strong> If edge computing costs proved non-competitive with optimized origin architectures at equivalent scale.
          </div>
        </div>
      </article>

      <details class="troubleshoot reveal">
        <summary>Common Pitfalls with Speculative API Patterns</summary>
        <div class="troubleshoot__body">
          <p><strong>Premature adoption:</strong> Implementing speculative patterns in production without fallback strategies. Always maintain the ability to revert to established patterns if the speculative approach fails.</p>
          <p><strong>Resume-driven development:</strong> Choosing architectural patterns because they are interesting rather than because they solve a real problem your API faces. If your API serves 1,000 requests per minute, you do not need edge-first architecture.</p>
          <p><strong>Cargo culting from FAANG:</strong> Patterns that work at Stripe's scale (millions of API calls per second) may be actively harmful at startup scale where simplicity is the highest-value architectural property.</p>
        </div>
      </details>

    </section><!-- END STRATUM 3: SPECULATIVE -->


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM BOUNDARY 3&#8594;4 — EXT-CONF-010
         Strongest scent — reader entering open research territory
         EXT-CONF-003: Non-alarming treatment (curiosity, not danger)
         ═══════════════════════════════════════════════════════════════════════ -->
    <div class="stratum-boundary reveal" role="separator" aria-label="Transition from Speculative to Open Questions">
      <div class="stratum-boundary__line"></div>
      <div class="stratum-boundary__label">Entering Stratum 4: Open Questions</div>
      <div class="stratum-boundary__scent">
        Below this point: genuine open questions where the industry has not converged on answers. These are not problems without solutions &mdash; they are problems where competing approaches have roughly equal evidence.
      </div>
      <div class="stratum-boundary__progress" aria-label="Progress: 3 of 4 confidence levels completed">
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square" aria-hidden="true"></div>
        <span class="stratum-boundary__progress-label">3 of 4</span>
      </div>
    </div>


    <!-- ═══════════════════════════════════════════════════════════════════════
         STRATUM 4: OPEN QUESTIONS — Deepest layer
         R1-001: DENSEST — research gaps, competing hypotheses
         DD-F-004: Bedrock (deep internals)
         DD-F-002: CRESCENDO — maximum density reached
         EXT-CONF-003: Non-alarming — curiosity, not danger
         EXT-CONF-011: Evidence DNA — "0-2 sources, frontier territory"
         ═══════════════════════════════════════════════════════════════════════ -->
    <section class="stratum stratum--open" id="open" aria-label="Open Questions">
      <div class="stratum__header reveal">
        <div class="stratum__depth-label">Stratum 4 — Open Questions</div>
        <h2 class="stratum__title">Frontier Territory</h2>
        <p class="stratum__epistemic">
          This section contains genuine open questions where the industry has not converged. Evidence is sparse or contradictory. Multiple competing approaches exist with roughly equal support. These questions represent active frontiers of API design practice where your own experimentation and judgment carry significant weight. This is not a warning zone &mdash; it is an invitation to explore.
        </p>
        <div class="evidence-dna">
          <span class="evidence-dna__item">Sources: <span class="evidence-dna__value">0-3</span></span>
          <span class="evidence-dna__item">Validation: <span class="evidence-dna__value">Anecdotal</span></span>
          <span class="evidence-dna__item">Consensus: <span class="evidence-dna__value">None &mdash; competing hypotheses</span></span>
        </div>
      </div>

      <!-- OPEN QUESTION 1: API Governance at Scale -->
      <article class="content-block reveal">
        <h3>How Should API Governance Scale Across Autonomous Teams?</h3>

        <p>Large organizations with dozens of autonomous teams each building their own APIs face a governance paradox: too much centralized control kills team velocity, but too little produces an incoherent API surface that degrades the developer experience. The question is not whether governance is needed &mdash; it is how to implement governance that scales without becoming a bottleneck.</p>

        <p><strong>Approach A: Centralized API review board.</strong> A small team reviews all API designs before implementation. Google's API Improvement Proposals (AIPs) follow this model. Advantage: consistency across all APIs. Disadvantage: the review board becomes a bottleneck, review cycles add days or weeks to delivery timelines, and the board's decisions are often disconnected from the production reality of individual teams. Teams game the system by designing APIs to pass review rather than to serve users.</p>

        <p><strong>Approach B: Automated linting with shared style guides.</strong> Spectral, Optic, and similar tools enforce API design rules automatically during CI/CD. No human review bottleneck. Advantage: fast, consistent, scalable. Disadvantage: linting rules capture syntax, not semantics. A linter can verify that your endpoint uses the correct HTTP method, but it cannot tell you whether your resource model makes sense for your domain.</p>

        <p><strong>Approach C: Federated guilds.</strong> Cross-team working groups that share knowledge and establish conventions through consensus rather than authority. Advantage: decisions are informed by production experience across teams. Disadvantage: guilds have no enforcement mechanism, conventions drift over time, attendance is inconsistent, and new teams may never encounter the guild's accumulated wisdom.</p>

        <p><strong>Approach D: API platforms as governance.</strong> Rather than governing API design through process, embed governance in infrastructure. Shared API gateways enforce rate limiting, authentication, and response formatting. Shared libraries enforce error handling and logging. The platform constrains the design space such that governance is implicit rather than explicit. Advantage: governance without process overhead. Disadvantage: building and maintaining an internal API platform is a massive engineering investment that only makes sense above a certain organizational scale.</p>

        <p>None of these approaches has demonstrated clear superiority. The right choice likely depends on organizational size, engineering culture, API maturity, and the specific domain. The industry lacks controlled studies comparing these approaches in similar contexts. Most evidence is anecdotal, retrospective, and confounded by survivorship bias.</p>
      </article>

      <!-- OPEN QUESTION 2: Protocol Coexistence -->
      <article class="content-block reveal">
        <h3>Will REST, GraphQL, and gRPC Converge or Permanently Coexist?</h3>

        <p>In 2016, the question was "will GraphQL replace REST?" In 2020, it was "gRPC for internal, REST for external, GraphQL for frontend-driven?" In 2026, we have ten years of data and the answer is: we still do not know. All three paradigms continue to gain adoption. None shows signs of declining. And new contenders (tRPC, ConnectRPC, server-sent events as API pattern) continue to emerge.</p>

        <p><strong>The convergence hypothesis:</strong> REST, GraphQL, and gRPC will eventually converge into a single protocol that combines REST's simplicity and cacheability, GraphQL's precise data fetching, and gRPC's performance and type safety. Evidence for: OpenAPI 4.0 discussions include features inspired by GraphQL's query language. gRPC-Web is bringing gRPC to browser contexts traditionally served by REST. ConnectRPC bridges gRPC and REST. Evidence against: each protocol has a different philosophical foundation (resource-oriented vs query-oriented vs procedure-oriented) that may be fundamentally irreconcilable.</p>

        <p><strong>The coexistence hypothesis:</strong> Different protocols serve different niches and will permanently coexist like programming languages. REST for public APIs. GraphQL for complex frontend requirements. gRPC for internal services. Evidence for: this is already the dominant pattern at large organizations. Evidence against: maintaining expertise and infrastructure for three protocols is expensive, and the boundaries between "public API" and "internal service" are increasingly blurred.</p>

        <p><strong>The disruption hypothesis:</strong> None of the current protocols will dominate. A fundamentally new approach &mdash; perhaps AI-mediated APIs where natural language replaces structured queries, or declarative APIs where the client specifies the desired outcome and the server determines how to achieve it &mdash; will make the REST/GraphQL/gRPC debate irrelevant. Evidence for: the rapid evolution of AI agents that consume APIs suggests future API consumers may not be humans writing HTTP requests but AI systems negotiating capabilities dynamically. Evidence against: new paradigms historically do not replace existing ones; they add to the stack. SOAP is still running in production at banks.</p>
      </article>

      <div class="callout callout--note reveal">
        <div class="callout__label">An Invitation</div>
        <div class="callout__body">
          <p>These open questions are not failures of knowledge. They are the frontier &mdash; the places where your own experiments, observations, and published findings could move the field forward. If you have data on API governance models, protocol coexistence patterns, or novel approaches, the community benefits from your contribution regardless of sample size.</p>
        </div>
      </div>

    </section><!-- END STRATUM 4: OPEN QUESTIONS -->


    <!-- ═══════════════════════════════════════════════════════════════════════
         FINAL BOUNDARY — Completion
         ═══════════════════════════════════════════════════════════════════════ -->
    <div class="stratum-boundary reveal" role="separator" aria-label="All confidence levels explored">
      <div class="stratum-boundary__line"></div>
      <div class="stratum-boundary__progress" aria-label="Progress: 4 of 4 confidence levels completed">
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <div class="progress-square progress-square--filled" aria-hidden="true"></div>
        <span class="stratum-boundary__progress-label">4 of 4 &mdash; Survey Complete</span>
      </div>
    </div>


    <!-- ═══════════════════════════════════════════════════════════════════════
         VERIFICATION — What you now know at each confidence level
         EXT-CONF-010: Gratification at each layer
         ═══════════════════════════════════════════════════════════════════════ -->
    <section class="whats-next reveal" aria-label="What You Now Know">
      <h2 class="whats-next__title">What You Now Know</h2>

      <ul class="verification-list">
        <li>
          <span class="verification-list__check" aria-hidden="true">&#x2713;</span>
          <span><strong>Established:</strong> HTTP status codes, resource naming, versioning, and pagination are non-negotiable API design foundations with industry-wide consensus.</span>
        </li>
        <li>
          <span class="verification-list__check" aria-hidden="true">&#x2713;</span>
          <span><strong>Probable:</strong> Structured error responses (RFC 9457), sliding window rate limiting, and lightweight hypermedia links are well-evidenced approaches with meaningful trade-offs.</span>
        </li>
        <li>
          <span class="verification-list__check" aria-hidden="true">&#x2713;</span>
          <span><strong>Speculative:</strong> AI-assisted schema generation and edge-first API architecture are emerging patterns with thin but intriguing evidence requiring careful evaluation.</span>
        </li>
        <li>
          <span class="verification-list__check" aria-hidden="true">&#x2713;</span>
          <span><strong>Open:</strong> API governance scaling and protocol coexistence remain genuinely unresolved questions where your experience contributes to the field.</span>
        </li>
      </ul>

      <p>Every stratum in this guide is independently valuable. The reader who stops at Established has accurate, complete guidance. The reader who reaches Open Questions has explored the full depth of current API design knowledge &mdash; including its honest limits.</p>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════════════
         DENSITY PATTERN REFLECTION — DD-F-006 META
         ═══════════════════════════════════════════════════════════════════════ -->
    <div class="callout callout--essence reveal">
      <div class="callout__label">Density Pattern Reflection</div>
      <div class="callout__body">
        The geological model works because certainty and density are natural inverses. What is known needs few words. What is unknown needs many. This page demonstrates that documentation benefits from explicit confidence stratification: readers calibrate their investment of attention based on the epistemic signal at each stratum boundary.
      </div>
    </div>

  </main>

  <!-- Fix #6: Tab ARIA keyboard navigation -->
  <script>
    (function() {
      var tablist = document.querySelector('[role="tablist"]');
      if (!tablist) return;
      var tabs = Array.from(tablist.querySelectorAll('[role="tab"]'));

      function activateTab(tab) {
        tabs.forEach(function(t) {
          t.setAttribute('aria-selected', 'false');
          t.setAttribute('tabindex', '-1');
          t.classList.remove('confidence-switcher__option--active');
          var panel = document.getElementById(t.getAttribute('aria-controls'));
          if (panel) panel.hidden = true;
        });
        tab.setAttribute('aria-selected', 'true');
        tab.setAttribute('tabindex', '0');
        tab.classList.add('confidence-switcher__option--active');
        var panel = document.getElementById(tab.getAttribute('aria-controls'));
        if (panel) panel.hidden = false;
        tab.focus();
      }

      tabs.forEach(function(tab) {
        tab.addEventListener('click', function() { activateTab(tab); });
        tab.addEventListener('keydown', function(e) {
          var idx = tabs.indexOf(tab);
          if (e.key === 'ArrowRight') {
            e.preventDefault();
            activateTab(tabs[(idx + 1) % tabs.length]);
          } else if (e.key === 'ArrowLeft') {
            e.preventDefault();
            activateTab(tabs[(idx - 1 + tabs.length) % tabs.length]);
          } else if (e.key === 'Home') {
            e.preventDefault();
            activateTab(tabs[0]);
          } else if (e.key === 'End') {
            e.preventDefault();
            activateTab(tabs[tabs.length - 1]);
          }
        });
      });
    })();
  </script>

</body>
</html>
