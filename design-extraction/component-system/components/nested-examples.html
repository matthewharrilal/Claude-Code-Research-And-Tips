<!--
═══════════════════════════════════════════════════════════════════════════════
LIGHT SECTION PROVENANCE HEADER — Phase 2B
File: design-extraction/component-system/components/nested-examples.html
Part Of: component-system/components — Production component HTML implementations
Contributed To: perceptual-audit-v2/components/ audit specimens; visual soul verification
═══════════════════════════════════════════════════════════════════════════════
-->

<!-- ============================================================================
   NESTED COMPONENT EXAMPLES
   Phase 3.5 Component System

   8 Specific Nested Combinations:
   1. Code block inside project card
   2. Gotcha box inside project card
   3. File tree inside project card
   4. ASCII art + code block combination
   5. Essence box with code example
   6. Multiple callout sequence (Gotcha -> Tip -> Info)
   7. Decision matrix inside reasoning box
   8. Full documentation page simulation

   Reference: SOUL-DEFINITION.md
   ============================================================================ -->

<!-- ============================================================================
   1. CODE BLOCK INSIDE PROJECT CARD
   Technical project showcase with code example
   ============================================================================ -->
<article class="project-card-ascii" data-component="project-card-ascii" style="margin: var(--space-10) 0; padding: var(--space-6); border: 2px solid var(--color-border);">
  <header style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: var(--space-4);">
    <h3 style="font-family: var(--font-display); font-size: var(--text-h3); font-weight: 600; margin: 0;">Context Manager Pattern</h3>
    <span style="font-family: var(--font-body); font-size: var(--text-sm); color: var(--color-text-secondary);">Pattern / 2025</span>
  </header>

  <p style="font-family: var(--font-body); font-size: var(--text-base); line-height: var(--leading-relaxed); color: var(--color-text); margin-bottom: var(--space-4);">
    A reusable pattern for managing agent context across session boundaries.
    External state files persist what matters; the context window stays focused.
  </p>

  <figure class="code-block" data-component="code-block" style="margin: var(--space-4) 0;">
    <span class="code-block__label">TypeScript</span>
    <pre class="code-block__pre"><code class="code-block__code"><span class="keyword">interface</span> ContextManager {
  load(): <span class="keyword">Promise</span>&lt;Context&gt;;
  save(ctx: Context): <span class="keyword">Promise</span>&lt;<span class="keyword">void</span>&gt;;
  merge(sources: Context[]): Context;
}

<span class="comment">// External files maintain state</span>
<span class="keyword">const</span> files = [<span class="string">'PROGRESS.md'</span>, <span class="string">'CONTEXT.json'</span>];</code></pre>
  </figure>
</article>

<!-- ============================================================================
   2. GOTCHA BOX INSIDE PROJECT CARD
   Warning embedded in project documentation
   ============================================================================ -->
<article class="project-card-ascii" data-component="project-card-ascii" style="margin: var(--space-10) 0; padding: var(--space-6); border: 2px solid var(--color-border);">
  <header style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: var(--space-4);">
    <h3 style="font-family: var(--font-display); font-size: var(--text-h3); font-weight: 600; margin: 0;">Overnight Ralph Loop</h3>
    <span style="font-family: var(--font-body); font-size: var(--text-sm); color: var(--color-text-secondary);">Autonomous / 2025</span>
  </header>

  <p style="font-family: var(--font-body); font-size: var(--text-base); line-height: var(--leading-relaxed); color: var(--color-text); margin-bottom: var(--space-4);">
    Run Claude Code autonomously overnight for large refactoring tasks.
    The loop restarts with fresh context on each iteration.
  </p>

  <aside class="gotcha-box" data-component="gotcha-box" role="note" aria-label="Warning" style="margin: var(--space-4) 0;">
    <span class="gotcha-box__label">Critical Warning</span>
    <div class="gotcha-box__content">
      <p>Never run autonomous loops without rate limiting. Without guards, you can
      exhaust your API quota in hours. Set a maximum iteration count or time limit.</p>
    </div>
  </aside>
</article>

<!-- ============================================================================
   3. FILE TREE INSIDE PROJECT CARD
   Project structure documentation
   ============================================================================ -->
<article class="project-card-ascii" data-component="project-card-ascii" style="margin: var(--space-10) 0; padding: var(--space-6); border: 2px solid var(--color-border);">
  <header style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: var(--space-4);">
    <h3 style="font-family: var(--font-display); font-size: var(--text-h3); font-weight: 600; margin: 0;">Gas Town Architecture</h3>
    <span style="font-family: var(--font-body); font-size: var(--text-sm); color: var(--color-text-secondary);">Factory / 2025</span>
  </header>

  <p style="font-family: var(--font-body); font-size: var(--text-base); line-height: var(--leading-relaxed); color: var(--color-text); margin-bottom: var(--space-4);">
    Steve Yegge's agent factory pattern with specialized roles.
  </p>

  <div class="file-tree" data-component="file-tree" style="margin: var(--space-4) 0;">
    <span class="file-tree__label">Gas Town Structure</span>
    <pre class="file-tree__content"><span class="file-tree__directory">gas-town/</span>
<span class="file-tree__branch">├── </span><span class="file-tree__item--emphasized">mayor/</span> <span class="file-tree__annotation">← Orchestrator</span>
<span class="file-tree__branch">├── </span><span class="file-tree__item--emphasized">deacon/</span> <span class="file-tree__annotation">← Quality control</span>
<span class="file-tree__branch">├── </span><span class="file-tree__directory">dogs/</span> <span class="file-tree__annotation">← Worker agents</span>
<span class="file-tree__branch">│   ├── </span>research.ts
<span class="file-tree__branch">│   └── </span>synthesis.ts
<span class="file-tree__branch">└── </span><span class="file-tree__item--emphasized">refinery/</span> <span class="file-tree__annotation">← Output processing</span></pre>
  </div>
</article>

<!-- ============================================================================
   4. ASCII ART + CODE BLOCK COMBINATION
   Visual + technical side by side
   ============================================================================ -->
<section style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-6); margin: var(--space-10) 0;">
  <figure class="ascii-art-container">
    <pre class="ascii-art ascii-art--md" style="color: var(--color-primary);" aria-label="Abstract pattern">
+============================+
|                            |
|     @@@@@@      @@@@@@     |
|     @@@@@@      @@@@@@     |
|     @@@@@@      @@@@@@     |
|                            |
|   ====================     |
|   ====================     |
|                            |
|     @@@@@@      @@@@@@     |
|     @@@@@@      @@@@@@     |
|     @@@@@@      @@@@@@     |
|                            |
|        ::::::::::          |
|        ::::::::::          |
|                            |
|   ====    @@@@    ====     |
|   ====    @@@@    ====     |
|                            |
+============================+
</pre>
    <figcaption style="font-family: var(--font-display); font-style: italic; font-size: var(--text-sm); color: var(--color-text-secondary); margin-top: var(--space-3);">Parallel Agent Architecture</figcaption>
  </figure>

  <figure class="code-block" data-component="code-block">
    <span class="code-block__label">Orchestration</span>
    <pre class="code-block__pre"><code class="code-block__code"><span class="comment">// Parallel agent execution</span>
<span class="keyword">const</span> agents = [
  createAgent(<span class="string">'research'</span>),
  createAgent(<span class="string">'analysis'</span>),
  createAgent(<span class="string">'synthesis'</span>)
];

<span class="keyword">const</span> results = <span class="keyword">await</span> Promise.all(
  agents.map(a => a.execute())
);

<span class="comment">// Merge into unified context</span>
<span class="keyword">return</span> mergeContexts(results);</code></pre>
  </figure>
</section>

<!-- ============================================================================
   5. ESSENCE BOX WITH CODE EXAMPLE
   Philosophy followed by implementation
   ============================================================================ -->
<section style="margin: var(--space-10) 0;">
  <aside class="essence-box" data-component="essence-box" role="note" aria-label="Key Insight">
    <div class="essence-box__content">
      <p>External state survives context resets. What persists between sessions
      defines what the agent can become.</p>
    </div>
    <cite class="essence-box__attribution">Compound Intelligence Principle</cite>
  </aside>

  <figure class="code-block" data-component="code-block" style="margin-top: var(--space-6);">
    <span class="code-block__label">Implementation</span>
    <pre class="code-block__pre"><code class="code-block__code"><span class="comment">// State that survives context boundary</span>
<span class="keyword">const</span> persist = {
  progress: <span class="string">'./PROGRESS.md'</span>,      <span class="comment">// What's done</span>
  context: <span class="string">'./CLAUDE.md'</span>,         <span class="comment">// How to work</span>
  memory: <span class="string">'./MEMORY.json'</span>         <span class="comment">// Learned patterns</span>
};

<span class="comment">// On session start: load external state</span>
<span class="comment">// On session end: save external state</span></code></pre>
    <figcaption class="code-block__caption">
      The pattern: internal context for the current task, external files for
      cross-session continuity.
    </figcaption>
  </figure>
</section>

<!-- ============================================================================
   6. MULTIPLE CALLOUT SEQUENCE
   Gotcha -> Tip -> Info flow
   ============================================================================ -->
<section style="margin: var(--space-10) 0;">
  <h3 style="font-family: var(--font-display); font-size: var(--text-h3); font-weight: 600; margin-bottom: var(--space-6);">Setting Up Your First Ralph Loop</h3>

  <aside class="gotcha-box" data-component="gotcha-box" role="note" aria-label="Warning">
    <span class="gotcha-box__label">Before You Start</span>
    <div class="gotcha-box__content">
      <p>Ensure you have a clear termination condition in PROMPT.md. Without one,
      the loop will run indefinitely until you manually stop it or exhaust your
      API quota.</p>
    </div>
  </aside>

  <aside class="tip-callout" data-component="tip-callout" role="note" aria-label="Tip">
    <span class="tip-callout__label">Pro Tip</span>
    <div class="tip-callout__content">
      <p>Add a <code>MAX_ITERATIONS=50</code> check at the start of your loop script.
      This provides a safety net while you're still learning the pattern.</p>
    </div>
  </aside>

  <aside class="info-callout" data-component="info-callout" role="note">
    <span class="info-callout__label">Background</span>
    <div class="info-callout__content">
      <p>The Ralph Wiggum name comes from the Simpsons character's "I'm in danger"
      meme. The community adopted it for the slight unease of running autonomous
      agents overnight.</p>
    </div>
  </aside>
</section>

<!-- ============================================================================
   7. DECISION MATRIX INSIDE REASONING BOX
   Structured comparison with tabular data
   ============================================================================ -->
<div class="reasoning-box" data-component="reasoning-box" role="region" aria-label="Nested Comparison" style="margin: var(--space-10) 0;">
  <h4 class="reasoning-box__title">Choosing Your Orchestration Level</h4>
  <div class="reasoning-box__grid">
    <div class="reasoning-box__column">
      <div class="reasoning-box__column-header">Simple (L0-L2)</div>
      <div class="reasoning-box__column-content">
        <p>Single session or basic file persistence. Best for individual tasks,
        prototyping, and learning.</p>
      </div>
    </div>
    <div class="reasoning-box__column">
      <div class="reasoning-box__column-header">Complex (L5-L7)</div>
      <div class="reasoning-box__column-content">
        <p>Multi-agent orchestration with distributed state. Best for production
        workloads and team-scale projects.</p>
      </div>
    </div>
  </div>

  <!-- Embedded decision matrix -->
  <div class="decision-matrix" data-component="decision-matrix" style="margin: var(--space-4) 0; border-left: none; padding-left: var(--space-5);">
    <table class="decision-matrix__table" style="width: 100%;">
      <thead>
        <tr>
          <th>Level</th>
          <th>Pattern</th>
          <th>Team Size</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>L0-L1</td>
          <td>Vanilla Claude</td>
          <td>Solo</td>
        </tr>
        <tr>
          <td>L2-L3</td>
          <td>Ralph Loop</td>
          <td>Solo-Pair</td>
        </tr>
        <tr>
          <td>L5-L6</td>
          <td>Gas Town</td>
          <td>Team</td>
        </tr>
        <tr>
          <td>L7</td>
          <td>Panopticon</td>
          <td>Enterprise</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="reasoning-box__summary">
    <span class="reasoning-box__summary-label">Recommendation</span>
    <p class="reasoning-box__summary-content">
      Start at L2 with Ralph Loop. Move up only when you hit concrete limitations,
      not because a higher level sounds more impressive.
    </p>
  </div>
</div>

<!-- ============================================================================
   8. FULL DOCUMENTATION PAGE SIMULATION
   Complete page with multiple component types
   ============================================================================ -->
<article style="margin: var(--space-16) 0; padding-top: var(--space-8); border-top: 4px solid var(--color-primary);">
  <header style="margin-bottom: var(--space-8);">
    <h2 style="font-family: var(--font-display); font-size: var(--text-h1); font-weight: 600; margin: 0;">The Ralph Wiggum Pattern</h2>
    <p style="font-family: var(--font-body); font-size: var(--text-lg); color: var(--color-text-secondary); margin-top: var(--space-2);">Continuous autonomous iteration for large-scale refactoring</p>
  </header>

  <div class="challenge-box" data-component="challenge-box" role="note" aria-label="Difficulty Level">
    <div class="challenge-box__level">L3</div>
    <div class="challenge-box__details">
      <div class="challenge-box__label">Intermediate</div>
      <p class="challenge-box__description">
        Requires understanding of CLAUDE.md and basic shell scripting.
      </p>
      <div class="challenge-box__modifiers">
        <span class="challenge-box__modifier">Autonomous</span>
        <span class="challenge-box__modifier">Multi-file</span>
      </div>
    </div>
  </div>

  <aside class="essence-box" data-component="essence-box" role="note" aria-label="Key Insight" style="margin-top: var(--space-8);">
    <div class="essence-box__content">
      <p>Fresh context per iteration prevents hallucination accumulation.
      External files are the memory; the context window is the workspace.</p>
    </div>
  </aside>

  <h3 style="font-family: var(--font-display); font-size: var(--text-h3); font-weight: 600; margin: var(--space-8) 0 var(--space-4) 0;">Implementation</h3>

  <div class="file-tree" data-component="file-tree">
    <span class="file-tree__label">Required Files</span>
    <pre class="file-tree__content"><span class="file-tree__directory">your-project/</span>
<span class="file-tree__branch">├── </span><span class="file-tree__item--emphasized">PROMPT.md</span> <span class="file-tree__annotation">← Current objective</span>
<span class="file-tree__branch">├── </span><span class="file-tree__item--emphasized">PROGRESS.md</span> <span class="file-tree__annotation">← Completed work</span>
<span class="file-tree__branch">├── </span><span class="file-tree__item--emphasized">CLAUDE.md</span> <span class="file-tree__annotation">← Agent context</span>
<span class="file-tree__branch">└── </span>run.sh <span class="file-tree__annotation">← Loop script</span></pre>
  </div>

  <figure class="code-block" data-component="code-block" style="margin-top: var(--space-6);">
    <span class="code-block__label">run.sh</span>
    <pre class="code-block__pre"><code class="code-block__code"><span class="comment">#!/bin/bash</span>
<span class="comment"># The Ralph Wiggum Loop</span>

<span class="keyword">while</span> :; <span class="keyword">do</span>
  <span class="comment"># Feed prompt to Claude Code</span>
  cat PROMPT.md | claude-code

  <span class="comment"># Check for termination signal</span>
  <span class="keyword">if</span> grep -q <span class="string">"DONE"</span> PROGRESS.md; <span class="keyword">then</span>
    <span class="keyword">break</span>
  <span class="keyword">fi</span>
<span class="keyword">done</span></code></pre>
  </figure>

  <aside class="gotcha-box" data-component="gotcha-box" role="note" aria-label="Warning" style="margin-top: var(--space-6);">
    <span class="gotcha-box__label">Critical</span>
    <div class="gotcha-box__content">
      <p>Always include a termination condition. Add <code>DONE</code> to PROGRESS.md
      when the objective is complete, or the loop runs forever.</p>
    </div>
  </aside>

  <h3 style="font-family: var(--font-display); font-size: var(--text-h3); font-weight: 600; margin: var(--space-8) 0 var(--space-4) 0;">Progress</h3>

  <div class="task-progression" data-component="task-progression">
    <div class="task-progression__item task-progression__item--complete">
      <span class="task-progression__number">1.</span>
      <div class="task-progression__content">
        <h4 class="task-progression__title">Create context files</h4>
        <p class="task-progression__description">
          Set up CLAUDE.md, PROMPT.md, and PROGRESS.md in project root.
        </p>
      </div>
    </div>
    <div class="task-progression__item task-progression__item--current">
      <span class="task-progression__number">2.</span>
      <div class="task-progression__content">
        <h4 class="task-progression__title">Define objective</h4>
        <p class="task-progression__description">
          Write clear goal and termination condition in PROMPT.md.
        </p>
      </div>
    </div>
    <div class="task-progression__item task-progression__item--upcoming">
      <span class="task-progression__number">3.</span>
      <div class="task-progression__content">
        <h4 class="task-progression__title">Run the loop</h4>
        <p class="task-progression__description">
          Execute run.sh and monitor for completion.
        </p>
      </div>
    </div>
  </div>

  <aside class="tip-callout" data-component="tip-callout" role="note" aria-label="Tip" style="margin-top: var(--space-6);">
    <span class="tip-callout__label">Best Practice</span>
    <div class="tip-callout__content">
      <p>Run your first loop during the day when you can monitor it. Once you're
      confident in your termination conditions, graduate to overnight runs.</p>
    </div>
  </aside>
</article>
