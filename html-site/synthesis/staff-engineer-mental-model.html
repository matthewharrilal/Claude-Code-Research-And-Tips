<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Engineer Mindset | Claude Code Documentation</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- GSAP for scroll-sync -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <!-- Tailwind Config with Design Tokens -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'bg-base': '#ffffff',
            'bg-subtle': '#fafafa',
            'bg-muted': '#f4f4f5',
            'text-primary': '#18181b',
            'text-secondary': '#3f3f46',
            'text-muted': '#71717a',
            'accent': '#0D9373',
            'accent-light': '#10b981',
            'accent-bg': '#ecfdf5',
            'border': '#e4e4e7',
            // Activity Zone content type colors (Original 6)
            'az-invariant': '#3b82f6',    // Blue
            'az-effect': '#f59e0b',       // Amber
            'az-composition': '#8b5cf6',  // Purple
            'az-frontier': '#ef4444',     // Red
            'az-warstory': '#10b981',     // Green
            'az-alternative': '#6b7280',  // Gray
            // Activity Zone generative content types (New 10)
            'az-inversion': '#4f46e5',    // Indigo
            'az-constraint': '#8b5cf6',   // Violet
            'az-gradient': '#f43f5e',     // Rose
            'az-horizon': '#06b6d4',      // Cyan
            'az-violation': '#f97316',    // Orange
            'az-tradeoff': '#f59e0b',     // Amber
            'az-analogy': '#d946ef',      // Fuchsia
            'az-expertise': '#10b981',    // Emerald
            'az-minimal': '#84cc16',      // Lime
            'az-inflection': '#eab308',   // Yellow
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Fira Code', 'monospace'],
          },
        },
      },
    }
  </script>

  <style>
    /* Base Styles */
    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
    }

    [id] {
      scroll-margin-top: 80px;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: #ffffff;
      color: #18181b;
      line-height: 1.7;
    }

    /* Three Panel Layout */
    .three-panel-layout {
      min-height: 100vh;
      position: relative;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: #ffffff;
      border-bottom: 1px solid #e4e4e7;
      z-index: 100;
      display: flex;
      align-items: center;
      padding: 0 24px;
    }

    /* Left Navigation - 240px fixed */
    .left-nav {
      position: fixed;
      top: 56px;
      left: 0;
      width: 240px;
      height: calc(100vh - 56px);
      border-right: 1px solid #e4e4e7;
      background: #ffffff;
      overflow-y: auto;
      padding: 16px 0;
      z-index: 40;
    }

    .nav-section {
      padding: 0 12px;
      margin-bottom: 8px;
    }

    .nav-section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      font-size: 14px;
      font-weight: 500;
      color: #3f3f46;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
    }

    .nav-section-header:hover {
      background: #f4f4f5;
    }

    .nav-section-header.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-item {
      display: block;
      padding: 6px 12px 6px 44px;
      font-size: 14px;
      color: #71717a;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.15s;
    }

    .nav-item:hover {
      color: #3f3f46;
      background: #f4f4f5;
    }

    .nav-item.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-children {
      display: none;
      overflow: hidden;
    }

    .nav-children.expanded {
      display: block;
    }

    .nav-chevron {
      transition: transform 0.2s;
    }

    .nav-section.expanded .nav-chevron {
      transform: rotate(90deg);
    }

    /* Main Content - Flexible, margins for fixed sidebars */
    .main-content {
      margin-left: 240px;
      margin-right: 480px;
      margin-top: 56px;
      padding: 48px 48px;
      min-width: 400px;
    }

    /* Activity Zone - 480px fixed */
    .activity-zone {
      position: fixed;
      top: 56px;
      right: 0;
      width: 480px;
      height: calc(100vh - 56px);
      border-left: 1px dashed #e4e4e7;
      background: #fafafa;
      overflow-y: auto;
      padding: 24px 20px;
      z-index: 40;
    }

    /* Responsive: Hide Activity Zone below 1400px */
    @media (max-width: 1400px) {
      .activity-zone {
        display: none;
      }
      .main-content {
        margin-right: 0;
        padding: 40px 32px;
      }
    }

    /* Responsive: Hide Left Nav below 768px */
    @media (max-width: 768px) {
      .left-nav {
        display: none;
      }
      .left-nav.open {
        display: block;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        z-index: 50;
        overflow-y: auto;
      }
      .main-content {
        margin-left: 0;
        padding: 24px 16px;
        min-width: auto;
      }
    }

    /* Resizer - Draggable divider between Main Panel and Activity Zone */
    .resizer {
      position: fixed;
      top: 56px;
      right: 480px;
      width: 6px;
      height: calc(100vh - 56px);
      cursor: col-resize;
      background: transparent;
      z-index: 50;
      transition: background 0.15s ease;
    }

    .resizer:hover {
      background: rgba(13, 147, 115, 0.15);
    }

    .resizer.active {
      background: rgba(13, 147, 115, 0.25);
    }

    /* Prevent text selection during resize */
    body.resizing {
      user-select: none;
      cursor: col-resize !important;
    }

    body.resizing * {
      cursor: col-resize !important;
    }

    /* Hide resizer when Activity Zone is hidden (responsive) */
    @media (max-width: 1400px) {
      .resizer {
        display: none;
      }
    }

    /* Activity Zone Items */
    .activity-item {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      background: #ffffff;
      border: 1px solid #e4e4e7;
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.5;
      transition: all 0.3s ease;
    }

    .activity-item.active {
      opacity: 1;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .activity-item:hover {
      opacity: 1;
    }

    .activity-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Activity Zone content type borders (Original 6) */
    .activity-item.invariant { border-left: 4px solid #3b82f6; }
    .activity-item.effect { border-left: 4px solid #f59e0b; }
    .activity-item.composition { border-left: 4px solid #8b5cf6; }
    .activity-item.frontier { border-left: 4px solid #ef4444; }
    .activity-item.warstory { border-left: 4px solid #10b981; }
    .activity-item.alternative { border-left: 4px solid #6b7280; }

    /* Activity Zone generative content types (New 10) */
    .activity-item.inversion { border-left: 4px solid #4f46e5; }
    .activity-item.constraint { border-left: 4px solid #8b5cf6; }
    .activity-item.gradient { border-left: 4px solid #f43f5e; }
    .activity-item.horizon { border-left: 4px solid #06b6d4; }
    .activity-item.violation { border-left: 4px solid #f97316; }
    .activity-item.tradeoff { border-left: 4px solid #f59e0b; }
    .activity-item.analogy { border-left: 4px solid #d946ef; }
    .activity-item.expertise { border-left: 4px solid #10b981; }
    .activity-item.minimal { border-left: 4px solid #84cc16; }
    .activity-item.inflection { border-left: 4px solid #eab308; }

    /* Main Content Components */

    /* Section titles with number */
    .section-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background: #0D9373;
      color: #ffffff;
      font-size: 14px;
      font-weight: 600;
      border-radius: 50%;
      margin-right: 12px;
    }

    .section-title {
      font-size: 24px;
      font-weight: 600;
      color: #18181b;
      margin-bottom: 20px;
      margin-top: 56px;
      display: flex;
      align-items: center;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    /* Essence Box (15 words) */
    .essence-box {
      background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 40px;
    }

    .essence-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #10b981;
      margin-bottom: 12px;
    }

    .essence-text {
      font-size: 22px;
      font-weight: 500;
      color: #ffffff;
      line-height: 1.4;
    }

    /* Core Abstraction Box */
    .core-abstraction {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .core-philosophy {
      font-size: 16px;
      color: #3f3f46;
      margin-bottom: 16px;
      font-style: italic;
    }

    .core-code {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 16px;
      overflow-x: auto;
    }

    .core-code code {
      font-family: 'Fira Code', monospace;
      font-size: 15px;
      color: #10b981;
      white-space: nowrap;
    }

    .core-anchor {
      font-size: 14px;
      color: #71717a;
      text-align: center;
    }

    /* Design Decision Box */
    .decision-box {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .decision-why {
      font-size: 16px;
      font-weight: 600;
      color: #0D9373;
      margin-bottom: 12px;
    }

    .decision-reasoning {
      font-size: 14px;
      color: #3f3f46;
      margin-bottom: 16px;
    }

    .decision-implication {
      background: #f4f4f5;
      border-radius: 8px;
      padding: 16px;
    }

    .decision-implication-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: #71717a;
      margin-bottom: 8px;
    }

    /* Code Blocks */
    .code-block {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 24px;
      position: relative;
      overflow-x: auto;
    }

    .code-block pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #e4e4e7;
      line-height: 1.6;
    }

    .code-block .comment { color: #6b7280; }
    .code-block .keyword { color: #c084fc; }
    .code-block .string { color: #10b981; }
    .code-block .variable { color: #60a5fa; }
    .code-block .number { color: #f59e0b; }

    .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #3f3f46;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s;
    }

    .copy-btn:hover {
      background: #52525b;
    }

    /* Path Steps */
    .path-container {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .path-step {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }

    .path-step:last-child {
      margin-bottom: 0;
    }

    .path-number {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      background: #0D9373;
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .path-content {
      flex: 1;
      font-size: 14px;
      color: #3f3f46;
    }

    .path-content code {
      background: #e4e4e7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
    }

    /* Gotcha Box */
    .gotcha-box {
      background: #fffbeb;
      border: 1px solid #fcd34d;
      border-left: 4px solid #f59e0b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .gotcha-title {
      font-weight: 600;
      color: #92400e;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .gotcha-detail {
      font-size: 14px;
      color: #78350f;
      margin-bottom: 8px;
    }

    .gotcha-detail strong {
      color: #92400e;
    }

    /* What's Hard Box */
    .hard-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-left: 4px solid #ef4444;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .hard-title {
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hard-detail {
      font-size: 14px;
      color: #7f1d1d;
      margin-bottom: 8px;
    }

    /* When To Use Grid */
    .when-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 40px;
    }

    @media (max-width: 900px) {
      .when-grid {
        grid-template-columns: 1fr;
      }
    }

    .when-use {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 24px;
    }

    .when-not {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 24px;
    }

    .when-title {
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .when-use .when-title { color: #166534; }
    .when-not .when-title { color: #991b1b; }

    .when-item {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 14px;
    }

    .when-use .when-item { color: #166534; }
    .when-not .when-item { color: #991b1b; }

    /* Wave Table */
    .wave-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
    }

    .wave-table th,
    .wave-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #e4e4e7;
      font-size: 14px;
    }

    .wave-table th {
      background: #f4f4f5;
      font-weight: 600;
      color: #3f3f46;
    }

    .wave-table tr:hover {
      background: #fafafa;
    }

    .wave-current {
      background: #ecfdf5 !important;
      font-weight: 600;
    }

    .wave-emerging {
      background: #fef3c7 !important;
    }

    .wave-frontier {
      background: #fce7f3 !important;
    }

    /* Stats Table */
    .stats-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
    }

    .stats-table th,
    .stats-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #e4e4e7;
      font-size: 14px;
    }

    .stats-table th {
      background: #fef2f2;
      font-weight: 600;
      color: #991b1b;
    }

    .stats-table td:last-child {
      font-family: 'Fira Code', monospace;
      font-weight: 600;
      color: #991b1b;
    }

    /* Principle Box */
    .principle-box {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .principle-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      background: #0D9373;
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      border-radius: 50%;
      margin-right: 12px;
    }

    .principle-title {
      font-size: 16px;
      font-weight: 600;
      color: #18181b;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
    }

    .principle-content {
      font-size: 14px;
      color: #3f3f46;
      margin-bottom: 12px;
    }

    .principle-quote {
      background: #f4f4f5;
      border-left: 3px solid #0D9373;
      padding: 12px 16px;
      font-style: italic;
      color: #3f3f46;
      font-size: 14px;
      border-radius: 0 8px 8px 0;
    }

    /* Iron Law Box */
    .iron-law-box {
      background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 24px;
      text-align: center;
    }

    .iron-law-text {
      font-size: 18px;
      font-weight: 600;
      color: #ffffff;
      letter-spacing: 0.5px;
    }

    .iron-law-subtext {
      font-size: 14px;
      color: #a1a1aa;
      margin-top: 12px;
    }

    /* Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      padding: 8px;
      background: none;
      border: none;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .mobile-menu-btn {
        display: flex;
      }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #fafafa;
    }

    ::-webkit-scrollbar-thumb {
      background: #d4d4d8;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1aa;
    }

    /* Keyboard shortcut hint */
    .kbd {
      display: inline-flex;
      align-items: center;
      padding: 2px 6px;
      background: #f4f4f5;
      border: 1px solid #e4e4e7;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: #71717a;
    }

    /* Subsection heading */
    .subsection-title {
      font-size: 18px;
      font-weight: 600;
      color: #18181b;
      margin-top: 32px;
      margin-bottom: 16px;
    }

    /* Quote block */
    .quote-block {
      background: #f4f4f5;
      border-left: 4px solid #0D9373;
      padding: 16px 20px;
      margin-bottom: 24px;
      border-radius: 0 8px 8px 0;
    }

    .quote-text {
      font-style: italic;
      color: #3f3f46;
      font-size: 15px;
      margin-bottom: 8px;
    }

    .quote-attribution {
      font-size: 13px;
      color: #71717a;
    }

    /* Factory diagram */
    .factory-diagram {
      background: #18181b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 24px;
      overflow-x: auto;
    }

    .factory-diagram pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #10b981;
      line-height: 1.6;
    }

    /* Leader table */
    .leader-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
    }

    .leader-table th,
    .leader-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #e4e4e7;
      font-size: 14px;
    }

    .leader-table th {
      background: #f4f4f5;
      font-weight: 600;
      color: #3f3f46;
    }

    .leader-table tr:hover {
      background: #fafafa;
    }

    .leader-rank {
      font-weight: 600;
      color: #0D9373;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
      <i data-lucide="menu" class="w-5 h-5 text-text-secondary"></i>
    </button>
    <div class="flex items-center gap-3">
      <i data-lucide="terminal" class="w-5 h-5 text-accent"></i>
      <span class="font-semibold text-text-primary">Claude Code</span>
    </div>
    <div class="flex-1 flex justify-center">
      <button class="flex items-center gap-2 px-4 py-2 bg-bg-muted rounded-lg text-text-muted text-sm hover:bg-border transition-colors">
        <i data-lucide="search" class="w-4 h-4"></i>
        <span>Search documentation...</span>
        <span class="kbd">Cmd+K</span>
      </button>
    </div>
    <div class="flex items-center gap-4">
      <a href="#" class="text-sm text-text-muted hover:text-text-primary transition-colors">Support</a>
      <button class="p-2 hover:bg-bg-muted rounded-lg transition-colors" aria-label="Toggle theme">
        <i data-lucide="sun" class="w-4 h-4 text-text-muted"></i>
      </button>
    </div>
  </header>

  <div class="three-panel-layout">
    <!-- Left Navigation -->
    <nav class="left-nav" id="leftNav">
      <div class="px-4 mb-4">
        <span class="text-xs font-semibold text-text-muted uppercase tracking-wider">Staff Engineer Mindset</span>
      </div>

      <!-- Essence -->
      <div class="nav-section expanded" data-section="essence">
        <div class="nav-section-header active" onclick="toggleSection(this)">
          <i data-lucide="zap" class="w-4 h-4"></i>
          <span>Essence</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#essence" class="nav-item active">The 15-Word Summary</a>
        </div>
      </div>

      <!-- Core Abstraction -->
      <div class="nav-section expanded" data-section="core">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="box" class="w-4 h-4"></i>
          <span>Core Abstraction</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#core-abstraction" class="nav-item">Six Waves + 5x Rule</a>
          <a href="#gas-town" class="nav-item">Gas Town Architecture</a>
          <a href="#beads" class="nav-item">Beads Memory System</a>
        </div>
      </div>

      <!-- Design Decisions -->
      <div class="nav-section expanded" data-section="decisions">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="lightbulb" class="w-4 h-4"></i>
          <span>Design Decisions</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#why-waves" class="nav-item">Why Think in Waves?</a>
          <a href="#why-infrastructure" class="nav-item">Why Infrastructure?</a>
          <a href="#why-orchestration" class="nav-item">Why Orchestrator/Worker?</a>
        </div>
      </div>

      <!-- The 8 Principles -->
      <div class="nav-section" data-section="principles">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="shield" class="w-4 h-4"></i>
          <span>The 8 Principles</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#principles" class="nav-item">Staff Engineer Mental Model</a>
        </div>
      </div>

      <!-- Path of a Decision -->
      <div class="nav-section" data-section="path">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="git-branch" class="w-4 h-4"></i>
          <span>Path of a Decision</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#path" class="nav-item">Frontier Questions</a>
        </div>
      </div>

      <!-- Gotchas -->
      <div class="nav-section" data-section="gotchas">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="alert-triangle" class="w-4 h-4"></i>
          <span>Gotchas</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#gotchas" class="nav-item">Production Reality</a>
        </div>
      </div>

      <!-- What's Hard -->
      <div class="nav-section" data-section="hard">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="flame" class="w-4 h-4"></i>
          <span>What's Hard</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#hard" class="nav-item">The Paradigm Shift</a>
        </div>
      </div>

      <!-- When to Use -->
      <div class="nav-section" data-section="when">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="check-circle" class="w-4 h-4"></i>
          <span>When to Apply</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#when" class="nav-item">Readiness Criteria</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Staff engineers think in waves, validate ruthlessly, and manage AI teams like distributed systems.</div>
        </div>

        <p class="text-text-secondary mb-6">
          This is <strong>frontier thinking</strong> for practitioners who've mastered the basics. If you're comfortable with Ralph loops and exploring multi-agent systems, this document provides the mental models of staff engineers building at the cutting edge.
        </p>

        <p class="text-text-secondary mb-6">
          Synthesized from Steve Yegge, Boris Cherny, Reuven Cohen, and other advanced practitioners who are defining how AI-assisted development actually works at scale.
        </p>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Abstraction
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"The industry is chasing the 2025 CLI form factor while the frontier has moved to multi-agent orchestration."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'Wave 4 → Wave 5 → Wave 6 = 5x × 5x × 5x = 125x')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>Wave 4 → Wave 5 → Wave 6 = 5x × 5x × 5x = 125x</code>
          </div>

          <div class="core-anchor">Each wave is ~5x productivity over the previous. Position yourself on the wave progression, not tool mastery.</div>
        </div>

        <h3 class="subsection-title">The Six Waves Framework (Steve Yegge)</h3>

        <p class="text-text-secondary mb-6">
          The most important mental model for understanding where AI-assisted development is heading:
        </p>

        <table class="wave-table">
          <thead>
            <tr>
              <th>Wave</th>
              <th>Name</th>
              <th>Timeline</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Wave 1</td>
              <td>Traditional Coding</td>
              <td>2022</td>
              <td>DECLINING</td>
            </tr>
            <tr>
              <td>Wave 2</td>
              <td>Code Completions</td>
              <td>2023</td>
              <td>DECLINING</td>
            </tr>
            <tr>
              <td>Wave 3</td>
              <td>Chat-Based Coding</td>
              <td>2024</td>
              <td>DECLINING</td>
            </tr>
            <tr class="wave-current">
              <td>Wave 4</td>
              <td>Coding Agents</td>
              <td>2025 H1</td>
              <td>CURRENT</td>
            </tr>
            <tr class="wave-emerging">
              <td>Wave 5</td>
              <td>Agent Clusters</td>
              <td>2025 H2</td>
              <td>EMERGING</td>
            </tr>
            <tr class="wave-frontier">
              <td>Wave 6</td>
              <td>Agent Fleets</td>
              <td>2026</td>
              <td>FRONTIER</td>
            </tr>
          </tbody>
        </table>

        <div class="quote-block">
          <div class="quote-text">"Coding agents are like receiving free camels when you've only walked—powerful but demanding."</div>
          <div class="quote-attribution">— Steve Yegge</div>
        </div>

        <p class="text-text-secondary mb-6">
          They require careful task decomposition, supervision (not blind trust), understanding of their limitations, and bounded ambition. The competitive advantage isn't tool mastery—it's being ahead on the wave progression.
        </p>

        <h3 class="subsection-title" id="gas-town">Gas Town: The Agent Factory Mental Model</h3>

        <p class="text-text-secondary mb-6">
          Gas Town is Steve Yegge's fourth complete orchestrator. The key insight isn't the tool—it's the architecture pattern that will define the next wave:
        </p>

        <div class="factory-diagram">
          <pre>Gas Town Factory
├─ HQ (Management)
│  ├─ Mayor (high-level coordination)
│  ├─ Deacon (monitoring & health)
│  └─ Dogs (quality gates)
├─ Refinery (auto-decomposition)
└─ Rigs (projects)
   ├─ Witness (observer agent)
   ├─ Polecats (persistent workers)
   └─ Crew (ephemeral workers)</pre>
        </div>

        <div class="quote-block">
          <div class="quote-text">"Gas Town will go from a self-propelling slime monster to a shiny, well-run agent factory. All without me having to do a damned thing to improve it myself anymore."</div>
          <div class="quote-attribution">— Steve Yegge</div>
        </div>

        <h3 class="subsection-title" id="beads">Beads: Solving the "50 First Dates" Problem</h3>

        <p class="text-text-secondary mb-6">
          Yegge's Beads is a structured memory system for agents. The mental model explains why markdown plans fail:
        </p>

        <div class="quote-block">
          <div class="quote-text">"Agents simply cannot keep track of work using Markdown files. They try, and they try, and they will churn out gobs of six-phase markdown todo-plans until the cows come home."</div>
          <div class="quote-attribution">— Steve Yegge</div>
        </div>

        <p class="text-text-secondary mb-6">
          Problems with markdown plans: Text, not structured data. Not queryable. High cognitive load on the model. No dependency tracking. No state persistence.
        </p>

        <p class="text-text-secondary mb-6">
          <strong>Beads provides:</strong> Distributed, git-backed graph issue tracker. Dependency-aware task tracking. Persistent state across sessions. Queryable structure. Agents use it "naturally and smoothly with no training."
        </p>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-waves" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Design Decisions
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY THINK IN WAVES?</div>
          <div class="decision-reasoning">
            Each wave represents a ~5x productivity multiplier. Wave 4 (agents) is 25x over manual coding. Wave 5 (clusters) is 125x. Most organizations are still at Wave 3 (chat). The competitive gap is widening exponentially.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Don't ask "how do I use Claude Code better?" Ask "am I ready for Wave 5?" Position yourself on the wave progression, not just tool mastery. The gap between waves compounds over time.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-infrastructure">
          <div class="decision-why">WHY INFRASTRUCTURE OVER WRAPPERS?</div>
          <div class="decision-reasoning">
            "Almost everyone starts with LangChain or similar frameworks. Almost everyone eventually strips them out." Production is FastAPI and direct API calls. Frameworks add abstraction that obscures failure modes. Wrappers hide the physics of the system.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Build orchestration platforms, not prompt templates. Frameworks are for demos. Production requires understanding the raw mechanics. Every wrapper you add is a failure mode you can't debug.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-orchestration">
          <div class="decision-why">WHY ORCHESTRATOR/WORKER SEPARATION?</div>
          <div class="decision-reasoning">
            Research shows error amplification is 17.2x for independent agents but only 4.4x for centralized orchestration. The Iron Law exists because mixing coordination and execution creates feedback loops that spiral into chaos.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Orchestrators ONLY coordinate. Workers ONLY execute. Never mix. This is the Iron Law. Violate it and your system fails. Every successful multi-agent system follows this pattern.
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: THE 8 PRINCIPLES -->
      <section id="principles" data-activity="principles">
        <h2 class="section-title">
          <span class="section-number">4</span>
          The 8 Staff Engineer Principles
        </h2>

        <p class="text-text-secondary mb-6">
          These principles synthesize the wisdom of advanced practitioners into actionable thinking:
        </p>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">1</span>
            Think in Waves, Not Tools
          </div>
          <div class="principle-content">
            Don't ask "how do I use Claude Code better?" Ask "am I ready for Wave 5 (agent clusters)?" The competitive advantage isn't tool mastery—it's being ahead on the wave progression.
          </div>
        </div>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">2</span>
            Infrastructure Over Wrappers
          </div>
          <div class="principle-quote">
            "Almost everyone starts with LangChain or similar frameworks. Almost everyone eventually strips them out."
          </div>
          <div class="principle-content" style="margin-top: 12px;">
            Production is FastAPI and direct API calls. Frameworks are for demos.
          </div>
        </div>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">3</span>
            Agents Are Junior Developers
          </div>
          <div class="principle-quote">
            "Think of AI coding as having an extremely persistent but context-limited junior developer who never sleeps."
          </div>
          <div class="principle-content" style="margin-top: 12px;">
            They need supervision. They need clear tasks. They need verification. They will make mistakes. They don't remember yesterday.
          </div>
        </div>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">4</span>
            The Trust Gradient
          </div>
          <div class="principle-quote">
            "Trust is the number one thing keeping the industry from rocketing forward. You can't trust anything—you have to validate and verify."
          </div>
          <div class="principle-content" style="margin-top: 12px;">
            <strong>Never trust:</strong> File operations, database operations, deployments.<br>
            <strong>Verify always:</strong> Code changes, API calls, git operations.<br>
            <strong>Trust with monitoring:</strong> Read operations, analysis, planning.
          </div>
        </div>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">5</span>
            Sandbox Everything
          </div>
          <div class="principle-quote">
            "Never give an autonomous AI agent access to your primary operating system or critical file storage."
          </div>
          <div class="principle-content" style="margin-top: 12px;">
            Docker containers for isolation. Git worktrees for parallel agents. Budget caps and iteration limits. Circuit breakers and timeouts.
          </div>
        </div>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">6</span>
            The Economics of Agents
          </div>
          <div class="principle-content">
            Yegge's model: Each agent costs ~$10-12/hour in tokens. Each agent delivers ~1 developer in productivity. 5 agents = $50/hour = 5x productivity. Budget accordingly: $50k+/year in LLM spend per developer.
          </div>
        </div>

        <div class="principle-box">
          <div class="principle-title">
            <span class="principle-number">7</span>
            Planning is Non-Negotiable
          </div>
          <div class="principle-content">
            From Anthropic and every advanced practitioner:<br>
            Planning Before Implementation. Explore → Plan → Code → Commit. PRD-driven development. Acceptance criteria before execution.
          </div>
        </div>

        <div class="iron-law-box">
          <div class="iron-law-text">PRINCIPLE 8: THE IRON LAW</div>
          <div class="iron-law-text" style="margin-top: 16px;">ORCHESTRATORS COORDINATE. WORKERS EXECUTE. NEVER MIX.</div>
          <div class="iron-law-subtext">Violate it and your system fails.</div>
        </div>
      </section>

      <!-- Section 5: PATH OF A DECISION -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Frontier Questions
        </h2>

        <p class="text-text-secondary mb-6">
          What staff engineers are thinking about now—the questions that define the next wave:
        </p>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content">
              <strong>How do you manage 20-30 agents at once?</strong><br>
              <em>Yegge's answer:</em> Gas Town with multiple levels of supervision. "It will be like Kubernetes, but for agents."
            </div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content">
              <strong>How do agents remember across sessions?</strong><br>
              <em>Yegge's answer:</em> Beads—structured, queryable, git-backed state. Not markdown.
            </div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content">
              <strong>How do you prevent runaway costs?</strong><br>
              <em>Production answer:</em> Hard caps, circuit breakers, monitoring dashboards, iteration limits.
            </div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content">
              <strong>How do you handle agent coordination failures?</strong><br>
              <em>Research answer:</em> Centralized orchestration reduces error amplification from 17.2x to 4.4x.
            </div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content">
              <strong>When do you stop automating and stay interactive?</strong><br>
              <em>Decision framework:</em><br>
              • Exploratory work → Stay interactive<br>
              • Well-defined tasks → Automate<br>
              • Security-critical → Human in the loop<br>
              • High-uncertainty → Agent clusters with verification
            </div>
          </div>
        </div>

        <h3 class="subsection-title">New Voices to Follow</h3>

        <p class="text-text-secondary mb-6">
          Practitioners pushing the frontier beyond Ralph loops:
        </p>

        <table class="leader-table">
          <thead>
            <tr>
              <th>Rank</th>
              <th>Name</th>
              <th>Key Contribution</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="leader-rank">1</td>
              <td>Reuven Cohen</td>
              <td>Enterprise swarm infrastructure (Claude-Flow)</td>
            </tr>
            <tr>
              <td class="leader-rank">2</td>
              <td>Numman Ali</td>
              <td>Unlocking hidden Anthropic capabilities (CC Mirror)</td>
            </tr>
            <tr>
              <td class="leader-rank">3</td>
              <td>Kieran Klaassen</td>
              <td>Compound Engineering management paradigm</td>
            </tr>
            <tr>
              <td class="leader-rank">4</td>
              <td>Seth Hobson</td>
              <td>Most comprehensive agent ecosystem (99 agents)</td>
            </tr>
            <tr>
              <td class="leader-rank">5</td>
              <td>mxllo</td>
              <td>Systems programming rigor (Rust agents)</td>
            </tr>
            <tr>
              <td class="leader-rank">6</td>
              <td>Han Lee</td>
              <td>Protocol-level architecture analysis</td>
            </tr>
            <tr>
              <td class="leader-rank">7</td>
              <td>YK (ykdojo)</td>
              <td>Optimization and security focus</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- Section 6: GOTCHAS (Production Reality) -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Production Reality: The War Stories
        </h2>

        <p class="text-text-secondary mb-6">
          What actually happens when you run agents at scale—the numbers nobody wants to talk about:
        </p>

        <table class="stats-table">
          <thead>
            <tr>
              <th>Metric</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>AI project failure rate</td>
              <td>80%+ (2x typical IT projects)</td>
            </tr>
            <tr>
              <td>Multi-agent system failures</td>
              <td>41-86.7%</td>
            </tr>
            <tr>
              <td>Error amplification (independent agents)</td>
              <td>17.2x</td>
            </tr>
            <tr>
              <td>Error amplification (centralized)</td>
              <td>4.4x</td>
            </tr>
            <tr>
              <td>Tool calling failure rate</td>
              <td>3-15%</td>
            </tr>
          </tbody>
        </table>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            The $47,000 Lesson
          </div>
          <div class="gotcha-detail">
            <strong>What happened:</strong> A multi-agent research tool slipped into a recursive loop that ran for 11 days before anyone noticed.
          </div>
          <div class="gotcha-detail">
            <strong>The cost:</strong> $47,000 in accumulated API charges.
          </div>
          <div class="gotcha-detail">
            <strong>The fix:</strong> Monitoring and cost caps are non-negotiable. Never run autonomous agents without circuit breakers.
          </div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            The 20-Step Workflow Math
          </div>
          <div class="gotcha-detail">
            <strong>The math:</strong> "Even if you're optimistic and assume each step succeeds 95% of the time, a 20-step workflow only has about a 36% chance of finishing without error."
          </div>
          <div class="gotcha-detail">
            <strong>Why this matters:</strong> Production aims for 99.9%+ reliability. Agents are nowhere near that.
          </div>
          <div class="gotcha-detail">
            <strong>The fix:</strong> Decompose into smaller verified units. Add retry logic with exponential backoff. Expect failures and design for recovery.
          </div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Context Degradation is the Primary Failure Mode
          </div>
          <div class="gotcha-detail">
            <strong>The insight:</strong> "Context degradation is the primary failure mode." Everything else is secondary.
          </div>
          <div class="gotcha-detail">
            <strong>What this means:</strong> Manage context or fail. Fresh context beats extended sessions. External state > internal memory.
          </div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Team Not Adopting Agent Workflows
          </div>
          <div class="gotcha-detail">
            <strong>Symptom:</strong> You've mastered agent orchestration but team members resist or fail to adopt.
          </div>
          <div class="gotcha-detail">
            <strong>Cause:</strong> Usually jumping to complexity (Wave 4-5) before team masters basics (Wave 3), no shared vocabulary, or insufficient tooling.
          </div>
          <div class="gotcha-detail">
            <strong>Fix:</strong> Start with shared CLAUDE.md (Level 1). This is the minimal team-wide standard. Then ladder the team up together.
          </div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard: The Paradigm Shift
        </h2>

        <div class="quote-block">
          <div class="quote-text">"The traditional software developer's role is transforming from writing code line-by-line to becoming a high-level orchestrator or strategic guide. This is one of the most challenging transitions the industry has ever faced."</div>
          <div class="quote-attribution">— Yegge and Kim, "Vibe Coding"</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            What Changes
          </div>
          <div class="hard-detail">• You don't write code anymore</div>
          <div class="hard-detail">• You remain fully accountable for it</div>
          <div class="hard-detail">• You orchestrate, validate, verify</div>
          <div class="hard-detail">• You manage AI teams, not just human teams</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            What Doesn't Change
          </div>
          <div class="hard-detail">• Architecture matters more than ever</div>
          <div class="hard-detail">• System design is still your job</div>
          <div class="hard-detail">• Quality standards are still your responsibility</div>
          <div class="hard-detail">• You need to understand what the code does</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            The Trust Problem
          </div>
          <div class="hard-detail">
            <strong>The tension:</strong> Agents are powerful but unreliable. You can't trust anything—you have to validate and verify. But verification at scale is expensive.
          </div>
          <div class="hard-detail">
            <strong>Why it's hard:</strong> Trust is the number one thing keeping the industry from rocketing forward. The gap between what agents CAN do and what you can TRUST them to do is enormous.
          </div>
          <div class="hard-detail">
            <strong>Mitigation:</strong> Build trust incrementally. Start with HOTL (Human On The Loop). Graduate to autonomous only for verified domains. Never trust security-critical operations.
          </div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            The Adoption Gap
          </div>
          <div class="hard-detail">
            <strong>The reality:</strong> "We couldn't even get people to use Claude Code, let alone 10-20 at once."
          </div>
          <div class="hard-detail">
            <strong>Why it's hard:</strong> The adoption gap between early adopters and mainstream is massive. Most organizations are still at Wave 3 while the frontier is at Wave 5-6.
          </div>
          <div class="hard-detail">
            <strong>Mitigation:</strong> Meet teams where they are. Build bridges, not walls. Document everything. Make the path obvious.
          </div>
        </div>
      </section>

      <!-- Section 8: WHEN TO APPLY -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Apply / Readiness Criteria
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              YOU'RE READY FOR STAFF-LEVEL THINKING WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You can explain the Six Waves and identify your current wave</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You understand why error amplification is 17.2x for independent vs 4.4x for centralized</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You've experienced context degradation and know how to prevent it</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You can articulate the Iron Law and why it matters</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You understand Yegge's $10-12/hour/agent economics</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You have a mental model for when to break the rules (exploration, prototyping)</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              START WITH BASICS FIRST IF
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>You haven't run a Ralph loop overnight → Start with MASTER-PLAYBOOK.md</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>You don't know what context rot is → Experience it first</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>You haven't used CLAUDE.md → Level 1 of the complexity ladder</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>You haven't hit a cost surprise → You will. Plan for it.</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>You can't explain why fresh context beats extended sessions → Core principle</span>
            </div>
          </div>
        </div>

        <p class="text-text-secondary mb-6">
          <strong>If you checked fewer than 4 readiness criteria:</strong> Focus on MASTER-PLAYBOOK.md first. Build mastery progressively.
        </p>

        <p class="text-text-secondary mb-6">
          <strong>If you checked 4+:</strong> You're ready for frontier work. Follow the new voices, experiment with swarms, but maintain the fundamentals.
        </p>

        <h3 class="subsection-title">Key Themes Across Frontier Practitioners</h3>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content"><strong>Swarm/Hive Architectures</strong> — Moving from single agents to coordinated swarms</div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content"><strong>Infrastructure over Wrappers</strong> — Building orchestration platforms, not prompt templates</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content"><strong>Production at Scale</strong> — Focus on reliability, observability, enterprise deployment</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content"><strong>Hidden Features</strong> — Reverse-engineering and enabling disabled capabilities</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content"><strong>Systems Thinking</strong> — Applying distributed systems concepts to agents</div>
          </div>
        </div>
      </section>

    </main>

    <!-- Resizer between Main Panel and Activity Zone -->
    <div class="resizer" data-resizer="activity-zone" aria-label="Resize activity panel"></div>

    <!-- Activity Zone -->
    <aside class="activity-zone" id="activityZone">
      <div class="text-xs font-semibold text-text-muted uppercase tracking-wider mb-4">Operational Intelligence</div>

      <!-- ESSENCE SECTION -->
      <div class="activity-item inversion" data-section="essence">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you stayed at Wave 3?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Better prompts, longer conversations, more context.<br>
          <strong>Why this fails:</strong> Wave 4+ is 5-25x more productive. Optimizing Wave 3 is running faster in the wrong race.<br>
          <strong>Hidden constraint revealed:</strong> The constraint is wave positioning, not tool mastery.
        </div>
      </div>

      <div class="activity-item minimal" data-section="essence">
        <div class="activity-label" style="color: #84cc16;">
          <i data-lucide="minimize-2" class="w-4 h-4"></i>
          Minimal Pattern
        </div>
        <div class="font-medium text-text-primary mb-2">The irreducible staff engineer mindset</div>
        <div class="text-text-secondary text-sm">
          <strong>Think in waves.</strong> Validate ruthlessly. Trust nothing. Manage agents like distributed systems.<br>
          <strong>Everything else:</strong> Tactics for your current wave.
        </div>
      </div>

      <div class="activity-item warstory" data-section="essence">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Steve Yegge: Four orchestrators in four months</div>
        <div class="text-text-secondary text-sm">
          Built four complete orchestrators (culminating in Gas Town) while others debated which prompting framework to use. The gap is velocity, not capability.
        </div>
      </div>

      <!-- CORE SECTION -->
      <div class="activity-item gradient" data-section="core">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How multi-agent systems fail (invisibly)</div>
        <div class="text-text-secondary text-sm">
          <strong>95% per step:</strong> Feels reliable<br>
          <strong>10 steps (60%):</strong> Starting to notice issues<br>
          <strong>15 steps (46%):</strong> More failures than successes<br>
          <strong>20 steps (36%):</strong> System is broken<br><br>
          <em>Critical: Each step feels fine. The cascade is invisible until catastrophic.</em>
        </div>
      </div>

      <div class="activity-item analogy" data-section="core">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Gas Town = Kubernetes for Agents</div>
        <div class="text-text-secondary text-sm">
          Mayor → Control plane<br>
          Polecats → Pods (persistent workers)<br>
          Crew → Jobs (ephemeral workers)<br>
          Deacon → Health checks<br>
          Dogs → Admission controllers<br><br>
          <em>If you understand Kubernetes, you understand Gas Town.</em>
        </div>
      </div>

      <div class="activity-item constraint" data-section="core">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Why markdown plans fail → Beads</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> LLMs have no persistent memory<br>
          → Markdown is text, not queryable data<br>
          → No dependency tracking<br>
          → "50 First Dates" problem<br>
          → Need structured, git-backed state<br>
          → Beads
        </div>
      </div>

      <div class="activity-item invariant" data-section="core">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">INV-003: External State > Internal Memory</div>
        <div class="text-text-secondary text-sm">
          Ralph, Gas Town, CC Mirror, Beads all share this invariant. The same principle forces the same architectural choice across every successful agent pattern.
        </div>
      </div>

      <!-- DECISIONS SECTION -->
      <div class="activity-item violation" data-section="decisions">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you mix orchestrator and worker roles</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> Orchestrator also executes tasks<br>
          <strong>THEN:</strong> Coordination decisions affected by execution state<br>
          <strong>THEN:</strong> Feedback loops create cascading errors<br>
          <strong>THEN:</strong> Error amplification goes from 4.4x to 17.2x<br>
          <strong>FINALLY:</strong> System becomes unpredictable, fails chaotically<br><br>
          <em>The Iron Law exists because mixing kills systems.</em>
        </div>
      </div>

      <div class="activity-item tradeoff" data-section="decisions">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Framework vs. Raw API</div>
        <div class="text-text-secondary text-sm">
          <strong>Frameworks:</strong> Fast start, but hide failure modes<br>
          <strong>Raw API:</strong> Slower start, but full visibility<br>
          <strong>Wrappers:</strong> Convenient, but add debugging layers<br><br>
          <strong>Why no perfect answer:</strong> Demo speed vs. production debuggability<br>
          <em>Heuristic: Start raw. Add abstractions only when you understand the failure modes they hide.</em>
        </div>
      </div>

      <div class="activity-item horizon" data-section="decisions">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How wave thinking evolves</div>
        <div class="text-text-secondary text-sm">
          <strong>Week 1:</strong> "Wave framework seems academic"<br>
          <strong>Month 1:</strong> "I'm definitely Wave 3, maybe Wave 4"<br>
          <strong>Month 3:</strong> "Wave positioning is the only metric that matters"<br>
          <strong>Month 6:</strong> "I'm building Wave 5 while others debate Wave 3 tools"<br><br>
          <em>Don't judge wave thinking by week 1.</em>
        </div>
      </div>

      <!-- PRINCIPLES SECTION -->
      <div class="activity-item expertise" data-section="principles">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Trust Gradient Understanding</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "What should I trust?" → Nothing without verification<br>
          <strong>Intermediate:</strong> "Why verify reads?" → Even reads can hallucinate<br>
          <strong>Advanced:</strong> "What's verifiable?" → Anything with external ground truth<br>
          <strong>Staff:</strong> "How to scale verification?" → Automated gates, not manual review<br>
          <strong>Expert:</strong> "When break trust rules?" → Prototyping only, never production
        </div>
      </div>

      <div class="activity-item inversion" data-section="principles">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if agents were perfectly reliable?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> No verification, no sandboxing, full trust<br>
          <strong>Why this fails:</strong> 3-15% tool calling failure rate is physics, not a bug<br>
          <strong>Hidden constraint revealed:</strong> All 8 principles exist BECAUSE agents are unreliable
        </div>
      </div>

      <div class="activity-item effect" data-section="principles">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="bar-chart-2" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">At 5+ agents, economics dominate</div>
        <div class="text-text-secondary text-sm">
          <strong>At 1 agent:</strong> Cost is noise<br>
          <strong>At 5 agents:</strong> $50/hour, you notice<br>
          <strong>At 20 agents:</strong> $200+/hour, it's your main budget line<br><br>
          <em>Threshold: ~5 agents where economics become strategic</em>
        </div>
      </div>

      <div class="activity-item composition" data-section="principles">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Iron Law + Trust Gradient</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Orchestrators handle low-trust coordination, workers handle verified execution.<br>
          <strong>Synergy:</strong> Separation makes trust boundaries clear.<br>
          <strong>Pattern:</strong> High-trust orchestrator → low-trust workers → verified output
        </div>
      </div>

      <!-- PATH SECTION -->
      <div class="activity-item frontier" data-section="path">
        <div class="activity-label" style="color: #ef4444;">
          <i data-lucide="flask-conical" class="w-4 h-4"></i>
          Research Frontier
        </div>
        <div class="font-medium text-text-primary mb-2">UNSOLVED: Agent Kubernetes</div>
        <div class="text-text-secondary text-sm">
          <strong>The question:</strong> How do you manage 50+ agents with the reliability of Kubernetes?<br>
          <strong>Why hard:</strong> Agents are non-deterministic. Pods are deterministic. Different failure modes.<br>
          <strong>Current best:</strong> Gas Town is closest. Still experimental.
        </div>
      </div>

      <div class="activity-item analogy" data-section="path">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Frontier Questions = Distributed Systems Problems</div>
        <div class="text-text-secondary text-sm">
          Agent memory → State management<br>
          Runaway costs → Resource quotas<br>
          Coordination failures → Consensus algorithms<br>
          Automation vs. interactive → CAP theorem tradeoffs<br><br>
          <em>If you've solved distributed systems problems, you can solve frontier agent problems.</em>
        </div>
      </div>

      <div class="activity-item warstory" data-section="path">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Reuven Cohen: Claude-Flow for enterprises</div>
        <div class="text-text-secondary text-sm">
          Built enterprise-grade swarm infrastructure. "For swarm memory, you don't need complex vector similarity searches. What you really need is a common simple SQLite storage environment." Simple beats complex.
        </div>
      </div>

      <!-- GOTCHAS SECTION -->
      <div class="activity-item inflection" data-section="gotchas">
        <div class="activity-label" style="color: #eab308;">
          <i data-lucide="activity" class="w-4 h-4"></i>
          Inflection Point
        </div>
        <div class="font-medium text-text-primary mb-2">When agent count flips from asset to liability</div>
        <div class="text-text-secondary text-sm">
          <strong>1-3 agents:</strong> Each adds velocity<br>
          <strong>4-10 agents:</strong> Coordination overhead appears<br>
          <strong>11-20 agents:</strong> Monitoring becomes critical<br>
          <strong>20+ agents:</strong> Without orchestration, chaos<br><br>
          <strong>THE INFLECTION:</strong> ~10 agents<br>
          <em>Detection: Spending more time debugging coordination than getting work done?</em>
        </div>
      </div>

      <div class="activity-item violation" data-section="gotchas">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip cost monitoring</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> No cost caps or monitoring<br>
          <strong>THEN:</strong> Recursive loop goes undetected<br>
          <strong>THEN:</strong> Runs for days<br>
          <strong>THEN:</strong> $47,000 bill arrives<br>
          <strong>FINALLY:</strong> Project cancelled, career impact<br><br>
          <em>The fix: Hard caps, circuit breakers, daily monitoring. Non-negotiable.</em>
        </div>
      </div>

      <div class="activity-item gradient" data-section="gotchas">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How team adoption fails</div>
        <div class="text-text-secondary text-sm">
          <strong>Day 1:</strong> Excitement about new tools<br>
          <strong>Week 1:</strong> Confusion about shared standards<br>
          <strong>Month 1:</strong> Everyone doing it differently<br>
          <strong>Quarter 1:</strong> "This doesn't work" abandonment<br><br>
          <em>Critical: The gradient is adoption friction. Fix at Day 1 with shared CLAUDE.md.</em>
        </div>
      </div>

      <div class="activity-item constraint" data-section="gotchas">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Why production reliability is hard</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Tool calling has 3-15% failure rate<br>
          → Multi-step workflows compound failures<br>
          → 20 steps at 95% = 36% success<br>
          → Production needs 99.9%+<br>
          → Must decompose into smaller verified units<br>
          → Architecture is the only solution
        </div>
      </div>

      <!-- HARD SECTION -->
      <div class="activity-item tradeoff" data-section="hard">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">The Accountability Paradox</div>
        <div class="text-text-secondary text-sm">
          <strong>Old model:</strong> You write code, you own it<br>
          <strong>New model:</strong> Agent writes code, you still own it<br>
          <strong>The tension:</strong> How do you own what you didn't write?<br><br>
          <strong>No perfect answer:</strong> You must understand code you didn't write deeply enough to be accountable for it.<br>
          <em>Heuristic: If you can't explain why the agent wrote it that way, you don't own it yet.</em>
        </div>
      </div>

      <div class="activity-item horizon" data-section="hard">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How trust evolves</div>
        <div class="text-text-secondary text-sm">
          <strong>Week 1:</strong> "I need to verify everything, this is slow"<br>
          <strong>Month 1:</strong> "I know which types of tasks to trust"<br>
          <strong>Month 3:</strong> "My verification is targeted, not universal"<br>
          <strong>Month 6:</strong> "Trust boundaries are my architecture"<br><br>
          <em>Don't judge the trust problem by week 1.</em>
        </div>
      </div>

      <div class="activity-item expertise" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Paradigm Shift Understanding</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "How do I use agents?" → Start with Ralph loops<br>
          <strong>Intermediate:</strong> "How do I scale?" → Add verification, monitoring<br>
          <strong>Advanced:</strong> "How do I architect?" → Orchestrator/worker separation<br>
          <strong>Staff:</strong> "How do I transform my team?" → Meet them where they are<br>
          <strong>Expert:</strong> "What's next?" → Build Wave 5-6 infrastructure
        </div>
      </div>

      <div class="activity-item warstory" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Boris Cherny: Low-level and unopinionated</div>
        <div class="text-text-secondary text-sm">
          "Claude Code is intentionally low-level and unopinionated, providing close to raw model access without forcing specific workflows." The creator's philosophy: primitives, not prescriptions.
        </div>
      </div>

      <!-- WHEN SECTION -->
      <div class="activity-item inversion" data-section="when">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you jumped to Wave 5 without Wave 4 mastery?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd build:</strong> Complex multi-agent systems<br>
          <strong>Why this fails:</strong> Can't debug coordination issues without single-agent intuition<br>
          <strong>Hidden constraint revealed:</strong> Wave progression is sequential, not skippable
        </div>
      </div>

      <div class="activity-item alternative" data-section="when">
        <div class="activity-label" style="color: #6b7280;">
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
          Alternative Paths
        </div>
        <div class="font-medium text-text-primary mb-2">If staff-level thinking isn't right for you yet</div>
        <div class="text-text-secondary text-sm">
          <strong>Need basics?</strong> → MASTER-PLAYBOOK.md (complexity ladder)<br>
          <strong>Need Ralph mastery?</strong> → mastery-ralph-complete.md<br>
          <strong>Need implementation patterns?</strong> → architecture-complexity-ladder.md<br>
          <strong>Need decision framework?</strong> → JUDGMENT-GUIDE.md
        </div>
      </div>

      <div class="activity-item invariant" data-section="when">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">INV-005: Parallelization Over Single-Agent Optimization</div>
        <div class="text-text-secondary text-sm">
          Staff engineers optimize for parallelization. Beginners optimize single agents. The invariant explains why Wave 5 (clusters) beats Wave 4 (single agents) at scale.
        </div>
      </div>

      <div class="activity-item composition" data-section="when">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Staff Mindset + Ralph Pattern</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Ralph is the implementation. Staff mindset is the architecture.<br>
          <strong>Synergy:</strong> Ralph loops are Wave 4. Staff thinking positions you for Wave 5.<br>
          <strong>Pattern:</strong> Master Ralph → Apply staff principles → Build swarm infrastructure
        </div>
      </div>

    </aside>
  </div>

  <script>
    /**
     * PanelResizer - Handles draggable panel dividers
     *
     * Designed for extraction to standalone module.
     * Auto-initializes on elements with [data-resizer] attribute.
     */
    class PanelResizer {
      constructor(resizerEl, config = {}) {
        this.resizer = resizerEl;
        this.config = {
          storageKey: 'panel-activity-zone-width',
          minWidth: 280,
          maxWidth: 900,  // Allow generous expansion
          defaultWidth: 480,
          ...config
        };

        this.isResizing = false;
        this.startX = 0;
        this.startWidth = 0;

        // Elements
        this.activityZone = document.querySelector('.activity-zone');
        this.mainContent = document.querySelector('.main-content');

        // Bind methods
        this.onMouseDown = this.onMouseDown.bind(this);
        this.onMouseMove = this.onMouseMove.bind(this);
        this.onMouseUp = this.onMouseUp.bind(this);

        this.init();
      }

      init() {
        // Restore saved width
        this.restoreWidth();

        // Attach mousedown listener
        this.resizer.addEventListener('mousedown', this.onMouseDown);
      }

      onMouseDown(e) {
        if (e.button !== 0) return; // Left click only

        this.isResizing = true;
        this.startX = e.clientX;
        this.startWidth = this.activityZone.offsetWidth;

        // Visual feedback
        this.resizer.classList.add('active');
        document.body.classList.add('resizing');

        // Listen on document for full-range movement
        document.addEventListener('mousemove', this.onMouseMove);
        document.addEventListener('mouseup', this.onMouseUp);

        e.preventDefault();
      }

      onMouseMove(e) {
        if (!this.isResizing) return;

        // Calculate new width (dragging left = larger activity zone)
        const delta = this.startX - e.clientX;
        const newWidth = this.startWidth + delta;

        // Apply constraints
        const constrainedWidth = Math.max(
          this.config.minWidth,
          Math.min(this.config.maxWidth, newWidth)
        );

        // Update styles
        this.activityZone.style.width = constrainedWidth + 'px';
        this.mainContent.style.marginRight = constrainedWidth + 'px';
        this.resizer.style.right = constrainedWidth + 'px';
      }

      onMouseUp(e) {
        if (!this.isResizing) return;

        this.isResizing = false;

        // Remove visual feedback
        this.resizer.classList.remove('active');
        document.body.classList.remove('resizing');

        // Clean up listeners
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);

        // Persist width
        this.saveWidth();
      }

      saveWidth() {
        const width = this.activityZone.offsetWidth;
        localStorage.setItem(this.config.storageKey, JSON.stringify({
          width,
          timestamp: Date.now()
        }));
      }

      restoreWidth() {
        try {
          const stored = localStorage.getItem(this.config.storageKey);
          if (stored) {
            const { width } = JSON.parse(stored);
            if (width >= this.config.minWidth && width <= this.config.maxWidth) {
              this.activityZone.style.width = width + 'px';
              this.mainContent.style.marginRight = width + 'px';
              this.resizer.style.right = width + 'px';
            }
          }
        } catch (e) {
          console.warn('Failed to restore panel width:', e);
        }
      }

      destroy() {
        this.resizer.removeEventListener('mousedown', this.onMouseDown);
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);
      }
    }

    // Auto-initialize resizers on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      const resizers = document.querySelectorAll('[data-resizer]');
      resizers.forEach(resizer => new PanelResizer(resizer));
    });

    // Initialize Lucide icons
    lucide.createIcons();

    // Navigation toggle
    function toggleSection(header) {
      const section = header.closest('.nav-section');
      section.classList.toggle('expanded');
      const children = section.querySelector('.nav-children');
      children.classList.toggle('expanded');
    }

    // Mobile menu toggle
    function toggleMobileMenu() {
      const nav = document.getElementById('leftNav');
      nav.classList.toggle('open');
    }

    // Copy functionality
    function copyCode(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> Copied!';
        lucide.createIcons();
        setTimeout(() => {
          btn.innerHTML = originalText;
          lucide.createIcons();
        }, 2000);
      });
    }

    function copyCodeBlock(btn) {
      const codeBlock = btn.closest('.code-block');
      const pre = codeBlock.querySelector('pre');
      const text = pre.textContent;
      copyCode(btn, text);
    }

    // Scroll-sync with GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    // Track which sections are in view
    const sections = document.querySelectorAll('[data-activity]');
    const activityItems = document.querySelectorAll('.activity-item');

    sections.forEach(section => {
      ScrollTrigger.create({
        trigger: section,
        start: 'top 40%',
        end: 'bottom 40%',
        onEnter: () => activateSection(section.dataset.activity),
        onEnterBack: () => activateSection(section.dataset.activity),
      });
    });

    function activateSection(sectionName) {
      activityItems.forEach(item => {
        if (item.dataset.section === sectionName) {
          item.classList.add('active');
          gsap.to(item, {
            opacity: 1,
            y: -2,
            boxShadow: '0 4px 12px rgba(0,0,0,0.08)',
            duration: 0.3,
            ease: 'power2.out'
          });
        } else {
          item.classList.remove('active');
          gsap.to(item, {
            opacity: 0.5,
            y: 0,
            boxShadow: 'none',
            duration: 0.3,
            ease: 'power2.out'
          });
        }
      });

      // Update nav active state
      document.querySelectorAll('.nav-section-header').forEach(header => {
        header.classList.remove('active');
      });
      const activeNav = document.querySelector(`[data-section="${sectionName}"] .nav-section-header`);
      if (activeNav) {
        activeNav.classList.add('active');
      }
    }

    // Initialize first section as active
    activateSection('essence');

    // Smooth scroll for nav links
    document.querySelectorAll('.nav-item').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const target = document.querySelector(link.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('active'));
          link.classList.add('active');
        }
      });
    });

    // Brushing interaction - hover activity item highlights related content
    activityItems.forEach(item => {
      item.addEventListener('mouseenter', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = 'rgba(13, 147, 115, 0.05)';
          relatedSection.style.transition = 'background-color 0.3s ease';
        }
      });

      item.addEventListener('mouseleave', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = '';
        }
      });
    });
  </script>
</body>
</html>
