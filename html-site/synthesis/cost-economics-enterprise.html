<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cost Economics Enterprise | Claude Code Documentation</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- GSAP for scroll-sync -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <!-- Tailwind Config with Design Tokens -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'bg-base': '#ffffff',
            'bg-subtle': '#fafafa',
            'bg-muted': '#f4f4f5',
            'text-primary': '#18181b',
            'text-secondary': '#3f3f46',
            'text-muted': '#71717a',
            'accent': '#0D9373',
            'accent-light': '#10b981',
            'accent-bg': '#ecfdf5',
            'border': '#e4e4e7',
            // Activity Zone content type colors (Original 6)
            'az-invariant': '#3b82f6',    // Blue
            'az-effect': '#f59e0b',       // Amber
            'az-composition': '#8b5cf6',  // Purple
            'az-frontier': '#ef4444',     // Red
            'az-warstory': '#10b981',     // Green
            'az-alternative': '#6b7280',  // Gray
            // Activity Zone generative content types (New 10)
            'az-inversion': '#4f46e5',    // Indigo
            'az-constraint': '#8b5cf6',   // Violet
            'az-gradient': '#f43f5e',     // Rose
            'az-horizon': '#06b6d4',      // Cyan
            'az-violation': '#f97316',    // Orange
            'az-tradeoff': '#f59e0b',     // Amber
            'az-analogy': '#d946ef',      // Fuchsia
            'az-expertise': '#10b981',    // Emerald
            'az-minimal': '#84cc16',      // Lime
            'az-inflection': '#eab308',   // Yellow
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Fira Code', 'monospace'],
          },
        },
      },
    }
  </script>

  <style>
    /* Base Styles */
    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
    }

    [id] {
      scroll-margin-top: 80px;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: #ffffff;
      color: #18181b;
      line-height: 1.7;
    }

    /* Three Panel Layout */
    .three-panel-layout {
      min-height: 100vh;
      position: relative;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: #ffffff;
      border-bottom: 1px solid #e4e4e7;
      z-index: 100;
      display: flex;
      align-items: center;
      padding: 0 24px;
    }

    /* Left Navigation - 240px fixed */
    .left-nav {
      position: fixed;
      top: 56px;
      left: 0;
      width: 240px;
      height: calc(100vh - 56px);
      border-right: 1px solid #e4e4e7;
      background: #ffffff;
      overflow-y: auto;
      padding: 16px 0;
      z-index: 40;
    }

    .nav-section {
      padding: 0 12px;
      margin-bottom: 8px;
    }

    .nav-section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      font-size: 14px;
      font-weight: 500;
      color: #3f3f46;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
    }

    .nav-section-header:hover {
      background: #f4f4f5;
    }

    .nav-section-header.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-item {
      display: block;
      padding: 6px 12px 6px 44px;
      font-size: 14px;
      color: #71717a;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.15s;
    }

    .nav-item:hover {
      color: #3f3f46;
      background: #f4f4f5;
    }

    .nav-item.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-children {
      display: none;
      overflow: hidden;
    }

    .nav-children.expanded {
      display: block;
    }

    .nav-chevron {
      transition: transform 0.2s;
    }

    .nav-section.expanded .nav-chevron {
      transform: rotate(90deg);
    }

    /* Main Content - Flexible, margins for fixed sidebars */
    .main-content {
      margin-left: 240px;
      margin-right: 480px;
      margin-top: 56px;
      padding: 48px 48px;
      min-width: 400px;
    }

    /* Activity Zone - 480px fixed */
    .activity-zone {
      position: fixed;
      top: 56px;
      right: 0;
      width: 480px;
      height: calc(100vh - 56px);
      border-left: 1px dashed #e4e4e7;
      background: #fafafa;
      overflow-y: auto;
      padding: 24px 20px;
      z-index: 40;
    }

    /* Responsive: Hide Activity Zone below 1400px */
    @media (max-width: 1400px) {
      .activity-zone {
        display: none;
      }
      .main-content {
        margin-right: 0;
        padding: 40px 32px;
      }
    }

    /* Responsive: Hide Left Nav below 768px */
    @media (max-width: 768px) {
      .left-nav {
        display: none;
      }
      .left-nav.open {
        display: block;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        z-index: 50;
        overflow-y: auto;
      }
      .main-content {
        margin-left: 0;
        padding: 24px 16px;
        min-width: auto;
      }
    }

    /* Resizer */
    .resizer {
      position: fixed;
      top: 56px;
      right: 480px;
      width: 6px;
      height: calc(100vh - 56px);
      cursor: col-resize;
      background: transparent;
      z-index: 50;
      transition: background 0.15s ease;
    }

    .resizer:hover {
      background: rgba(13, 147, 115, 0.15);
    }

    .resizer.active {
      background: rgba(13, 147, 115, 0.25);
    }

    body.resizing {
      user-select: none;
      cursor: col-resize !important;
    }

    body.resizing * {
      cursor: col-resize !important;
    }

    @media (max-width: 1400px) {
      .resizer {
        display: none;
      }
    }

    /* Activity Zone Items */
    .activity-item {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      background: #ffffff;
      border: 1px solid #e4e4e7;
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.5;
      transition: all 0.3s ease;
    }

    .activity-item.active {
      opacity: 1;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .activity-item:hover {
      opacity: 1;
    }

    .activity-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Activity Zone content type borders */
    .activity-item.invariant { border-left: 4px solid #3b82f6; }
    .activity-item.effect { border-left: 4px solid #f59e0b; }
    .activity-item.composition { border-left: 4px solid #8b5cf6; }
    .activity-item.frontier { border-left: 4px solid #ef4444; }
    .activity-item.warstory { border-left: 4px solid #10b981; }
    .activity-item.alternative { border-left: 4px solid #6b7280; }
    .activity-item.inversion { border-left: 4px solid #4f46e5; }
    .activity-item.constraint { border-left: 4px solid #8b5cf6; }
    .activity-item.gradient { border-left: 4px solid #f43f5e; }
    .activity-item.horizon { border-left: 4px solid #06b6d4; }
    .activity-item.violation { border-left: 4px solid #f97316; }
    .activity-item.tradeoff { border-left: 4px solid #f59e0b; }
    .activity-item.analogy { border-left: 4px solid #d946ef; }
    .activity-item.expertise { border-left: 4px solid #10b981; }
    .activity-item.minimal { border-left: 4px solid #84cc16; }
    .activity-item.inflection { border-left: 4px solid #eab308; }

    /* Main Content Components */
    .section-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background: #0D9373;
      color: #ffffff;
      font-size: 14px;
      font-weight: 600;
      border-radius: 50%;
      margin-right: 12px;
    }

    .section-title {
      font-size: 24px;
      font-weight: 600;
      color: #18181b;
      margin-bottom: 20px;
      margin-top: 56px;
      display: flex;
      align-items: center;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    /* Essence Box */
    .essence-box {
      background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 40px;
    }

    .essence-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #10b981;
      margin-bottom: 12px;
    }

    .essence-text {
      font-size: 22px;
      font-weight: 500;
      color: #ffffff;
      line-height: 1.4;
    }

    /* Core Abstraction Box */
    .core-abstraction {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .core-philosophy {
      font-size: 16px;
      color: #3f3f46;
      margin-bottom: 16px;
      font-style: italic;
    }

    .core-code {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 16px;
      overflow-x: auto;
    }

    .core-code code {
      font-family: 'Fira Code', monospace;
      font-size: 15px;
      color: #10b981;
      white-space: nowrap;
    }

    .core-anchor {
      font-size: 14px;
      color: #71717a;
      text-align: center;
    }

    /* Decision Box */
    .decision-box {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .decision-why {
      font-size: 16px;
      font-weight: 600;
      color: #0D9373;
      margin-bottom: 12px;
    }

    .decision-reasoning {
      font-size: 14px;
      color: #3f3f46;
      margin-bottom: 16px;
    }

    .decision-implication {
      background: #f4f4f5;
      border-radius: 8px;
      padding: 16px;
    }

    .decision-implication-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: #71717a;
      margin-bottom: 8px;
    }

    /* Code Blocks */
    .code-block {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 24px;
      position: relative;
      overflow-x: auto;
    }

    .code-block pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #e4e4e7;
      line-height: 1.6;
    }

    .code-block .comment { color: #6b7280; }
    .code-block .keyword { color: #c084fc; }
    .code-block .string { color: #10b981; }
    .code-block .variable { color: #60a5fa; }
    .code-block .number { color: #f59e0b; }

    .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #3f3f46;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s;
    }

    .copy-btn:hover {
      background: #52525b;
    }

    /* Tables */
    .pricing-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
      font-size: 14px;
    }

    .pricing-table th {
      background: #f4f4f5;
      padding: 12px 16px;
      text-align: left;
      font-weight: 600;
      color: #3f3f46;
      border-bottom: 2px solid #e4e4e7;
    }

    .pricing-table td {
      padding: 12px 16px;
      border-bottom: 1px solid #e4e4e7;
      color: #3f3f46;
    }

    .pricing-table tr:hover td {
      background: #fafafa;
    }

    .pricing-table code {
      background: #e4e4e7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
    }

    /* Path Steps */
    .path-container {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .path-step {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }

    .path-step:last-child {
      margin-bottom: 0;
    }

    .path-number {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      background: #0D9373;
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .path-content {
      flex: 1;
      font-size: 14px;
      color: #3f3f46;
    }

    .path-content code {
      background: #e4e4e7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
    }

    /* Gotcha Box */
    .gotcha-box {
      background: #fffbeb;
      border: 1px solid #fcd34d;
      border-left: 4px solid #f59e0b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .gotcha-title {
      font-weight: 600;
      color: #92400e;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .gotcha-detail {
      font-size: 14px;
      color: #78350f;
      margin-bottom: 8px;
    }

    .gotcha-detail strong {
      color: #92400e;
    }

    /* Hard Box */
    .hard-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-left: 4px solid #ef4444;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .hard-title {
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hard-detail {
      font-size: 14px;
      color: #7f1d1d;
      margin-bottom: 8px;
    }

    /* When Grid */
    .when-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 40px;
    }

    @media (max-width: 900px) {
      .when-grid {
        grid-template-columns: 1fr;
      }
    }

    .when-use {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 24px;
    }

    .when-not {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 24px;
    }

    .when-title {
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .when-use .when-title { color: #166534; }
    .when-not .when-title { color: #991b1b; }

    .when-item {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 14px;
    }

    .when-use .when-item { color: #166534; }
    .when-not .when-item { color: #991b1b; }

    /* Info Box */
    .info-box {
      background: #ecfdf5;
      border: 1px solid #a7f3d0;
      border-left: 4px solid #10b981;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 24px;
    }

    .info-box-title {
      font-weight: 600;
      color: #065f46;
      margin-bottom: 8px;
    }

    .info-box-text {
      font-size: 14px;
      color: #047857;
    }

    /* Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      padding: 8px;
      background: none;
      border: none;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .mobile-menu-btn {
        display: flex;
      }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #fafafa;
    }

    ::-webkit-scrollbar-thumb {
      background: #d4d4d8;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1aa;
    }

    /* Keyboard shortcut hint */
    .kbd {
      display: inline-flex;
      align-items: center;
      padding: 2px 6px;
      background: #f4f4f5;
      border: 1px solid #e4e4e7;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: #71717a;
    }

    /* Budget Card */
    .budget-card {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .budget-card-header {
      font-weight: 600;
      color: #18181b;
      margin-bottom: 12px;
      font-size: 16px;
    }

    .budget-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #f4f4f5;
      font-size: 14px;
    }

    .budget-item:last-child {
      border-bottom: none;
    }

    .budget-label {
      color: #71717a;
    }

    .budget-value {
      color: #18181b;
      font-weight: 500;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
      <i data-lucide="menu" class="w-5 h-5 text-text-secondary"></i>
    </button>
    <div class="flex items-center gap-3">
      <i data-lucide="terminal" class="w-5 h-5 text-accent"></i>
      <span class="font-semibold text-text-primary">Claude Code</span>
    </div>
    <div class="flex-1 flex justify-center">
      <button class="flex items-center gap-2 px-4 py-2 bg-bg-muted rounded-lg text-text-muted text-sm hover:bg-border transition-colors">
        <i data-lucide="search" class="w-4 h-4"></i>
        <span>Search documentation...</span>
        <span class="kbd">Cmd+K</span>
      </button>
    </div>
    <div class="flex items-center gap-4">
      <a href="#" class="text-sm text-text-muted hover:text-text-primary transition-colors">Support</a>
      <button class="p-2 hover:bg-bg-muted rounded-lg transition-colors" aria-label="Toggle theme">
        <i data-lucide="sun" class="w-4 h-4 text-text-muted"></i>
      </button>
    </div>
  </header>

  <div class="three-panel-layout">
    <!-- Left Navigation -->
    <nav class="left-nav" id="leftNav">
      <div class="px-4 mb-4">
        <span class="text-xs font-semibold text-text-muted uppercase tracking-wider">Cost Economics</span>
      </div>

      <!-- Essence -->
      <div class="nav-section expanded" data-section="essence">
        <div class="nav-section-header active" onclick="toggleSection(this)">
          <i data-lucide="zap" class="w-4 h-4"></i>
          <span>Essence</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#essence" class="nav-item active">The 15-Word Summary</a>
        </div>
      </div>

      <!-- Core Abstraction -->
      <div class="nav-section expanded" data-section="core">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="box" class="w-4 h-4"></i>
          <span>Core Abstraction</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#core-abstraction" class="nav-item">Token Economics Model</a>
        </div>
      </div>

      <!-- Design Decisions -->
      <div class="nav-section expanded" data-section="decisions">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="lightbulb" class="w-4 h-4"></i>
          <span>Design Decisions</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#why-tiered-models" class="nav-item">Why Tiered Models?</a>
          <a href="#why-prompt-caching" class="nav-item">Why Prompt Caching?</a>
          <a href="#why-fresh-context" class="nav-item">Why Fresh Context?</a>
        </div>
      </div>

      <!-- Pricing Structure -->
      <div class="nav-section" data-section="pricing">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="dollar-sign" class="w-4 h-4"></i>
          <span>Pricing Structure</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#pricing" class="nav-item">Model Pricing</a>
          <a href="#pattern-costs" class="nav-item">Pattern Costs</a>
          <a href="#enterprise-scale" class="nav-item">Enterprise Scale</a>
        </div>
      </div>

      <!-- Optimization Path -->
      <div class="nav-section" data-section="path">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="git-branch" class="w-4 h-4"></i>
          <span>Optimization Path</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#path" class="nav-item">The Flow</a>
        </div>
      </div>

      <!-- Gotchas -->
      <div class="nav-section" data-section="gotchas">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="alert-triangle" class="w-4 h-4"></i>
          <span>Gotchas</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#gotchas" class="nav-item">Cost Pitfalls</a>
        </div>
      </div>

      <!-- What's Hard -->
      <div class="nav-section" data-section="hard">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="flame" class="w-4 h-4"></i>
          <span>What's Hard</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#hard" class="nav-item">Real Tensions</a>
        </div>
      </div>

      <!-- When to Optimize -->
      <div class="nav-section" data-section="when">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="check-circle" class="w-4 h-4"></i>
          <span>When to Optimize</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#when" class="nav-item">Decision Criteria</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Match model tier to task complexity, cache aggressively, and fresh context beats extended sessions.</div>
        </div>
      </section>

      <!-- Section 2: CORE ABSTRACTION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Abstraction
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"Haiku for setup, Sonnet for builds, Opus for reviews. Every model tier has its job."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'Haiku: $1/MTok | Sonnet: $3/MTok | Opus: $5/MTok')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>Haiku: $1/MTok | Sonnet: $3/MTok | Opus: $5/MTok (input)</code>
          </div>

          <div class="core-anchor">Model selection is your biggest cost lever. 60-95% savings from this one decision.</div>
        </div>

        <p class="text-text-secondary mb-6">
          Token economics is simple math with compound effects. The wrong model choice on a 50-iteration Ralph loop doesn't just cost 5x more per iteration - it costs 5x more across ALL 50 iterations. A single architectural decision about model selection can mean $50 vs $750 for the same work.
        </p>

        <p class="text-text-secondary mb-6">
          The core insight: <strong>Opus output is 5x Sonnet, which is 3x Haiku.</strong> For a 1000-token response: Haiku costs $0.005, Sonnet costs $0.015, Opus costs $0.025. Scale this to enterprise (100 agents, 8 hours/day) and the gap becomes $2,400/month vs $24,000/month.
        </p>

        <div class="info-box">
          <div class="info-box-title">The 67% Price Drop</div>
          <div class="info-box-text">Opus 4.5 represents a 67% price reduction from Opus 4.1 ($5/$25 vs $15/$75 per MTok). The flagship model is now economically viable for production workflows that previously defaulted to Sonnet.</div>
        </div>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-tiered-models" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Design Decisions
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY TIERED MODELS?</div>
          <div class="decision-reasoning">
            Different tasks have fundamentally different reasoning requirements. Simple file lookups don't need Opus-level intelligence. Complex architectural decisions don't benefit from Haiku's speed if the answer is wrong. Matching model to task is the single highest-leverage cost optimization.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Default to Sonnet. Only upgrade to Opus when reasoning complexity requires it (architecture, ambiguous requirements, security-critical). Drop to Haiku for simple tasks (file lookups, status checks, test runs). This alone saves 60-80%.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-prompt-caching">
          <div class="decision-why">WHY PROMPT CACHING?</div>
          <div class="decision-reasoning">
            Large system prompts (CLAUDE.md, instructions, context) get sent with EVERY request. A 10K token system prompt at $3/MTok costs $0.03 per call. With 100 calls/day, that's $3/day just for the system prompt. Caching drops this to $0.003/day - 90% savings on repeated content.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Structure prompts with static content first. Use 5-min cache for interactive sessions (1.25x write, 0.1x read). Use 1-hour cache for batch operations (2x write, 0.1x read). Target 30:1+ cache read:write ratio. At enterprise scale, caching alone can save $10K+/month.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-fresh-context">
          <div class="decision-why">WHY FRESH CONTEXT FOR COST?</div>
          <div class="decision-reasoning">
            Extended sessions accumulate context. At iteration 10, you're paying for 10 iterations worth of accumulated tokens every call. Fresh context (Ralph pattern) resets this: iteration 10 costs the same as iteration 1. Plus, context rot at 80K+ means you're paying MORE for WORSE output.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Use Ralph loops for autonomous work. Each iteration starts fresh, pays only for current context. External state (prd.json, progress.txt) persists learnings without context bloat. Expect 50-60% cost savings vs extended sessions for equivalent work.
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: PRICING STRUCTURE -->
      <section id="pricing" data-activity="pricing">
        <h2 class="section-title">
          <span class="section-number">4</span>
          Pricing Structure
        </h2>

        <h3 class="font-semibold text-lg mb-4">Model Pricing (January 2026)</h3>

        <table class="pricing-table">
          <thead>
            <tr>
              <th>Model</th>
              <th>Input (per 1M)</th>
              <th>Output (per 1M)</th>
              <th>Context</th>
              <th>Cost Multiplier</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Claude Haiku 4.5</strong></td>
              <td>$1.00</td>
              <td>$5.00</td>
              <td>200K</td>
              <td>1x (baseline)</td>
            </tr>
            <tr>
              <td><strong>Claude Haiku 3.5</strong></td>
              <td>$0.80</td>
              <td>$4.00</td>
              <td>200K</td>
              <td>0.8x</td>
            </tr>
            <tr>
              <td><strong>Claude Haiku 3</strong></td>
              <td>$0.25</td>
              <td>$1.25</td>
              <td>200K</td>
              <td>0.25x</td>
            </tr>
            <tr>
              <td><strong>Claude Sonnet 4.5</strong></td>
              <td>$3.00</td>
              <td>$15.00</td>
              <td>200K (1M beta)</td>
              <td>3x</td>
            </tr>
            <tr>
              <td><strong>Claude Opus 4.5</strong></td>
              <td>$5.00</td>
              <td>$25.00</td>
              <td>200K</td>
              <td>5x</td>
            </tr>
          </tbody>
        </table>

        <h3 class="font-semibold text-lg mb-4 mt-8">Prompt Caching Pricing</h3>

        <table class="pricing-table">
          <thead>
            <tr>
              <th>Cache Operation</th>
              <th>Multiplier</th>
              <th>Opus 4.5</th>
              <th>Sonnet 4.5</th>
              <th>Haiku 4.5</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Base Input</td>
              <td>1.0x</td>
              <td>$5.00/MTok</td>
              <td>$3.00/MTok</td>
              <td>$1.00/MTok</td>
            </tr>
            <tr>
              <td>5-min Cache Write</td>
              <td>1.25x</td>
              <td>$6.25/MTok</td>
              <td>$3.75/MTok</td>
              <td>$1.25/MTok</td>
            </tr>
            <tr>
              <td>1-hour Cache Write</td>
              <td>2.0x</td>
              <td>$10.00/MTok</td>
              <td>$6.00/MTok</td>
              <td>$2.00/MTok</td>
            </tr>
            <tr>
              <td><strong>Cache Read/Refresh</strong></td>
              <td><strong>0.1x</strong></td>
              <td>$0.50/MTok</td>
              <td>$0.30/MTok</td>
              <td>$0.10/MTok</td>
            </tr>
          </tbody>
        </table>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="pattern-costs">Pattern Cost Analysis</h3>

        <table class="pricing-table">
          <thead>
            <tr>
              <th>Pattern</th>
              <th>Per Session</th>
              <th>Daily Estimate</th>
              <th>Monthly Estimate</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Single Sessions</strong></td>
              <td>$0.50-$5</td>
              <td>$3-$15</td>
              <td>$60-$300</td>
            </tr>
            <tr>
              <td><strong>Ralph Loop (10 iter)</strong></td>
              <td>$5-$20</td>
              <td>$5-$20</td>
              <td>$100-$400</td>
            </tr>
            <tr>
              <td><strong>Ralph Loop (50 iter)</strong></td>
              <td>$25-$100</td>
              <td>$25-$100</td>
              <td>$500-$2,000</td>
            </tr>
            <tr>
              <td><strong>CC Mirror (5 agents)</strong></td>
              <td>$10-$30</td>
              <td>$50-$150</td>
              <td>$1,000-$3,000</td>
            </tr>
            <tr>
              <td><strong>Gas Town (minimal)</strong></td>
              <td>$30-$100</td>
              <td>$50-$150</td>
              <td>$1,500-$4,500</td>
            </tr>
            <tr>
              <td><strong>Gas Town (full)</strong></td>
              <td>$100-$300</td>
              <td>$150-$300</td>
              <td>$4,500-$9,000</td>
            </tr>
          </tbody>
        </table>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="enterprise-scale">Enterprise Scale (10-100 Agents)</h3>

        <table class="pricing-table">
          <thead>
            <tr>
              <th>Scale</th>
              <th>Agents</th>
              <th>Model Mix</th>
              <th>Daily Cost</th>
              <th>Monthly Cost</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Small</strong></td>
              <td>10</td>
              <td>2 Opus, 6 Sonnet, 2 Haiku</td>
              <td>$80-$150</td>
              <td>$2,400-$4,500</td>
            </tr>
            <tr>
              <td><strong>Medium</strong></td>
              <td>25</td>
              <td>4 Opus, 16 Sonnet, 5 Haiku</td>
              <td>$200-$400</td>
              <td>$6,000-$12,000</td>
            </tr>
            <tr>
              <td><strong>Large</strong></td>
              <td>50</td>
              <td>8 Opus, 32 Sonnet, 10 Haiku</td>
              <td>$400-$800</td>
              <td>$12,000-$24,000</td>
            </tr>
            <tr>
              <td><strong>Enterprise</strong></td>
              <td>100</td>
              <td>15 Opus, 65 Sonnet, 20 Haiku</td>
              <td>$800-$1,600</td>
              <td>$24,000-$48,000</td>
            </tr>
          </tbody>
        </table>

        <div class="info-box mt-6">
          <div class="info-box-title">Cost per Output Decreases at Scale</div>
          <div class="info-box-text">At 10 agents: $5-$15 per PR. At 100 agents: $2-$8 per PR. Better caching hit rates, efficient task distribution, and amortized orchestration overhead all contribute to this efficiency gain.</div>
        </div>
      </section>

      <!-- Section 5: OPTIMIZATION PATH -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Cost Optimization Path
        </h2>

        <p class="text-text-secondary mb-6">
          Follow this path to achieve 60-80% cost reduction without sacrificing quality:
        </p>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content"><strong>Model Selection</strong> - Default to Sonnet. Use <code>Haiku</code> for simple tasks, <code>Opus</code> only for complex reasoning. This alone: <strong>40-60% savings</strong>.</div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content"><strong>Prompt Caching</strong> - Cache your CLAUDE.md and system prompts. Structure static content first. Target 30:1 read:write ratio. Additional <strong>20-40% savings</strong>.</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content"><strong>Fresh Context</strong> - Use Ralph pattern for autonomous work. Each iteration resets context. Avoid accumulated context costs. Additional <strong>30-50% savings</strong>.</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content"><strong>Batch Processing</strong> - Use Batch API for non-urgent work: test generation, bulk refactoring, documentation. <strong>50% discount</strong> on batch operations.</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content"><strong>Output Control</strong> - Set <code>max_tokens</code> limits. Request concise responses. Output costs 5x input. Additional <strong>20-40% savings</strong>.</div>
          </div>
          <div class="path-step">
            <div class="path-number">6</div>
            <div class="path-content"><strong>Subagent Isolation</strong> - Put expensive tools (browser, MCP) in subagents. Protect main context window. Additional <strong>20-30% savings</strong> on heavy workflows.</div>
          </div>
          <div class="path-step">
            <div class="path-number">7</div>
            <div class="path-content"><strong>Monitor and Iterate</strong> - Use <code>/cost</code> after sessions. Track cost per PR. Identify expensive patterns. Continuous improvement.</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">Claude-Flow 75% Cost Reduction</h3>

        <p class="text-text-secondary mb-4">
          Claude-Flow achieves 75% cost reduction through three-tier intelligent routing:
        </p>

        <div class="code-block">
          <pre><span class="comment"># Task Complexity Router</span>
Simple transforms (rename, format) <span class="keyword">--></span> Agent Booster (WASM) <span class="comment"># $0, &lt;1ms</span>
Low complexity (simple fixes)      <span class="keyword">--></span> Haiku               <span class="comment"># $0.001, ~100ms</span>
Complex reasoning (architecture)   <span class="keyword">--></span> Sonnet/Opus         <span class="comment"># $0.05, ~2s</span>

<span class="comment"># Example: 100 tasks/day</span>
Without Claude-Flow: <span class="number">100</span> x <span class="variable">$0.05</span> = <span class="variable">$5/day</span> = <span class="variable">$150/month</span>
With Claude-Flow:    (<span class="number">40</span> x <span class="variable">$0</span>) + (<span class="number">40</span> x <span class="variable">$0.001</span>) + (<span class="number">20</span> x <span class="variable">$0.05</span>) = <span class="variable">$1.04/day</span> = <span class="variable">$31/month</span>
Savings: <span class="string">79%</span></pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          Cost pitfalls that catch even experienced users:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Runaway Ralph loops
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Daily cost jumped from $5 to $50+ overnight. Budget consumed unexpectedly.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> No MAX_ITERATIONS set. Loop ran all night without stopping.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> ALWAYS set MAX_ITERATIONS. Use <code>MAX_ITERATIONS=25 ./ralph.sh $MAX_ITERATIONS</code>. Add early exit on <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code>.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Opus for everything
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Costs 5x higher than expected. Same work, much higher bills.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Defaulting to Opus "because it's better" without considering task complexity.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Audit model selection. Ask: "Does this task REQUIRE complex reasoning?" If not, use Sonnet. For simple tasks, use Haiku.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Large file reads into context
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Single sessions cost $5+ when they should cost $0.50.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Reading entire codebases into context. Every file adds tokens; tokens add cost.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Read specific files, not directories. Use git diff instead of full files. Put file exploration in subagents.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Cache invalidation loops
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Expecting 90% cache savings but seeing full prices.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Dynamic content in system prompts invalidating cache. Each variation is a new cache entry.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Structure prompts with STATIC content first. Move dynamic content to user messages. Check <code>cache_read_input_tokens</code> in responses.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Parallel agents without coordination
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Multi-agent costs 5-10x expected. Same work being done multiple times.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Workers duplicating tasks. No unique assignment. Coordination overhead exploding.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Ensure orchestrator assigns unique, non-overlapping tasks. Add task ID to each worker context. Use worker preamble that forbids sub-spawning.</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          Fundamental tensions in cost optimization with no perfect solutions:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Quality vs. Cost Tension
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Opus produces better architecture decisions but costs 5x more. Haiku is cheap but loses track in complex tasks. The optimal choice varies by task AND by how expensive mistakes are downstream.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Haiku produces wrong architecture, costs $50 to fix later. Opus used for simple task, wastes $4 that could have been $0.80.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Use the cascade pattern - start with Haiku, escalate on failure. For architecture decisions, pay for Opus upfront. Track cost of rework vs cost of premium model.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Predictability vs. Variable Workloads
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Subscriptions ($20-$200/month) are predictable but wasteful for variable usage. API is pay-per-use but unpredictable. Neither fits all workloads.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Pro subscription but hitting 5-hour limits. Max subscription feels wasted during slow weeks. API costs spike during crunch periods.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Hybrid approach: subscription for baseline, API for overflow. Track actual usage for 30 days before choosing. Review quarterly and adjust.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            ROI Measurement Difficulty
          </div>
          <div class="hard-detail"><strong>The tension:</strong> AI costs are easy to measure ($/day). AI VALUE is hard to measure. How do you quantify "better architecture decision" or "bug caught early"?</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Finance wants ROI numbers. Engineering knows value but can't prove it. Budgets get cut based on costs without understanding benefits.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Track proxy metrics: PRs merged, time to first commit, bugs per PR. Accept that 6 months of data needed for meaningful ROI. Use Faros AI or similar for standardized measurement.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Scale Economies vs. Coordination Costs
          </div>
          <div class="hard-detail"><strong>The tension:</strong> More agents = better parallelism = faster delivery. But more agents = more coordination overhead = higher costs. There's a point where adding agents costs more than it saves.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Gas Town costs 5x expected. Agents waiting on each other. Mayor spending all tokens on coordination, not work.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Start with fewer agents than you think you need. Measure throughput vs agent count. Find your optimal ratio (often 3-5 workers per orchestrator).</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO OPTIMIZE -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Optimize / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              OPTIMIZE AGGRESSIVELY WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Running autonomous overnight loops (Ralph) - costs compound per iteration</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Multi-agent orchestration (Gas Town, Swarms) - coordination multiplies costs</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Enterprise scale (50+ developers) - small per-developer savings compound</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Bulk operations (migrations, test generation) - batch API halves costs</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Repeated similar tasks - caching provides 90% savings</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              DON'T OVER-OPTIMIZE WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Architecture decisions - wrong call costs 100x the "savings"</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Security review - Opus catching a vulnerability is worth any price</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Developer time > API cost - $100/hr developer waiting on slow Haiku</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Learning phase - optimize after you understand usage patterns</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Low-volume usage - Pro subscription already handles most users</span>
            </div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4">Budget Templates by Scale</h3>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
          <div class="budget-card">
            <div class="budget-card-header">Small Projects (&lt;$5K/month)</div>
            <div class="budget-item">
              <span class="budget-label">Subscription</span>
              <span class="budget-value">$100 (Max 5x)</span>
            </div>
            <div class="budget-item">
              <span class="budget-label">API overflow</span>
              <span class="budget-value">$100</span>
            </div>
            <div class="budget-item">
              <span class="budget-label">Tools/plugins</span>
              <span class="budget-value">$50</span>
            </div>
            <div class="budget-item">
              <span class="budget-label">Buffer (20%)</span>
              <span class="budget-value">$50</span>
            </div>
            <div class="budget-item" style="border-top: 2px solid #e4e4e7; padding-top: 12px;">
              <span class="budget-label"><strong>Total</strong></span>
              <span class="budget-value"><strong>$300/month</strong></span>
            </div>
          </div>

          <div class="budget-card">
            <div class="budget-card-header">Medium Projects ($5K-$20K/month)</div>
            <div class="budget-item">
              <span class="budget-label">Team subscriptions (10)</span>
              <span class="budget-value">$3,000</span>
            </div>
            <div class="budget-item">
              <span class="budget-label">API costs</span>
              <span class="budget-value">$5,000</span>
            </div>
            <div class="budget-item">
              <span class="budget-label">Cloud infrastructure</span>
              <span class="budget-value">$1,500</span>
            </div>
            <div class="budget-item">
              <span class="budget-label">Tooling/licenses</span>
              <span class="budget-value">$500</span>
            </div>
            <div class="budget-item" style="border-top: 2px solid #e4e4e7; padding-top: 12px;">
              <span class="budget-label"><strong>Total</strong></span>
              <span class="budget-value"><strong>$10,000/month</strong></span>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">The Fundamental ROI Equation</div>
          <div class="info-box-text">
            <code>If AI_cost &lt; (Developer_hourly_rate x Hours_saved x Quality_factor) Then: Use AI</code><br><br>
            Example: AI_cost = $50 (Ralph loop), Developer_rate = $100/hr, Hours_saved = 6, Quality_factor = 0.9<br>
            $50 &lt; ($100 x 6 x 0.9) = $50 &lt; $540. ROI = 980%.
          </div>
        </div>
      </section>

    </main>

    <!-- Resizer -->
    <div class="resizer" data-resizer="activity-zone" aria-label="Resize activity panel"></div>

    <!-- Activity Zone -->
    <aside class="activity-zone" id="activityZone">
      <div class="text-xs font-semibold text-text-muted uppercase tracking-wider mb-4">Operational Intelligence</div>

      <!-- ESSENCE SECTION -->
      <div class="activity-item inversion" data-section="essence">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if all models cost the same?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Always use Opus. No decision overhead.<br>
          <strong>Why this fails:</strong> Compute isn't free. Pricing reflects real resource consumption. Even if subsidized, supply would be constrained.<br>
          <strong>Hidden constraint revealed:</strong> Model tiering IS the market's solution to resource allocation.
        </div>
      </div>

      <div class="activity-item minimal" data-section="essence">
        <div class="activity-label" style="color: #84cc16;">
          <i data-lucide="minimize-2" class="w-4 h-4"></i>
          Minimal Pattern
        </div>
        <div class="font-medium text-text-primary mb-2">The irreducible cost optimization</div>
        <div class="text-text-secondary text-sm">
          <code style="background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;">Use Sonnet unless you have a specific reason not to.</code><br>
          <strong>Essential:</strong> Model selection matching task complexity.<br>
          <strong>Everything else:</strong> Refinement for marginal gains.
        </div>
      </div>

      <div class="activity-item warstory" data-section="essence">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">YC Hackathon: $297 for 6 MVPs</div>
        <div class="text-text-secondary text-sm">
          Multiple teams using Ralph loops overnight. 6+ functional repos built. Total cost: $297. ~$50 per MVP. ROI: 3,000%+ vs contractor rates.
        </div>
      </div>

      <!-- CORE SECTION -->
      <div class="activity-item constraint" data-section="core">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">One constraint forces FIVE decisions</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Compute costs money  Models have different resource requirements<br>
           Models priced by capability tier<br>
           Tasks have varying complexity requirements<br>
           Matching model to task is economically optimal<br>
           Over-provisioning wastes money<br>
           Under-provisioning costs more in rework
        </div>
      </div>

      <div class="activity-item analogy" data-section="core">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Token Budget = Staffing Budget</div>
        <div class="text-text-secondary text-sm">
          Junior dev ($50K/yr)  Haiku ($1/MTok)<br>
          Senior dev ($120K/yr)  Sonnet ($3/MTok)<br>
          Staff eng ($200K/yr)  Opus ($5/MTok)<br><br>
          <em>You don't use Staff engineers for junior tasks. Don't use Opus for simple lookups.</em>
        </div>
      </div>

      <div class="activity-item effect" data-section="core">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="trending-up" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">Cost per output DECREASES at scale</div>
        <div class="text-text-secondary text-sm">
          At 10 agents: $5-$15 per PR<br>
          At 100 agents: $2-$8 per PR<br><br>
          <strong>Why:</strong> Better cache hit rates, efficient task distribution, amortized orchestration overhead.
        </div>
      </div>

      <!-- DECISIONS SECTION -->
      <div class="activity-item gradient" data-section="decisions">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How model mismatch fails (invisibly)</div>
        <div class="text-text-secondary text-sm">
          <strong>Haiku on complex task:</strong><br>
          100%  90%: Subtle omissions, you won't notice<br>
          90%  70%: Missing edge cases, architectural drift<br>
          70%  50%: Wrong abstractions, technical debt<br>
          50%  CLIFF: Completely wrong approach, $500 rework<br><br>
          <em>The gradient is invisible until the rework bill.</em>
        </div>
      </div>

      <div class="activity-item tradeoff" data-section="decisions">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">The Cache TTL Dilemma</div>
        <div class="text-text-secondary text-sm">
          <strong>5-min cache (1.25x write):</strong> Cheaper writes, but frequent misses<br>
          <strong>1-hour cache (2x write):</strong> Expensive writes, but better hit rate<br><br>
          <strong>No perfect answer:</strong> Depends on your request frequency. Interactive = 5-min. Batch = 1-hour.
        </div>
      </div>

      <div class="activity-item expertise" data-section="decisions">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How deep is your cost understanding?</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "Which model should I use?"  Sonnet for most things<br>
          <strong>Intermediate:</strong> "Why these prices?"  Reflects compute requirements<br>
          <strong>Advanced:</strong> "When is Opus worth 5x?"  Architecture, security, ambiguity<br>
          <strong>Staff:</strong> "What's the ROI equation?"  AI_cost &lt; Dev_rate x Hours_saved<br>
          <strong>Expert:</strong> "Where's the inflection?"  ~$300/month per developer
        </div>
      </div>

      <!-- PRICING SECTION -->
      <div class="activity-item invariant" data-section="pricing">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">Output costs 5x input across ALL models</div>
        <div class="text-text-secondary text-sm">
          This ratio is constant: Haiku ($1/$5), Sonnet ($3/$15), Opus ($5/$25).<br><br>
          <strong>Why this matters:</strong> Output length control is universally valuable. Applies to every model choice.
        </div>
      </div>

      <div class="activity-item warstory" data-section="pricing">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Ryan Carson: $50K contract, $297 API cost</div>
        <div class="text-text-secondary text-sm">
          One engineer delivered a $50,000 contract for $297 in API costs. Profit margin impact: 99.4%. Production Ralph at scale.
        </div>
      </div>

      <div class="activity-item horizon" data-section="pricing">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How cost perception changes with scale</div>
        <div class="text-text-secondary text-sm">
          <strong>Day 1:</strong> "$6/day seems expensive for a tool"<br>
          <strong>Week 2:</strong> "Wait, I shipped 3x more features"<br>
          <strong>Month 2:</strong> "$180/month is cheap for a junior dev equivalent"<br>
          <strong>Quarter 2:</strong> "This is our highest ROI investment"<br><br>
          <em>Don't judge AI ROI by day 1 costs.</em>
        </div>
      </div>

      <div class="activity-item composition" data-section="pricing">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Batch API + Ralph</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Use Batch API for non-urgent Ralph iterations.<br>
          <strong>Savings:</strong> 50% on batch operations.<br>
          <strong>Catch:</strong> 24-hour turnaround. Only for truly autonomous overnight work.
        </div>
      </div>

      <!-- PATH SECTION -->
      <div class="activity-item violation" data-section="path">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip model selection optimization</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> You use Opus for everything<br>
          <strong>THEN:</strong> Simple tasks cost 5x necessary<br>
          <strong>THEN:</strong> 50-iteration Ralph costs $750 vs $150<br>
          <strong>THEN:</strong> Budget consumed 5x faster<br>
          <strong>FINALLY:</strong> Work stops mid-feature when budget exhausted<br><br>
          <em>The fix: Default Sonnet. Upgrade consciously.</em>
        </div>
      </div>

      <div class="activity-item inversion" data-section="path">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you couldn't cache prompts?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Tiny system prompts. No CLAUDE.md. Every call minimal.<br>
          <strong>Why this fails:</strong> Context is valuable. Rich instructions improve output quality.<br>
          <strong>Hidden constraint revealed:</strong> Caching lets you have rich context affordably.
        </div>
      </div>

      <div class="activity-item inflection" data-section="path">
        <div class="activity-label" style="color: #eab308;">
          <i data-lucide="activity" class="w-4 h-4"></i>
          Inflection Point
        </div>
        <div class="font-medium text-text-primary mb-2">When subscription beats API</div>
        <div class="text-text-secondary text-sm">
          <strong>$0-$20/month:</strong> Pro subscription (predictable)<br>
          <strong>$20-$100/month:</strong> Max 5x subscription<br>
          <strong>$100-$200/month:</strong> Max 20x subscription<br>
          <strong>$200+/month:</strong> API (pay-per-use)<br><br>
          <strong>THE INFLECTION:</strong> ~$180/month = Anthropic's reported $6/day average<br>
          <em>Detection: Track /cost for 30 days before deciding.</em>
        </div>
      </div>

      <!-- GOTCHAS SECTION -->
      <div class="activity-item gradient" data-section="gotchas">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How runaway loops fail</div>
        <div class="text-text-secondary text-sm">
          <strong>Iteration 10:</strong> On track, ~$10 spent<br>
          <strong>Iteration 25:</strong> Should have stopped, ~$25<br>
          <strong>Iteration 50:</strong> Diminishing returns, ~$50<br>
          <strong>Iteration 100:</strong> Wasted compute, ~$100<br>
          <strong>Morning:</strong> $150 bill, half wasted on stuck loops<br><br>
          <em>The gradient is invisible while you're asleep.</em>
        </div>
      </div>

      <div class="activity-item constraint" data-section="gotchas">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Why parallel agents explode costs</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> N agents  N coordination messages<br>
           Each message is tokens<br>
           Orchestrator context grows with N<br>
           Coordination overhead > task work<br>
           Adding agents INCREASES cost per task<br><br>
          <em>Optimal: 3-5 workers per orchestrator</em>
        </div>
      </div>

      <div class="activity-item frontier" data-section="gotchas">
        <div class="activity-label" style="color: #ef4444;">
          <i data-lucide="flask-conical" class="w-4 h-4"></i>
          Research Frontier
        </div>
        <div class="font-medium text-text-primary mb-2">UNSOLVED: Automatic cost anomaly detection</div>
        <div class="text-text-secondary text-sm">
          When should a loop self-terminate for cost? After N iterations? After $X spent? After diminishing returns detected? No automation yet. Manual monitoring required.
        </div>
      </div>

      <!-- HARD SECTION -->
      <div class="activity-item tradeoff" data-section="hard">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Quality vs. Cost Tension</div>
        <div class="text-text-secondary text-sm">
          <strong>THE DILEMMA:</strong><br>
          Use Opus: Better output, 5x cost<br>
          Use Haiku: 80% savings, risk of rework<br>
          Use cascade: Complexity overhead<br><br>
          <strong>WHY NO PERFECT ANSWER:</strong> Task complexity isn't always predictable upfront.
        </div>
      </div>

      <div class="activity-item analogy" data-section="hard">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">ROI Measurement = Clinical Trial</div>
        <div class="text-text-secondary text-sm">
          Short-term results misleading  Need 6 months data<br>
          Placebo effect exists  Learning curve distorts early numbers<br>
          Controls matter  Compare to baseline, not ideal<br>
          Sample size matters  One project isn't proof<br><br>
          <em>Treat AI ROI measurement like science, not marketing.</em>
        </div>
      </div>

      <div class="activity-item warstory" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Steve Yegge on Gas Town costs</div>
        <div class="text-text-secondary text-sm">
          "If you care about costs, don't use this."<br><br>
          Gas Town optimizes for capability, not cost. Multiple Claude accounts. "Expensive as hell." But enables solo developer to match small team output.
        </div>
      </div>

      <div class="activity-item horizon" data-section="hard">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How ROI perception evolves</div>
        <div class="text-text-secondary text-sm">
          <strong>Week 1:</strong> "Productivity dropped during learning curve"<br>
          <strong>Month 1:</strong> "Patterns emerging, some wins"<br>
          <strong>Month 3:</strong> "Consistent velocity improvements"<br>
          <strong>Month 6:</strong> "Finally have meaningful data"<br><br>
          <em>Warning: Short-term measurements during learning curves produce misleading negative results.</em>
        </div>
      </div>

      <!-- WHEN SECTION -->
      <div class="activity-item inversion" data-section="when">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you optimized architecture decisions?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Use Haiku for architecture to save money.<br>
          <strong>Why this fails:</strong> Wrong architecture costs 100x the "savings" in rework.<br>
          <strong>Hidden insight:</strong> Some decisions should NEVER be cost-optimized.
        </div>
      </div>

      <div class="activity-item expertise" data-section="when">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Budget decision by expertise level</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "How much should I budget?"  Start with Pro ($20)<br>
          <strong>Intermediate:</strong> "When to upgrade?"  When hitting limits 3+ days/week<br>
          <strong>Advanced:</strong> "Subscription or API?"  Depends on usage variance<br>
          <strong>Staff:</strong> "Team budget formula?"  $150-300/dev/month<br>
          <strong>Expert:</strong> "Enterprise negotiation?"  Volume commits unlock discounts
        </div>
      </div>

      <div class="activity-item alternative" data-section="when">
        <div class="activity-label" style="color: #6b7280;">
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
          Alternative Paths
        </div>
        <div class="font-medium text-text-primary mb-2">If budget is truly constrained</div>
        <div class="text-text-secondary text-sm">
          <strong>Haiku-only workflow:</strong> 80% savings, simple tasks only<br>
          <strong>Batch API:</strong> 50% savings, 24hr turnaround<br>
          <strong>Cache-heavy:</strong> 90% savings on repeated work<br>
          <strong>Off-peak usage:</strong> Better rate limit headroom<br>
          <strong>Self-hosted:</strong> Higher setup, lower marginal cost
        </div>
      </div>

      <div class="activity-item composition" data-section="when">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">All optimizations combined</div>
        <div class="text-text-secondary text-sm">
          <strong>Model tiering:</strong> -40-60%<br>
          <strong>+ Prompt caching:</strong> -20-40% more<br>
          <strong>+ Fresh context:</strong> -30-50% more<br>
          <strong>+ Batch API:</strong> -50% on eligible<br>
          <strong>= Full stack:</strong> 80-90% total savings<br><br>
          <em>Complexity: High. Worth it at enterprise scale.</em>
        </div>
      </div>

      <div class="activity-item inflection" data-section="when">
        <div class="activity-label" style="color: #eab308;">
          <i data-lucide="activity" class="w-4 h-4"></i>
          Inflection Point
        </div>
        <div class="font-medium text-text-primary mb-2">When optimization becomes negative ROI</div>
        <div class="text-text-secondary text-sm">
          <strong>$0-$500/month:</strong> Basic tiering only<br>
          <strong>$500-$2K/month:</strong> Add caching, monitoring<br>
          <strong>$2K-$10K/month:</strong> Add batch, subagents<br>
          <strong>$10K+/month:</strong> Full optimization stack<br><br>
          <strong>THE INFLECTION:</strong> ~$2K/month<br>
          <em>Below this, optimization time > savings value.</em>
        </div>
      </div>

    </aside>
  </div>

  <script>
    /**
     * PanelResizer - Handles draggable panel dividers
     */
    class PanelResizer {
      constructor(resizerEl, config = {}) {
        this.resizer = resizerEl;
        this.config = {
          storageKey: 'panel-activity-zone-width',
          minWidth: 280,
          maxWidth: 900,
          defaultWidth: 480,
          ...config
        };

        this.isResizing = false;
        this.startX = 0;
        this.startWidth = 0;

        this.activityZone = document.querySelector('.activity-zone');
        this.mainContent = document.querySelector('.main-content');

        this.onMouseDown = this.onMouseDown.bind(this);
        this.onMouseMove = this.onMouseMove.bind(this);
        this.onMouseUp = this.onMouseUp.bind(this);

        this.init();
      }

      init() {
        this.restoreWidth();
        this.resizer.addEventListener('mousedown', this.onMouseDown);
      }

      onMouseDown(e) {
        if (e.button !== 0) return;

        this.isResizing = true;
        this.startX = e.clientX;
        this.startWidth = this.activityZone.offsetWidth;

        this.resizer.classList.add('active');
        document.body.classList.add('resizing');

        document.addEventListener('mousemove', this.onMouseMove);
        document.addEventListener('mouseup', this.onMouseUp);

        e.preventDefault();
      }

      onMouseMove(e) {
        if (!this.isResizing) return;

        const delta = this.startX - e.clientX;
        const newWidth = this.startWidth + delta;

        const constrainedWidth = Math.max(
          this.config.minWidth,
          Math.min(this.config.maxWidth, newWidth)
        );

        this.activityZone.style.width = constrainedWidth + 'px';
        this.mainContent.style.marginRight = constrainedWidth + 'px';
        this.resizer.style.right = constrainedWidth + 'px';
      }

      onMouseUp(e) {
        if (!this.isResizing) return;

        this.isResizing = false;

        this.resizer.classList.remove('active');
        document.body.classList.remove('resizing');

        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);

        this.saveWidth();
      }

      saveWidth() {
        const width = this.activityZone.offsetWidth;
        localStorage.setItem(this.config.storageKey, JSON.stringify({
          width,
          timestamp: Date.now()
        }));
      }

      restoreWidth() {
        try {
          const stored = localStorage.getItem(this.config.storageKey);
          if (stored) {
            const { width } = JSON.parse(stored);
            if (width >= this.config.minWidth && width <= this.config.maxWidth) {
              this.activityZone.style.width = width + 'px';
              this.mainContent.style.marginRight = width + 'px';
              this.resizer.style.right = width + 'px';
            }
          }
        } catch (e) {
          console.warn('Failed to restore panel width:', e);
        }
      }

      destroy() {
        this.resizer.removeEventListener('mousedown', this.onMouseDown);
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);
      }
    }

    // Auto-initialize resizers
    document.addEventListener('DOMContentLoaded', () => {
      const resizers = document.querySelectorAll('[data-resizer]');
      resizers.forEach(resizer => new PanelResizer(resizer));
    });

    // Initialize Lucide icons
    lucide.createIcons();

    // Navigation toggle
    function toggleSection(header) {
      const section = header.closest('.nav-section');
      section.classList.toggle('expanded');
      const children = section.querySelector('.nav-children');
      children.classList.toggle('expanded');
    }

    // Mobile menu toggle
    function toggleMobileMenu() {
      const nav = document.getElementById('leftNav');
      nav.classList.toggle('open');
    }

    // Copy functionality
    function copyCode(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> Copied!';
        lucide.createIcons();
        setTimeout(() => {
          btn.innerHTML = originalText;
          lucide.createIcons();
        }, 2000);
      });
    }

    function copyCodeBlock(btn) {
      const codeBlock = btn.closest('.code-block');
      const pre = codeBlock.querySelector('pre');
      const text = pre.textContent;
      copyCode(btn, text);
    }

    // Scroll-sync with GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    const sections = document.querySelectorAll('[data-activity]');
    const activityItems = document.querySelectorAll('.activity-item');

    sections.forEach(section => {
      ScrollTrigger.create({
        trigger: section,
        start: 'top 40%',
        end: 'bottom 40%',
        onEnter: () => activateSection(section.dataset.activity),
        onEnterBack: () => activateSection(section.dataset.activity),
      });
    });

    function activateSection(sectionName) {
      activityItems.forEach(item => {
        if (item.dataset.section === sectionName) {
          item.classList.add('active');
          gsap.to(item, {
            opacity: 1,
            y: -2,
            boxShadow: '0 4px 12px rgba(0,0,0,0.08)',
            duration: 0.3,
            ease: 'power2.out'
          });
        } else {
          item.classList.remove('active');
          gsap.to(item, {
            opacity: 0.5,
            y: 0,
            boxShadow: 'none',
            duration: 0.3,
            ease: 'power2.out'
          });
        }
      });

      document.querySelectorAll('.nav-section-header').forEach(header => {
        header.classList.remove('active');
      });
      const activeNav = document.querySelector(`[data-section="${sectionName}"] .nav-section-header`);
      if (activeNav) {
        activeNav.classList.add('active');
      }
    }

    // Initialize first section as active
    activateSection('essence');

    // Smooth scroll for nav links
    document.querySelectorAll('.nav-item').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const target = document.querySelector(link.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('active'));
          link.classList.add('active');
        }
      });
    });

    // Brushing interaction
    activityItems.forEach(item => {
      item.addEventListener('mouseenter', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = 'rgba(13, 147, 115, 0.05)';
          relatedSection.style.transition = 'background-color 0.3s ease';
        }
      });

      item.addEventListener('mouseleave', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = '';
        }
      });
    });
  </script>
</body>
</html>
