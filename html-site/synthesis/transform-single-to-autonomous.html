<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Transform: Single Session to Autonomous | Claude Code Documentation</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- GSAP for scroll-sync -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <!-- Tailwind Config with Design Tokens -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'bg-base': '#ffffff',
            'bg-subtle': '#fafafa',
            'bg-muted': '#f4f4f5',
            'text-primary': '#18181b',
            'text-secondary': '#3f3f46',
            'text-muted': '#71717a',
            'accent': '#0D9373',
            'accent-light': '#10b981',
            'accent-bg': '#ecfdf5',
            'border': '#e4e4e7',
            // Activity Zone content type colors (Original 6)
            'az-invariant': '#3b82f6',    // Blue
            'az-effect': '#f59e0b',       // Amber
            'az-composition': '#8b5cf6',  // Purple
            'az-frontier': '#ef4444',     // Red
            'az-warstory': '#10b981',     // Green
            'az-alternative': '#6b7280',  // Gray
            // Activity Zone generative content types (New 10)
            'az-inversion': '#4f46e5',    // Indigo
            'az-constraint': '#8b5cf6',   // Violet
            'az-gradient': '#f43f5e',     // Rose
            'az-horizon': '#06b6d4',      // Cyan
            'az-violation': '#f97316',    // Orange
            'az-tradeoff': '#f59e0b',     // Amber
            'az-analogy': '#d946ef',      // Fuchsia
            'az-expertise': '#10b981',    // Emerald
            'az-minimal': '#84cc16',      // Lime
            'az-inflection': '#eab308',   // Yellow
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Fira Code', 'monospace'],
          },
        },
      },
    }
  </script>

  <style>
    /* Base Styles */
    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
    }

    [id] {
      scroll-margin-top: 80px;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: #ffffff;
      color: #18181b;
      line-height: 1.7;
    }

    /* Three Panel Layout */
    .three-panel-layout {
      min-height: 100vh;
      position: relative;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: #ffffff;
      border-bottom: 1px solid #e4e4e7;
      z-index: 100;
      display: flex;
      align-items: center;
      padding: 0 24px;
    }

    /* Left Navigation - 240px fixed */
    .left-nav {
      position: fixed;
      top: 56px;
      left: 0;
      width: 240px;
      height: calc(100vh - 56px);
      border-right: 1px solid #e4e4e7;
      background: #ffffff;
      overflow-y: auto;
      padding: 16px 0;
      z-index: 40;
    }

    .nav-section {
      padding: 0 12px;
      margin-bottom: 8px;
    }

    .nav-section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      font-size: 14px;
      font-weight: 500;
      color: #3f3f46;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
    }

    .nav-section-header:hover {
      background: #f4f4f5;
    }

    .nav-section-header.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-item {
      display: block;
      padding: 6px 12px 6px 44px;
      font-size: 14px;
      color: #71717a;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.15s;
    }

    .nav-item:hover {
      color: #3f3f46;
      background: #f4f4f5;
    }

    .nav-item.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-children {
      display: none;
      overflow: hidden;
    }

    .nav-children.expanded {
      display: block;
    }

    .nav-chevron {
      transition: transform 0.2s;
    }

    .nav-section.expanded .nav-chevron {
      transform: rotate(90deg);
    }

    /* Main Content - Flexible, margins for fixed sidebars */
    .main-content {
      margin-left: 240px;
      margin-right: 480px;
      margin-top: 56px;
      padding: 48px 48px;
      min-width: 400px;
    }

    /* Activity Zone - 480px fixed */
    .activity-zone {
      position: fixed;
      top: 56px;
      right: 0;
      width: 480px;
      height: calc(100vh - 56px);
      border-left: 1px dashed #e4e4e7;
      background: #fafafa;
      overflow-y: auto;
      padding: 24px 20px;
      z-index: 40;
    }

    /* Responsive: Hide Activity Zone below 1400px */
    @media (max-width: 1400px) {
      .activity-zone {
        display: none;
      }
      .main-content {
        margin-right: 0;
        padding: 40px 32px;
      }
    }

    /* Responsive: Hide Left Nav below 768px */
    @media (max-width: 768px) {
      .left-nav {
        display: none;
      }
      .left-nav.open {
        display: block;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        z-index: 50;
        overflow-y: auto;
      }
      .main-content {
        margin-left: 0;
        padding: 24px 16px;
        min-width: auto;
      }
    }

    /* Resizer - Draggable divider between Main Panel and Activity Zone */
    .resizer {
      position: fixed;
      top: 56px;
      right: 480px;
      width: 6px;
      height: calc(100vh - 56px);
      cursor: col-resize;
      background: transparent;
      z-index: 50;
      transition: background 0.15s ease;
    }

    .resizer:hover {
      background: rgba(13, 147, 115, 0.15);
    }

    .resizer.active {
      background: rgba(13, 147, 115, 0.25);
    }

    /* Prevent text selection during resize */
    body.resizing {
      user-select: none;
      cursor: col-resize !important;
    }

    body.resizing * {
      cursor: col-resize !important;
    }

    /* Hide resizer when Activity Zone is hidden (responsive) */
    @media (max-width: 1400px) {
      .resizer {
        display: none;
      }
    }

    /* Activity Zone Items */
    .activity-item {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      background: #ffffff;
      border: 1px solid #e4e4e7;
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.5;
      transition: all 0.3s ease;
    }

    .activity-item.active {
      opacity: 1;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .activity-item:hover {
      opacity: 1;
    }

    .activity-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Activity Zone content type borders (Original 6) */
    .activity-item.invariant { border-left: 4px solid #3b82f6; }
    .activity-item.effect { border-left: 4px solid #f59e0b; }
    .activity-item.composition { border-left: 4px solid #8b5cf6; }
    .activity-item.frontier { border-left: 4px solid #ef4444; }
    .activity-item.warstory { border-left: 4px solid #10b981; }
    .activity-item.alternative { border-left: 4px solid #6b7280; }

    /* Activity Zone generative content types (New 10) */
    .activity-item.inversion { border-left: 4px solid #4f46e5; }
    .activity-item.constraint { border-left: 4px solid #8b5cf6; }
    .activity-item.gradient { border-left: 4px solid #f43f5e; }
    .activity-item.horizon { border-left: 4px solid #06b6d4; }
    .activity-item.violation { border-left: 4px solid #f97316; }
    .activity-item.tradeoff { border-left: 4px solid #f59e0b; }
    .activity-item.analogy { border-left: 4px solid #d946ef; }
    .activity-item.expertise { border-left: 4px solid #10b981; }
    .activity-item.minimal { border-left: 4px solid #84cc16; }
    .activity-item.inflection { border-left: 4px solid #eab308; }

    /* Main Content Components */

    /* Section titles with number */
    .section-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background: #0D9373;
      color: #ffffff;
      font-size: 14px;
      font-weight: 600;
      border-radius: 50%;
      margin-right: 12px;
    }

    .section-title {
      font-size: 24px;
      font-weight: 600;
      color: #18181b;
      margin-bottom: 20px;
      margin-top: 56px;
      display: flex;
      align-items: center;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    /* Essence Box (15 words) */
    .essence-box {
      background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 40px;
    }

    .essence-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #10b981;
      margin-bottom: 12px;
    }

    .essence-text {
      font-size: 22px;
      font-weight: 500;
      color: #ffffff;
      line-height: 1.4;
    }

    /* Core Abstraction Box */
    .core-abstraction {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .core-philosophy {
      font-size: 16px;
      color: #3f3f46;
      margin-bottom: 16px;
      font-style: italic;
    }

    .core-code {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 16px;
      overflow-x: auto;
    }

    .core-code code {
      font-family: 'Fira Code', monospace;
      font-size: 15px;
      color: #10b981;
      white-space: nowrap;
    }

    .core-anchor {
      font-size: 14px;
      color: #71717a;
      text-align: center;
    }

    /* Design Decision Box */
    .decision-box {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .decision-why {
      font-size: 16px;
      font-weight: 600;
      color: #0D9373;
      margin-bottom: 12px;
    }

    .decision-reasoning {
      font-size: 14px;
      color: #3f3f46;
      margin-bottom: 16px;
    }

    .decision-implication {
      background: #f4f4f5;
      border-radius: 8px;
      padding: 16px;
    }

    .decision-implication-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: #71717a;
      margin-bottom: 8px;
    }

    /* Code Blocks */
    .code-block {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 24px;
      position: relative;
      overflow-x: auto;
    }

    .code-block pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #e4e4e7;
      line-height: 1.6;
    }

    .code-block .comment { color: #6b7280; }
    .code-block .keyword { color: #c084fc; }
    .code-block .string { color: #10b981; }
    .code-block .variable { color: #60a5fa; }

    .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #3f3f46;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s;
    }

    .copy-btn:hover {
      background: #52525b;
    }

    /* Path Steps */
    .path-container {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .path-step {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }

    .path-step:last-child {
      margin-bottom: 0;
    }

    .path-number {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      background: #0D9373;
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .path-content {
      flex: 1;
      font-size: 14px;
      color: #3f3f46;
    }

    .path-content code {
      background: #e4e4e7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
    }

    /* Gotcha Box */
    .gotcha-box {
      background: #fffbeb;
      border: 1px solid #fcd34d;
      border-left: 4px solid #f59e0b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .gotcha-title {
      font-weight: 600;
      color: #92400e;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .gotcha-detail {
      font-size: 14px;
      color: #78350f;
      margin-bottom: 8px;
    }

    .gotcha-detail strong {
      color: #92400e;
    }

    /* What's Hard Box */
    .hard-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-left: 4px solid #ef4444;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .hard-title {
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hard-detail {
      font-size: 14px;
      color: #7f1d1d;
      margin-bottom: 8px;
    }

    /* When To Use Grid */
    .when-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 40px;
    }

    @media (max-width: 900px) {
      .when-grid {
        grid-template-columns: 1fr;
      }
    }

    .when-use {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 24px;
    }

    .when-not {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 24px;
    }

    .when-title {
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .when-use .when-title { color: #166534; }
    .when-not .when-title { color: #991b1b; }

    .when-item {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 14px;
    }

    .when-use .when-item { color: #166534; }
    .when-not .when-item { color: #991b1b; }

    /* Comparison Table */
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
      font-size: 14px;
    }

    .comparison-table th {
      background: #f4f4f5;
      padding: 12px 16px;
      text-align: left;
      font-weight: 600;
      border-bottom: 2px solid #e4e4e7;
    }

    .comparison-table td {
      padding: 12px 16px;
      border-bottom: 1px solid #e4e4e7;
    }

    .comparison-table .before-col {
      background: #fef2f2;
      color: #991b1b;
    }

    .comparison-table .after-col {
      background: #f0fdf4;
      color: #166534;
    }

    /* Checkpoint Box */
    .checkpoint-box {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border: 1px solid #a7f3d0;
      border-left: 4px solid #10b981;
      border-radius: 8px;
      padding: 20px;
      margin: 24px 0;
    }

    .checkpoint-title {
      font-weight: 600;
      color: #065f46;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .checkpoint-content {
      font-size: 14px;
      color: #047857;
    }

    .checkpoint-content code {
      background: rgba(0,0,0,0.1);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
    }

    /* Before/After Visual */
    .before-after-box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 24px;
    }

    @media (max-width: 900px) {
      .before-after-box {
        grid-template-columns: 1fr;
      }
    }

    .before-panel {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 20px;
    }

    .after-panel {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 20px;
    }

    .panel-title {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
    }

    .before-panel .panel-title { color: #991b1b; }
    .after-panel .panel-title { color: #166534; }

    /* Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      padding: 8px;
      background: none;
      border: none;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .mobile-menu-btn {
        display: flex;
      }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #fafafa;
    }

    ::-webkit-scrollbar-thumb {
      background: #d4d4d8;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1aa;
    }

    /* Keyboard shortcut hint */
    .kbd {
      display: inline-flex;
      align-items: center;
      padding: 2px 6px;
      background: #f4f4f5;
      border: 1px solid #e4e4e7;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: #71717a;
    }

    /* Context degradation visual */
    .degradation-chart {
      background: #18181b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 24px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #e4e4e7;
    }

    .degradation-row {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }

    .degradation-label {
      width: 100px;
      color: #a1a1aa;
    }

    .degradation-bar {
      flex: 1;
      height: 20px;
      background: #3f3f46;
      border-radius: 4px;
      overflow: hidden;
    }

    .degradation-fill {
      height: 100%;
      transition: width 0.3s;
    }

    .degradation-fill.good { background: #10b981; }
    .degradation-fill.warning { background: #f59e0b; }
    .degradation-fill.danger { background: #ef4444; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
      <i data-lucide="menu" class="w-5 h-5 text-text-secondary"></i>
    </button>
    <div class="flex items-center gap-3">
      <i data-lucide="terminal" class="w-5 h-5 text-accent"></i>
      <span class="font-semibold text-text-primary">Claude Code</span>
    </div>
    <div class="flex-1 flex justify-center">
      <button class="flex items-center gap-2 px-4 py-2 bg-bg-muted rounded-lg text-text-muted text-sm hover:bg-border transition-colors">
        <i data-lucide="search" class="w-4 h-4"></i>
        <span>Search documentation...</span>
        <span class="kbd">Cmd+K</span>
      </button>
    </div>
    <div class="flex items-center gap-4">
      <a href="#" class="text-sm text-text-muted hover:text-text-primary transition-colors">Support</a>
      <button class="p-2 hover:bg-bg-muted rounded-lg transition-colors" aria-label="Toggle theme">
        <i data-lucide="sun" class="w-4 h-4 text-text-muted"></i>
      </button>
    </div>
  </header>

  <div class="three-panel-layout">
    <!-- Left Navigation -->
    <nav class="left-nav" id="leftNav">
      <div class="px-4 mb-4">
        <span class="text-xs font-semibold text-text-muted uppercase tracking-wider">Transformation</span>
      </div>

      <!-- Essence -->
      <div class="nav-section expanded" data-section="essence">
        <div class="nav-section-header active" onclick="toggleSection(this)">
          <i data-lucide="zap" class="w-4 h-4"></i>
          <span>Essence</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#essence" class="nav-item active">The Paradigm Shift</a>
        </div>
      </div>

      <!-- Core Abstraction -->
      <div class="nav-section expanded" data-section="core">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="box" class="w-4 h-4"></i>
          <span>The Core Shift</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#core-abstraction" class="nav-item">Before vs After</a>
        </div>
      </div>

      <!-- Design Decisions -->
      <div class="nav-section expanded" data-section="decisions">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="lightbulb" class="w-4 h-4"></i>
          <span>Why Transform?</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#why-context-degrades" class="nav-item">Why Context Degrades</a>
          <a href="#why-external-state" class="nav-item">Why External State</a>
          <a href="#why-atomic-tasks" class="nav-item">Why Atomic Tasks</a>
        </div>
      </div>

      <!-- File Structure -->
      <div class="nav-section" data-section="files">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="folder" class="w-4 h-4"></i>
          <span>Implementation</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#file-structure" class="nav-item">The 4 Files</a>
          <a href="#prd-json" class="nav-item">prd.json</a>
          <a href="#ralph-sh" class="nav-item">ralph.sh</a>
          <a href="#progress-txt" class="nav-item">progress.txt</a>
        </div>
      </div>

      <!-- Path of Transformation -->
      <div class="nav-section" data-section="path">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="git-branch" class="w-4 h-4"></i>
          <span>The Path</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#path" class="nav-item">Transformation Flow</a>
        </div>
      </div>

      <!-- Gotchas -->
      <div class="nav-section" data-section="gotchas">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="alert-triangle" class="w-4 h-4"></i>
          <span>Gotchas</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#gotchas" class="nav-item">Common Failures</a>
        </div>
      </div>

      <!-- What's Hard -->
      <div class="nav-section" data-section="hard">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="flame" class="w-4 h-4"></i>
          <span>What's Hard</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#hard" class="nav-item">Real Complexity</a>
        </div>
      </div>

      <!-- When to Transform -->
      <div class="nav-section" data-section="when">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="check-circle" class="w-4 h-4"></i>
          <span>When to Transform</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#when" class="nav-item">Decision Criteria</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Transform human-babysitting-AI into AI-working-while-human-sleeps through fresh context and external state.</div>
        </div>

        <p class="text-text-secondary mb-6">
          <strong>The Paradigm Shift:</strong> From 90 minutes of active engagement watching context degrade, to 30 minutes of setup then walking away while work completes overnight.
        </p>

        <p class="text-text-secondary mb-6">
          This transformation unlocks Level 2+ on the complexity ladder. It's the difference between using Claude as a pair programmer who gets tired, and using Claude as a factory worker who never forgets the plan because the plan lives in files, not context.
        </p>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Shift
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"Context degrades. Files persist. Fresh instances win."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'BEFORE: You ↔ Claude (continuous, context fills, quality drops)\nAFTER: You → PRD → [Fresh Claude]₁ → [Fresh Claude]₂ → ... → Complete')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>BEFORE: You <span class="comment">↔</span> Claude <span class="comment">(continuous, context fills, quality drops)</span><br>
AFTER:  You <span class="comment">→</span> PRD <span class="comment">→</span> [Fresh Claude]<span class="variable">₁</span> <span class="comment">→</span> [Fresh Claude]<span class="variable">₂</span> <span class="comment">→</span> ... <span class="comment">→</span> Complete</code>
          </div>

          <div class="core-anchor">The transformation: Replace "continuous conversation" with "loop of fresh instances + external state".</div>
        </div>

        <!-- Before/After Visual Comparison -->
        <div class="before-after-box">
          <div class="before-panel">
            <div class="panel-title">Before: Single Session</div>
            <ul class="text-sm text-red-900 space-y-2">
              <li>You prompt iteratively</li>
              <li>Context fills over 90 minutes</li>
              <li>Quality degrades at 60-70%</li>
              <li>Earlier decisions forgotten</li>
              <li>Human must stay engaged</li>
              <li>Session dies = state lost</li>
            </ul>
          </div>
          <div class="after-panel">
            <div class="panel-title">After: Autonomous Loop</div>
            <ul class="text-sm text-green-900 space-y-2">
              <li>PRD defines all tasks upfront</li>
              <li>Fresh context each iteration</li>
              <li>Quality maintained throughout</li>
              <li>Decisions persist in files</li>
              <li>Human can walk away</li>
              <li>Crash = resume from git</li>
            </ul>
          </div>
        </div>

        <p class="text-text-secondary mb-6">
          Each iteration spawns a <strong>new Claude instance with zero memory</strong> of previous work. The agent reads prd.json to know what's done and what's next. It reads progress.txt to learn patterns from past iterations. It does ONE task, verifies, commits, logs learnings, and exits. The bash loop restarts it fresh.
        </p>

        <!-- Context Degradation Visualization -->
        <h3 class="font-semibold text-lg mb-4">Context Degradation in Single Sessions</h3>

        <div class="degradation-chart">
          <div class="degradation-row">
            <div class="degradation-label">0-50%</div>
            <div class="degradation-bar">
              <div class="degradation-fill good" style="width: 100%;"></div>
            </div>
            <span class="ml-3 text-green-400">Full capability</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">50-70%</div>
            <div class="degradation-bar">
              <div class="degradation-fill warning" style="width: 75%;"></div>
            </div>
            <span class="ml-3 text-yellow-400">Slight degradation</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">70-85%</div>
            <div class="degradation-bar">
              <div class="degradation-fill warning" style="width: 50%;"></div>
            </div>
            <span class="ml-3 text-yellow-400">Noticeable loss</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">85-95%</div>
            <div class="degradation-bar">
              <div class="degradation-fill danger" style="width: 25%;"></div>
            </div>
            <span class="ml-3 text-red-400">Instructions forgotten</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">95%+</div>
            <div class="degradation-bar">
              <div class="degradation-fill danger" style="width: 10%;"></div>
            </div>
            <span class="ml-3 text-red-400">Hallucinations, amnesia</span>
          </div>
        </div>

        <p class="text-text-secondary mb-6">
          This is why iteration 20 in a single session produces worse code than iteration 5. The solution isn't debugging—it's restarting with fresh context.
        </p>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-context-degrades" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Why Transform?
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY CONTEXT DEGRADES</div>
          <div class="decision-reasoning">
            Transformer attention has finite capacity. At 200K tokens, the model must compress. At 80K+ tokens, quality visibly degrades—earlier instructions get lost, the model contradicts itself, "context rot" sets in. This isn't a bug; it's physics.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Don't fight context degradation—embrace fresh context. If quality drops, the fix is restart, not debug. The transformation moves you from fighting this constraint to leveraging it.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-external-state">
          <div class="decision-why">WHY EXTERNAL STATE</div>
          <div class="decision-reasoning">
            If each iteration is a fresh Claude with no memory, how does progress persist? Through files. Git commits are the audit trail. prd.json tracks what's done. progress.txt accumulates learnings. The filesystem IS the memory.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Never rely on "Claude remembering" something from a previous iteration. If it's not written to a file, it doesn't exist. Every decision, every learning, every blocker must be persisted externally.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-atomic-tasks">
          <div class="decision-why">WHY ATOMIC TASKS</div>
          <div class="decision-reasoning">
            Each task must complete in ONE iteration (one context window). If a task spans multiple iterations, there's no way to persist the "partial state" of thinking. Large tasks = Claude loses track mid-task = broken code.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              If you can't describe a task in 2-3 sentences, split it. "Build auth system" becomes 7 atomic stories: add schema, add middleware, add form, add server action, wire them up, test validation, test action. Each is one iteration.
            </div>
          </div>
        </div>

        <div class="checkpoint-box">
          <div class="checkpoint-title">
            <i data-lucide="check-circle" class="w-4 h-4"></i>
            Checkpoint: Is Transformation Right For This Task?
          </div>
          <div class="checkpoint-content">
            <strong>Ask yourself:</strong><br>
            - Does task have 3+ discrete steps? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Will it take > 30 min total? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Do you have clear "done" criteria? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Can each step be verified programmatically? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Are you okay walking away? <span class="text-emerald-700">(Yes = transform)</span><br><br>
            If all yes: proceed with transformation. If any no: consider single session or HOTL Ralph.
          </div>
        </div>
      </section>

      <!-- Section 4: FILE STRUCTURE -->
      <section id="file-structure" data-activity="files">
        <h2 class="section-title">
          <span class="section-number">4</span>
          The Implementation
        </h2>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>project/
<span class="comment">├── scripts/ralph/           # The autonomous system</span>
│   ├── ralph.sh             <span class="comment"># The loop engine</span>
│   ├── prd.json             <span class="comment"># Task board (external state)</span>
│   └── progress.txt         <span class="comment"># Learnings log (append-only)</span>
└── CLAUDE.md                <span class="comment"># Project context</span></pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="prd-json">prd.json - The Task Board</h3>

        <p class="text-text-secondary mb-4">
          This is the transformation in action. Your single "build auth feature" request becomes 7 atomic, verifiable stories.
        </p>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>{
  <span class="string">"project"</span>: <span class="string">"UserAuth"</span>,
  <span class="string">"branchName"</span>: <span class="string">"feat/user-auth"</span>,
  <span class="string">"description"</span>: <span class="string">"User authentication with login form, validation, and tests"</span>,
  <span class="string">"userStories"</span>: [
    {
      <span class="string">"id"</span>: <span class="string">"US-001"</span>,
      <span class="string">"title"</span>: <span class="string">"Create login form component with email/password fields"</span>,
      <span class="string">"description"</span>: <span class="string">"Basic login form UI with styled inputs"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"LoginForm component exists in components/auth/"</span>,
        <span class="string">"Has email input with type='email'"</span>,
        <span class="string">"Has password input with type='password'"</span>,
        <span class="string">"Has submit button"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 1,
      <span class="string">"passes"</span>: <span class="keyword">false</span>,
      <span class="string">"notes"</span>: <span class="string">""</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-002"</span>,
      <span class="string">"title"</span>: <span class="string">"Add Zod schema for login validation"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"loginSchema defined with email and password fields"</span>,
        <span class="string">"Email validates format with .email()"</span>,
        <span class="string">"Password requires minimum 8 characters"</span>,
        <span class="string">"Schema exported from lib/validations/auth.ts"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 2,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-003"</span>,
      <span class="string">"title"</span>: <span class="string">"Integrate validation into login form"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Form uses react-hook-form with zodResolver"</span>,
        <span class="string">"Validation errors display below inputs"</span>,
        <span class="string">"Submit disabled when form invalid"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 3,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-004"</span>,
      <span class="string">"title"</span>: <span class="string">"Create auth server action"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"loginAction in app/auth/actions.ts"</span>,
        <span class="string">"Accepts email and password"</span>,
        <span class="string">"Uses bcrypt for password comparison"</span>,
        <span class="string">"Returns success/error response"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 4,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-005"</span>,
      <span class="string">"title"</span>: <span class="string">"Wire form to server action"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Form calls loginAction on submit"</span>,
        <span class="string">"Loading state during submission"</span>,
        <span class="string">"Error messages from server displayed"</span>,
        <span class="string">"Redirect on success"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 5,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-006"</span>,
      <span class="string">"title"</span>: <span class="string">"Write unit tests for validation schema"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Tests in __tests__/auth/validation.test.ts"</span>,
        <span class="string">"Tests valid email formats"</span>,
        <span class="string">"Tests invalid email rejection"</span>,
        <span class="string">"Tests password length requirements"</span>,
        <span class="string">"npm run test passes"</span>
      ],
      <span class="string">"priority"</span>: 6,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-007"</span>,
      <span class="string">"title"</span>: <span class="string">"Write unit tests for server action"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Tests in __tests__/auth/actions.test.ts"</span>,
        <span class="string">"Tests successful login"</span>,
        <span class="string">"Tests invalid credentials"</span>,
        <span class="string">"Tests missing user"</span>,
        <span class="string">"Mocks database calls"</span>,
        <span class="string">"npm run test passes"</span>
      ],
      <span class="string">"priority"</span>: 7,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    }
  ]
}</pre>
        </div>

        <p class="text-text-secondary mb-6">
          <strong>Why this structure works:</strong> Each story is atomic (one context window). Dependencies are ordered by priority. Acceptance criteria are verifiable. <code>passes: true/false</code> tracks completion state externally.
        </p>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="ralph-sh">ralph.sh - The Automation Loop</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment">#!/bin/bash</span>
<span class="keyword">set</span> -e

<span class="variable">MAX_ITERATIONS</span>=<span class="variable">${1:-25}</span>
<span class="variable">SCRIPT_DIR</span>="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
<span class="variable">PROJECT_ROOT</span>="$(cd "$SCRIPT_DIR/../.." && pwd)"

<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"  Ralph - Autonomous Development Loop"</span>
<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"Max iterations: $MAX_ITERATIONS"</span>
<span class="keyword">echo</span> <span class="string">"Project root: $PROJECT_ROOT"</span>

cd "$PROJECT_ROOT"

<span class="keyword">for</span> i <span class="keyword">in</span> $(seq 1 $MAX_ITERATIONS); <span class="keyword">do</span>
  <span class="keyword">echo</span> <span class="string">""</span>
  <span class="keyword">echo</span> <span class="string">"════════════════════════════════════════"</span>
  <span class="keyword">echo</span> <span class="string">"  Iteration $i of $MAX_ITERATIONS"</span>
  <span class="keyword">echo</span> <span class="string">"════════════════════════════════════════"</span>
  <span class="keyword">echo</span> <span class="string">""</span>

  <span class="comment"># Run Claude with fresh context each iteration</span>
  OUTPUT=$(claude --dangerously-skip-permissions &lt;&lt;'PROMPT' 2>&1 | tee /dev/stderr) || true
<span class="comment"># Ralph Agent Instructions</span>

<span class="comment">## Your Context</span>
You are one iteration in an autonomous development loop.
You have NO memory of previous iterations.
Your memory comes from: git history, prd.json, and progress.txt.

<span class="comment">## Your Task</span>

1. Read `scripts/ralph/prd.json` to see all user stories
2. Read `scripts/ralph/progress.txt` for learnings from previous iterations
3. Verify you're on the correct git branch (create if needed)
4. Find the highest priority story where `passes: false`
5. Implement that ONE story completely
6. Run verification: `npm run typecheck` and `npm run test`
7. If passing:
   - Commit with message: `feat: [US-XXX] - [title]`
   - Update prd.json: set `passes: true` for this story
   - APPEND learnings to progress.txt
8. If failing:
   - Fix the issues
   - Try again (up to 3 attempts)
   - If still failing, log the blocker and move on

<span class="comment">## Progress Log Format</span>

APPEND to progress.txt (never edit previous entries):

---
## Iteration [N] - [Story ID] - [Date/Time]
- **Completed:** [what was done]
- **Files changed:** [list]
- **Learnings:** [patterns, gotchas discovered]
- **Blockers:** [any issues for next iteration]
---

<span class="comment">## Stop Condition</span>

If ALL stories in prd.json have `passes: true`, output exactly:
&lt;promise&gt;COMPLETE&lt;/promise&gt;

Otherwise, end your response normally after completing one story.
PROMPT

  <span class="comment"># Check for completion signal</span>
  <span class="keyword">if</span> <span class="keyword">echo</span> "$OUTPUT" | grep -q "&lt;promise&gt;COMPLETE&lt;/promise&gt;"; <span class="keyword">then</span>
    <span class="keyword">echo</span> <span class="string">""</span>
    <span class="keyword">echo</span> <span class="string">"========================================"</span>
    <span class="keyword">echo</span> <span class="string">"  ALL STORIES COMPLETE!"</span>
    <span class="keyword">echo</span> <span class="string">"========================================"</span>
    <span class="keyword">echo</span> <span class="string">""</span>

    <span class="comment"># Summary</span>
    <span class="keyword">echo</span> <span class="string">"Final status:"</span>
    cat scripts/ralph/prd.json | jq '.userStories[] | {id, title, passes}'

    <span class="keyword">exit</span> 0
  <span class="keyword">fi</span>

  <span class="comment"># Brief pause between iterations</span>
  sleep 2
<span class="keyword">done</span>

<span class="keyword">echo</span> <span class="string">""</span>
<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"  Max iterations reached"</span>
<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"Some stories may be incomplete. Check prd.json for status."</span>
<span class="keyword">exit</span> 1</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="progress-txt">progress.txt - The Learning Log</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Ralph Progress Log</span>
Project: UserAuth
Started: 2026-01-09

<span class="comment">## Codebase Patterns</span>
(Ralph updates this section with reusable patterns)

<span class="comment">## Key Files</span>
- components/auth/LoginForm.tsx
- lib/validations/auth.ts
- app/auth/actions.ts
- __tests__/auth/

---

<span class="comment">## Iteration 1 - US-001 - 2026-01-09 02:15</span>
- <span class="keyword">Completed:</span> Created LoginForm component
- <span class="keyword">Files changed:</span> components/auth/LoginForm.tsx
- <span class="keyword">Learnings:</span> Project uses Tailwind, shadcn/ui components available
- <span class="keyword">Blockers:</span> None

---

<span class="comment">## Iteration 2 - US-002 - 2026-01-09 02:18</span>
- <span class="keyword">Completed:</span> Added Zod validation schema
- <span class="keyword">Files changed:</span> lib/validations/auth.ts
- <span class="keyword">Learnings:</span> Use .optional() for nullable fields in Zod
- <span class="keyword">Blockers:</span> None

---
<span class="comment">(Ralph continues appending...)</span></pre>
        </div>

        <div class="checkpoint-box">
          <div class="checkpoint-title">
            <i data-lucide="check-circle" class="w-4 h-4"></i>
            Checkpoint: Verify Setup
          </div>
          <div class="checkpoint-content">
            <code>ls -la scripts/ralph/</code> should show ralph.sh (executable), prd.json, progress.txt<br>
            <code>jq '.userStories | length' scripts/ralph/prd.json</code> should return your story count<br>
            <code>bash -n scripts/ralph/ralph.sh && echo "Syntax OK"</code> should pass<br>
            <code>which claude</code> should return the Claude CLI path
          </div>
        </div>
      </section>

      <!-- Section 5: PATH OF TRANSFORMATION -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Transformation Path
        </h2>

        <p class="text-text-secondary mb-6">
          Follow the transformation from "build auth feature" through to "wake up to completed feature":
        </p>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content"><strong>You decompose</strong> "build auth feature" into 7 atomic user stories in <code>prd.json</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content"><strong>You create</strong> <code>ralph.sh</code> with the loop and embedded prompt</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content"><strong>You initialize</strong> <code>progress.txt</code> with project context and empty log</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content"><strong>You run</strong> <code>./scripts/ralph/ralph.sh 25</code> and walk away</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content"><strong>Iteration 1:</strong> Fresh Claude spawns, reads prd.json, finds US-001, implements LoginForm, commits, updates prd.json, appends to progress.txt, exits</div>
          </div>
          <div class="path-step">
            <div class="path-number">6</div>
            <div class="path-content"><strong>Iteration 2:</strong> Fresh Claude spawns (NO MEMORY), reads prd.json (sees US-001 done), reads progress.txt (learns Tailwind/shadcn), implements US-002, commits, exits</div>
          </div>
          <div class="path-step">
            <div class="path-number">7</div>
            <div class="path-content"><strong>Iterations 3-6:</strong> Pattern repeats. Each iteration has fresh context. Learnings compound in progress.txt.</div>
          </div>
          <div class="path-step">
            <div class="path-number">8</div>
            <div class="path-content"><strong>Iteration 7:</strong> Fresh Claude reads prd.json, sees all <code>passes: true</code>, outputs <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">9</div>
            <div class="path-content"><strong>Script exits.</strong> You wake up to 7 commits, all tests passing, complete authentication feature.</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">What Happens Under the Hood</h3>

        <div class="code-block">
          <pre><span class="comment">Iteration 1 (2:00 AM)</span>
├── Fresh Claude instance spawns
├── Reads: prd.json, progress.txt, CLAUDE.md
├── Picks: US-001 (highest priority, passes: false)
├── Implements: LoginForm.tsx
├── Verifies: npm run typecheck (passes)
├── Commits: "feat: US-001 - Create login form component"
├── Updates: prd.json (US-001.passes = true)
├── Appends: progress.txt with learnings
└── <span class="keyword">Exits (context cleared)</span>

<span class="comment">Iteration 2 (2:05 AM)</span>
├── Fresh Claude instance spawns (<span class="keyword">NO MEMORY</span>)
├── Reads: prd.json (sees US-001 done)
├── Reads: progress.txt (learns about Tailwind/shadcn)
├── Picks: US-002 (next priority)
├── Implements: Zod schema
├── Verifies: npm run typecheck (passes)
├── Commits: "feat: US-002 - Add Zod schema"
└── <span class="keyword">Exits (context cleared)</span>

<span class="comment">... (pattern repeats) ...</span>

<span class="comment">Iteration 7 (2:35 AM)</span>
├── Fresh Claude instance spawns
├── Reads: prd.json (<span class="string">all passes: true!</span>)
├── Outputs: &lt;promise&gt;COMPLETE&lt;/promise&gt;
└── <span class="keyword">Script exits with success</span>

<span class="string">You wake up at 7:00 AM to a complete feature.</span></pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          Real problems you'll hit during the transformation, with concrete numbers and fixes:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Ralph exits after first iteration
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Script runs once, then stops. Only 1 commit in git log.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code> emitted incorrectly, or all stories marked <code>passes: true</code> by mistake.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Check prd.json: <code>jq '.userStories | map(select(.passes==true)) | length' scripts/ralph/prd.json</code>. If all marked true but shouldn't be, reset with <code>jq '.userStories |= map(.passes = false)'</code>.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Same story keeps failing (stuck loop)
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Same task attempted 3+ times with no progress. Iteration count climbing.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Task has impossible acceptance criteria, or verification failing for external reasons.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Check progress.txt for blocker patterns. Split the story or add missing dependency. Reset <code>passes: false</code> and run again.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            progress.txt grows unbounded
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> After ~50 iterations, Claude spends more tokens reading than thinking.</div>
          <div class="gotcha-detail"><strong>Threshold:</strong> >20KB progress.txt starts degrading quality.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Truncate to last 10 entries between runs. Move permanent learnings to CLAUDE.md or AGENTS.md.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Tests pass but story marked failed
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> <code>npm test</code> shows green but prd.json still has <code>passes: false</code>.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Claude didn't update prd.json after verification passed (incomplete prompt following).</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Manually verify tests pass, then update prd.json with <code>jq '.userStories |= map(if .id == "US-XXX" then .passes = true else . end)'</code>.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Context too large for single story
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Iteration completes but work is incomplete. Output mentions "running out of space."</div>
          <div class="gotcha-detail"><strong>Threshold:</strong> Stories with >5 acceptance criteria often hit this.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Split the story: US-002 (8 criteria) becomes US-002a (4 criteria) + US-002b (4 criteria). Add dependencies.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Git commits not appearing
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Work is done in progress.txt but <code>git log</code> shows no new commits.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Claude didn't commit, or commits are on wrong branch.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Check current branch with <code>git branch --show-current</code>. Check expected branch from prd.json. Stash and move if needed.</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          These are fundamental tensions in the transformation, not bugs to fix:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Context Rot vs. Memory Loss
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Fresh context avoids rot but loses learnings. progress.txt helps but grows unbounded. No perfect solution exists.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Quality drops in late iterations (rot), OR early iterations repeat mistakes from archived runs (memory loss).</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Keep progress.txt under 20KB. Start fresh runs from AGENTS.md (permanent), not progress.txt (session). Accept that some re-learning is the cost of fresh context.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Verification Dependency
          </div>
          <div class="hard-detail"><strong>The tension:</strong> The transformation only works if acceptance criteria are verifiable. But not everything can be verified automatically.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Tasks marked "complete" that aren't actually complete. Garbage compounding across iterations.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Don't transform subjective tasks. Use HOTL (Human On The Loop) variant for tasks requiring judgment. Accept that some domains (design, UX) aren't suitable for full autonomous transformation.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Task Decomposition Skill
          </div>
          <div class="hard-detail"><strong>The tension:</strong> The transformation's success depends on your ability to decompose features into iteration-sized tasks. This is a skill, not a formula.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Tasks too big = context overflow. Tasks too small = overhead dominates. Wrong order = broken dependencies.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Start with HOTL to learn task sizing. Review progress.txt after runs to see what worked. Expect to get better over time. If task description > code change, you've decomposed too far.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            The Upfront Investment
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Transformation requires upfront work (PRD creation, script setup, acceptance criteria) that single sessions don't.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Feeling like the setup takes longer than just doing it manually. Temptation to skip transformation for "quick" tasks.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Only transform tasks >30 minutes. The break-even is ~3 stories. Below that, single session wins. Above that, transformation compounds.</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO TRANSFORM -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Transform / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              TRANSFORM WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Task has 3+ discrete steps (decomposition worthwhile)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Total work exceeds 30 minutes (overhead justified)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Clear "done" criteria exist (verifiable completion)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You have test/typecheck infrastructure (verification layer)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You're okay walking away (autonomous execution acceptable)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Overnight execution is fine (fresh context needs time)</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              DON'T TRANSFORM WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Task takes &lt;30 min total (single session faster)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Subjective quality goals ("make it pretty") (use human judgment)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Exploratory work with no defined end (use single session)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Security-critical code (use HOTL with human gates)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Need real-time parallelism (use CC Mirror instead)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Legacy code without tests (add tests first)</span>
            </div>
          </div>
        </div>

        <!-- Summary Comparison Table -->
        <h3 class="font-semibold text-lg mb-4 mt-8">Side-by-Side Comparison</h3>

        <table class="comparison-table">
          <thead>
            <tr>
              <th>Aspect</th>
              <th class="before-col">Before (Single Session)</th>
              <th class="after-col">After (Autonomous)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Context</strong></td>
              <td class="before-col">Degrades over 90 min</td>
              <td class="after-col">Fresh each 5-min iteration</td>
            </tr>
            <tr>
              <td><strong>Human</strong></td>
              <td class="before-col">Must stay engaged entire time</td>
              <td class="after-col">Can leave after setup</td>
            </tr>
            <tr>
              <td><strong>Quality</strong></td>
              <td class="before-col">Drops after 60% context</td>
              <td class="after-col">Maintained throughout</td>
            </tr>
            <tr>
              <td><strong>Duration</strong></td>
              <td class="before-col">90 min + human present</td>
              <td class="after-col">30 min setup + human asleep</td>
            </tr>
            <tr>
              <td><strong>Memory</strong></td>
              <td class="before-col">Lost when session ends</td>
              <td class="after-col">Persists in git + files</td>
            </tr>
            <tr>
              <td><strong>Recoverability</strong></td>
              <td class="before-col">Start over if session dies</td>
              <td class="after-col">Resume from last commit</td>
            </tr>
            <tr>
              <td><strong>Verification</strong></td>
              <td class="before-col">Manual after each step</td>
              <td class="after-col">Automated (typecheck/test)</td>
            </tr>
            <tr>
              <td><strong>Errors</strong></td>
              <td class="before-col">Compound in context</td>
              <td class="after-col">Isolated to one iteration</td>
            </tr>
          </tbody>
        </table>

        <div class="checkpoint-box" style="margin-top: 32px;">
          <div class="checkpoint-title">
            <i data-lucide="trophy" class="w-4 h-4"></i>
            Transformation Complete
          </div>
          <div class="checkpoint-content">
            <strong>You've achieved:</strong><br>
            - AI works while you sleep<br>
            - Quality maintained throughout long tasks<br>
            - Progress compounding across iterations<br>
            - Recoverable state in git + files<br>
            - Human bottleneck removed<br><br>
            <strong>Next steps:</strong> Combine with other patterns (Compounding, Parallel, CC Mirror) to reach Level 4+ on the complexity ladder.
          </div>
        </div>
      </section>

    </main>

    <!-- Resizer between Main Panel and Activity Zone -->
    <div class="resizer" data-resizer="activity-zone" aria-label="Resize activity panel"></div>

    <!-- Activity Zone -->
    <aside class="activity-zone" id="activityZone">
      <div class="text-xs font-semibold text-text-muted uppercase tracking-wider mb-4">Operational Intelligence</div>

      <!-- ESSENCE SECTION -->
      <div class="activity-item inversion" data-section="essence">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you DIDN'T transform?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd get:</strong> 90 min engagement, quality degradation at 60%, forgotten decisions, frustration.<br>
          <strong>Why this fails:</strong> Context rot is physics. Fighting it wastes energy.<br>
          <strong>Hidden constraint:</strong> The transformation isn't optional for multi-hour work. It's architecturally required.
        </div>
      </div>

      <div class="activity-item minimal" data-section="essence">
        <div class="activity-label" style="color: #84cc16;">
          <i data-lucide="minimize-2" class="w-4 h-4"></i>
          Minimal Pattern
        </div>
        <div class="font-medium text-text-primary mb-2">The irreducible transformation</div>
        <div class="text-text-secondary text-sm">
          <code style="background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;">BEFORE: one session → AFTER: loop + files</code><br>
          <strong>Essential:</strong> Loop. Fresh context. External state.<br>
          <strong>Everything else:</strong> Refinement for reliability.
        </div>
      </div>

      <div class="activity-item warstory" data-section="essence">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Matt Pocock: "I don't babysit Claude anymore"</div>
        <div class="text-text-secondary text-sm">
          After adopting Ralph pattern, Matt reports setting up tasks before bed and waking to completed features. "The transformation changed my relationship with AI development."
        </div>
      </div>

      <!-- CORE SECTION -->
      <div class="activity-item gradient" data-section="core">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How single sessions degrade (invisibly)</div>
        <div class="text-text-secondary text-sm">
          <strong>100% to 90%</strong> (40-60K): Subtle drift, you won't notice<br>
          <strong>90% to 70%</strong> (60-80K): Repetition, compression<br>
          <strong>70% to 50%</strong> (80-100K): Instructions forgotten<br>
          <strong>50% to CLIFF</strong> (100K+): Hallucinations, amnesia<br><br>
          <em>Critical: The gradient is invisible until the cliff.</em>
        </div>
      </div>

      <div class="activity-item analogy" data-section="core">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Transformation = Going Stateless</div>
        <div class="text-text-secondary text-sm">
          Single session = Stateful server (holds state in memory, fails on restart)<br>
          Autonomous = Stateless server (state in database, survives restarts)<br>
          prd.json = Database table<br>
          progress.txt = Audit log<br><br>
          <em>If you've designed stateless web services, you already understand this transformation.</em>
        </div>
      </div>

      <div class="activity-item invariant" data-section="core">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">INV-002: External state > internal memory</div>
        <div class="text-text-secondary text-sm">
          Ralph, Gas Town, CC Mirror all share this invariant. The transformation embodies it: move memory from context (internal) to files (external). This is the same principle that makes microservices reliable.
        </div>
      </div>

      <!-- DECISIONS SECTION -->
      <div class="activity-item constraint" data-section="decisions">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">One constraint forces FIVE decisions</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Context finite (200K) and quality degrades<br>
          <span style="color: #8b5cf6;">→</span> Fresh context beats extended sessions<br>
          <span style="color: #8b5cf6;">→</span> State must persist externally<br>
          <span style="color: #8b5cf6;">→</span> Each iteration must be self-contained<br>
          <span style="color: #8b5cf6;">→</span> Tasks must complete in one context window<br>
          <span style="color: #8b5cf6;">→</span> Verification must be automatable
        </div>
      </div>

      <div class="activity-item violation" data-section="decisions">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip the transformation</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> You keep using single sessions for multi-hour work<br>
          <strong>THEN:</strong> Context degrades at 60-70%<br>
          <strong>THEN:</strong> Earlier decisions forgotten<br>
          <strong>THEN:</strong> Quality drops, contradictions emerge<br>
          <strong>FINALLY:</strong> Incomplete, buggy feature after 90 min frustration<br><br>
          <em>The transformation isn't optional. It's architecturally required.</em>
        </div>
      </div>

      <div class="activity-item tradeoff" data-section="decisions">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Upfront investment vs. time savings</div>
        <div class="text-text-secondary text-sm">
          <strong>Single session:</strong> Zero setup, but 90+ min engagement<br>
          <strong>Transformation:</strong> 30 min setup, but can sleep<br>
          <strong>Break-even:</strong> ~3 stories<br><br>
          <em>Below 3 stories, single session wins. Above 3, transformation compounds.</em>
        </div>
      </div>

      <div class="activity-item horizon" data-section="decisions">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How perception changes over attempts</div>
        <div class="text-text-secondary text-sm">
          <strong>First transformation:</strong> "This setup is tedious"<br>
          <strong>Second transformation:</strong> "Oh, I can reuse most of this"<br>
          <strong>Third transformation:</strong> "Setup takes 10 minutes now"<br>
          <strong>After 10:</strong> "I can't imagine going back to single sessions"<br><br>
          <em>Don't judge the transformation by your first attempt.</em>
        </div>
      </div>

      <!-- FILES SECTION -->
      <div class="activity-item expertise" data-section="files">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How deep is your understanding?</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "What files do I need?" - The 4 files<br>
          <strong>Intermediate:</strong> "Why these files?" - Each serves ONE purpose<br>
          <strong>Advanced:</strong> "What's minimal?" - Just loop + prompt<br>
          <strong>Staff:</strong> "When add more?" - Dr. Ralph, HOTL gates<br>
          <strong>Expert:</strong> "Cross-pattern?" - prd.json = Gas Town inbox
        </div>
      </div>

      <div class="activity-item composition" data-section="files">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Transformation + Playwright</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Visual verification catches UI bugs that typecheck/test miss.<br>
          <strong>Danger:</strong> Browser context consumes tokens. Put Playwright in subagents to protect main context.<br>
          <strong>Recommendation:</strong> Use for UI stories only, not every task.
        </div>
      </div>

      <div class="activity-item analogy" data-section="files">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Cross-Pattern Equivalence
        </div>
        <div class="font-medium text-text-primary mb-2">prd.json = Gas Town Inbox</div>
        <div class="text-text-secondary text-sm">
          <strong>YOU</strong> = The Mayor (orchestrator)<br>
          <strong>prd.json</strong> = The Inbox (work queue)<br>
          <strong>progress.txt</strong> = The Refinery (persistent memory)<br>
          <strong>Each Claude iteration</strong> = A Polecat (stateless worker)<br><br>
          <em>The transformation follows the same architecture as Gas Town.</em>
        </div>
      </div>

      <div class="activity-item inversion" data-section="files">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if progress.txt didn't exist?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd get:</strong> Each iteration relearns everything. Same mistakes repeated. No velocity increase.<br>
          <strong>Why this fails:</strong> Learnings don't compound. Iteration 20 is as slow as iteration 1.<br>
          <strong>Hidden value:</strong> progress.txt IS the compounding mechanism.
        </div>
      </div>

      <!-- PATH SECTION -->
      <div class="activity-item effect" data-section="path">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="bar-chart-2" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">Learnings compound across iterations</div>
        <div class="text-text-secondary text-sm">
          At iteration 1, Claude knows nothing about your codebase.<br>
          At iteration 5, progress.txt contains patterns Claude can reuse.<br>
          At iteration 10, Claude knows your conventions, your gotchas, your preferences.<br><br>
          <strong>This only happens with external state.</strong>
        </div>
      </div>

      <div class="activity-item violation" data-section="path">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip verification step</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> You skip "run typecheck and tests"<br>
          <strong>THEN:</strong> Claude marks tasks done without verification<br>
          <strong>THEN:</strong> Broken code enters git<br>
          <strong>THEN:</strong> Future iterations inherit broken foundation<br>
          <strong>FINALLY:</strong> Morning reveals 20 bad commits<br><br>
          <em>One unverified task at iteration 5 poisons iterations 6-20.</em>
        </div>
      </div>

      <div class="activity-item warstory" data-section="path">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Ryan Carson: 14 iterations, ~$10-15</div>
        <div class="text-text-secondary text-sm">
          Untangle Legal Agent. 6 user stories, ran overnight. "Learnings compound. By story 10, Ralph knew our patterns." The progress.txt paid off in later iterations.
        </div>
      </div>

      <!-- GOTCHAS SECTION -->
      <div class="activity-item inflection" data-section="gotchas">
        <div class="activity-label" style="color: #eab308;">
          <i data-lucide="activity" class="w-4 h-4"></i>
          Inflection Point
        </div>
        <div class="font-medium text-text-primary mb-2">When progress.txt flips from help to hurt</div>
        <div class="text-text-secondary text-sm">
          <strong>0-10KB:</strong> Pure benefit (learnings compound)<br>
          <strong>10-20KB:</strong> Diminishing returns (more to read)<br>
          <strong>20-30KB:</strong> Neutral (reading cost = thinking benefit)<br>
          <strong>30KB+:</strong> Net negative (context wasted on history)<br><br>
          <strong>THE INFLECTION:</strong> ~20KB<br>
          <em>Detection: Late iterations worse than early? Check file size.</em>
        </div>
      </div>

      <div class="activity-item gradient" data-section="gotchas">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How stuck loops degrade</div>
        <div class="text-text-secondary text-sm">
          <strong>Attempt 1:</strong> Task fails, Claude tries to fix<br>
          <strong>Attempt 2:</strong> Different approach, still fails<br>
          <strong>Attempt 3:</strong> Similar to attempt 1 (memory lost)<br>
          <strong>Attempts 4+:</strong> Cycling through same failures<br><br>
          <em>Detection: Same story for 3+ iterations. Fix: Split or add dependency.</em>
        </div>
      </div>

      <div class="activity-item frontier" data-section="gotchas">
        <div class="activity-label" style="color: #ef4444;">
          <i data-lucide="flask-conical" class="w-4 h-4"></i>
          Research Frontier
        </div>
        <div class="font-medium text-text-primary mb-2">UNSOLVED: Optimal story size</div>
        <div class="text-text-secondary text-sm">
          <strong>The question:</strong> What's the optimal story size for transformation? 5 min? 10 min? 30 min?<br>
          <strong>Why it's hard:</strong> Varies by codebase, task type, and Claude model.<br>
          <strong>Current best practice:</strong> Heuristic: if description > code change, too small. If >5 acceptance criteria, too big.
        </div>
      </div>

      <div class="activity-item constraint" data-section="gotchas">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Why progress.txt must be append-only</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Each iteration has no memory of what it wrote<br>
          <span style="color: #8b5cf6;">→</span> If Claude "updates" it rewrites everything<br>
          <span style="color: #8b5cf6;">→</span> Previous learnings lost<br>
          <span style="color: #8b5cf6;">→</span> Same mistakes repeated<br>
          <span style="color: #8b5cf6;">→</span> No compounding<br><br>
          <em>Fix: Use CAPS "APPEND" in prompt. The capitalization matters.</em>
        </div>
      </div>

      <!-- HARD SECTION -->
      <div class="activity-item tradeoff" data-section="hard">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Context Rot vs. Memory Loss</div>
        <div class="text-text-secondary text-sm">
          <strong>THE DILEMMA:</strong><br>
          - Extended session: Rich context, but quality degrades at 80K<br>
          - Fresh context: Peak quality, but must reconstruct state<br><br>
          <strong>WHY NO PERFECT ANSWER:</strong><br>
          progress.txt is lossy. Each iteration "forgets" 90% of the prior.<br><br>
          <em>Accept that fresh > rot. Invest in better hygiene, not longer sessions.</em>
        </div>
      </div>

      <div class="activity-item expertise" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Task Decomposition Understanding</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "How small should tasks be?" - Fit in one context<br>
          <strong>Intermediate:</strong> "What's too small?" - When description > code change<br>
          <strong>Advanced:</strong> "How do I improve?" - Review progress.txt after runs<br>
          <strong>Staff:</strong> "Is there a formula?" - No. It's a skill, not a formula.<br>
          <strong>Expert:</strong> "Invisible errors?" - Tasks with hidden dependencies
        </div>
      </div>

      <div class="activity-item warstory" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Molly Cantillon: Personal Panopticon</div>
        <div class="text-text-secondary text-sm">
          8 parallel transformed loops managing different life domains. "The transformation scaled. Now I run 8 Ralph instances for different concerns. Each has its own prd.json. State never crosses boundaries."
        </div>
      </div>

      <div class="activity-item horizon" data-section="hard">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How task decomposition skill develops</div>
        <div class="text-text-secondary text-sm">
          <strong>Week 1:</strong> "I keep making tasks too big"<br>
          <strong>Week 2:</strong> "Now I'm making them too small"<br>
          <strong>Week 4:</strong> "Starting to find the balance"<br>
          <strong>Month 2:</strong> "I can size tasks instinctively now"<br><br>
          <em>Expect 4-6 weeks to develop this skill.</em>
        </div>
      </div>

      <!-- WHEN SECTION -->
      <div class="activity-item inversion" data-section="when">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you transformed a 15-min task?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd spend:</strong> 30 min on setup for 15 min of work.<br>
          <strong>Why this fails:</strong> Setup overhead exceeds task length.<br>
          <strong>Hidden insight:</strong> The 30-min threshold exists because that's where setup ROI becomes positive.
        </div>
      </div>

      <div class="activity-item alternative" data-section="when">
        <div class="activity-label" style="color: #6b7280;">
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
          Alternative Paths
        </div>
        <div class="font-medium text-text-primary mb-2">If transformation isn't right</div>
        <div class="text-text-secondary text-sm">
          <strong>Task &lt;30 min?</strong> - Single Claude session<br>
          <strong>Subjective quality?</strong> - HOTL Ralph (human gates)<br>
          <strong>Need parallelism?</strong> - CC Mirror<br>
          <strong>Exploratory work?</strong> - Single session with human guidance<br>
          <strong>Security-critical?</strong> - Human review required
        </div>
      </div>

      <div class="activity-item composition" data-section="when">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Transformation + HOTL</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Human reviews every N iterations or at story boundaries.<br>
          <strong>When to use:</strong> Security-sensitive code, unfamiliar codebases, learning task decomposition.<br>
          <strong>The pattern:</strong> Not fully autonomous, but preserves fresh context benefits.
        </div>
      </div>

      <div class="activity-item invariant" data-section="when">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">INV-004: Verification as trust boundary</div>
        <div class="text-text-secondary text-sm">
          All patterns (Ralph, Gas Town, CC Mirror) require verification gates. The transformation only works because <code>npm run typecheck && npm test</code> provides automated verification. Without verification, garbage compounds.
        </div>
      </div>

      <div class="activity-item effect" data-section="when">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="bar-chart-2" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">At scale: compound velocity</div>
        <div class="text-text-secondary text-sm">
          After 10+ transformations, you have:<br>
          - Reusable prd.json templates<br>
          - Refined ralph.sh with your improvements<br>
          - Pattern library in progress.txt archives<br>
          - Intuitive task sizing skill<br><br>
          <strong>Setup time drops from 30 min to 10 min.</strong> The transformation itself compounds.
        </div>
      </div>

    </aside>
  </div>

  <script>
    /**
     * PanelResizer - Handles draggable panel dividers
     */
    class PanelResizer {
      constructor(resizerEl, config = {}) {
        this.resizer = resizerEl;
        this.config = {
          storageKey: 'panel-activity-zone-width',
          minWidth: 280,
          maxWidth: 900,
          defaultWidth: 480,
          ...config
        };

        this.isResizing = false;
        this.startX = 0;
        this.startWidth = 0;

        // Elements
        this.activityZone = document.querySelector('.activity-zone');
        this.mainContent = document.querySelector('.main-content');

        // Bind methods
        this.onMouseDown = this.onMouseDown.bind(this);
        this.onMouseMove = this.onMouseMove.bind(this);
        this.onMouseUp = this.onMouseUp.bind(this);

        this.init();
      }

      init() {
        this.restoreWidth();
        this.resizer.addEventListener('mousedown', this.onMouseDown);
      }

      onMouseDown(e) {
        if (e.button !== 0) return;

        this.isResizing = true;
        this.startX = e.clientX;
        this.startWidth = this.activityZone.offsetWidth;

        this.resizer.classList.add('active');
        document.body.classList.add('resizing');

        document.addEventListener('mousemove', this.onMouseMove);
        document.addEventListener('mouseup', this.onMouseUp);

        e.preventDefault();
      }

      onMouseMove(e) {
        if (!this.isResizing) return;

        const delta = this.startX - e.clientX;
        const newWidth = this.startWidth + delta;

        const constrainedWidth = Math.max(
          this.config.minWidth,
          Math.min(this.config.maxWidth, newWidth)
        );

        this.activityZone.style.width = constrainedWidth + 'px';
        this.mainContent.style.marginRight = constrainedWidth + 'px';
        this.resizer.style.right = constrainedWidth + 'px';
      }

      onMouseUp(e) {
        if (!this.isResizing) return;

        this.isResizing = false;

        this.resizer.classList.remove('active');
        document.body.classList.remove('resizing');

        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);

        this.saveWidth();
      }

      saveWidth() {
        const width = this.activityZone.offsetWidth;
        localStorage.setItem(this.config.storageKey, JSON.stringify({
          width,
          timestamp: Date.now()
        }));
      }

      restoreWidth() {
        try {
          const stored = localStorage.getItem(this.config.storageKey);
          if (stored) {
            const { width } = JSON.parse(stored);
            if (width >= this.config.minWidth && width <= this.config.maxWidth) {
              this.activityZone.style.width = width + 'px';
              this.mainContent.style.marginRight = width + 'px';
              this.resizer.style.right = width + 'px';
            }
          }
        } catch (e) {
          console.warn('Failed to restore panel width:', e);
        }
      }

      destroy() {
        this.resizer.removeEventListener('mousedown', this.onMouseDown);
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);
      }
    }

    // Auto-initialize resizers on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      const resizers = document.querySelectorAll('[data-resizer]');
      resizers.forEach(resizer => new PanelResizer(resizer));
    });

    // Initialize Lucide icons
    lucide.createIcons();

    // Navigation toggle
    function toggleSection(header) {
      const section = header.closest('.nav-section');
      section.classList.toggle('expanded');
      const children = section.querySelector('.nav-children');
      children.classList.toggle('expanded');
    }

    // Mobile menu toggle
    function toggleMobileMenu() {
      const nav = document.getElementById('leftNav');
      nav.classList.toggle('open');
    }

    // Copy functionality
    function copyCode(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> Copied!';
        lucide.createIcons();
        setTimeout(() => {
          btn.innerHTML = originalText;
          lucide.createIcons();
        }, 2000);
      });
    }

    function copyCodeBlock(btn) {
      const codeBlock = btn.closest('.code-block');
      const pre = codeBlock.querySelector('pre');
      const text = pre.textContent;
      copyCode(btn, text);
    }

    // Scroll-sync with GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    // Track which sections are in view
    const sections = document.querySelectorAll('[data-activity]');
    const activityItems = document.querySelectorAll('.activity-item');

    sections.forEach(section => {
      ScrollTrigger.create({
        trigger: section,
        start: 'top 40%',
        end: 'bottom 40%',
        onEnter: () => activateSection(section.dataset.activity),
        onEnterBack: () => activateSection(section.dataset.activity),
      });
    });

    function activateSection(sectionName) {
      activityItems.forEach(item => {
        if (item.dataset.section === sectionName) {
          item.classList.add('active');
          gsap.to(item, {
            opacity: 1,
            y: -2,
            boxShadow: '0 4px 12px rgba(0,0,0,0.08)',
            duration: 0.3,
            ease: 'power2.out'
          });
        } else {
          item.classList.remove('active');
          gsap.to(item, {
            opacity: 0.5,
            y: 0,
            boxShadow: 'none',
            duration: 0.3,
            ease: 'power2.out'
          });
        }
      });

      // Update nav active state
      document.querySelectorAll('.nav-section-header').forEach(header => {
        header.classList.remove('active');
      });
      const activeNav = document.querySelector(`[data-section="${sectionName}"] .nav-section-header`);
      if (activeNav) {
        activeNav.classList.add('active');
      }
    }

    // Initialize first section as active
    activateSection('essence');

    // Smooth scroll for nav links
    document.querySelectorAll('.nav-item').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const target = document.querySelector(link.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('active'));
          link.classList.add('active');
        }
      });
    });

    // Brushing interaction - hover activity item highlights related content
    activityItems.forEach(item => {
      item.addEventListener('mouseenter', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = 'rgba(13, 147, 115, 0.05)';
          relatedSection.style.transition = 'background-color 0.3s ease';
        }
      });

      item.addEventListener('mouseleave', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = '';
        }
      });
    });
  </script>
</body>
</html>
