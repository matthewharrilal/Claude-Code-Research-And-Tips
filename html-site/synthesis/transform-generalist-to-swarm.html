<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generalist to Swarm Transformation | Claude Code Documentation</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- GSAP for scroll-sync -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <!-- Tailwind Config with Design Tokens -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'bg-base': '#ffffff',
            'bg-subtle': '#fafafa',
            'bg-muted': '#f4f4f5',
            'text-primary': '#18181b',
            'text-secondary': '#3f3f46',
            'text-muted': '#71717a',
            'accent': '#0D9373',
            'accent-light': '#10b981',
            'accent-bg': '#ecfdf5',
            'border': '#e4e4e7',
            // Activity Zone content type colors (Original 6)
            'az-invariant': '#3b82f6',    // Blue
            'az-effect': '#f59e0b',       // Amber
            'az-composition': '#8b5cf6',  // Purple
            'az-frontier': '#ef4444',     // Red
            'az-warstory': '#10b981',     // Green
            'az-alternative': '#6b7280',  // Gray
            // Activity Zone generative content types (New 10)
            'az-inversion': '#4f46e5',    // Indigo
            'az-constraint': '#8b5cf6',   // Violet
            'az-gradient': '#f43f5e',     // Rose
            'az-horizon': '#06b6d4',      // Cyan
            'az-violation': '#f97316',    // Orange
            'az-tradeoff': '#f59e0b',     // Amber
            'az-analogy': '#d946ef',      // Fuchsia
            'az-expertise': '#10b981',    // Emerald
            'az-minimal': '#84cc16',      // Lime
            'az-inflection': '#eab308',   // Yellow
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Fira Code', 'monospace'],
          },
        },
      },
    }
  </script>

  <style>
    /* Base Styles */
    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
    }

    [id] {
      scroll-margin-top: 80px;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: #ffffff;
      color: #18181b;
      line-height: 1.7;
    }

    /* Three Panel Layout */
    .three-panel-layout {
      min-height: 100vh;
      position: relative;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: #ffffff;
      border-bottom: 1px solid #e4e4e7;
      z-index: 100;
      display: flex;
      align-items: center;
      padding: 0 24px;
    }

    /* Left Navigation - 240px fixed */
    .left-nav {
      position: fixed;
      top: 56px;
      left: 0;
      width: 240px;
      height: calc(100vh - 56px);
      border-right: 1px solid #e4e4e7;
      background: #ffffff;
      overflow-y: auto;
      padding: 16px 0;
      z-index: 40;
    }

    .nav-section {
      padding: 0 12px;
      margin-bottom: 8px;
    }

    .nav-section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      font-size: 14px;
      font-weight: 500;
      color: #3f3f46;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
    }

    .nav-section-header:hover {
      background: #f4f4f5;
    }

    .nav-section-header.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-item {
      display: block;
      padding: 6px 12px 6px 44px;
      font-size: 14px;
      color: #71717a;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.15s;
    }

    .nav-item:hover {
      color: #3f3f46;
      background: #f4f4f5;
    }

    .nav-item.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-children {
      display: none;
      overflow: hidden;
    }

    .nav-children.expanded {
      display: block;
    }

    .nav-chevron {
      transition: transform 0.2s;
    }

    .nav-section.expanded .nav-chevron {
      transform: rotate(90deg);
    }

    /* Main Content - Flexible, margins for fixed sidebars */
    .main-content {
      margin-left: 240px;
      margin-right: 480px;
      margin-top: 56px;
      padding: 48px 48px;
      min-width: 400px;
    }

    /* Activity Zone - 480px fixed */
    .activity-zone {
      position: fixed;
      top: 56px;
      right: 0;
      width: 480px;
      height: calc(100vh - 56px);
      border-left: 1px dashed #e4e4e7;
      background: #fafafa;
      overflow-y: auto;
      padding: 24px 20px;
      z-index: 40;
    }

    /* Responsive: Hide Activity Zone below 1400px */
    @media (max-width: 1400px) {
      .activity-zone {
        display: none;
      }
      .main-content {
        margin-right: 0;
        padding: 40px 32px;
      }
    }

    /* Responsive: Hide Left Nav below 768px */
    @media (max-width: 768px) {
      .left-nav {
        display: none;
      }
      .left-nav.open {
        display: block;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        z-index: 50;
        overflow-y: auto;
      }
      .main-content {
        margin-left: 0;
        padding: 24px 16px;
        min-width: auto;
      }
    }

    /* Resizer */
    .resizer {
      position: fixed;
      top: 56px;
      right: 480px;
      width: 6px;
      height: calc(100vh - 56px);
      cursor: col-resize;
      background: transparent;
      z-index: 50;
      transition: background 0.15s ease;
    }

    .resizer:hover {
      background: rgba(13, 147, 115, 0.15);
    }

    .resizer.active {
      background: rgba(13, 147, 115, 0.25);
    }

    body.resizing {
      user-select: none;
      cursor: col-resize !important;
    }

    body.resizing * {
      cursor: col-resize !important;
    }

    @media (max-width: 1400px) {
      .resizer {
        display: none;
      }
    }

    /* Activity Zone Items */
    .activity-item {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      background: #ffffff;
      border: 1px solid #e4e4e7;
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.5;
      transition: all 0.3s ease;
    }

    .activity-item.active {
      opacity: 1;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .activity-item:hover {
      opacity: 1;
    }

    .activity-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Activity Zone content type borders */
    .activity-item.invariant { border-left: 4px solid #3b82f6; }
    .activity-item.effect { border-left: 4px solid #f59e0b; }
    .activity-item.composition { border-left: 4px solid #8b5cf6; }
    .activity-item.frontier { border-left: 4px solid #ef4444; }
    .activity-item.warstory { border-left: 4px solid #10b981; }
    .activity-item.alternative { border-left: 4px solid #6b7280; }
    .activity-item.inversion { border-left: 4px solid #4f46e5; }
    .activity-item.constraint { border-left: 4px solid #8b5cf6; }
    .activity-item.gradient { border-left: 4px solid #f43f5e; }
    .activity-item.horizon { border-left: 4px solid #06b6d4; }
    .activity-item.violation { border-left: 4px solid #f97316; }
    .activity-item.tradeoff { border-left: 4px solid #f59e0b; }
    .activity-item.analogy { border-left: 4px solid #d946ef; }
    .activity-item.expertise { border-left: 4px solid #10b981; }
    .activity-item.minimal { border-left: 4px solid #84cc16; }
    .activity-item.inflection { border-left: 4px solid #eab308; }

    /* Main Content Components */
    .section-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background: #0D9373;
      color: #ffffff;
      font-size: 14px;
      font-weight: 600;
      border-radius: 50%;
      margin-right: 12px;
    }

    .section-title {
      font-size: 24px;
      font-weight: 600;
      color: #18181b;
      margin-bottom: 20px;
      margin-top: 56px;
      display: flex;
      align-items: center;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    /* Essence Box */
    .essence-box {
      background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 40px;
    }

    .essence-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #10b981;
      margin-bottom: 12px;
    }

    .essence-text {
      font-size: 22px;
      font-weight: 500;
      color: #ffffff;
      line-height: 1.4;
    }

    /* Core Abstraction Box */
    .core-abstraction {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .core-philosophy {
      font-size: 16px;
      color: #3f3f46;
      margin-bottom: 16px;
      font-style: italic;
    }

    .core-code {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 16px;
      overflow-x: auto;
    }

    .core-code code {
      font-family: 'Fira Code', monospace;
      font-size: 15px;
      color: #10b981;
      white-space: nowrap;
    }

    .core-anchor {
      font-size: 14px;
      color: #71717a;
      text-align: center;
    }

    /* Design Decision Box */
    .decision-box {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .decision-why {
      font-size: 16px;
      font-weight: 600;
      color: #0D9373;
      margin-bottom: 12px;
    }

    .decision-reasoning {
      font-size: 14px;
      color: #3f3f46;
      margin-bottom: 16px;
    }

    .decision-implication {
      background: #f4f4f5;
      border-radius: 8px;
      padding: 16px;
    }

    .decision-implication-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: #71717a;
      margin-bottom: 8px;
    }

    /* Code Blocks */
    .code-block {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 24px;
      position: relative;
      overflow-x: auto;
    }

    .code-block pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #e4e4e7;
      line-height: 1.6;
    }

    .code-block .comment { color: #6b7280; }
    .code-block .keyword { color: #c084fc; }
    .code-block .string { color: #10b981; }
    .code-block .variable { color: #60a5fa; }

    .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #3f3f46;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s;
    }

    .copy-btn:hover {
      background: #52525b;
    }

    /* Path Steps */
    .path-container {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .path-step {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }

    .path-step:last-child {
      margin-bottom: 0;
    }

    .path-number {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      background: #0D9373;
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .path-content {
      flex: 1;
      font-size: 14px;
      color: #3f3f46;
    }

    .path-content code {
      background: #e4e4e7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
    }

    /* Gotcha Box */
    .gotcha-box {
      background: #fffbeb;
      border: 1px solid #fcd34d;
      border-left: 4px solid #f59e0b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .gotcha-title {
      font-weight: 600;
      color: #92400e;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .gotcha-detail {
      font-size: 14px;
      color: #78350f;
      margin-bottom: 8px;
    }

    .gotcha-detail strong {
      color: #92400e;
    }

    /* What's Hard Box */
    .hard-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-left: 4px solid #ef4444;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .hard-title {
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hard-detail {
      font-size: 14px;
      color: #7f1d1d;
      margin-bottom: 8px;
    }

    /* When To Use Grid */
    .when-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 40px;
    }

    @media (max-width: 900px) {
      .when-grid {
        grid-template-columns: 1fr;
      }
    }

    .when-use {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 24px;
    }

    .when-not {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 24px;
    }

    .when-title {
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .when-use .when-title { color: #166534; }
    .when-not .when-title { color: #991b1b; }

    .when-item {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 14px;
    }

    .when-use .when-item { color: #166534; }
    .when-not .when-item { color: #991b1b; }

    /* Comparison Table */
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 32px;
      font-size: 14px;
    }

    .comparison-table th,
    .comparison-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #e4e4e7;
    }

    .comparison-table th {
      background: #f4f4f5;
      font-weight: 600;
      color: #18181b;
    }

    .comparison-table td {
      color: #3f3f46;
    }

    .comparison-table tr:hover td {
      background: #fafafa;
    }

    /* Architecture Diagram */
    .architecture-diagram {
      background: #18181b;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 32px;
      overflow-x: auto;
    }

    .architecture-diagram pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: #e4e4e7;
      line-height: 1.4;
    }

    /* Quality Bar */
    .quality-bar {
      background: #f4f4f5;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .quality-label {
      font-size: 13px;
      font-weight: 500;
      color: #3f3f46;
      margin-bottom: 8px;
    }

    .quality-track {
      height: 8px;
      background: #e4e4e7;
      border-radius: 4px;
      overflow: hidden;
    }

    .quality-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .quality-fill.low { background: #ef4444; }
    .quality-fill.medium { background: #f59e0b; }
    .quality-fill.high { background: #10b981; }

    /* Anti-pattern Box */
    .antipattern-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .antipattern-header {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 8px;
    }

    .antipattern-bad {
      background: #fecaca;
      padding: 8px 12px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #991b1b;
      margin-bottom: 8px;
    }

    .antipattern-good {
      background: #bbf7d0;
      padding: 8px 12px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #166534;
    }

    /* Checkpoint Box */
    .checkpoint-box {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-left: 4px solid #10b981;
      border-radius: 8px;
      padding: 20px;
      margin: 32px 0;
    }

    .checkpoint-title {
      font-weight: 600;
      color: #166534;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .checkpoint-detail {
      font-size: 14px;
      color: #166534;
      margin-bottom: 8px;
    }

    /* Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      padding: 8px;
      background: none;
      border: none;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .mobile-menu-btn {
        display: flex;
      }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #fafafa;
    }

    ::-webkit-scrollbar-thumb {
      background: #d4d4d8;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1aa;
    }

    /* Keyboard shortcut hint */
    .kbd {
      display: inline-flex;
      align-items: center;
      padding: 2px 6px;
      background: #f4f4f5;
      border: 1px solid #e4e4e7;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: #71717a;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
      <i data-lucide="menu" class="w-5 h-5 text-text-secondary"></i>
    </button>
    <div class="flex items-center gap-3">
      <i data-lucide="terminal" class="w-5 h-5 text-accent"></i>
      <span class="font-semibold text-text-primary">Claude Code</span>
    </div>
    <div class="flex-1 flex justify-center">
      <button class="flex items-center gap-2 px-4 py-2 bg-bg-muted rounded-lg text-text-muted text-sm hover:bg-border transition-colors">
        <i data-lucide="search" class="w-4 h-4"></i>
        <span>Search documentation...</span>
        <span class="kbd">Cmd+K</span>
      </button>
    </div>
    <div class="flex items-center gap-4">
      <a href="#" class="text-sm text-text-muted hover:text-text-primary transition-colors">Support</a>
      <button class="p-2 hover:bg-bg-muted rounded-lg transition-colors" aria-label="Toggle theme">
        <i data-lucide="sun" class="w-4 h-4 text-text-muted"></i>
      </button>
    </div>
  </header>

  <div class="three-panel-layout">
    <!-- Left Navigation -->
    <nav class="left-nav" id="leftNav">
      <div class="px-4 mb-4">
        <span class="text-xs font-semibold text-text-muted uppercase tracking-wider">Generalist to Swarm</span>
      </div>

      <!-- Essence -->
      <div class="nav-section expanded" data-section="essence">
        <div class="nav-section-header active" onclick="toggleSection(this)">
          <i data-lucide="zap" class="w-4 h-4"></i>
          <span>Essence</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#essence" class="nav-item active">The 15-Word Summary</a>
        </div>
      </div>

      <!-- Core Abstraction -->
      <div class="nav-section expanded" data-section="core">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="box" class="w-4 h-4"></i>
          <span>Core Abstraction</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#core-abstraction" class="nav-item">The Paradigm Shift</a>
          <a href="#before-after" class="nav-item">Before vs After</a>
        </div>
      </div>

      <!-- Design Decisions -->
      <div class="nav-section expanded" data-section="decisions">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="lightbulb" class="w-4 h-4"></i>
          <span>Design Decisions</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children expanded">
          <a href="#why-specialization" class="nav-item">Why Specialization?</a>
          <a href="#why-parallelism" class="nav-item">Why Parallelism?</a>
          <a href="#why-orchestrator" class="nav-item">Why Orchestrator?</a>
        </div>
      </div>

      <!-- Implementation -->
      <div class="nav-section" data-section="implementation">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="folder" class="w-4 h-4"></i>
          <span>Implementation</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#orchestrator-prompt" class="nav-item">Orchestrator Prompt</a>
          <a href="#worker-preambles" class="nav-item">Worker Preambles</a>
          <a href="#execution-patterns" class="nav-item">Execution Patterns</a>
        </div>
      </div>

      <!-- Path of a Task -->
      <div class="nav-section" data-section="path">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="git-branch" class="w-4 h-4"></i>
          <span>Path of a Task</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#path" class="nav-item">Orchestrator Flow</a>
        </div>
      </div>

      <!-- Gotchas -->
      <div class="nav-section" data-section="gotchas">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="alert-triangle" class="w-4 h-4"></i>
          <span>Gotchas</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#gotchas" class="nav-item">Common Problems</a>
          <a href="#antipatterns" class="nav-item">Anti-Patterns</a>
        </div>
      </div>

      <!-- What's Hard -->
      <div class="nav-section" data-section="hard">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="flame" class="w-4 h-4"></i>
          <span>What's Hard</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#hard" class="nav-item">Real Complexity</a>
        </div>
      </div>

      <!-- When to Use -->
      <div class="nav-section" data-section="when">
        <div class="nav-section-header" onclick="toggleSection(this)">
          <i data-lucide="check-circle" class="w-4 h-4"></i>
          <span>When to Use</span>
          <i data-lucide="chevron-right" class="w-4 h-4 nav-chevron ml-auto"></i>
        </div>
        <div class="nav-children">
          <a href="#when" class="nav-item">Decision Criteria</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Replace context-diluted generalist with focused domain specialists coordinated by a non-coding orchestrator.</div>
        </div>

        <p class="text-text-secondary mb-6">
          <strong>You Are Here:</strong> This document shows how to evolve from a single agent doing everything (poorly) to specialized workers doing their domains excellently. If your full-stack features have inconsistent quality or take forever due to context dilution, the swarm pattern solves this.
        </p>

        <p class="text-text-secondary mb-6">
          This connects to Level 5-6 (CC Mirror Hub-and-Spoke) on the complexity ladder and enables true parallel execution with domain expertise.
        </p>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Abstraction
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"Single context tries to be everything. Domain specialists excel at one thing."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'Orchestrator (coordinates) + Workers (execute) = Swarm')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>Orchestrator (coordinates) + Workers (execute) = Swarm</code>
          </div>

          <div class="core-anchor">The orchestrator never touches code. Workers never spawn subworkers. That's the iron law.</div>
        </div>

        <p class="text-text-secondary mb-6">
          The transformation is from single-context generalist to orchestrated domain specialists. Instead of one Claude instance handling database, API, frontend, and tests sequentially (with context dilution killing quality by the end), you have dedicated workers for each domain running in parallel.
        </p>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="before-after">The Before and After</h3>

        <!-- Before: Generalist -->
        <div class="architecture-diagram">
          <pre>
BEFORE: GENERALIST AGENT (Single Instance)
========================================

Context Window (filling up...)
┌─────────────────────────────────────────────────────┐
│ DB schema design decisions...                        │
│ SQL migration syntax...                              │
│ API route patterns...                                │
│ JWT token implementation...                          │
│ React component structure...                         │
│ Form validation patterns...                          │
│ Test setup boilerplate...                           │
│ Mock configuration...                                │
│ [CONTEXT GETTING CROWDED]                           │
└─────────────────────────────────────────────────────┘

Execution: Sequential
Step 1: Design schema          [45 min]
Step 2: Write migrations       [30 min]
Step 3: Implement API          [60 min]
Step 4: Build UI components    [45 min]
Step 5: Write tests            [60 min]
─────────────────────────────────────
Total:                         [240 min = 4 hours]
          </pre>
        </div>

        <!-- After: Swarm -->
        <div class="architecture-diagram">
          <pre>
AFTER: SPECIALIZED SWARM (CC Mirror Pattern)
============================================

           ┌─────────────────────────────────┐
           │       ORCHESTRATOR              │
           │       (Opus 4.5)                │
           │                                 │
           │  "I coordinate. I never code."  │
           │                                 │
           │  Tools: Task*, Read (minimal)   │
           └─────────────┬───────────────────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                │
        ▼                ▼                ▼
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│  BACKEND    │  │  FRONTEND   │  │   TEST      │
│  WORKER     │  │  WORKER     │  │   WORKER    │
│  (Sonnet)   │  │  (Sonnet)   │  │  (Haiku)    │
│             │  │             │  │             │
│ DB schema   │  │ UI comps    │  │ Integration │
│ Migrations  │  │ Forms       │  │ tests       │
│ API routes  │  │ Auth ctx    │  │ E2E tests   │
└─────────────┘  └─────────────┘  └─────────────┘

Execution:
├── Backend Worker    ████████░░  [60 min]
├── Frontend Worker   ████████░░  [45 min] (parallel after APIs)
└── Test Worker       ██████░░░░  [30 min] (after both complete)
─────────────────────────────────────────
Total Wall Clock:     [~90 min with dependencies]
          </pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">Quality Distribution Comparison</h3>

        <div class="quality-bar">
          <div class="quality-label">Database (Generalist): 40%</div>
          <div class="quality-track">
            <div class="quality-fill low" style="width: 40%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">Database (Swarm): 85%</div>
          <div class="quality-track">
            <div class="quality-fill high" style="width: 85%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">API (Generalist): 50%</div>
          <div class="quality-track">
            <div class="quality-fill medium" style="width: 50%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">API (Swarm): 80%</div>
          <div class="quality-track">
            <div class="quality-fill high" style="width: 80%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">Frontend (Generalist): 30%</div>
          <div class="quality-track">
            <div class="quality-fill low" style="width: 30%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">Frontend (Swarm): 75%</div>
          <div class="quality-track">
            <div class="quality-fill high" style="width: 75%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">Tests (Generalist): 20%</div>
          <div class="quality-track">
            <div class="quality-fill low" style="width: 20%;"></div>
          </div>
        </div>

        <div class="quality-bar">
          <div class="quality-label">Tests (Swarm): 80%</div>
          <div class="quality-track">
            <div class="quality-fill high" style="width: 80%;"></div>
          </div>
        </div>

        <p class="text-text-muted text-sm mt-4 mb-8">
          <strong>Generalist average: 35%</strong> | <strong>Swarm average: 80%</strong><br>
          Tests suffer most in generalist mode because they come last, when context is most crowded.
        </p>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-specialization" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Design Decisions
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY SPECIALIZATION?</div>
          <div class="decision-reasoning">
            Each worker loads only relevant patterns. A backend worker doesn't pollute its context with React component patterns. A test worker doesn't carry API implementation details. Fresh, focused contexts outperform crowded, diluted ones.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Design worker prompts with explicit scope boundaries. "You handle /src/api/** ONLY. Do NOT touch /src/components/**." The boundaries aren't bureaucracy - they're what makes specialization work.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-parallelism">
          <div class="decision-why">WHY PARALLELISM?</div>
          <div class="decision-reasoning">
            Wall-clock time matters for human productivity. 4 hours sequential means you wait all afternoon. 90 minutes parallel (with dependencies) means you're reviewing code after lunch. The productivity gain isn't theoretical - it's hours back in your day.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Identify which tasks can run in parallel (no dependencies) vs sequential (blocked by others). Use <code>run_in_background: true</code> for parallel tasks. Don't serialize work that doesn't need serialization.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-orchestrator">
          <div class="decision-why">WHY A NON-CODING ORCHESTRATOR?</div>
          <div class="decision-reasoning">
            If the orchestrator starts writing code, it stops being an orchestrator. It becomes just another generalist with extra complexity. The orchestrator's only job is coordination: spawn workers, track completion, synthesize results. This separation is what makes swarms manageable.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Enforce the iron law: "You do NOT write code. You do NOT run commands. You ONLY coordinate workers." Put this in the orchestrator's system prompt. If you see the orchestrator touching files, your prompts are broken.
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: IMPLEMENTATION -->
      <section id="orchestrator-prompt" data-activity="implementation">
        <h2 class="section-title">
          <span class="section-number">4</span>
          Implementation
        </h2>

        <h3 class="font-semibold text-lg mb-4">Orchestrator System Prompt</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># ORCHESTRATOR SYSTEM PROMPT</span>

You are the orchestrator for building a user authentication system.

<span class="comment">## IRON LAW</span>
- You do NOT write code
- You do NOT run commands
- You do NOT explore codebases directly
- You ONLY coordinate workers

<span class="comment">## YOUR TOOLS</span>
- Task (to spawn workers)
- Read (only for high-level overview, 1-2 files max)

<span class="comment">## TASK BREAKDOWN</span>

1. <span class="keyword">Backend Task</span> (blocked_by: none)
   - Design and implement users/sessions schema
   - Create API endpoints: register, login, logout, refresh
   - Run backend tests before reporting complete

2. <span class="keyword">Frontend Task</span> (blocked_by: Backend Task)
   - Create LoginForm, RegistrationForm components
   - Implement AuthContext provider
   - Wire up to API endpoints
   - Run component tests before reporting complete

3. <span class="keyword">Test Task</span> (blocked_by: Frontend Task)
   - Write integration tests for auth flow
   - Write E2E test for complete user journey
   - Verify all tests pass

<span class="comment">## WORKFLOW</span>
1. Spawn Backend Worker (run_in_background: true)
2. Wait for Backend completion
3. Spawn Frontend Worker (run_in_background: true)
4. Wait for Frontend completion
5. Spawn Test Worker
6. Synthesize results and report to human</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="worker-preambles">Worker Preambles</h3>

        <p class="text-text-secondary mb-4">Every worker prompt must include these elements:</p>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># WORKER CONTEXT</span>

ROLE: Backend Worker
SCOPE: Database schema and API endpoints ONLY

<span class="comment">## RULES</span>
- Complete ONLY the task described below
- Use tools directly (Read, Write, Edit, Bash, Glob, Grep)
- Do NOT spawn sub-agents
- Do NOT call Task or TaskCreate
- Report results with absolute file paths

<span class="comment">## AVAILABLE TOOLS</span>
Read, Write, Edit, Bash, Glob, Grep, WebSearch

<span class="comment">## TASK</span>
Implement user authentication backend:

1. <span class="keyword">Database Schema</span>
   - users table (id, email, password_hash, created_at, updated_at)
   - sessions table (id, user_id, token, expires_at, created_at)
   - Use existing migration patterns in /db/migrations/

2. <span class="keyword">API Endpoints</span>
   - POST /auth/register
   - POST /auth/login
   - POST /auth/logout
   - POST /auth/refresh
   - Follow patterns in /src/api/

3. <span class="keyword">Verification</span>
   - Run: npm run test:backend
   - All tests must pass before reporting complete

<span class="comment">## DELIVERABLES</span>
Report with:
- Files created/modified (absolute paths)
- Any blockers encountered
- Test results summary</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="execution-patterns">Execution Patterns</h3>

        <h4 class="font-medium text-base mb-3">Manual Swarm (No Infrastructure)</h4>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Terminal 1: Backend Worker</span>
cd ~/project
claude --print <span class="string">"You are a backend worker. Implement auth DB and API..."</span> > backend.log &

<span class="comment"># Wait for backend to complete (monitor backend.log)</span>
<span class="comment"># Then Terminal 2: Frontend Worker</span>
claude --print <span class="string">"You are a frontend worker. Implement auth UI..."</span> > frontend.log &

<span class="comment"># Wait for frontend to complete</span>
<span class="comment"># Then Terminal 3: Test Worker</span>
claude --print <span class="string">"You are a test worker. Write integration tests..."</span> > test.log</pre>
        </div>

        <h4 class="font-medium text-base mb-3 mt-6">Git Worktrees (Filesystem Isolation)</h4>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Create worktrees for each worker</span>
git worktree add ../auth-backend feature/auth-backend
git worktree add ../auth-frontend feature/auth-frontend
git worktree add ../auth-tests feature/auth-tests

<span class="comment"># Run workers in parallel</span>
(cd ../auth-backend && claude <span class="string">"Implement auth backend..."</span>) &
(cd ../auth-frontend && claude <span class="string">"Implement auth frontend..."</span>) &
wait

<span class="comment"># Sequential tests after parallel work completes</span>
cd ../auth-tests && claude <span class="string">"Write auth tests..."</span>

<span class="comment"># Merge back</span>
git checkout main
git merge feature/auth-backend
git merge feature/auth-frontend
git merge feature/auth-tests</pre>
        </div>

        <div class="checkpoint-box">
          <div class="checkpoint-title">
            <i data-lucide="check-circle" class="w-4 h-4"></i>
            Checkpoint: After Git Worktrees Setup
          </div>
          <div class="checkpoint-detail"><strong>Where you are:</strong> You have isolated filesystem environments for parallel agent work via git worktrees.</div>
          <div class="checkpoint-detail"><strong>Verify with:</strong> <code>git worktree list</code> - should show 4 entries (main + 3 worktrees)</div>
          <div class="checkpoint-detail"><strong>You should see:</strong> Each worktree on its own branch, independent file changes don't interfere.</div>
        </div>

        <h4 class="font-medium text-base mb-3 mt-6">CC Mirror Native (Task Tool)</h4>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># .claude/orchestrator.md</span>

You are an orchestrator. Your only tool is Task.

For this session, break work into:
1. Backend tasks (subagent_type: <span class="string">"coder"</span>)
2. Frontend tasks (subagent_type: <span class="string">"coder"</span>)
3. Test tasks (subagent_type: <span class="string">"coder"</span>)

Each worker prompt must include:
- WORKER CONTEXT header
- Explicit scope boundaries
- <span class="string">"Do NOT spawn sub-agents"</span> rule
- Required verification steps</pre>
        </div>
      </section>

      <!-- Section 5: PATH OF A TASK -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Path of a Task
        </h2>

        <p class="text-text-secondary mb-6">
          Follow a full-stack feature through the swarm to see how coordination works:
        </p>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content">Orchestrator receives task: "Build user authentication system"</div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content">Orchestrator decomposes into worker tasks with dependency graph</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content">Spawns Backend Worker with <code>run_in_background: true</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content">Backend Worker creates migrations, implements endpoints, runs tests</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content">Backend Worker reports: 8 files modified, 12 tests passing</div>
          </div>
          <div class="path-step">
            <div class="path-number">6</div>
            <div class="path-content">Orchestrator validates completion, spawns Frontend Worker</div>
          </div>
          <div class="path-step">
            <div class="path-number">7</div>
            <div class="path-content">Frontend Worker creates components, implements AuthContext, runs tests</div>
          </div>
          <div class="path-step">
            <div class="path-number">8</div>
            <div class="path-content">Frontend Worker reports: 6 files modified, 8 tests passing</div>
          </div>
          <div class="path-step">
            <div class="path-number">9</div>
            <div class="path-content">Orchestrator validates, spawns Test Worker (depends on both)</div>
          </div>
          <div class="path-step">
            <div class="path-number">10</div>
            <div class="path-content">Test Worker writes integration and E2E tests, verifies full flow</div>
          </div>
          <div class="path-step">
            <div class="path-number">11</div>
            <div class="path-content">Test Worker reports: 2 files created, 10 tests passing</div>
          </div>
          <div class="path-step">
            <div class="path-number">12</div>
            <div class="path-content">Orchestrator synthesizes results, reports to human: 16 files, 30 tests, ready for review</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4">Orchestrator Execution Log</h3>

        <div class="architecture-diagram">
          <pre>
ORCHESTRATOR LOG
================================================================

[00:00] Received task: Build user authentication system

[00:01] Decomposing into worker tasks...
        Task 1: Backend (DB + API)     [no dependencies]
        Task 2: Frontend (UI + State)  [depends on: Backend]
        Task 3: Tests (Integration/E2E) [depends on: Frontend]

[00:02] Spawning Backend Worker (run_in_background: true)
        -> Worker ID: backend-auth-001

[00:45] Backend Worker completed
        -> Files modified: 8
        -> /db/migrations/20260109_users.sql
        -> /db/migrations/20260109_sessions.sql
        -> /src/api/auth/register.ts
        -> /src/api/auth/login.ts
        -> /src/api/auth/logout.ts
        -> /src/api/auth/refresh.ts
        -> /src/api/auth/index.ts
        -> /src/api/auth/__tests__/auth.test.ts
        -> Tests: 12 passed, 0 failed

[00:46] Spawning Frontend Worker (run_in_background: true)
        -> Worker ID: frontend-auth-001

[01:15] Frontend Worker completed
        -> Files modified: 6
        -> /src/components/auth/LoginForm.tsx
        -> /src/components/auth/RegistrationForm.tsx
        -> /src/components/auth/ProtectedRoute.tsx
        -> /src/context/AuthContext.tsx
        -> /src/hooks/useAuth.ts
        -> /src/components/auth/__tests__/auth.test.tsx
        -> Tests: 8 passed, 0 failed

[01:16] Spawning Test Worker
        -> Worker ID: test-auth-001

[01:35] Test Worker completed
        -> Files created: 2
        -> /tests/integration/auth.integration.test.ts
        -> /tests/e2e/auth.e2e.spec.ts
        -> Integration tests: 6 passed
        -> E2E tests: 4 passed

[01:36] SYNTHESIS
        ========================================

        Authentication system complete.

        Total files: 16
        Total tests: 30 (all passing)

        Backend:  /src/api/auth/
        Frontend: /src/components/auth/, /src/context/
        Tests:    /tests/integration/, /tests/e2e/

        Ready for human review.

================================================================
          </pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          Real problems you'll hit when running swarms, with concrete fixes:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Workers Interfere With Each Other's Files
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Merge conflicts when combining worker output. One worker overwrites another's changes.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Workers are operating on overlapping file scopes without isolation.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use git worktrees for filesystem isolation, OR include explicit scope boundaries in worker prompts: "SCOPE: Only modify files in /src/api/** - do NOT touch /src/components/**"</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Orchestrator Waits Too Long (No Parallelism)
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Workers run sequentially when they could run in parallel. Total time = sum of all workers.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Dependencies defined too conservatively, or <code>run_in_background: true</code> not used.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Identify truly independent tasks. Backend static setup and frontend static components often have no real dependencies - run them parallel. Only serialize when there's a genuine data dependency.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Worker Spawns Sub-Workers (Nesting)
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Backend worker spawns "DB worker" and "API worker". Deep hierarchy, hard to track.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Worker prompt didn't prohibit Task tool usage, or task was too large for single worker.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Add to every worker preamble: "Do NOT spawn sub-agents. Do NOT call Task or TaskCreate." If task genuinely needs splitting, do it at orchestrator level, not worker level.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Worker Reports Complete But Verification Fails
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Worker says "Done!" but tests fail when orchestrator checks.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Worker prompt didn't require verification before reporting, or verification command is wrong.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Add verification requirements to worker preamble: "Before reporting complete, you MUST: 1) Run npm run typecheck, 2) Run npm run test:[domain], 3) Include test results in your report. If any verification fails, fix the issue and re-verify."</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Swarm Cost Is Too High
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Multiple workers + orchestrator = 3-5x the token cost of a generalist approach.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Swarm pattern has overhead. Not all tasks benefit from it.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Do cost-benefit analysis. Generalist: ~50K tokens x 1 agent = 50K. Swarm: ~30K x 4 agents = 120K. But swarm time is 90 min vs 4 hours. When time savings justify cost (billing rate > token cost), use swarm. When budget constrained or task is small, use generalist.</div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="antipatterns">Anti-Patterns to Avoid</h3>

        <div class="antipattern-box">
          <div class="antipattern-header">
            <i data-lucide="x-circle" class="w-4 h-4"></i>
            Spawning Workers for Simple Tasks
          </div>
          <div class="antipattern-bad">BAD: Orchestrator spawns worker to add a comment</div>
          <div class="antipattern-good">GOOD: Just do it directly (if generalist) or batch with other work</div>
        </div>

        <div class="antipattern-box">
          <div class="antipattern-header">
            <i data-lucide="x-circle" class="w-4 h-4"></i>
            Deep Worker Nesting
          </div>
          <div class="antipattern-bad">BAD: Orchestrator -> Worker -> SubWorker -> SubSubWorker</div>
          <div class="antipattern-good">GOOD: Orchestrator -> Worker (flat structure, max 2 levels)</div>
        </div>

        <div class="antipattern-box">
          <div class="antipattern-header">
            <i data-lucide="x-circle" class="w-4 h-4"></i>
            Orchestrator Doing Code
          </div>
          <div class="antipattern-bad">BAD: Orchestrator: "Let me just quickly fix this bug..."</div>
          <div class="antipattern-good">GOOD: Orchestrator: "Spawning bugfix worker for issue #123..."</div>
        </div>

        <div class="antipattern-box">
          <div class="antipattern-header">
            <i data-lucide="x-circle" class="w-4 h-4"></i>
            Workers Spawning Workers
          </div>
          <div class="antipattern-bad">BAD: Backend Worker spawns "DB Worker" and "API Worker"</div>
          <div class="antipattern-good">GOOD: Backend Worker does all backend work, reports to orchestrator</div>
        </div>

        <div class="antipattern-box">
          <div class="antipattern-header">
            <i data-lucide="x-circle" class="w-4 h-4"></i>
            No Verification Before Complete
          </div>
          <div class="antipattern-bad">BAD: Worker: "I wrote the code, marking complete"</div>
          <div class="antipattern-good">GOOD: Worker: "Tests pass: 12/12. Files: [...]. Marking complete."</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          These are fundamental tensions in swarm architectures, not bugs to fix:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Coordination Overhead vs. Parallelism Gains
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Adding an orchestrator and worker spawning has cost. For small tasks, the coordination overhead exceeds the parallelism gains. You have to calibrate when swarm is worth it.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Swarm takes longer than generalist for simple features. You're spending more on orchestration than execution.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Use the 30-minute rule: if a generalist could do the whole feature in under 30 minutes, don't use a swarm. Swarm shines at 2+ hour equivalent tasks with parallelizable components.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Worker Scope Definition
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Too narrow scope = spawn overhead dominates. Too broad scope = you're back to generalist problems. Finding the right granularity requires judgment.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Workers finish in seconds (too narrow) or hit context limits (too broad). Frequent merge conflicts (overlapping scope).</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Start with domain boundaries: backend, frontend, tests. Split further only when a single domain exceeds context limits. Review first few runs and adjust based on actual worker performance.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Debugging Distributed Failures
          </div>
          <div class="hard-detail"><strong>The tension:</strong> When swarm output is broken, which worker caused it? Multiple contexts to examine. The bug might be in worker prompts, orchestrator logic, or genuine code issues.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Broken output with no clear cause. "It worked for backend worker but frontend worker broke it." Blame ambiguity.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Require workers to report file paths modified. Log orchestrator decisions. When debugging, start with worker outputs before examining code. Consider running suspect workers in isolation to reproduce.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Model Selection for Workers
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Using Opus for everything maximizes quality but cost scales with worker count. Using Haiku for everything cuts cost but may sacrifice quality on complex tasks.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Budget overruns. Or: simple test-writing takes forever because you used Opus. Or: complex API design is buggy because you used Haiku.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Match model to task complexity. Opus for orchestration (reasoning about dependencies). Sonnet for implementation (code generation). Haiku for mechanical tasks (writing boilerplate tests, formatting). Adjust based on actual worker output quality.</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO USE -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Use / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              USE SWARM WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Multi-domain work (full-stack features spanning DB, API, UI, tests)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Task size would exhaust single context window</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Parallelism provides significant time savings (2+ hour equivalent)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Quality requirements are high per domain</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Team is comfortable with orchestration overhead</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Overnight/AFK execution desired</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              USE GENERALIST WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Task is simple (&lt;30 min equivalent human time)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Single domain (backend only, frontend only)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Exploratory/research work with unclear scope</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Quick iterations with human feedback</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Budget constraints (swarm costs 2-4x more)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Learning the codebase (context sharing is valuable)</span>
            </div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4">Comparison Matrix</h3>

        <table class="comparison-table">
          <thead>
            <tr>
              <th>Aspect</th>
              <th>Generalist</th>
              <th>Specialized Swarm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Parallelism</strong></td>
              <td>None (sequential)</td>
              <td>Full (with dependency awareness)</td>
            </tr>
            <tr>
              <td><strong>Specialization</strong></td>
              <td>None (one agent does all)</td>
              <td>Per-worker domain focus</td>
            </tr>
            <tr>
              <td><strong>Context</strong></td>
              <td>Shared/diluted across domains</td>
              <td>Focused per domain</td>
            </tr>
            <tr>
              <td><strong>Speed</strong></td>
              <td>Linear (4 hours)</td>
              <td>Parallel (~90 min with deps)</td>
            </tr>
            <tr>
              <td><strong>Quality</strong></td>
              <td>Averages down (35%)</td>
              <td>High per domain (80%)</td>
            </tr>
            <tr>
              <td><strong>Fault Tolerance</strong></td>
              <td>Single point of failure</td>
              <td>Isolated failures, retry individual</td>
            </tr>
            <tr>
              <td><strong>Cost</strong></td>
              <td>Lower (one agent)</td>
              <td>Higher (multiple agents)</td>
            </tr>
            <tr>
              <td><strong>Complexity</strong></td>
              <td>Simple to run</td>
              <td>Requires orchestration setup</td>
            </tr>
            <tr>
              <td><strong>Debugging</strong></td>
              <td>Single context to examine</td>
              <td>Multiple contexts, need monitoring</td>
            </tr>
            <tr>
              <td><strong>Scaling</strong></td>
              <td>Add more time</td>
              <td>Add more workers</td>
            </tr>
          </tbody>
        </table>

        <h3 class="font-semibold text-lg mb-4">The Hybrid Approach</h3>

        <p class="text-text-secondary mb-4">You don't have to choose one or the other:</p>

        <ul class="list-disc list-inside text-text-secondary mb-6 space-y-2">
          <li>Use generalist for <strong>planning and exploration</strong></li>
          <li>Spawn swarm for <strong>execution</strong> once plan is clear</li>
          <li>Generalist <strong>synthesizes and reviews</strong> swarm output</li>
        </ul>

        <p class="text-text-secondary">
          This gives you the benefits of both: generalist flexibility for understanding the problem, swarm parallelism and specialization for solving it.
        </p>
      </section>

    </main>

    <!-- Resizer -->
    <div class="resizer" data-resizer="activity-zone" aria-label="Resize activity panel"></div>

    <!-- Activity Zone -->
    <aside class="activity-zone" id="activityZone">
      <div class="text-xs font-semibold text-text-muted uppercase tracking-wider mb-4">Operational Intelligence</div>

      <!-- ESSENCE SECTION -->
      <div class="activity-item inversion" data-section="essence">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if context DIDN'T dilute?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> One mega-agent for all domains. Load everything.<br>
          <strong>Why this fails:</strong> Transformer attention is finite. Quality degrades with context size.<br>
          <strong>Hidden constraint revealed:</strong> Domain specialization isn't preference, it's physics.
        </div>
      </div>

      <div class="activity-item minimal" data-section="essence">
        <div class="activity-label" style="color: #84cc16;">
          <i data-lucide="minimize-2" class="w-4 h-4"></i>
          Minimal Pattern
        </div>
        <div class="font-medium text-text-primary mb-2">The irreducible swarm</div>
        <div class="text-text-secondary text-sm">
          <strong>Minimal:</strong> Orchestrator + 2 workers with Task tool.<br>
          <strong>Essential:</strong> Orchestrator never codes. Workers never spawn.<br>
          <strong>Everything else:</strong> Refinement for reliability and monitoring.
        </div>
      </div>

      <div class="activity-item invariant" data-section="essence">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">INV-5: Parallelization over single-agent</div>
        <div class="text-text-secondary text-sm">
          Swarm, Gas Town, and CC Mirror all share this: when work is decomposable, parallel specialists beat sequential generalists. The invariant forces the architecture.
        </div>
      </div>

      <!-- CORE SECTION -->
      <div class="activity-item gradient" data-section="core">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How generalist quality degrades</div>
        <div class="text-text-secondary text-sm">
          <strong>Domain 1 (DB):</strong> 70% quality - fresh context<br>
          <strong>Domain 2 (API):</strong> 60% quality - context filling<br>
          <strong>Domain 3 (UI):</strong> 40% quality - attention splitting<br>
          <strong>Domain 4 (Tests):</strong> 20% quality - context exhausted<br><br>
          <em>Critical: The last domain always suffers most.</em>
        </div>
      </div>

      <div class="activity-item analogy" data-section="core">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Swarm = Microservices</div>
        <div class="text-text-secondary text-sm">
          Monolith = Generalist (does everything, coupling increases)<br>
          Microservice = Worker (single responsibility, focused)<br>
          API Gateway = Orchestrator (routes, coordinates)<br>
          Service mesh = Task tool (communication layer)<br><br>
          <em>If you've designed microservices, you understand swarms.</em>
        </div>
      </div>

      <div class="activity-item effect" data-section="core">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="bar-chart-2" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">At 4+ workers, monitoring becomes essential</div>
        <div class="text-text-secondary text-sm">
          <strong>Threshold:</strong> 3 workers - you can track in your head<br>
          <strong>Beyond:</strong> Need logs, status board, or HUD<br>
          <strong>Implication:</strong> Swarm complexity has a steepness curve. Don't start with 8 workers.
        </div>
      </div>

      <!-- DECISIONS SECTION -->
      <div class="activity-item constraint" data-section="decisions">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">One constraint leads to FIVE decisions</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Context dilution reduces quality<br>
          -> Workers must have focused domains<br>
          -> Domains need explicit boundaries<br>
          -> Boundaries need enforcement (prompts)<br>
          -> Orchestrator must not code (or becomes generalist)<br>
          -> Workers must not nest (or lose flat coordination)
        </div>
      </div>

      <div class="activity-item violation" data-section="decisions">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If orchestrator starts coding</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> Orchestrator writes "just one quick fix"<br>
          <strong>THEN:</strong> Orchestrator context fills with code details<br>
          <strong>THEN:</strong> Coordination quality degrades<br>
          <strong>THEN:</strong> Worker spawning becomes inconsistent<br>
          <strong>FINALLY:</strong> You have a bad generalist, not a swarm<br><br>
          <em>The fix: Iron law in system prompt. No exceptions.</em>
        </div>
      </div>

      <div class="activity-item tradeoff" data-section="decisions">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Worker Granularity Dilemma</div>
        <div class="text-text-secondary text-sm">
          <strong>Fine-grained:</strong> Many small workers - overhead dominates<br>
          <strong>Coarse-grained:</strong> Few large workers - back to generalist<br>
          <strong>Right-sized:</strong> Domain-aligned - judgment required<br><br>
          <em>Heuristic: One worker per clear domain boundary (backend, frontend, tests).</em>
        </div>
      </div>

      <!-- IMPLEMENTATION SECTION -->
      <div class="activity-item expertise" data-section="implementation">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Implementation understanding depth</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "How do I run a swarm?" -> Manual terminals<br>
          <strong>Intermediate:</strong> "How do I isolate workers?" -> Git worktrees<br>
          <strong>Advanced:</strong> "How do I automate?" -> CC Mirror Task tool<br>
          <strong>Staff:</strong> "How do I monitor?" -> Log aggregation, HUD<br>
          <strong>Expert:</strong> "How do I scale?" -> Worker pools, dynamic spawning
        </div>
      </div>

      <div class="activity-item composition" data-section="implementation">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Swarm + Git Worktrees</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Yes, this is the recommended approach.<br>
          <strong>Why:</strong> Filesystem isolation prevents merge conflicts.<br>
          <strong>The danger:</strong> Worktree management adds complexity.<br>
          <strong>Recommendation:</strong> Start manual, graduate to worktrees when conflicts appear.
        </div>
      </div>

      <div class="activity-item warstory" data-section="implementation">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Matt Pocock: Full-stack in 90 minutes</div>
        <div class="text-text-secondary text-sm">
          Auth system that would take 4 hours generalist. Backend, frontend, tests workers. "The orchestrator never touched code. That's what made it work."
        </div>
      </div>

      <!-- PATH SECTION -->
      <div class="activity-item horizon" data-section="path">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">How swarm perception evolves</div>
        <div class="text-text-secondary text-sm">
          <strong>First swarm:</strong> "This is so much setup overhead"<br>
          <strong>Third swarm:</strong> "Okay, the parallelism is nice"<br>
          <strong>Tenth swarm:</strong> "I can't imagine doing full-stack any other way"<br>
          <strong>Mature:</strong> "Generalist for exploration, swarm for execution"<br><br>
          <em>Don't judge swarms by your first run.</em>
        </div>
      </div>

      <div class="activity-item violation" data-section="path">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip dependency tracking</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> Spawn frontend worker before backend completes<br>
          <strong>THEN:</strong> Frontend builds against non-existent API<br>
          <strong>THEN:</strong> Integration fails at test worker<br>
          <strong>THEN:</strong> Entire swarm output is broken<br>
          <strong>FINALLY:</strong> You debug for 2 hours what should have been prevented<br><br>
          <em>The fix: blocked_by declarations. Honor the dependency graph.</em>
        </div>
      </div>

      <div class="activity-item invariant" data-section="path">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">INV-14: Claims-based coordination</div>
        <div class="text-text-secondary text-sm">
          Workers claim completion with evidence. Orchestrator validates claims before proceeding. This is the same pattern as Ralph's progress.txt and Gas Town's Inbox - external state for coordination.
        </div>
      </div>

      <!-- GOTCHAS SECTION -->
      <div class="activity-item inflection" data-section="gotchas">
        <div class="activity-label" style="color: #eab308;">
          <i data-lucide="activity" class="w-4 h-4"></i>
          Inflection Point
        </div>
        <div class="font-medium text-text-primary mb-2">When swarm cost flips from justified to excessive</div>
        <div class="text-text-secondary text-sm">
          <strong>&lt;30 min task:</strong> Swarm overhead > parallelism benefit (use generalist)<br>
          <strong>30-60 min:</strong> Break-even zone (judgment call)<br>
          <strong>1-2 hours:</strong> Swarm clearly wins on time<br>
          <strong>2+ hours:</strong> Swarm essential for quality<br><br>
          <strong>THE INFLECTION:</strong> ~45 minute equivalent task<br>
          <em>Detection: If orchestrator setup takes longer than the task, you over-engineered.</em>
        </div>
      </div>

      <div class="activity-item inversion" data-section="gotchas">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if workers could spawn workers?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Recursive decomposition. Workers split when tasks are large.<br>
          <strong>Why this fails:</strong> No single point of visibility. Deep nesting loses coordination.<br>
          <strong>Hidden constraint revealed:</strong> Flat hierarchy is feature, not limitation.
        </div>
      </div>

      <div class="activity-item frontier" data-section="gotchas">
        <div class="activity-label" style="color: #ef4444;">
          <i data-lucide="flask-conical" class="w-4 h-4"></i>
          Research Frontier
        </div>
        <div class="font-medium text-text-primary mb-2">UNSOLVED: Dynamic worker scaling</div>
        <div class="text-text-secondary text-sm">
          <strong>The question:</strong> Can orchestrator spawn more workers mid-flight if task proves larger than expected?<br>
          <strong>Why it's hard:</strong> Mid-flight spawning requires state handoff. No clean protocol yet.<br>
          <strong>Current practice:</strong> Pre-decompose conservatively. Re-run swarm if under-decomposed.
        </div>
      </div>

      <!-- HARD SECTION -->
      <div class="activity-item tradeoff" data-section="hard">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Cost vs. Speed vs. Quality Triangle</div>
        <div class="text-text-secondary text-sm">
          <strong>Optimize cost:</strong> Generalist (1 agent) - slow, lower quality<br>
          <strong>Optimize speed:</strong> Many Haiku workers - fast, lower quality<br>
          <strong>Optimize quality:</strong> Opus workers - expensive, slow<br><br>
          <strong>Why no perfect answer:</strong> Pick 2 of 3. Swarm lets you pick differently per domain.
        </div>
      </div>

      <div class="activity-item expertise" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Debugging distributed failures</div>
        <div class="text-text-secondary text-sm">
          <strong>Beginner:</strong> "Which worker broke it?" -> Check file modification times<br>
          <strong>Intermediate:</strong> "How do I reproduce?" -> Run suspect worker in isolation<br>
          <strong>Advanced:</strong> "How do I prevent?" -> Better worker verification<br>
          <strong>Staff:</strong> "How do I monitor?" -> Centralized logging<br>
          <strong>Expert:</strong> "How do I automate detection?" -> Orchestrator validates outputs
        </div>
      </div>

      <div class="activity-item warstory" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Steve Yegge: Gas Town's Polecat Principle</div>
        <div class="text-text-secondary text-sm">
          "Workers are disposable. If one fails, spawn another. Don't try to save broken context - the cost of retry is less than the cost of debugging corrupted state."
        </div>
      </div>

      <!-- WHEN SECTION -->
      <div class="activity-item inversion" data-section="when">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if you used swarm for exploration?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Exploratory workers investigating different approaches.<br>
          <strong>Why this fails:</strong> No defined completion criteria. Workers wander.<br>
          <strong>Hidden constraint revealed:</strong> Swarm needs clear deliverables. Use generalist for open-ended work.
        </div>
      </div>

      <div class="activity-item analogy" data-section="when">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Generalist vs Swarm = Agile vs Waterfall</div>
        <div class="text-text-secondary text-sm">
          <strong>Generalist:</strong> Agile - iterate, explore, pivot<br>
          <strong>Swarm:</strong> Waterfall - plan upfront, execute parallel<br>
          <strong>Hybrid:</strong> Best of both - explore with generalist, execute with swarm<br><br>
          <em>The question isn't "which is better" but "what phase am I in?"</em>
        </div>
      </div>

      <div class="activity-item alternative" data-section="when">
        <div class="activity-label" style="color: #6b7280;">
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
          Alternative Paths
        </div>
        <div class="font-medium text-text-primary mb-2">If Swarm isn't right for your use case</div>
        <div class="text-text-secondary text-sm">
          <strong>Need iteration loops?</strong> -> Ralph (sequential with persistence)<br>
          <strong>Need human gates?</strong> -> HOTL Swarm (orchestrator pauses for approval)<br>
          <strong>Need overnight execution?</strong> -> Ralph + Swarm hybrid<br>
          <strong>Need real-time parallelism?</strong> -> CC Mirror native
        </div>
      </div>

      <div class="activity-item constraint" data-section="when">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Budget constraint cascades</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Limited budget for tokens<br>
          -> Can't afford 4 workers + orchestrator<br>
          -> Must reduce worker count or model tier<br>
          -> Reduced workers = less parallelism<br>
          -> Less parallelism = longer wall clock<br>
          -> May need to accept generalist for small tasks
        </div>
      </div>

      <div class="activity-item horizon" data-section="when">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">When swarm mastery arrives</div>
        <div class="text-text-secondary text-sm">
          <strong>Week 1:</strong> "Swarms feel overengineered"<br>
          <strong>Month 1:</strong> "I'm getting faster at decomposition"<br>
          <strong>Month 3:</strong> "I instinctively know when to swarm"<br>
          <strong>Month 6:</strong> "I design features for swarm execution"<br><br>
          <em>The skill isn't swarm configuration - it's task decomposition.</em>
        </div>
      </div>

      <div class="activity-item composition" data-section="when">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Swarm + Ralph (Hybrid)</div>
        <div class="text-text-secondary text-sm">
          <strong>Works:</strong> Yes, powerful combination.<br>
          <strong>How:</strong> Ralph loop spawns swarms for each iteration. Fresh swarm context per loop.<br>
          <strong>The danger:</strong> Cost multiplies. Use for large projects only.<br>
          <strong>Recommendation:</strong> Master each pattern separately first.
        </div>
      </div>

      <div class="activity-item warstory" data-section="when">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Molly Cantillon: Personal Panopticon</div>
        <div class="text-text-secondary text-sm">
          8 parallel Claude instances managing different life domains. Each specialized for its domain. "The key was clear boundaries. Finance Claude never touched Health Claude's domain."
        </div>
      </div>

    </aside>
  </div>

  <script>
    /**
     * PanelResizer - Handles draggable panel dividers
     */
    class PanelResizer {
      constructor(resizerEl, config = {}) {
        this.resizer = resizerEl;
        this.config = {
          storageKey: 'panel-activity-zone-width',
          minWidth: 280,
          maxWidth: 900,
          defaultWidth: 480,
          ...config
        };

        this.isResizing = false;
        this.startX = 0;
        this.startWidth = 0;

        this.activityZone = document.querySelector('.activity-zone');
        this.mainContent = document.querySelector('.main-content');

        this.onMouseDown = this.onMouseDown.bind(this);
        this.onMouseMove = this.onMouseMove.bind(this);
        this.onMouseUp = this.onMouseUp.bind(this);

        this.init();
      }

      init() {
        this.restoreWidth();
        this.resizer.addEventListener('mousedown', this.onMouseDown);
      }

      onMouseDown(e) {
        if (e.button !== 0) return;

        this.isResizing = true;
        this.startX = e.clientX;
        this.startWidth = this.activityZone.offsetWidth;

        this.resizer.classList.add('active');
        document.body.classList.add('resizing');

        document.addEventListener('mousemove', this.onMouseMove);
        document.addEventListener('mouseup', this.onMouseUp);

        e.preventDefault();
      }

      onMouseMove(e) {
        if (!this.isResizing) return;

        const delta = this.startX - e.clientX;
        const newWidth = this.startWidth + delta;

        const constrainedWidth = Math.max(
          this.config.minWidth,
          Math.min(this.config.maxWidth, newWidth)
        );

        this.activityZone.style.width = constrainedWidth + 'px';
        this.mainContent.style.marginRight = constrainedWidth + 'px';
        this.resizer.style.right = constrainedWidth + 'px';
      }

      onMouseUp(e) {
        if (!this.isResizing) return;

        this.isResizing = false;

        this.resizer.classList.remove('active');
        document.body.classList.remove('resizing');

        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);

        this.saveWidth();
      }

      saveWidth() {
        const width = this.activityZone.offsetWidth;
        localStorage.setItem(this.config.storageKey, JSON.stringify({
          width,
          timestamp: Date.now()
        }));
      }

      restoreWidth() {
        try {
          const stored = localStorage.getItem(this.config.storageKey);
          if (stored) {
            const { width } = JSON.parse(stored);
            if (width >= this.config.minWidth && width <= this.config.maxWidth) {
              this.activityZone.style.width = width + 'px';
              this.mainContent.style.marginRight = width + 'px';
              this.resizer.style.right = width + 'px';
            }
          }
        } catch (e) {
          console.warn('Failed to restore panel width:', e);
        }
      }

      destroy() {
        this.resizer.removeEventListener('mousedown', this.onMouseDown);
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);
      }
    }

    // Auto-initialize resizers on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      const resizers = document.querySelectorAll('[data-resizer]');
      resizers.forEach(resizer => new PanelResizer(resizer));
    });

    // Initialize Lucide icons
    lucide.createIcons();

    // Navigation toggle
    function toggleSection(header) {
      const section = header.closest('.nav-section');
      section.classList.toggle('expanded');
      const children = section.querySelector('.nav-children');
      children.classList.toggle('expanded');
    }

    // Mobile menu toggle
    function toggleMobileMenu() {
      const nav = document.getElementById('leftNav');
      nav.classList.toggle('open');
    }

    // Copy functionality
    function copyCode(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> Copied!';
        lucide.createIcons();
        setTimeout(() => {
          btn.innerHTML = originalText;
          lucide.createIcons();
        }, 2000);
      });
    }

    function copyCodeBlock(btn) {
      const codeBlock = btn.closest('.code-block');
      const pre = codeBlock.querySelector('pre');
      const text = pre.textContent;
      copyCode(btn, text);
    }

    // Scroll-sync with GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    const sections = document.querySelectorAll('[data-activity]');
    const activityItems = document.querySelectorAll('.activity-item');

    sections.forEach(section => {
      ScrollTrigger.create({
        trigger: section,
        start: 'top 40%',
        end: 'bottom 40%',
        onEnter: () => activateSection(section.dataset.activity),
        onEnterBack: () => activateSection(section.dataset.activity),
      });
    });

    function activateSection(sectionName) {
      activityItems.forEach(item => {
        if (item.dataset.section === sectionName) {
          item.classList.add('active');
          gsap.to(item, {
            opacity: 1,
            y: -2,
            boxShadow: '0 4px 12px rgba(0,0,0,0.08)',
            duration: 0.3,
            ease: 'power2.out'
          });
        } else {
          item.classList.remove('active');
          gsap.to(item, {
            opacity: 0.5,
            y: 0,
            boxShadow: 'none',
            duration: 0.3,
            ease: 'power2.out'
          });
        }
      });

      // Update nav active state
      document.querySelectorAll('.nav-section-header').forEach(header => {
        header.classList.remove('active');
      });
      const activeNav = document.querySelector(`[data-section="${sectionName}"] .nav-section-header`);
      if (activeNav) {
        activeNav.classList.add('active');
      }
    }

    // Initialize first section as active
    activateSection('essence');

    // Smooth scroll for nav links
    document.querySelectorAll('.nav-item').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const target = document.querySelector(link.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('active'));
          link.classList.add('active');
        }
      });
    });

    // Brushing interaction - hover activity item highlights related content
    activityItems.forEach(item => {
      item.addEventListener('mouseenter', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = 'rgba(13, 147, 115, 0.05)';
          relatedSection.style.transition = 'background-color 0.3s ease';
        }
      });

      item.addEventListener('mouseleave', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = '';
        }
      });
    });
  </script>
</body>
</html>
