<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta data-pagefind-meta="section" content="Synthesis">
  <meta data-pagefind-meta="category" content="Architecture">
  <title>Domain Isolation Patterns - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/search.css">
</head>
<body>
  <nav class="left-nav" id="leftNav">
    <div class="px-4 mb-4">
      <a href="../index.html" class="text-xs font-semibold text-accent hover:text-accent-light uppercase tracking-wider">Claude Code KB</a>
    </div>
    <div class="nav-content"></div>
  </nav>

  <!-- Search Modal -->
  <div class="search-modal" id="searchModal" aria-hidden="true">
    <div class="search-overlay" onclick="closeSearch()"></div>
    <div class="search-content">
      <div class="search-header">
        <div class="search-input-wrapper">
          <span class="search-icon-input">&#128269;</span>
          <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
          <kbd class="search-kbd">ESC</kbd>
        </div>
      </div>
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="synthesis">Synthesis</button>
        <button class="filter-btn" data-filter="extractions">Extractions</button>
      </div>
      <div class="search-results" id="searchResults">
        <div class="search-empty"><p>Start typing to search... (Press Cmd+K anytime)</p></div>
      </div>
      <div class="search-footer">
        <span>Up/Down Navigate</span><span>Enter Select</span><span>ESC Close</span>
      </div>
    </div>
  </div>

  <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
    <span class="search-icon">Cmd+K</span>
    <span class="search-text">Search</span>
  </button>

  <div class="wide-container">
    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="synthesis-index.html">Synthesis</a>
      <span>/</span>
      <span>Architecture</span>
      <span>/</span>
      <span>Domain Isolation</span>
    </nav>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <h3 style="color: #2a7d7d; margin-top: 0; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px;">You Are Here</h3>
      <p style="margin-bottom: 0;">This guide teaches you how to <strong><span style="font-weight: 700;">run</span> multiple Claude Code instances</strong> across separate life/work domains without context pollution. Essential reading if you want to scale beyond single-project usage to managing entire life systems (the "Personal Panopticon" approach). Prerequisite: understand basic Claude Code usage (Level 0-1 from <a href="architecture-complexity-ladder.html">complexity ladder</a>).</p>
    </div>

    <h1><span style="font-weight: 700;">Dom</span>ain Isolation Patterns</h1>

    <p class="conversational-lead">
      A <span style="font-weight: 700;">com</span>prehensive guide to isolating Claude Code instances across life and work domains, derived from the Personal Panopticon architecture and community best practices.
    </p>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">Contents</div>
      <ul>
        <li><a href="#panopticon-model">The Panopticon Model</a> - 8 parallel isolated domains</li>
        <li><a href="#why-isolation-matters">Why Domain Isolation Matters</a> - Context, security, parallelism</li>
        <li><a href="#implementation-patterns">Implementation Patterns</a> - Filesystem, process, git isolation</li>
        <li><a href="#cross-domain-coordination">Cross-Domain Coordination</a> - Handoffs and correlation</li>
        <li><a href="#domain-customization">Domain-Specific Customization</a> - Rules, subagents, models</li>
        <li><a href="#anti-patterns">Anti-Patterns</a> - Over/under-isolation, sprawl</li>
        <li><a href="#implementation-checklist">Implementation Checklist</a> - Phase-by-phase setup</li>
        <li><a href="#troubleshooting">Troubleshooting</a> - Common issues</li>
      </ul>
    </div>

    <hr class="section-divider divider-procedure">

    <!-- Panopticon Model Section -->
    <section id="panopticon-model">
      <h2><span style="font-weight: 700;">The</span> Panopticon Model</h2>

      <h3>The Core Concept</h3>

      <p>Molly Cantillon's "Personal Panopticon" introduces a paradigm shift: running Claude Code as a <strong>swarm of 8 parallel isolated instances</strong>, each owning a distinct life domain to achieve "self-legibility" and reverse the data asymmetry institutions have over you.</p>

      <blockquote style="border-left: 3px solid #2a7d7d; padding-left: 1rem; margin: 1.5rem 0; font-style: italic; color: #5c4b3a;">
        "The feeling is hard to name. It is the violent gap between how blind you were and how obvious everything feels now with an observer that reads all the feeds, catches what you've unconsciously dropped, notices patterns across domains you'd kept stubbornly separate, and---crucially---tells you what to do about it."
      </blockquote>

      <h3>The 8 Parallel Isolated Domains</h3>

      <div class="ascii-diagram">
~/nox        # Company/product - business operations
~/metrics    # Analytics/data - quantitative insights
~/email      # Communications - inbox management
~/growth     # Marketing/acquisition - audience building
~/trades     # Personal finance/trading - market intelligence
~/health     # Fitness/sleep/wellness - body optimization
~/writing    # Content creation - creative output
~/personal   # Life admin - everything else
      </div>

      <h3>How Isolation Works</h3>

      <table class="comparison-table">
        <thead>
          <tr><th>Principle</th><th>Implementation</th></tr>
        </thead>
        <tbody>
          <tr><td><strong>Directory isolation</strong></td><td>Each instance runs in its own <code>~/&lt;domain&gt;</code> directory</td></tr>
          <tr><td><strong>No cross-contamination</strong></td><td>Agents cannot read/write outside their directory</td></tr>
          <tr><td><strong>Independent context</strong></td><td>Each instance has fresh context, no shared conversation history</td></tr>
          <tr><td><strong>Domain-specific memory</strong></td><td>Each directory contains its own notes, data, and history</td></tr>
          <tr><td><strong>Explicit handoffs</strong></td><td>Information crosses domains only through deliberate file-based handoffs</td></tr>
        </tbody>
      </table>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Why Isolation Matters Section -->
    <section id="why-isolation-matters">
      <h2><span style="font-weight: 700;">Why</span> Domain Isolation Matters</h2>

      <h3>1. Context Pollution Prevention</h3>

      <p>Claude Code's context window is finite. When a single instance handles everything---finances, health, code, personal admin---the context becomes diluted:</p>

      <ul>
        <li><strong>Context rot:</strong> Older, irrelevant information crowds out recent, relevant context</li>
        <li><strong>Confusion:</strong> Agent may apply patterns from one domain inappropriately to another</li>
        <li><strong>Diluted expertise:</strong> A generalist context produces generalist outputs</li>
      </ul>

      <div class="callout callout-insight">
        <div class="callout-title">Isolation Solution</div>
        <p>Each domain agent maintains a focused, specialized context that deepens over time rather than broadening into noise.</p>
      </div>

      <h3>2. Specialized Optimization Per Domain</h3>

      <p>Different domains require different:</p>

      <table class="comparison-table">
        <thead>
          <tr><th>Aspect</th><th>Example Differences</th></tr>
        </thead>
        <tbody>
          <tr><td><strong>Tools</strong></td><td><code>~/trades</code> needs brokerage APIs; <code>~/health</code> needs WHOOP integration</td></tr>
          <tr><td><strong>Schedules</strong></td><td><code>~/trades</code> runs overnight for market data; <code>~/health</code> runs post-workout</td></tr>
          <tr><td><strong>Models</strong></td><td><code>~/writing</code> may benefit from Opus creativity; <code>~/metrics</code> works fine with Sonnet</td></tr>
          <tr><td><strong>Verification</strong></td><td><code>~/nox</code> (company) needs rigorous testing; <code>~/personal</code> can be looser</td></tr>
          <tr><td><strong>CLAUDE.md rules</strong></td><td>Each domain has domain-specific guardrails and conventions</td></tr>
        </tbody>
      </table>

      <h3>3. Security and Privacy Boundaries</h3>

      <p>Domain isolation creates natural security perimeters:</p>

      <ul>
        <li><strong>Credential separation:</strong> API keys for trading don't leak to other domains</li>
        <li><strong>Blast radius containment:</strong> A compromised or misbehaving agent affects only one domain</li>
        <li><strong>Privacy zones:</strong> Personal health data never mingles with company code</li>
        <li><strong>Audit trails:</strong> Per-domain logs make it clear what accessed what</li>
      </ul>

      <h3>4. Parallel Execution</h3>

      <p>With isolation, you can run all domains simultaneously:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Terminal 1          # Terminal 2          # Terminal 3
cd ~/nox && claude    cd ~/trades && claude cd ~/health && claude</code></pre>
      </div>

      <p>No conflicts. No waiting. Each agent works on its domain while others work in parallel.</p>

      <!-- Checkpoint Box -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: Domain Isolation Fundamentals</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>Why context pollution degrades agent performance</li>
          <li>The 8 domain categories in the Panopticon model</li>
          <li>How directory isolation enables parallel execution</li>
          <li>The security benefits of domain separation</li>
        </ul>
        <p><strong>If unclear:</strong> Re-read "Why Domain Isolation Matters" above before proceeding.</p>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Implementation Patterns Section -->
    <section id="implementation-patterns">
      <h2><span style="font-weight: 700;">Imp</span>lementation Patterns</h2>

      <h3>Filesystem Isolation</h3>

      <h4>Basic Directory Structure</h4>

      <div class="ascii-diagram">
~/
+-- nox/
|   +-- CLAUDE.md           # Company-specific rules
|   +-- .claude/
|   |   +-- settings.json   # Domain permissions
|   |   +-- commands/       # Domain slash commands
|   +-- [project files]
|
+-- trades/
|   +-- CLAUDE.md           # Finance rules, risk limits
|   +-- briefs/             # Daily morning briefs
|   +-- data/               # Market data pulls
|   +-- .secrets/           # Brokerage credentials
|
+-- health/
|   +-- CLAUDE.md           # Health tracking rules
|   +-- workouts/           # Generated workout plans
|   +-- integrations/       # WHOOP, Apple Health exports
|
+-- [other domains...]
      </div>

      <h4>Domain-Specific CLAUDE.md</h4>

      <p>Each domain gets its own <code>CLAUDE.md</code> tailored to that context:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># ~/trades/CLAUDE.md

## Domain: Personal Finance & Trading

### Data Sources
- Brokerage exports in ./data/
- Congressional disclosures from House API
- Polymarket odds via MCP
- X sentiment from firehose

### Morning Brief Protocol
1. Pull overnight data
2. Cross-reference against positions
3. Flag material changes
4. Output to ./briefs/YYYY-MM-DD.md

### Risk Rules
- NEVER execute actual trades
- Flag any position >5% of portfolio
- Always note data freshness</code></pre>
      </div>

      <hr style="border: 0; border-top: 1px solid #e0d5c5; margin: 2rem 0;">

      <h3>Process Isolation</h3>

      <h4>Separate Claude Code Instances</h4>

      <p>Each domain runs its own Claude Code process:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>#!/bin/bash
# start-domains.sh

DOMAINS="nox metrics email growth trades health writing personal"

for domain in $DOMAINS; do
    cd ~/$domain
    tmux new-session -d -s $domain "claude"
done

echo "All domains launched. Use 'tmux attach -t <domain>' to connect."</code></pre>
      </div>

      <h4>tmux/screen Management</h4>

      <p>tmux provides the ideal interface for managing parallel instances:</p>

      <div class="ascii-diagram">
+-------------------------------------------------------------+
|  tmux sessions                                               |
+-------------------------------------------------------------+
|  nox       | Claude running on company product              |
|  metrics   | Pulling analytics data                         |
|  email     | Processing inbox, drafting replies             |
|  growth    | Running A/B copy generation                    |
|  trades    | [Overnight] Scraping brokerage data            |
|  health    | Generating workout for tomorrow                |
|  writing   | [Idle] Waiting for creative task               |
|  personal  | Finding forgotten subscriptions                |
+-------------------------------------------------------------+
      </div>

      <p><strong>Key tmux commands:</strong></p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># List all domain sessions
tmux ls

# Attach to specific domain
tmux attach -t trades

# Detach (keeps running)
Ctrl-b d

# Kill a domain session
tmux kill-session -t health</code></pre>
      </div>

      <hr style="border: 0; border-top: 1px solid #e0d5c5; margin: 2rem 0;">

      <h3>Git Isolation</h3>

      <h4>Separate Repositories</h4>

      <p>The cleanest isolation: each domain is its own git repository.</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>~/nox/.git         # Company code history
~/trades/.git      # Trading analysis history
~/health/.git      # Health tracking history</code></pre>
      </div>

      <p><strong>Benefits:</strong></p>
      <ul>
        <li>Complete commit history isolation</li>
        <li>Independent branching strategies</li>
        <li>No risk of cross-domain commits</li>
        <li>Domain-specific <code>.gitignore</code></li>
      </ul>

      <h4>Git Worktrees for Parallel Development</h4>

      <p>When a single domain needs parallel work streams, use git worktrees:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Within ~/nox, create parallel feature branches
cd ~/nox
git worktree add ../nox-feature-auth feature-auth
git worktree add ../nox-feature-payments feature-payments

# Now you have:
~/nox/                   # Main development
~/nox-feature-auth/      # Auth feature (isolated)
~/nox-feature-payments/  # Payments feature (isolated)</code></pre>
      </div>

      <p>Each worktree can run its own Claude Code instance without conflicts.</p>

      <!-- Checkpoint Box -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: Implementation Patterns</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>How to create domain-specific CLAUDE.md files</li>
          <li>tmux session management for parallel instances</li>
          <li>The difference between separate repos vs. git worktrees</li>
          <li>When to use worktrees within a domain</li>
        </ul>
        <p><strong>Terminal verification:</strong></p>
        <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
          <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
          <pre style="margin: 0; overflow-x: auto;"><code># You should be able to run multiple sessions:
tmux new-session -d -s trades "cd ~/trades && claude"
tmux new-session -d -s health "cd ~/health && claude"
tmux ls  # Should show both sessions</code></pre>
        </div>
        <p><strong>If unclear:</strong> Practice creating and switching between tmux sessions before proceeding.</p>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Cross-Domain Coordination Section -->
    <section id="cross-domain-coordination">
      <h2><span style="font-weight: 700;">Cro</span>ss-Domain Coordination</h2>

      <h3>When Bridging Is Needed</h3>

      <p>Despite strict isolation, some scenarios require cross-domain awareness:</p>

      <ul>
        <li><strong>Morning brief synthesis:</strong> Combine insights from <code>~/trades</code>, <code>~/health</code>, <code>~/nox</code></li>
        <li><strong>Schedule conflicts:</strong> <code>~/writing</code> deadline vs <code>~/nox</code> meeting</li>
        <li><strong>Resource allocation:</strong> Time/money tradeoffs across domains</li>
        <li><strong>Pattern recognition:</strong> Sleep quality (<code>~/health</code>) affecting productivity (<code>~/nox</code>)</li>
      </ul>

      <h3>The Handoff Pattern</h3>

      <p>Agents communicate through explicit file-based handoffs:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>{
  "from": "trades",
  "to": "personal",
  "timestamp": "2026-01-09T06:30:00Z",
  "summary": "Portfolio up 2.3% overnight. No action required.",
  "flags": [],
  "data_freshness": "2026-01-09T06:00:00Z"
}</code></pre>
      </div>

      <p><strong>Reading handoffs:</strong></p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># In ~/personal/CLAUDE.md

## Cross-Domain Integration
Check ~/shared/ for handoffs from other domains before generating daily brief.
Incorporate flags from trades, health status, and calendar conflicts.</code></pre>
      </div>

      <h3>The Correlation Engine Pattern</h3>

      <p>For domains that need persistent cross-referencing, create a dedicated correlation layer:</p>

      <div class="ascii-diagram">
~/correlation/
+-- CLAUDE.md              # Rules for cross-domain analysis
+-- feeds/                 # Symlinks to domain outputs
|   +-- trades-brief -> ~/trades/briefs/latest.md
|   +-- health-status -> ~/health/status/current.json
|   +-- nox-blockers -> ~/nox/blockers.md
+-- output/
    +-- daily-synthesis.md
      </div>

      <p><strong>The correlation agent:</strong></p>
      <ul>
        <li>Has read-only access to all domain outputs</li>
        <li>Cannot write to any domain directory</li>
        <li>Synthesizes patterns across domains</li>
        <li>Outputs to <code>~/correlation/output/</code></li>
      </ul>

      <p>This creates a "meta-observer" that sees across domains without violating isolation.</p>

      <h3>Scheduled Cross-Domain Runs</h3>

      <p>Use cron for orchestrated multi-domain workflows:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Morning synthesis (6 AM)
0 6 * * * cd ~/trades && claude "Generate morning brief" > briefs/$(date +%Y-%m-%d).md
5 6 * * * cd ~/health && claude "Analyze overnight recovery" > status/current.json
10 6 * * * cd ~/correlation && claude "Synthesize daily brief from all domains"</code></pre>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Domain Customization Section -->
    <section id="domain-customization">
      <h2><span style="font-weight: 700;">Dom</span>ain-Specific Customization</h2>

      <h3>Different Rules Per Domain</h3>

      <p>Each domain's <code>CLAUDE.md</code> enforces domain-appropriate behavior:</p>

      <table class="comparison-table">
        <thead>
          <tr><th>Domain</th><th>Key Rules</th></tr>
        </thead>
        <tbody>
          <tr><td><strong>nox</strong></td><td>Strict testing, PR workflow, code review requirements</td></tr>
          <tr><td><strong>trades</strong></td><td>Read-only market access, risk limits, no actual execution</td></tr>
          <tr><td><strong>health</strong></td><td>Privacy-first, local data only, no cloud uploads</td></tr>
          <tr><td><strong>email</strong></td><td>Drafts require approval, never auto-send, BCC logging</td></tr>
          <tr><td><strong>writing</strong></td><td>Creative license, experimental, less verification</td></tr>
          <tr><td><strong>personal</strong></td><td>Maximum automation, minimal oversight</td></tr>
        </tbody>
      </table>

      <h3>Model Selection by Domain</h3>

      <p>Different domains may benefit from different models:</p>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># ~/nox/CLAUDE.md
## Model: Opus 4.5
Complex reasoning for architecture decisions, security reviews.

# ~/email/CLAUDE.md
## Model: Sonnet
Fast drafting, pattern-based responses.

# ~/metrics/CLAUDE.md
## Model: Haiku
Simple data lookups, aggregations.</code></pre>
      </div>
    </section>

    <hr class="section-divider divider-warning">

    <!-- Anti-Patterns Section -->
    <section id="anti-patterns">
      <h2><span style="font-weight: 700;">Ant</span>i-Patterns</h2>

      <h3>Over-Isolation (Can't Coordinate)</h3>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Domains become silos with no awareness of each other</li>
        <li>Duplicate work across domains</li>
        <li>Conflicting decisions (trading decision ignores health crash)</li>
        <li>No synthesized view of life/work</li>
      </ul>

      <p><strong>Solutions:</strong></p>
      <ul>
        <li>Implement the correlation engine pattern</li>
        <li>Schedule cross-domain synthesis</li>
        <li>Create explicit handoff protocols</li>
        <li>Allow read-only access to critical domain outputs</li>
      </ul>

      <hr style="border: 0; border-top: 1px solid #e0d5c5; margin: 2rem 0;">

      <h3>Under-Isolation (Context Bleed)</h3>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Single Claude instance handling "everything"</li>
        <li>Long context with mixed domain information</li>
        <li>Agent confuses domain contexts</li>
        <li>Privacy breaches (health data in work context)</li>
        <li>Generic, unfocused outputs</li>
      </ul>

      <p><strong>Solutions:</strong></p>
      <ul>
        <li>Strict directory separation</li>
        <li>Separate tmux sessions per domain</li>
        <li>Domain-specific CLAUDE.md files</li>
        <li>Never run a single "master" instance</li>
      </ul>

      <hr style="border: 0; border-top: 1px solid #e0d5c5; margin: 2rem 0;">

      <h3>Domain Sprawl</h3>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Creating too many micro-domains</li>
        <li>Overhead of managing 15+ instances</li>
        <li>Unclear domain boundaries</li>
        <li>Constant handoffs for simple tasks</li>
      </ul>

      <p><strong>Solutions:</strong></p>
      <ul>
        <li>Start with 3-5 core domains</li>
        <li>Expand only when clear need emerges</li>
        <li>Consolidate related concerns</li>
        <li>Use subagents within domains instead of new domains</li>
      </ul>

      <hr style="border: 0; border-top: 1px solid #e0d5c5; margin: 2rem 0;">

      <h3>Ignoring the Meta-Level</h3>

      <p>From Molly Cantillon's warning:</p>

      <blockquote style="border-left: 3px solid #c49052; padding-left: 1rem; margin: 1.5rem 0; font-style: italic; color: #5c4b3a;">
        "Goodhart says optimize for a metric and you game your way to hollow victory."
      </blockquote>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Over-optimizing domain metrics</li>
        <li>Losing sight of actual goals</li>
        <li>WHOOP says recovered but you feel like death</li>
        <li>Trusting the brief over lived experience</li>
      </ul>

      <p><strong>Solutions:</strong></p>
      <ul>
        <li>Maintain a "meta-level outside the system"</li>
        <li>Periodic human review of domain outputs</li>
        <li>Be ready to delete a domain if it stops serving</li>
        <li>"We must continue to live outside it"</li>
      </ul>
    </section>

    <hr class="section-divider divider-checkpoint">

    <!-- Implementation Checklist Section -->
    <section id="implementation-checklist">
      <h2><span style="font-weight: 700;">Imp</span>lementation Checklist</h2>

      <h3>Phase 1: Core Setup (Day 1)</h3>

      <ul>
        <li>Choose 3-5 initial domains</li>
        <li>Create directory structure: <code>mkdir -p ~/{domain1,domain2,domain3}</code></li>
        <li>Write basic CLAUDE.md for each domain</li>
        <li>Set up tmux sessions for each domain</li>
        <li>Test running parallel instances</li>
      </ul>

      <h3>Phase 2: Automation (Week 1)</h3>

      <ul>
        <li>Create domain startup script</li>
        <li>Set up cron jobs for scheduled runs (e.g., overnight <code>~/trades</code>)</li>
        <li>Implement basic handoff protocol in <code>~/shared/</code></li>
        <li>Add domain-specific slash commands</li>
      </ul>

      <h3>Phase 3: Correlation (Week 2)</h3>

      <ul>
        <li>Set up <code>~/correlation/</code> meta-observer</li>
        <li>Create morning synthesis workflow</li>
        <li>Implement cross-domain flagging</li>
        <li>Add notification system for completions</li>
      </ul>

      <h3>Phase 4: Refinement (Ongoing)</h3>

      <ul>
        <li>Tune CLAUDE.md rules based on experience</li>
        <li>Prune domains that don't add value</li>
        <li>Add/remove subagents as needed</li>
        <li>Maintain meta-level perspective</li>
      </ul>
    </section>

    <hr class="section-divider divider-warning">

    <!-- Troubleshooting Section -->
    <section id="troubleshooting">
      <h2><span style="font-weight: 700;">Tro</span>ubleshooting</h2>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Domain Agent Accesses Wrong Directory</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Agent reads/writes files outside its domain directory</p>
          <p><strong>Cause:</strong> Missing directory constraints or agent started from wrong path</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Always start agents with explicit <code>cd ~/domain && claude</code></li>
            <li>Add path restrictions in domain's CLAUDE.md</li>
            <li>Use <code>.claudeignore</code> to exclude parent directories</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Handoffs Not Being Read</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Receiving domain ignores handoff files; no cross-domain awareness</p>
          <p><strong>Cause:</strong> Handoff files not mentioned in CLAUDE.md or wrong path</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Add explicit handoff instruction to receiving domain's CLAUDE.md</li>
            <li>Verify handoff file path matches exactly</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Too Many Domains (Domain Sprawl)</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Managing 15+ domains; high overhead; unclear boundaries</p>
          <p><strong>Cause:</strong> Over-fragmentation; created domains for minor concerns</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Start with 3-5 core domains, expand only when clear need emerges</li>
            <li>Consolidate related concerns (e.g., "finance" includes both "trades" and "expenses")</li>
            <li>Use subagents within domains instead of creating new domains</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Cron Jobs Fail Silently</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Scheduled domain runs don't produce expected output</p>
          <p><strong>Cause:</strong> Environment differences between cron and interactive shell</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Use full paths in cron</li>
            <li>Log stderr to diagnose: <code>2>&1 | tee /tmp/cron-trades.log</code></li>
            <li>Ensure API credentials are available to cron environment</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">tmux Sessions Lost After Reboot</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> All domain sessions gone; must manually restart</p>
          <p><strong>Cause:</strong> tmux sessions don't persist across system restarts</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Create a startup script that recreates sessions</li>
            <li>Add to login items or use tmux-resurrect plugin</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Context Pollution Despite Isolation</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Agent behavior suggests knowledge from other domains</p>
          <p><strong>Cause:</strong> Shared ~/.claude/ config or global CLAUDE.md bleeding through</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Use domain-specific <code>.claude/</code> directories, not global</li>
            <li>Check <code>~/.claude/CLAUDE.md</code> for generic instructions that apply everywhere</li>
            <li>Verify agent is reading the correct domain CLAUDE.md (check path in startup)</li>
          </ol>
        </div>
      </details>
    </section>

    <hr class="section-divider">

    <!-- Note about Anthropic -->
    <div class="callout callout-insight">
      <div class="callout-title">The Anthropic Trade-off</div>
      <blockquote style="margin: 0; font-style: italic;">
        "Sometimes the tower has a landlord. Anthropic sees every query you make. The value exchange is explicit: their visibility into your thinking for access to a thousand-clone attention span. In this case, chosen beats imposed."
      </blockquote>
      <p style="margin-top: 0.5rem; margin-bottom: 0;">Domain isolation provides local privacy (domains don't see each other), but Anthropic's API sees all domains. This is an accepted trade-off for the capability.</p>
    </div>

    <!-- Milestone -->
    <div class="milestone" style="background: linear-gradient(90deg, #6b9b7a 0%, #2a7d7d 100%); color: white; padding: 1rem 1.5rem; border-radius: 8px; text-align: center; margin: 2rem 0;">
      Domain isolation is the foundation for scaling Claude Code across your entire life and work.
    </div>

    <!-- Related Pages -->
    <div class="related-pages" style="margin-top: 2rem; padding: 1rem; background: #f9f6f0; border-radius: 8px;">
      <h4 style="margin-top: 0;">Related Architecture Documents</h4>
      <ul>
        <li><a href="architecture-primitives.html">Architecture Primitives</a> - The atomic building blocks</li>
        <li><a href="architecture-composition-rules.html">Composition Rules</a> - How primitives combine</li>
        <li><a href="architecture-complexity-ladder.html">Complexity Ladder</a> - Progression from Level 0 to Level 7</li>
        <li><a href="architecture-swarm-topologies.html">Swarm Topologies</a> - Advanced multi-agent structures</li>
      </ul>
      <h4>Sources</h4>
      <ul>
        <li><strong>Primary:</strong> @mollycantillon - The Personal Panopticon thread</li>
        <li><strong>Supporting:</strong> @bcherny - Boris Cherny's parallel sessions workflow</li>
      </ul>
    </div>

    <!-- Footer Navigation -->
    <div class="footer-nav" style="display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e0d5c5;">
      <a href="architecture-composition-rules.html">Prev: Composition Rules</a>
      <a href="architecture-complexity-ladder.html">Next: Complexity Ladder</a>
    </div>

  </div>

  <script src="../js/copy-code.js"></script>
  <script src="../js/search.js"></script>
  <script src="../js/global-nav.js"></script>
  <script>
    function copyCode(button) {
      const codeBlock = button.parentElement.querySelector('code');
      navigator.clipboard.writeText(codeBlock.textContent);
      button.textContent = 'Copied!';
      setTimeout(() => button.textContent = 'Copy', 2000);
    }
  </script>
</body>
</html>
