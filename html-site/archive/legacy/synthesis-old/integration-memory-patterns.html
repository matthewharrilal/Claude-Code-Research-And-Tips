<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta data-pagefind-meta="section" content="Synthesis">
  <meta data-pagefind-meta="category" content="Integration">
  <title>Memory Layer Integration Patterns - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/search.css">
</head>
<body>
  <!-- Search Modal -->
  <div class="search-modal" id="searchModal" aria-hidden="true">
    <div class="search-overlay" onclick="closeSearch()"></div>
    <div class="search-content">
      <div class="search-header">
        <div class="search-input-wrapper">
          <span class="search-icon-input">&#128269;</span>
          <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
          <kbd class="search-kbd">ESC</kbd>
        </div>
      </div>
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="synthesis">Synthesis</button>
        <button class="filter-btn" data-filter="extractions">Extractions</button>
        <button class="filter-btn" data-filter="journeys">Journeys</button>
      </div>
      <div class="search-results" id="searchResults">
        <div class="search-empty"><p>Start typing to search... (Press Cmd+K anytime)</p></div>
      </div>
      <div class="search-footer">
        <span>Up/Down Navigate</span><span>Enter Select</span><span>ESC Close</span>
      </div>
    </div>
  </div>

  <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
    <span class="search-icon">Cmd+K</span>
    <span class="search-text">Search</span>
  </button>

  <div class="wide-container">
    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="synthesis-index.html">Synthesis</a>
      <span>/</span>
      <span>Memory Integration Patterns</span>
    </nav>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <h3 style="color: #2a7d7d; margin-top: 0; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px;">You Are Here</h3>
      <p style="margin-bottom: 0;"><strong><span class="b">Mem</span>ory Layer Integration Patterns</strong> - Complete guide to integrating Claude-Mem (session memory), Beads (work tracking), and Claude HUD (observability) into your Claude Code workflows. Covers 3-layer progressive disclosure, cross-session learning, and decision frameworks for tool selection.</p>
    </div>

    <h1><span class="b">Mem</span>ory Layer <span class="b">Int</span>egration Patterns</h1>
    <p class="subtitle">Claude-Mem, Beads, and Claude HUD Complete Guide</p>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">Contents</div>
      <ul>
        <li><a href="#architecture-stack">Memory Layer in the Architecture Stack</a></li>
        <li><a href="#ecosystem">The Memory Layer Ecosystem</a></li>
        <li><a href="#claude-mem">Claude-Mem Integration</a></li>
        <li><a href="#progressive-disclosure">3-Layer Progressive Disclosure</a></li>
        <li><a href="#beads">Beads Dual Persistence</a></li>
        <li><a href="#cross-session">Cross-Session Learning</a></li>
        <li><a href="#decision-tree">When to Use Which Tool</a></li>
        <li><a href="#mental-models">Mental Models</a></li>
        <li><a href="#checkpoints">Checkpoints</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
        <li><a href="#integration-matrix">Integration Matrix</a></li>
        <li><a href="#source-attribution">Source Attribution</a></li>
      </ul>
    </div>

    <hr class="section-divider">

    <!-- Architecture Stack -->
    <section id="architecture-stack">
      <h2><span class="b">Mem</span>ory Layer in the <span class="b">Arch</span>itecture Stack</h2>

      <div class="ascii-diagram">
+=====================================================================+
|                   CLAUDE CODE ARCHITECTURE STACK                      |
+=====================================================================+
|                                                                       |
|  LAYER 5: ORCHESTRATION UI                                            |
|  +---------------------------------------------------------------+   |
|  |  GTGUI, rpai, tmux dashboards                                  |   |
|  +---------------------------------------------------------------+   |
|                                  |                                    |
|  LAYER 4: ORCHESTRATION PATTERNS                                      |
|  +---------------------------------------------------------------+   |
|  |  Ralph Loop | Gas Town | CC-Mirror | Swarms                    |   |
|  +---------------------------------------------------------------+   |
|                                  |                                    |
|  LAYER 3: MEMORY &amp; OBSERVABILITY &lt;------ YOU ARE HERE                 |
|  +---------------------------------------------------------------+   |
|  |  +------------------+  +------------------+  +---------------+ |   |
|  |  |   Claude-Mem     |  |      Beads       |  |  Claude HUD   | |   |
|  |  | Session memory   |  | Multi-agent data |  | Observability | |   |
|  |  | Semantic search  |  | Git-backed state |  | Real-time     | |   |
|  |  | Token compression|  | Dependency graph |  | Context meter | |   |
|  |  +------------------+  +------------------+  +---------------+ |   |
|  +---------------------------------------------------------------+   |
|                                  |                                    |
|  LAYER 2: EXECUTION ENGINE                                            |
|  +---------------------------------------------------------------+   |
|  |  Claude Code CLI - Tools, Hooks, MCP, Skills                   |   |
|  +---------------------------------------------------------------+   |
|                                                                       |
+=====================================================================+</div>

      <h3>Prerequisites</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Requirement</th><th>Purpose</th></tr>
          </thead>
          <tbody>
            <tr><td>Claude Code v1.0.80+</td><td>Plugin support, hooks enabled</td></tr>
            <tr><td>Node.js 18+</td><td>Runtime for plugins</td></tr>
            <tr><td>Git repository</td><td>Required for Beads persistence</td></tr>
            <tr><td>Pro/Max/Team subscription</td><td>For HUD usage display (optional)</td></tr>
          </tbody>
        </table>
      </div>

      <h3>What You'll Learn</h3>

      <ol>
        <li>How each memory tool works independently</li>
        <li>How to combine tools for maximum effect</li>
        <li>Token-efficient retrieval patterns</li>
        <li>Decision framework for tool selection</li>
        <li>Troubleshooting common integration issues</li>
      </ol>
    </section>

    <hr class="section-divider">

    <!-- Memory Layer Ecosystem -->
    <section id="ecosystem">
      <h2><span class="b">The</span> Memory Layer <span class="b">Eco</span>system</h2>

      <h3>The Three Memory Pillars</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                    MEMORY LAYER ECOSYSTEM                               |
+-----------------------------------------------------------------------+
|                                                                         |
|  +-------------------+     +-------------------+     +-----------------+ |
|  |                   |     |                   |     |                 | |
|  |    CLAUDE-MEM     |     |       BEADS       |     |    CLAUDE HUD   | |
|  |  (Session Memory) |     |  (Work Tracking)  |     | (Observability) | |
|  |                   |     |                   |     |                 | |
|  +-------------------+     +-------------------+     +-----------------+ |
|         |                         |                         |           |
|  +--------------+           +-----------+             +-----------+     |
|  | SQLite +     |           | SQLite +  |             | stdin     |     |
|  | Chroma       |           | JSONL     |             | polling   |     |
|  | vectors      |           | (git)     |             | (~300ms)  |     |
|  +--------------+           +-----------+             +-----------+     |
|         |                         |                         |           |
|  +--------------+           +-----------+             +-----------+     |
|  | Observations |           | Issues    |             | Context % |     |
|  | Summaries    |           | Deps      |             | Tools     |     |
|  | Prompts      |           | Molecules |             | Agents    |     |
|  +--------------+           +-----------+             +-----------+     |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Comparison Matrix</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Feature</th><th>Claude-Mem</th><th>Beads</th><th>Claude HUD</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>Primary Purpose</strong></td><td>Session memory</td><td>Work tracking</td><td>Real-time monitoring</td></tr>
            <tr><td><strong>Persistence</strong></td><td>Local SQLite + Chroma</td><td>Git-backed JSONL</td><td>None (real-time)</td></tr>
            <tr><td><strong>Scope</strong></td><td>Single Claude instance</td><td>Multi-agent, multi-machine</td><td>Single session</td></tr>
            <tr><td><strong>Query Type</strong></td><td>Semantic search</td><td>Structured SQL</td><td>Visual display</td></tr>
            <tr><td><strong>Token Cost</strong></td><td>Variable (progressive)</td><td>1-2k (bd prime)</td><td>0 (display only)</td></tr>
            <tr><td><strong>Integration</strong></td><td>Plugin (hooks)</td><td>CLI + hooks</td><td>Plugin</td></tr>
            <tr><td><strong>Sharing</strong></td><td>Per-installation</td><td>Git repository</td><td>Per-terminal</td></tr>
          </tbody>
        </table>
      </div>

      <h3>When to Use Each Tool</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                     TOOL SELECTION QUICK GUIDE                          |
+-----------------------------------------------------------------------+
|                                                                         |
|  CLAUDE-MEM:                                                            |
|  - Need to remember learnings across sessions                           |
|  - Want semantic search ("find that auth bug")                          |
|  - Working alone on complex, multi-session tasks                        |
|  - Token optimization is critical                                       |
|                                                                         |
|  BEADS:                                                                 |
|  - Multiple agents need shared context                                  |
|  - Work involves dependencies ("X blocks Y")                            |
|  - Need git-native collaboration                                        |
|  - Running Gas Town or multi-agent orchestration                        |
|                                                                         |
|  CLAUDE HUD:                                                            |
|  - Want visibility into session state                                   |
|  - Need to monitor context window consumption                           |
|  - Debugging orchestration patterns                                     |
|  - Tracking tool execution and agent activity                           |
|                                                                         |
+-----------------------------------------------------------------------+</div>
    </section>

    <hr class="section-divider">

    <!-- Claude-Mem Integration -->
    <section id="claude-mem">
      <h2><span class="b">Cla</span>ude-Mem <span class="b">Int</span>egration</h2>

      <h3>Integration with Ralph Wiggum Loop</h3>

      <p><strong>The Problem:</strong> Each Ralph iteration starts fresh. Iteration 15's learnings are unknown to iteration 16.</p>

      <p><strong>The Solution:</strong> Claude-mem captures observations automatically, injecting relevant history at session start.</p>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                    RALPH + CLAUDE-MEM INTEGRATION                       |
+-----------------------------------------------------------------------+
|                                                                         |
|   Iteration 1                 Iteration 2                 Iteration 3   |
|   +----------+               +----------+               +----------+    |
|   | Fresh    |               | Fresh    |               | Fresh    |    |
|   | Context  |               | Context  |               | Context  |    |
|   +----+-----+               +----+-----+               +----+-----+    |
|        |                          |                          |          |
|        v                          v                          v          |
|   +----------+               +----------+               +----------+    |
|   | mem      |               | mem      |               | mem      |    |
|   | inject   |-------------&gt;| inject   |-------------&gt;| inject   |    |
|   +----------+               +----------+               +----------+    |
|        |                          |                          |          |
|        | discoveries              | discoveries              |          |
|        v                          v                          v          |
|   +----------+               +----------+               +----------+    |
|   | PostTool |               | PostTool |               | PostTool |    |
|   | capture  |               | capture  |               | capture  |    |
|   +----+-----+               +----+-----+               +----+-----+    |
|        |                          |                          |          |
|        +------------+-------------+-------------+------------+          |
|                     |                           |                       |
|                     v                           v                       |
|              +-------------+             +-------------+                |
|              | SQLite DB   |&lt;----------&gt;| Chroma      |                |
|              | (Structure) |             | (Semantics) |                |
|              +-------------+             +-------------+                |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Configuration for Ralph + Mem</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>{
  "context": {
    "observationCount": 100,
    "fullObservationCount": 10,
    "observationTypes": "feature,discovery,decision,change",
    "observationConcepts": "how-it-works,what-changed,problem-solution,gotcha"
  }
}</code></pre>
      </div>

      <h3>PROMPT.md Addition for Ralph + Mem</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>## Memory Integration

CRITICAL: Before making changes, use mem-search to check prior learnings:
- Query: "[current feature] implementation"
- Query: "[current feature] gotchas"

This surfaces discoveries from previous iterations.
After completing work, ensure observations are captured automatically.</code></pre>
      </div>

      <h3>Example Learning Accumulation</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>Iteration 1:  Discovered auth endpoint structure
              -&gt; Stored as observation type: "discovery"

Iteration 5:  Found rate limiting gotcha
              -&gt; Stored as observation type: "gotcha"

Iteration 12: Decided on retry pattern
              -&gt; Stored as observation type: "decision"

Iteration 18: Refined error handling based on 5+12 learnings
              -&gt; mem-search surfaces iterations 1,5,12 automatically

Iteration 20: Full implementation incorporating all discoveries
              -&gt; Institutional memory across 20 iterations</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Progressive Disclosure -->
    <section id="progressive-disclosure">
      <h2><span class="b">3-Lay</span>er Progressive <span class="b">Dis</span>closure: 90% Token Savings</h2>

      <h3>The Token Economics Problem</h3>

      <p>Raw tool observations can consume 10,000+ tokens per session. Without compression:</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>Session 1: 50,000 tokens of tool output
Session 2: Load all 50,000 tokens? Context explodes.
Session 3: Context window full before work begins.</code></pre>
      </div>

      <h3>The 3-Layer Solution</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|              PROGRESSIVE DISCLOSURE TOKEN FUNNEL                        |
+-----------------------------------------------------------------------+
|                                                                         |
|                        Search Query                                     |
|                             |                                           |
|                             v                                           |
|                    +----------------+                                   |
|                    |                |                                   |
|   LAYER 1          |   100 IDs      |  &lt;- Compact index                 |
|   (~50-100 tokens  |   titles only  |     One line per result           |
|    per result)     |   timestamps   |     NO full content               |
|                    |                |                                   |
|                    +-------+--------+                                   |
|                            |                                            |
|                            | Filter by relevance                        |
|                            v                                            |
|                    +----------------+                                   |
|                    |                |                                   |
|   LAYER 2          |   20 items     |  &lt;- Timeline context              |
|   (summaries)      |   with context |     Observations around anchor    |
|                    |   temporal     |     Still compressed              |
|                    |                |                                   |
|                    +-------+--------+                                   |
|                            |                                            |
|                            | Select specific items                      |
|                            v                                            |
|                    +----------------+                                   |
|                    |                |                                   |
|   LAYER 3          |   5 items      |  &lt;- Full details                  |
|   (~500-1000       |   complete     |     Only what you need            |
|    tokens each)    |   narratives   |     Full observation data         |
|                    |                |                                   |
|                    +-------+--------+                                   |
|                            |                                            |
|                            v                                            |
|                    Context Injection                                    |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Token Savings Calculation</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>Discovery tokens (work performed):     50,000
Progressive retrieval path:
  Layer 1 (100 results):               +  5,000 tokens
  Layer 2 (20 items):                  +  3,000 tokens
  Layer 3 (5 full details):            +  2,500 tokens
Total read tokens:                        10,500 tokens

Savings: ((50,000 - 10,500) / 50,000) * 100 = 79% savings

With better filtering (typical):
  Layer 1 (50 results):                +  2,500 tokens
  Layer 2 (10 items):                  +  1,500 tokens
  Layer 3 (3 full details):            +  1,500 tokens
Total:                                     5,500 tokens

Savings: ((50,000 - 5,500) / 50,000) * 100 = 89% savings</code></pre>
      </div>

      <h3>Configuration for Maximum Savings</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>{
  "context": {
    "observationCount": 50,
    "fullObservationCount": 5,
    "sessionCount": 10,
    "showReadTokens": true,
    "showWorkTokens": true,
    "showSavings": true,
    "fullObservationField": "narrative"
  }
}</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Beads Dual Persistence -->
    <section id="beads">
      <h2><span class="b">Bea</span>ds Dual <span class="b">Per</span>sistence Architecture</h2>

      <h3>The Dual-Persistence Model</h3>

      <p>Beads uses a unique architecture combining fast local queries with git-backed collaboration:</p>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                  BEADS DUAL-PERSISTENCE ARCHITECTURE                    |
+-----------------------------------------------------------------------+
|                                                                         |
|                         +----------------+                              |
|                         |    bd CLI      |                              |
|                         |  (User/Agent)  |                              |
|                         +-------+--------+                              |
|                                 |                                       |
|            +--------------------+--------------------+                  |
|            |                                         |                  |
|            v                                         v                  |
|  +--------------------+                   +--------------------+        |
|  |                    |                   |                    |        |
|  |    SQLite DB       |&lt;-----  sync  ----&gt;|    JSONL Files     |        |
|  |   (Performance)    |                   |   (Git Truth)      |        |
|  |                    |                   |                    |        |
|  |  * Sub-ms queries  |                   |  * Readable diffs  |        |
|  |  * Complex joins   |                   |  * Merge-friendly  |        |
|  |  * Dependency      |                   |  * Version history |        |
|  |    graphs          |                   |  * Collaboration   |        |
|  |  * Full-text       |                   |                    |        |
|  |    search          |                   |                    |        |
|  |                    |                   |                    |        |
|  |  .beads/beads.db   |                   |  .beads/issues.    |        |
|  |  (gitignored)      |                   |  jsonl (tracked)   |        |
|  |                    |                   |                    |        |
|  +--------------------+                   +--------------------+        |
|            |                                         |                  |
|            +--------------------+--------------------+                  |
|                                 |                                       |
|                                 v                                       |
|                         +----------------+                              |
|                         |   Git Remote   |                              |
|                         | (Collaboration)|                              |
|                         +----------------+                              |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>The .beads/ Directory Structure</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>.beads/
+-- issues.jsonl         # Git-tracked source of truth
+-- deletions.jsonl      # Deletion manifest (prevents resurrection)
+-- beads.db             # SQLite cache (gitignored)
+-- sync_base.jsonl      # Last-synced snapshot (gitignored)
+-- bd.sock              # Daemon socket (gitignored)
+-- config.yaml          # Local configuration
+-- metadata.json        # Database metadata</code></pre>
      </div>

      <h3>Molecules and Wisps: Workflow Chemistry</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                     WORKFLOW CHEMISTRY MODEL                            |
+-----------------------------------------------------------------------+
|                                                                         |
|        SOLID              -&gt;         LIQUID           -&gt;    VAPOR       |
|        (Proto)                       (Mol)                  (Wisp)      |
|                                                                         |
|  +------------------+         +------------------+     +--------------+ |
|  |                  |         |                  |     |              | |
|  | Frozen template  |  pour   | Active instance  | run | Ephemeral    | |
|  | Stored in git    |--------&gt;| Persistent       |---&gt; | Temporary    | |
|  | Reusable         |         | Audited          |     | No audit     | |
|  |                  |         |                  |     |              | |
|  +------------------+         +------------------+     +--------------+ |
|                                                                         |
|  Use Case:                    Use Case:               Use Case:         |
|  Template library             Feature work            Routine ops       |
|  Best practices               Multi-session           One-shot tasks    |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>When to Use Each Phase</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Scenario</th><th>Phase</th><th>Rationale</th></tr>
          </thead>
          <tbody>
            <tr><td>Feature implementation</td><td>Mol (Liquid)</td><td>Needs audit trail, multi-session</td></tr>
            <tr><td>Daily patrol cycle</td><td>Wisp (Vapor)</td><td>Routine, no audit value</td></tr>
            <tr><td>Code review</td><td>Wisp (Vapor)</td><td>Ephemeral, result matters not process</td></tr>
            <tr><td>Bug investigation</td><td>Mol (Liquid)</td><td>Findings need preservation</td></tr>
            <tr><td>Deployment checklist</td><td>Proto (Solid)</td><td>Reusable template</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Cross-Session Learning -->
    <section id="cross-session">
      <h2><span class="b">Cro</span>ss-Session <span class="b">Lea</span>rning Compound Patterns</h2>

      <h3>The Compound Learning Loop</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                   CROSS-SESSION COMPOUND LEARNING                       |
+-----------------------------------------------------------------------+
|                                                                         |
|   SESSION 1              SESSION 2              SESSION 3               |
|   +---------+           +---------+           +---------+               |
|   | Learn A |           | Learn B |           | Learn C |               |
|   +----+----+           +----+----+           +----+----+               |
|        |                     |                     |                    |
|        v                     v                     v                    |
|   +---------+           +---------+           +---------+               |
|   | Store A |           | Store B |           | Store C |               |
|   +----+----+           +----+----+           +----+----+               |
|        |                     |                     |                    |
|        +----------+----------+---------+-----------+                    |
|                   |                    |                                |
|                   v                    v                                |
|              +---------+          +---------+                           |
|              | Query   |          | Query   |                           |
|              | A+B     |          | A+B+C   |                           |
|              +---------+          +---------+                           |
|                                                                         |
|   COMPOUND EFFECT: Each session builds on ALL previous sessions         |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Observation Types for Learning</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Type</th><th>When to Use</th><th>Example</th></tr>
          </thead>
          <tbody>
            <tr><td><code>discovery</code></td><td>Found something new</td><td>"Discovered auth endpoint structure"</td></tr>
            <tr><td><code>gotcha</code></td><td>Pitfall or warning</td><td>"Found rate limiting gotcha"</td></tr>
            <tr><td><code>decision</code></td><td>Made architectural choice</td><td>"Decided on retry pattern"</td></tr>
            <tr><td><code>pattern</code></td><td>Recurring pattern</td><td>"This API always needs pagination"</td></tr>
            <tr><td><code>trade-off</code></td><td>Weighed options</td><td>"Chose speed over memory"</td></tr>
            <tr><td><code>how-it-works</code></td><td>Mechanism explanation</td><td>"OAuth flow documented"</td></tr>
            <tr><td><code>why-it-exists</code></td><td>Rationale documentation</td><td>"Legacy compatibility reason"</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Decision Tree -->
    <section id="decision-tree">
      <h2><span class="b">Whe</span>n to Use <span class="b">Whi</span>ch Memory Layer</h2>

      <h3>Decision Flowchart</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                    MEMORY TOOL DECISION TREE                            |
+-----------------------------------------------------------------------+
|                                                                         |
|  START: What do you need?                                               |
|                |                                                        |
|                v                                                        |
|  +---------------------------+                                          |
|  | Need to REMEMBER things   |                                          |
|  | across sessions?          |                                          |
|  +-------------+-------------+                                          |
|       YES      |      NO                                                |
|        |       |       |                                                |
|        v       |       v                                                |
|  +----------+  |  +---------------------------+                         |
|  | Multiple |  |  | Need to SEE what's        |                         |
|  | agents?  |  |  | happening RIGHT NOW?      |                         |
|  +----+-----+  |  +-------------+-------------+                         |
|   YES |  NO    |       YES      |      NO                               |
|    |  |   |    |        |       |       |                               |
|    v  |   v    |        v       |       v                               |
| BEADS |   |    |   CLAUDE HUD   |  Just use                             |
|       |   |    |                |  Claude Code                          |
|       |   v    |                |  directly                             |
|       | CLAUDE-|                |                                       |
|       | MEM    |                |                                       |
|       +--------+                |                                       |
|                                                                         |
|  SECONDARY QUESTIONS:                                                   |
|                                                                         |
|  Need dependency tracking? ---------&gt; BEADS                             |
|  Need semantic search? -------------&gt; CLAUDE-MEM                        |
|  Need git-native workflow? ---------&gt; BEADS                             |
|  Need token optimization? ----------&gt; CLAUDE-MEM (3-layer)              |
|  Need context bar visibility? ------&gt; CLAUDE HUD                        |
|  Need tool execution monitoring? ---&gt; CLAUDE HUD                        |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Scenario-Based Recommendations</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Scenario</th><th>Recommendation</th><th>Rationale</th></tr>
          </thead>
          <tbody>
            <tr><td>Single developer, complex feature</td><td>Claude-Mem</td><td>Personal memory, semantic search</td></tr>
            <tr><td>Team with shared issues</td><td>Beads</td><td>Git-backed, multi-agent</td></tr>
            <tr><td>Ralph loop optimization</td><td>Claude-Mem + HUD</td><td>Memory + visibility</td></tr>
            <tr><td>Gas Town deployment</td><td>Beads + Claude-Mem + HUD</td><td>Shared work + agent memory</td></tr>
            <tr><td>Debugging session issues</td><td>Claude HUD</td><td>Real-time observability</td></tr>
            <tr><td>Long-running autonomous</td><td>All three</td><td>Full memory + observability stack</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Mental Models -->
    <section id="mental-models">
      <h2><span class="b">Men</span>tal <span class="b">Mod</span>els</h2>

      <h3>Mental Model 1: The Memory Pyramid</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                      THE MEMORY PYRAMID                                 |
+-----------------------------------------------------------------------+
|                                                                         |
|                            /\                                           |
|                           /  \                                          |
|                          /    \                                         |
|                         / HOT  \          Current session               |
|                        / MEMORY \         Full detail available         |
|                       /   5-10   \        Immediate access              |
|                      /   items    \                                     |
|                     +--------------+                                    |
|                    /                \                                   |
|                   /    WARM MEMORY   \     Recent sessions              |
|                  /   Summaries + key  \    Compressed                   |
|                 /    observations      \   Searchable                   |
|                /      ~50 items         \                               |
|               +------------------------+                                |
|              /                          \                               |
|             /       COLD MEMORY          \   All historical             |
|            /     Vector search access     \  Unlimited storage          |
|           /      Full archive              \                            |
|          /                                  \                           |
|         +------------------------------------+                          |
|                                                                         |
|  KEY INSIGHT: Progressive disclosure moves data UP the pyramid          |
|               only when needed, saving tokens                           |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Mental Model 2: The Dual Persistence Brain</h3>

      <blockquote>
        <p>"Think of Beads as having two brains: SQLite for thinking fast, JSONL for remembering forever."</p>
      </blockquote>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                    THE DUAL PERSISTENCE BRAIN                           |
+-----------------------------------------------------------------------+
|                                                                         |
|  +---------------------------+   +---------------------------+          |
|  |                           |   |                           |          |
|  |      LEFT BRAIN           |   |      RIGHT BRAIN          |          |
|  |       (SQLite)            |   |        (JSONL)            |          |
|  |                           |   |                           |          |
|  |  * Fast processing        |   |  * Long-term memory       |          |
|  |  * Complex queries        |   |  * Shareable              |          |
|  |  * Local only             |   |  * Version controlled     |          |
|  |  * Ephemeral cache        |   |  * Source of truth        |          |
|  |                           |   |                           |          |
|  +-------------+-------------+   +-------------+-------------+          |
|                |                               |                        |
|                +--------------+----------------+                        |
|                               |                                         |
|                        Synchronization                                  |
|                    (5-second debounce)                                  |
|                                                                         |
|  ANALOGY: Like working in RAM but saving to disk                        |
|           Fast operations, durable storage                              |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Mental Model 3: Dashboard Instrumentation</h3>

      <blockquote>
        <p>"Think of Claude Code sessions as a dynamic system needing instrumentation--like a dashboard in a car to avoid breakdowns."</p>
      </blockquote>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Car Gauge</th><th>HUD Equivalent</th><th>What It Prevents</th></tr>
          </thead>
          <tbody>
            <tr><td>Fuel gauge</td><td>Context meter</td><td>Running out of context</td></tr>
            <tr><td>Speedometer</td><td>Duration timer</td><td>Session too long</td></tr>
            <tr><td>RPM gauge</td><td>Tool activity</td><td>Runaway execution</td></tr>
            <tr><td>Check engine</td><td>Agent status</td><td>Stuck workers</td></tr>
            <tr><td>Temperature</td><td>Usage limits</td><td>Rate limit surprise</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Checkpoints -->
    <section id="checkpoints">
      <h2><span class="b">Check</span>points</h2>

      <!-- Checkpoint: Claude-Mem Installation -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 1: Claude-Mem Installation</div>
        <p><strong>After Installation:</strong></p>
        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code># Check plugin installed
&gt; /plugin list
# Expected output: - claude-mem (installed)

# Check worker running
curl http://localhost:37777/api/health
# Expected: {"status":"ok","version":"9.0.5"}

# Check database created
ls -la ~/.claude-mem/
# Expected: claude-mem.db, settings.json, vector-db/</code></pre>
        </div>
        <p><strong>If you don't see this:</strong></p>
        <ul>
          <li>Reinstall: <code>/plugin install claude-mem</code></li>
          <li>Check Node.js version: <code>node --version</code> (18+ required)</li>
        </ul>
      </div>

      <!-- Checkpoint: Beads Installation -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 2: Beads Installation</div>
        <p><strong>Verify your state:</strong></p>
        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code># CLI Available
bd version
# Expected: Version number (e.g., 1.0.0)

# Repository Initialized
ls -la .beads/
# Expected: issues.jsonl (git-tracked), beads.db (gitignored), config.yaml

# Basic Operations
bd create "Test issue"
bd list
# Expected: Test issue appears in list</code></pre>
        </div>
      </div>

      <!-- Checkpoint: Claude HUD Installation -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 3: Claude HUD Installation</div>
        <p><strong>Verify your state:</strong></p>
        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code># After /plugin install claude-hud
# Expected: claude-hud installed! HUD will appear on your next prompt.

# After next prompt, you should see:
# [Opus 4.5] -------- 35% | myapp | git:(main) | 5m</code></pre>
        </div>
        <p><strong>Features Working:</strong></p>
        <ol>
          <li>Context bar moves when you send prompts</li>
          <li>Tool activity shows when reading/editing files</li>
          <li>Git status shows current branch</li>
        </ol>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Troubleshooting -->
    <section id="troubleshooting">
      <h2><span class="b">Trou</span>bleshooting</h2>

      <details class="troubleshoot">
        <summary>Claude-Mem: Worker Won't Start</summary>
        <div>
          <p><strong>Symptom:</strong> Worker startup blocks Claude Code</p>
          <p><strong>Solution:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Kill existing worker
pkill -f "claude-mem-worker"

# Clear version markers
rm -rf ~/.claude-mem/.version-*

# Restart Claude Code</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Claude-Mem: Empty Context Injection</summary>
        <div>
          <p><strong>Symptom:</strong> New sessions show no prior context</p>
          <p><strong>Diagnosis:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Check worker
curl http://localhost:37777/api/health

# Check database
sqlite3 ~/.claude-mem/claude-mem.db "SELECT COUNT(*) FROM observations;"</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Beads: Database Locked</summary>
        <div>
          <p><strong>Symptom:</strong> "Database locked" error</p>
          <p><strong>Solution:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Stop daemon
bd daemons stop

# Retry operation
bd list</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Beads: Sync Conflict</summary>
        <div>
          <p><strong>Symptom:</strong> Divergent changes error</p>
          <p><strong>Solution:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Check conflicts
bd conflicts

# Accept local or remote
bd conflicts resolve bd-xxxx --ours
# or
bd conflicts resolve bd-xxxx --theirs</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Claude HUD: Not Displaying</summary>
        <div>
          <p><strong>Symptom:</strong> No statusline visible</p>
          <p><strong>Solution:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Re-run setup
/claude-hud:setup

# Or check config
cat ~/.claude/plugins/claude-hud/config.json</code></pre>
          </div>
        </div>
      </details>

      <h3>Emergency Recovery</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># Claude-Mem Full Reset
cp -r ~/.claude-mem ~/.claude-mem-backup
rm -rf ~/.claude-mem
/plugin uninstall claude-mem
/plugin install claude-mem

# Beads Database Recovery
git checkout origin/main -- .beads/issues.jsonl
rm .beads/beads.db
bd sync --force

# Claude HUD Reset
rm -rf ~/.claude/plugins/claude-hud
/plugin install claude-hud
/claude-hud:setup</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Integration Matrix -->
    <section id="integration-matrix">
      <h2><span class="b">Int</span>egration <span class="b">Mat</span>rix</h2>

      <h3>Single Tool Patterns</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Pattern</th><th>Tool</th><th>Use Case</th><th>Token Cost</th></tr>
          </thead>
          <tbody>
            <tr><td>Session Memory</td><td>Claude-Mem</td><td>Solo dev, complex features</td><td>Variable (progressive)</td></tr>
            <tr><td>Work Tracking</td><td>Beads</td><td>Team coordination</td><td>1-2k (bd prime)</td></tr>
            <tr><td>Visibility</td><td>Claude HUD</td><td>Monitoring sessions</td><td>0 (display only)</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Dual Tool Combinations</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Combination</th><th>Use Case</th><th>Setup Complexity</th><th>Value</th></tr>
          </thead>
          <tbody>
            <tr><td>Mem + HUD</td><td>Solo developer visibility</td><td>Low</td><td>High</td></tr>
            <tr><td>Beads + Mem</td><td>Multi-agent with personal memory</td><td>Medium</td><td>Very High</td></tr>
            <tr><td>Beads + HUD</td><td>Gas Town monitoring</td><td>Medium</td><td>High</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Full Stack Pattern</h3>

      <div class="ascii-diagram">
+-----------------------------------------------------------------------+
|                     FULL MEMORY STACK                                   |
+-----------------------------------------------------------------------+
|                                                                         |
|  Claude HUD (observability layer)                                       |
|       |                                                                 |
|       | Real-time visibility into:                                      |
|       | - Context consumption                                           |
|       | - Tool execution                                                |
|       | - Agent activity                                                |
|       |                                                                 |
|  Claude-Mem (semantic memory layer)                                     |
|       |                                                                 |
|       | Cross-session learning:                                         |
|       | - Observation capture                                           |
|       | - Semantic search                                               |
|       | - Progressive disclosure                                        |
|       |                                                                 |
|  Beads (structured work layer)                                          |
|       |                                                                 |
|       | Multi-agent coordination:                                       |
|       | - Issue tracking                                                |
|       | - Dependency graphs                                             |
|       | - Git-backed persistence                                        |
|                                                                         |
|  RESULT: Maximum observability + memory + coordination                  |
|                                                                         |
+-----------------------------------------------------------------------+</div>

      <h3>Orchestration Integration Matrix</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Orchestration</th><th>Recommended Stack</th><th>Setup Time</th><th>Complexity</th></tr>
          </thead>
          <tbody>
            <tr><td>Ralph Loop</td><td>Mem + HUD</td><td>15 min</td><td>Low</td></tr>
            <tr><td>Gas Town</td><td>Beads + Mem + HUD</td><td>45 min</td><td>High</td></tr>
            <tr><td>CC-Mirror</td><td>Mem + HUD</td><td>20 min</td><td>Medium</td></tr>
            <tr><td>Personal Panopticon</td><td>Beads + Mem</td><td>30 min</td><td>Medium</td></tr>
            <tr><td>Full Autonomous</td><td>All Three</td><td>1 hour</td><td>High</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Source Attribution -->
    <section id="source-attribution">
      <h2><span class="b">Sou</span>rce <span class="b">Attr</span>ibution</h2>

      <h3>Primary Sources</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Source</th><th>Document</th><th>Lines</th><th>Coverage</th></tr>
          </thead>
          <tbody>
            <tr><td>Claude HUD</td><td><code>extractions/tooling/008-claude-hud-complete.md</code></td><td>1160+</td><td>Full</td></tr>
            <tr><td>Claude-Mem</td><td><code>extractions/tooling/009-claude-mem-complete.md</code></td><td>1200+</td><td>Full</td></tr>
            <tr><td>Beads</td><td><code>extractions/orchestration/023-beads-data-plane.md</code></td><td>1430+</td><td>Full</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Creator Attribution</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Tool</th><th>Creator</th><th>Repository</th></tr>
          </thead>
          <tbody>
            <tr><td>Claude HUD</td><td>Jarrod Watts (@jarrodwatts)</td><td>github.com/jarrodwatts/claude-hud</td></tr>
            <tr><td>Claude-Mem</td><td>Alex Newman (@thedotmack)</td><td>github.com/thedotmack/claude-mem</td></tr>
            <tr><td>Beads</td><td>Steve Yegge (@Steve_Yegge)</td><td>github.com/steveyegge/beads</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Related Documentation</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Document</th><th>Relationship</th></tr>
          </thead>
          <tbody>
            <tr><td><a href="mastery-ralph-complete.html">mastery-ralph-complete</a></td><td>Ralph pattern integration</td></tr>
            <tr><td><a href="mastery-gastown-complete.html">mastery-gastown-complete</a></td><td>Gas Town architecture</td></tr>
            <tr><td><a href="multi-agent-cc-mirror-complete.html">multi-agent-cc-mirror-complete</a></td><td>CC-Mirror patterns</td></tr>
            <tr><td><a href="architecture-complexity-ladder.html">architecture-complexity-ladder</a></td><td>Complexity progression</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Milestone -->
    <div class="milestone" style="background: linear-gradient(90deg, #6b9b7a 0%, #2a7d7d 100%); color: white; padding: 1rem 1.5rem; border-radius: 8px; text-align: center; margin: 2rem 0;">
      Claude-Mem for session memory. Beads for work tracking. Claude HUD for visibility. Combine all three for maximum coverage.
    </div>

    <!-- Related Pages -->
    <div class="related-pages">
      <h3>Related Pages</h3>
      <ul>
        <li><a href="mastery-ralph-complete.html">Ralph Complete</a> - Ralph loops that integrate with memory</li>
        <li><a href="mastery-gastown-complete.html">Gas Town Complete</a> - Factory orchestration using Beads</li>
        <li><a href="mcp-ecosystem-complete.html">MCP Ecosystem</a> - Protocol and SDK reference</li>
        <li><a href="infrastructure-stack-blueprint.html">Infrastructure Blueprint</a> - Production deployment</li>
      </ul>
    </div>

    <!-- Footer Navigation -->
    <nav class="footer-nav">
      <a href="infrastructure-stack-blueprint.html" class="nav-prev">
        <span class="nav-direction">Previous</span>
        <span class="nav-title">Infrastructure Blueprint</span>
      </a>
      <a href="mcp-ecosystem-complete.html" class="nav-next">
        <span class="nav-direction">Next</span>
        <span class="nav-title">MCP Ecosystem</span>
      </a>
    </nav>

  </div>

  <script src="../js/search.js"></script>
  <script src="../js/sidebar.js"></script>
  <script>
    function copyCode(button) {
      const codeBlock = button.parentElement.querySelector('code');
      navigator.clipboard.writeText(codeBlock.textContent);
      button.textContent = 'Copied!';
      button.classList.add('copied');
      setTimeout(() => {
        button.textContent = 'Copy';
        button.classList.remove('copied');
      }, 2000);
    }
  </script>
<script src="../js/global-nav.js"></script>
</body>
</html>
