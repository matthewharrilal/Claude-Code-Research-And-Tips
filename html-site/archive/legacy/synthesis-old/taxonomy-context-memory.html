<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta data-pagefind-meta="section" content="Synthesis">
  <meta data-pagefind-meta="category" content="Taxonomy">
  <title>Context and Memory Taxonomy - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/search.css">
</head>
<body>
  <!-- Search Modal -->
  <div class="search-modal" id="searchModal" aria-hidden="true">
    <div class="search-overlay" onclick="closeSearch()"></div>
    <div class="search-content">
      <div class="search-header">
        <div class="search-input-wrapper">
          <span class="search-icon-input">&#128269;</span>
          <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
          <kbd class="search-kbd">ESC</kbd>
        </div>
      </div>
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="synthesis">Synthesis</button>
        <button class="filter-btn" data-filter="extractions">Extractions</button>
      </div>
      <div class="search-results" id="searchResults">
        <div class="search-empty"><p>Start typing to search... (Press Cmd+K anytime)</p></div>
      </div>
      <div class="search-footer">
        <span>Up/Down Navigate</span><span>Enter Select</span><span>ESC Close</span>
      </div>
    </div>
  </div>

  <nav class="left-nav" id="leftNav">
    <div class="px-4 mb-4">
      <a href="../index.html" class="text-xs font-semibold text-accent hover:text-accent-light uppercase tracking-wider">Claude Code KB</a>
    </div>
    <div class="nav-content"></div>
  </nav>

  <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
    <span class="search-icon">Cmd+K</span>
    <span class="search-text">Search</span>
  </button>

  <div class="container">
    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="synthesis-index.html">Synthesis</a>
      <span>/</span>
      <a href="taxonomy-master.html">Taxonomy</a>
      <span>/</span>
      <span>Context and Memory Taxonomy</span>
    </nav>

    <!-- Deprecation Notice -->
    <div class="callout callout-warning" style="background: #fff9e6; border-left: 4px solid #c49052; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <div class="callout-title" style="color: #c49052; font-weight: 600;">Deprecated (2026-01-18)</div>
      <p>This content has been superseded by D-FINAL synthesis.</p>
      <p><strong>Replacement:</strong> See D-FINAL-implementation Sections 1-2 for current content.</p>
      <p><strong>Reason:</strong> Content fully covered in D-FINAL with production validation.</p>
      <p>Original preserved below for reference.</p>
    </div>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <h3 style="color: #2a7d7d; margin-top: 0; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px;">You Are Here</h3>
      <p style="margin-bottom: 0;">This is the <strong>memory and persistence reference</strong> for Claude Code. If you're trying to solve the "no persistent memory" problem, understand context window management, or implement multi-agent memory sharing, this document covers every pattern from simple CLAUDE.md to sophisticated Claude-Mem and Gas Town Beads.</p>
    </div>

    <h1><span class="bionic">Con</span>text and <span class="bionic">Mem</span>ory <span class="bionic">Tax</span>onomy</h1>

    <p class="conversational-lead">
      <span class="bionic">Eve</span>ry pattern to solve the fundamental problem: LLMs have <span class="bionic">no</span> persistent memory across sessions. From file-based state to sophisticated semantic compression systems.
    </p>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">Contents</div>
      <ul>
        <li><a href="#memory-problem">Overview: The Memory Problem</a></li>
        <li><a href="#file-based-state">2.1 File-Based State</a></li>
        <li><a href="#git-based-memory">2.2 Git-Based Memory</a></li>
        <li><a href="#external-memory">2.3 External Memory Systems</a></li>
        <li><a href="#context-management">3. Context Management Patterns</a></li>
        <li><a href="#multi-agent-memory">4. Multi-Agent Memory Patterns</a></li>
        <li><a href="#memory-hierarchy">5. Memory Hierarchy Patterns</a></li>
        <li><a href="#pattern-progression">6. Pattern Progression</a></li>
        <li><a href="#tradeoff-matrix">7. Tradeoff Matrix</a></li>
        <li><a href="#decision-tree">8. Implementation Decision Tree</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ul>
    </div>

    <hr class="section-divider">

    <!-- Section 1: The Memory Problem -->
    <section id="memory-problem">
      <h2><span class="bionic">Ove</span>rview: The <span class="bionic">Mem</span>ory <span class="bionic">Pro</span>blem</h2>

      <p>LLMs face a fundamental limitation: <strong>no persistent memory across sessions</strong>. Every new conversation starts from zero. This creates several challenges:</p>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Challenge</th><th>Impact</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>Context window limits</strong></td><td>Can't process entire codebases at once</td></tr>
            <tr><td><strong>Session boundaries</strong></td><td>Must re-explain project context each time</td></tr>
            <tr><td><strong>Context rot</strong></td><td>Performance degrades as context fills up</td></tr>
            <tr><td><strong>Token waste</strong></td><td>Repetitive information consumes expensive tokens</td></tr>
            <tr><td><strong>Lossy compaction</strong></td><td>Auto-summary loses important details</td></tr>
          </tbody>
        </table>
      </div>

      <p>The patterns in this taxonomy represent the community's solutions to these challenges, ranging from simple file-based approaches to sophisticated multi-agent memory architectures.</p>
    </section>

    <hr class="section-divider">

    <!-- Section 2.1: File-Based State -->
    <section id="file-based-state">
      <h2>2.1 <span class="bionic">Fil</span>e-<span class="bionic">Bas</span>ed <span class="bionic">Sta</span>te</h2>

      <p>The simplest and most widely-used persistence pattern. Information survives sessions through filesystem reads.</p>

      <h3>Pattern 2.1.1: CLAUDE.md Knowledge Base</h3>
      <p><strong>Source:</strong> Boris Cherny (Creator), Greg Isenberg, official docs</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>project/
|-- CLAUDE.md              # Project-level knowledge (git-checked)
|-- CLAUDE.local.md        # Personal/secret config (gitignored)
+-- .claude/
    +-- rules/*.md         # Path-specific rules with frontmatter</code></pre>
      </div>

      <h4>How it works</h4>
      <ol>
        <li>Claude Code scans for CLAUDE.md files at startup</li>
        <li>Content injected into system prompt</li>
        <li>Path-targeted rules activate based on file context</li>
        <li>Updates persist via git (CLAUDE.md) or locally (CLAUDE.local.md)</li>
      </ol>

      <h4>When to use</h4>
      <ul>
        <li>Project standards, coding conventions</li>
        <li>Architecture decisions that shouldn't be repeated</li>
        <li>Tool-specific instructions</li>
        <li>Team knowledge that compounds</li>
      </ul>

      <hr class="section-divider divider-context">

      <h3>Pattern 2.1.2: progress.txt Append-Only Log</h3>
      <p><strong>Source:</strong> Ralph Wiggum pattern (Ryan Carson, Matt Pocock, Geoffrey Huntley)</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># progress.txt - APPEND ONLY - NEVER EDIT

---
Iteration 1 (2026-01-09 10:00):
- Completed: US-001 - Tool skeleton created
- Learned: Use orange (#FF6B35) for visibility on dark backgrounds
- Next: Consider beat playback timing

---
Iteration 2 (2026-01-09 10:15):
- Completed: US-002 - Category mapping
- Issue encountered: Zod schema needed adjustment
- Pattern discovered: Always use .optional() explicitly</code></pre>
      </div>

      <div class="callout callout-warning" style="background: #fff9e6; border-left: 4px solid #c49052; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0;">
        <div class="callout-title" style="color: #c49052; font-weight: 600;">Critical Rule</div>
        <p style="margin-bottom: 0;"><strong>NEVER UPDATE</strong> - only append new entries. This preserves the full history of learnings.</p>
      </div>

      <h4>What to log</h4>
      <ul>
        <li>What was completed (reference user story ID)</li>
        <li>What was learned (patterns, gotchas, decisions)</li>
        <li>What blocked or failed</li>
        <li>What to do next</li>
      </ul>

      <hr class="section-divider divider-context">

      <h3>Pattern 2.1.3: prd.json Structured Task State</h3>
      <p><strong>Source:</strong> Ralph pattern, Anthropic best practices</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>{
  "project": "Untangle",
  "branchName": "ralph/feature-name",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create upsertIncome tool skeleton",
      "acceptanceCriteria": [
        "Zod schema matches PRD",
        "npm run typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    }
  ]
}</code></pre>
      </div>

      <h4>Why JSON over Markdown</h4>
      <ul>
        <li>Machine-parseable (jq, scripts)</li>
        <li>Unambiguous state (<code>passes: true/false</code>)</li>
        <li>Smaller context footprint</li>
        <li>Follows Anthropic's internal patterns</li>
      </ul>

      <!-- Checkpoint -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: File-Based State</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>The 4 file-based patterns: CLAUDE.md, progress.txt, prd.json, Filesystem as Memory</li>
          <li>Why progress.txt is APPEND-ONLY (never update)</li>
          <li>What to log in each iteration</li>
          <li>The tradeoffs of each pattern</li>
        </ul>
        <p><strong>Terminal verification:</strong></p>
        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code># Test your memory files exist
ls -la CLAUDE.md plans/prd.json plans/progress.txt 2>/dev/null
# You should see: files with recent modification times</code></pre>
        </div>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 2.2: Git-Based Memory -->
    <section id="git-based-memory">
      <h2>2.2 <span class="bionic">Git</span>-<span class="bionic">Bas</span>ed <span class="bionic">Mem</span>ory</h2>

      <p>Git provides distributed, versioned memory that Claude can read through its standard tooling.</p>

      <h3>Pattern 2.2.1: Commit History as Context</h3>
      <p><strong>Source:</strong> Ralph pattern, Boris Cherny</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># Agent can reconstruct project evolution
git log --oneline -20
git diff HEAD~5
git show &lt;commit-hash&gt;</code></pre>
      </div>

      <h4>Best practices</h4>
      <ul>
        <li>Meaningful commit messages (not "WIP")</li>
        <li>One feature per commit</li>
        <li>Reference PRD/story IDs</li>
        <li>Include "why" not just "what"</li>
      </ul>

      <hr class="section-divider divider-context">

      <h3>Pattern 2.2.2: Git Worktrees for Parallel Isolation</h3>
      <p><strong>Source:</strong> 0xSero (Infinite Orchestra), multi-agent patterns</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># Main repo
~/project/
  |-- .git/           # Shared git database
  +-- src/            # Main working directory

# Worktrees (parallel agent checkouts)
~/project-worktrees/
  |-- feature-a/      # Agent 1's isolated directory
  |-- feature-b/      # Agent 2's isolated directory
  +-- bugfix-c/       # Agent 3's isolated directory</code></pre>
      </div>

      <h4>Use case: Parallel Ralph loops</h4>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>for feature in auth payments notifications; do
  git worktree add ../wt-$feature $feature-branch
  (cd ../wt-$feature && ./ralph.sh 20) &
done
wait</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 2.3: External Memory -->
    <section id="external-memory">
      <h2>2.3 <span class="bionic">Ext</span>ernal <span class="bionic">Mem</span>ory <span class="bionic">Sys</span>tems</h2>

      <h3>Pattern 2.3.1: Claude-Mem Plugin</h3>
      <p><strong>Source:</strong> @thedotmack, shared by Lior Alexander</p>

      <div class="ascii-diagram">
+---------------------------------------------+
|  Claude Code Session                         |
|  +-- Lifecycle Hooks                         |
|       +-- Capture events                     |
+---------------------------------------------+
              |
              v
+---------------------------------------------+
|  Worker Service (port 37777)                 |
|  |-- SQLite DB (raw data)                    |
|  |-- Chroma Vector DB (embeddings)           |
|  +-- Claude Agent SDK (compression)          |
+---------------------------------------------+
              |
              v
+---------------------------------------------+
|  Future Session                              |
|  +-- Auto-inject relevant context            |
+---------------------------------------------+
      </div>

      <h4>Key stats</h4>
      <ul>
        <li>Up to 95% fewer tokens per session</li>
        <li>~20x more tool calls before limit</li>
        <li>Local-only storage (SQLite)</li>
      </ul>

      <h4>Usage</h4>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>// Search for relevant context
search(query = "authentication bug", type = "bugfix", limit = 10)

// Fetch full details (always batch!)
get_observations(ids = [123, 456])</code></pre>
      </div>

      <h4>Privacy</h4>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>&lt;private&gt;
API_KEY=sk-xxx
DATABASE_PASSWORD=secret
&lt;/private&gt;</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 3: Context Management -->
    <section id="context-management">
      <h2>3. <span class="bionic">Con</span>text <span class="bionic">Man</span>agement <span class="bionic">Pat</span>terns</h2>

      <h3>3.1 Fresh Context Per Iteration (Ralph's Clean Slate)</h3>

      <blockquote>
        <p>"Context rot: LLMs get stupider with more tokens"</p>
        <cite>-- @mattpocockuk</cite>
      </blockquote>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>while [ $CURRENT_ITERATION -le $MAX_ITERATIONS ]; do
  echo "Starting Ralph iteration $CURRENT_ITERATION"

  # Fresh instance each time
  claude "Review prd.json and progress.txt..."

  CURRENT_ITERATION=$((CURRENT_ITERATION + 1))
done</code></pre>
      </div>

      <h4>Why this works</h4>
      <ul>
        <li>Full context capacity each iteration</li>
        <li>No accumulated confusion</li>
        <li>External files provide continuity</li>
        <li>Quality doesn't degrade over time</li>
      </ul>

      <h4>Continuity comes from</h4>
      <ul>
        <li>Git history</li>
        <li>prd.json</li>
        <li>progress.txt</li>
        <li>The codebase itself</li>
      </ul>

      <hr class="section-divider divider-context">

      <h3>3.2 Subagent Isolation</h3>
      <p><strong>Source:</strong> @TendiesOfWisdom, Boris Cherny</p>

      <blockquote>
        <p>"The feedback loop is everything, but put costly tools like browser control in subagents to protect your main context window tokens"</p>
      </blockquote>

      <div class="ascii-diagram">
Main Agent Context
|-- Task coordination
|-- High-level decisions
+-- Small token footprint

Subagent 1 (Playwright)
|-- Browser automation
|-- Screenshot analysis
+-- Isolated context (not in main)

Subagent 2 (Research)
|-- WebSearch results
|-- Document parsing
+-- Isolated context (not in main)
      </div>

      <h4>Token savings</h4>
      <ul>
        <li>Playwright output: 1000s of tokens -> 50-token summary</li>
        <li>WebSearch results: 5000 tokens -> 100-token extraction</li>
        <li>File reading: entire file -> relevant snippet</li>
      </ul>

      <hr class="section-divider divider-context">

      <h3>3.3 Model Stepping</h3>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Model</th><th>Input Cost/1M</th><th>Output Cost/1M</th><th>Use Case</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>Haiku</strong></td><td>$0.25</td><td>$1.25</td><td>File lookup, simple grep</td></tr>
            <tr><td><strong>Sonnet</strong></td><td>$3.00</td><td>$15.00</td><td>Implementation, testing</td></tr>
            <tr><td><strong>Opus</strong></td><td>$15.00</td><td>$75.00</td><td>Architecture, complex reasoning</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 4: Multi-Agent Memory -->
    <section id="multi-agent-memory">
      <h2>4. <span class="bionic">Mul</span>ti-<span class="bionic">Age</span>nt <span class="bionic">Mem</span>ory <span class="bionic">Pat</span>terns</h2>

      <h3>4.1 Isolated Domain Memory (Panopticon)</h3>
      <p><strong>Source:</strong> Molly Cantillon</p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>~/nox/        -> Only NOX agent touches
~/trades/     -> Only Finance agent touches
~/health/     -> Only Health agent touches</code></pre>
      </div>

      <h4>Properties</h4>
      <ul>
        <li>Zero cross-contamination</li>
        <li>Complete autonomy</li>
        <li>Filesystem as single source of truth</li>
        <li>No coordination protocol needed</li>
      </ul>

      <h3>4.2 File-Based Handoffs</h3>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>// ~/shared/handoff-agent1-to-agent2.json
{
  "from": "agent1",
  "to": "agent2",
  "timestamp": "2026-01-09T10:30:00Z",
  "context": {
    "completed": ["API schema", "Database models"],
    "next_steps": ["Implement REST endpoints"],
    "blockers": [],
    "notes": "Using FastAPI, see docs in /api/README.md"
  }
}</code></pre>
      </div>

      <h4>Protocol</h4>
      <ol>
        <li>Agent 1 writes handoff file on completion</li>
        <li>Agent 2 polls or watches for file</li>
        <li>Agent 2 reads context, deletes/archives file</li>
        <li>Continues work</li>
      </ol>
    </section>

    <hr class="section-divider">

    <!-- Section 5: Memory Hierarchy -->
    <section id="memory-hierarchy">
      <h2>5. <span class="bionic">Mem</span>ory <span class="bionic">Hie</span>rarchy <span class="bionic">Pat</span>terns</h2>

      <h3>Four-Tier Claude Code Memory</h3>

      <div class="ascii-diagram">
+---------------------------------------------------------------+
| Layer 1: Enterprise Policy                                     |
| /Library/Application Support/ClaudeCode/CLAUDE.md              |
| Organization-wide security policies, compliance requirements    |
+---------------------------------------------------------------+
| Layer 2: Project Memory                                         |
| ./CLAUDE.md or ./.claude/CLAUDE.md                              |
| Architecture decisions, coding standards, team workflows        |
+---------------------------------------------------------------+
| Layer 3: Modular Rules                                          |
| ./.claude/rules/*.md                                            |
| Path-specific rules with frontmatter targeting                  |
+---------------------------------------------------------------+
| Layer 4: Personal + Local                                       |
| ~/.claude/CLAUDE.md (user global)                               |
| ./CLAUDE.local.md (project local, gitignored)                   |
| Agent-specific context, sandbox URLs, test credentials          |
+---------------------------------------------------------------+
      </div>

      <p><strong>Loading order:</strong> Enterprise -> Project -> Modular Rules -> Personal -> Local</p>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Layer</th><th>What Goes Here</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>Enterprise</strong></td><td>Security policies, compliance, banned patterns</td></tr>
            <tr><td><strong>Project</strong></td><td>Architecture, stack decisions, team conventions</td></tr>
            <tr><td><strong>Modular Rules</strong></td><td>Path-specific patterns (API rules, test patterns)</td></tr>
            <tr><td><strong>Personal</strong></td><td>Global preferences, aliases, style</td></tr>
            <tr><td><strong>Local</strong></td><td>Secrets, sandbox URLs, personal experiments</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 6: Pattern Progression -->
    <section id="pattern-progression">
      <h2>6. <span class="bionic">Pat</span>tern <span class="bionic">Pro</span>gression: <span class="bionic">Sim</span>ple to <span class="bionic">Com</span>plex</h2>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Stage</th><th>Pattern</th><th>Effort</th><th>Best For</th></tr>
          </thead>
          <tbody>
            <tr><td>1</td><td>No Persistence (Default)</td><td>Zero</td><td>One-off questions, simple tasks</td></tr>
            <tr><td>2</td><td>CLAUDE.md Only</td><td>5 minutes</td><td>Project standards, recurring patterns</td></tr>
            <tr><td>3</td><td>Ralph Pattern (Files + Git)</td><td>1 hour setup</td><td>Feature development, overnight work</td></tr>
            <tr><td>4</td><td>Claude-Mem (Semantic Memory)</td><td>Plugin install</td><td>Long-term projects, multi-session work</td></tr>
            <tr><td>5</td><td>Multi-Agent Isolation (Panopticon)</td><td>Hours</td><td>Life automation, domain specialists</td></tr>
            <tr><td>6</td><td>Orchestrated Multi-Agent</td><td>Significant</td><td>Complex projects, team collaboration</td></tr>
            <tr><td>7+</td><td>Agent Factory (Gas Town)</td><td>Days</td><td>"Superintelligent chimpanzee wrangling"</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 7: Tradeoff Matrix -->
    <section id="tradeoff-matrix">
      <h2>7. <span class="bionic">Tra</span>deoff <span class="bionic">Mat</span>rix</h2>

      <h3>Memory Pattern Selection</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Pattern</th><th>Setup</th><th>Token Cost</th><th>Persistence</th><th>Queryability</th><th>Multi-Agent</th><th>Best For</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>None</strong></td><td>Zero</td><td>Low</td><td>None</td><td>N/A</td><td>No</td><td>One-off tasks</td></tr>
            <tr><td><strong>CLAUDE.md</strong></td><td>5 min</td><td>Medium</td><td>Session</td><td>No</td><td>Via git</td><td>Standards</td></tr>
            <tr><td><strong>progress.txt</strong></td><td>10 min</td><td>Low</td><td>Permanent</td><td>Text search</td><td>Manual</td><td>Learnings</td></tr>
            <tr><td><strong>prd.json</strong></td><td>30 min</td><td>Very Low</td><td>Permanent</td><td>jq queries</td><td>Via git</td><td>Task state</td></tr>
            <tr><td><strong>Git history</strong></td><td>Built-in</td><td>Very Low</td><td>Permanent</td><td>git log/diff</td><td>Natural</td><td>Code changes</td></tr>
            <tr><td><strong>Claude-Mem</strong></td><td>30 min</td><td>Very Low</td><td>Permanent</td><td>Semantic</td><td>Shared DB</td><td>Long projects</td></tr>
            <tr><td><strong>Panopticon</strong></td><td>Hours</td><td>Low</td><td>Permanent</td><td>Per-domain</td><td>Isolated</td><td>Life OS</td></tr>
            <tr><td><strong>Gas Town</strong></td><td>Days</td><td>High</td><td>Permanent</td><td>Beads</td><td>Full support</td><td>Scale</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Section 8: Decision Tree -->
    <section id="decision-tree">
      <h2>8. <span class="bionic">Imp</span>lementation <span class="bionic">Dec</span>ision <span class="bionic">Tre</span>e</h2>

      <div class="ascii-diagram">
START: Do I need persistent memory?
|
+-- NO -> Use default Claude Code
|
+-- YES -> What kind of persistence?
         |
         +-- Project knowledge -> CLAUDE.md
         |   +-- Team shared? -> Git check it
         |   +-- Personal? -> CLAUDE.local.md
         |
         +-- Task state -> prd.json
         |   +-- Simple tasks? -> Flat JSON
         |   +-- Complex dependencies? -> CC Mirror TaskCreate
         |
         +-- Learnings across iterations -> progress.txt
         |   +-- Growing too large? -> Periodic archiving
         |
         +-- Code history -> Git (built-in)
         |   +-- Parallel work? -> Worktrees
         |
         +-- Semantic memory -> Claude-Mem plugin
         |
         +-- Multi-agent?
             |
             +-- Isolated domains -> Panopticon (directories)
             |
             +-- Coordinated tasks -> CC Mirror
             |
             +-- Factory scale -> Gas Town (Stage 7+)
      </div>

      <h3>Quick Reference Commands</h3>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># Create CLAUDE.md
echo "# Project Standards" > CLAUDE.md

# Initialize progress.txt
echo "# Progress - APPEND ONLY" > progress.txt

# Create prd.json
echo '{"userStories": []}' > prd.json

# Create worktree for parallel agent
git worktree add ../wt-feature feature-branch

# Install Claude-Mem
/plugin marketplace add thedotmack/claude-mem
/plugin install claude-mem

# Run Ralph loop
./ralph.sh 25</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Troubleshooting -->
    <section id="troubleshooting">
      <h2><span class="bionic">Tro</span>ubleshooting</h2>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065;">Context Window Fills Up Too Quickly</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Quality degrades mid-task, agent forgets earlier context</p>
          <p><strong>Cause:</strong> Too much context loaded, or expensive operations in main context</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Move expensive tools to subagents (Playwright, MCP, large file reads)</li>
            <li>Use fresh context per iteration (Ralph pattern)</li>
            <li>Enable auto-compact in CC Mirror</li>
            <li>Verify CLAUDE.md isn't bloated: <code>wc -l CLAUDE.md</code> (should be &lt;500 lines)</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065;">progress.txt Getting Too Large</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Progress file consuming too much context, slowing iterations</p>
          <p><strong>Cause:</strong> Not pruning old learnings</p>
          <p><strong>Fix:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># 1. Check current size
wc -l plans/progress.txt
# If > 100 entries, consider archiving

# 2. Archive old entries
head -50 plans/progress.txt > plans/progress-archive-$(date +%Y-%m).txt
tail -50 plans/progress.txt > plans/progress-new.txt
mv plans/progress-new.txt plans/progress.txt</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065;">Claude-Mem Not Finding Relevant Context</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Semantic search returns irrelevant results</p>
          <p><strong>Cause:</strong> Query too broad, or observations not properly tagged</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Use specific type filters: <code>search(query="auth bug", type="bugfix")</code></li>
            <li>Always batch IDs in get_observations (never single fetches)</li>
            <li>Check Chroma DB health: <code>ls -la ~/.claude-mem/chroma/</code></li>
            <li>Rebuild embeddings if corrupted: reinstall claude-mem plugin</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065;">Multi-Agent Memory Conflicts</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptom:</strong> Agents overwrite each other's state, or miss handoffs</p>
          <p><strong>Cause:</strong> Unclear ownership or timing issues</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Use explicit file ownership (each agent owns its directory)</li>
            <li>Use handoff protocol with timestamps and acknowledgment</li>
            <li>For shared state, use TaskCreate/TaskUpdate dependencies</li>
            <li>Consider using file locks: <code>flock -x /tmp/shared.lock -c "write_to_shared_file"</code></li>
          </ol>
        </div>
      </details>
    </section>

    <hr class="section-divider">

    <!-- Related Pages -->
    <div class="related-pages">
      <h3>Related Taxonomy Documents</h3>
      <ul>
        <li><a href="taxonomy-architectures.html">Architecture Taxonomy</a> - Agent pattern classification</li>
        <li><a href="taxonomy-cross-reference.html">Cross-Reference Index</a> - Theme connections and author expertise</li>
        <li><a href="compare-memory.html">Memory Comparison</a> - File-based vs git-based vs external</li>
      </ul>
    </div>

    <!-- Footer Navigation -->
    <nav class="footer-nav">
      <a href="taxonomy-architectures.html" class="nav-prev">
        <span class="nav-direction">Previous</span>
        <span class="nav-title">Architecture Taxonomy</span>
      </a>
      <a href="taxonomy-cross-reference.html" class="nav-next">
        <span class="nav-direction">Next</span>
        <span class="nav-title">Cross-Reference Index</span>
      </a>
    </nav>

    <!-- Tags -->
    <div style="margin-top: 2rem;">
      <span class="tag">#taxonomy</span>
      <span class="tag">#context-management</span>
      <span class="tag">#memory</span>
      <span class="tag">#persistence</span>
      <span class="tag">#file-based</span>
      <span class="tag">#git-based</span>
      <span class="tag">#claude-mem</span>
      <span class="tag">#fresh-context</span>
      <span class="tag">#ralph</span>
      <span class="tag">#panopticon</span>
    </div>
  </div>

  <script src="../js/copy-code.js"></script>
  <script src="../js/search.js"></script>
  <script src="../js/global-nav.js"></script>
</body>
</html>
