<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta data-pagefind-meta="section" content="Synthesis">
  <meta data-pagefind-meta="category" content="Mastery">
  <title>CC Mirror Complete Mastery Guide - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/search.css">
</head>
<body>
  <nav class="left-nav" id="leftNav">
    <div class="px-4 mb-4">
      <a href="../index.html" class="text-xs font-semibold text-accent hover:text-accent-light uppercase tracking-wider">Claude Code KB</a>
    </div>
    <div class="nav-content"></div>
  </nav>

  <!-- Search Modal -->
  <div class="search-modal" id="searchModal" aria-hidden="true">
    <div class="search-overlay" onclick="closeSearch()"></div>
    <div class="search-content">
      <div class="search-header">
        <div class="search-input-wrapper">
          <span class="search-icon-input">&#128269;</span>
          <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
          <kbd class="search-kbd">ESC</kbd>
        </div>
      </div>
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="synthesis">Synthesis</button>
        <button class="filter-btn" data-filter="extractions">Extractions</button>
      </div>
      <div class="search-results" id="searchResults">
        <div class="search-empty"><p>Start typing to search... (Press Cmd+K anytime)</p></div>
      </div>
      <div class="search-footer">
        <span>Up/Down Navigate</span><span>Enter Select</span><span>ESC Close</span>
      </div>
    </div>
  </div>

  <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
    <span class="search-icon">Cmd+K</span>
    <span class="search-text">Search</span>
  </button>

  <div class="wide-container">
    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="synthesis-index.html">Synthesis</a>
      <span>/</span>
      <span>Mastery</span>
      <span>/</span>
      <span>CC Mirror Complete</span>
    </nav>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <h3 style="color: #2a7d7d; margin-top: 0; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px;">You Are Here</h3>
      <p style="margin-bottom: 0;"><strong>CC Mirror</strong> is the <strong>native multi-agent orchestration</strong> feature hidden inside Claude Code. This guide teaches you to unlock Level 4-5 orchestration using Anthropic's own disabled primitives - TaskCreate, TaskUpdate, TaskGet - without building custom infrastructure. If you want hub-and-spoke parallel agent coordination with 3 commands, start here.</p>
    </div>

    <h1><span style="font-weight: 700;">CC</span> Mirror: Complete Mastery Guide</h1>

    <p class="conversational-lead">
      CC Mirror enables <span style="font-weight: 700;">native multi-agent orchestration</span> using primitives Anthropic already built but disabled. This is the definitive reference for unlocking Level 4-5 capabilities with minimal infrastructure.
    </p>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">Contents</div>
      <ul>
        <li><a href="#complexity-position">Position on Complexity Ladder</a> - Level 4 orchestration</li>
        <li><a href="#mental-models">Core Mental Models</a> - Trading Floor, Kraken, Hub-and-Spoke</li>
        <li><a href="#task-api">Task API Deep Dive</a> - TaskCreate, TaskUpdate, TaskGet</li>
        <li><a href="#iron-law">The Iron Law</a> - Orchestrator vs Worker separation</li>
        <li><a href="#worker-preambles">Worker Preambles</a> - Anti-recursion safety</li>
        <li><a href="#model-escalation">Model Escalation</a> - Haiku/Sonnet/Opus selection</li>
        <li><a href="#haiku-army">The Haiku Army Pattern</a> - 10x cheaper, 10x faster</li>
        <li><a href="#installation">Installation</a> - 3 commands to orchestration</li>
        <li><a href="#checkpoints">Checkpoints</a> - Implementation journey</li>
        <li><a href="#troubleshooting">Troubleshooting</a> - Common issues and recovery</li>
      </ul>
    </div>

    <hr class="section-divider divider-context">

    <!-- Position Section -->
    <section id="complexity-position">
      <h2><span style="font-weight: 700;">Pos</span>ition on Complexity Ladder</h2>

      <div class="ascii-diagram">
Level 7: Gas Town (Factory-Scale)          [ ]  Team-scale solo
         |
Level 6: Parallel Swarms + Worktrees       [ ]  Massive parallelization
         |
Level 5: Multi-Instance Coordination       [ ]  Named persistent agents
         |
Level 4: NATIVE ORCHESTRATION (CC Mirror)  [*] &lt;-- YOU ARE HERE
         |
Level 3: Memory Persistence                [ ]  Skills, hooks, context
         |
Level 2: Hooks and Automation              [ ]  Event-driven responses
         |
Level 1: CLAUDE.md + Commands              [ ]  Consistent behavior
         |
Level 0: Single Interactive Session        [ ]  Basic AI assistance
      </div>

      <p>CC Mirror unlocks Level 4-5 orchestration using primitives Anthropic already built but disabled. Before CC Mirror, reaching this level required building custom task management systems, implementing worker coordination manually, and creating your own monitoring dashboards.</p>

      <blockquote style="border-left: 3px solid #2a7d7d; padding-left: 1rem; margin: 1.5rem 0; font-style: italic; color: #5c4b3a;">
        "Claude Code - Official Multi Agent Orchestration. This is a disabled feature, but through CC Mirror, I have been able to enable it. It is so simple, yet powerful and IMO beats every orchestration I've seen. There's no point building your own."
        <cite style="display: block; margin-top: 0.5rem; font-size: 0.9em;">-- Numman Ali (@nummanali)</cite>
      </blockquote>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Mental Models Section -->
    <section id="mental-models">
      <h2><span style="font-weight: 700;">Cor</span>e Mental Models</h2>

      <h3>Mental Model 1: The Trading Floor</h3>
      <div class="callout callout-insight">
        <div class="callout-title">You are the Conductor on the trading floor of agents</div>
        <p>FAST. DECISIVE. Commanding a symphony of parallel work. Users bring dreams. You make them real. This is what AGI feels like.</p>
      </div>

      <p>This mental model frames the orchestrator as a <strong>decision-maker, NOT an implementer</strong> - moving fast through parallel work, handling chaos while radiating simplicity.</p>

      <h3>Mental Model 2: Hub-and-Spoke Architecture</h3>
      <div class="ascii-diagram">
                      +------------------+
                      |   ORCHESTRATOR   |
                      |   (Conductor)    |
                      +--------+---------+
                               |
                               | Task() with run_in_background=True
                               |
               +---------------+---------------+
               |               |               |
               v               v               v
          +---------+   +---------+   +---------+
          | Worker1 |   | Worker2 |   | Worker3 |
          | (Coder) |   | (Tester)|   | (Docs)  |
          +---------+   +---------+   +---------+
                |             |             |
                +-------------+-------------+
                              |
                       Shared Filesystem
                       (handoff files)
      </div>

      <h3>Key Architectural Properties</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Property</th><th>Implementation</th></tr>
        </thead>
        <tbody>
          <tr><td>Central coordination</td><td>Orchestrator manages task graph</td></tr>
          <tr><td>Worker isolation</td><td>Each worker has independent context</td></tr>
          <tr><td>Parallel execution</td><td>Workers run simultaneously</td></tr>
          <tr><td>File-based handoff</td><td>Results shared via filesystem</td></tr>
          <tr><td>Automatic unblocking</td><td>Dependencies resolve on completion</td></tr>
        </tbody>
      </table>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Task API Section -->
    <section id="task-api">
      <h2><span style="font-weight: 700;">Tas</span>k API Deep Dive</h2>

      <p>Anthropic built and shipped these tools but <strong>turned them off</strong>. CC Mirror re-enables them:</p>

      <div class="ascii-diagram">
HIDDEN TASK MANAGEMENT APIs
============================
TaskCreate   --&gt; Create task with subject, description, acceptance
TaskList     --&gt; Filter: status='open', no owner, not blocked
TaskGet      --&gt; Full context: description, comments, dependencies
TaskUpdate   --&gt; Claim (set owner), add comments, resolve, link refs

HIDDEN DEPENDENCY MANAGEMENT
============================
addBlocks     --&gt; This task blocks another
addBlockedBy  --&gt; This task is blocked by another
      </div>

      <h3>TaskCreate Example</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>{
  "subject": "Implement authentication middleware",
  "description": "Create Express middleware for JWT verification",
  "acceptanceCriteria": [
    "Middleware validates JWT signature",
    "Returns 401 on invalid/expired token",
    "Attaches user object to request",
    "npm run typecheck passes"
  ],
  "priority": 1,
  "blockedBy": ["task-id-001"],
  "blocks": ["task-id-003", "task-id-004"]
}</code></pre>
      </div>

      <div class="callout callout-warning">
        <div class="callout-title">Critical Insight: Verifiable Acceptance Criteria</div>
        <p>Acceptance criteria MUST be verifiable by the agent itself. Vague criteria like "works correctly" or "good UX" lead to false completion signals.</p>
      </div>

      <h3>Task vs TodoWrite Comparison</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Feature</th><th>TaskCreate</th><th>TodoWrite</th></tr>
        </thead>
        <tbody>
          <tr><td>Persistence</td><td>Survives sessions</td><td>Ephemeral</td></tr>
          <tr><td>Owners</td><td>Agent IDs</td><td>None</td></tr>
          <tr><td>Dependencies</td><td>blocks/blockedBy</td><td>None</td></tr>
          <tr><td>Team visibility</td><td>Yes</td><td>No</td></tr>
        </tbody>
      </table>
    </section>

    <hr class="section-divider divider-warning">

    <!-- Iron Law Section -->
    <section id="iron-law">
      <h2><span style="font-weight: 700;">The</span> Iron Law: Orchestrator =/= Tool User</h2>

      <div class="callout callout-warning">
        <div class="callout-title">THE IRON LAW OF CC MIRROR ORCHESTRATION</div>
        <p><strong>YOU DO NOT WRITE CODE. YOU DO NOT RUN COMMANDS. YOU DO NOT EXPLORE CODEBASES.</strong></p>
        <p>You are the CONDUCTOR. Your agents play the instruments.</p>
      </div>

      <h3>Why This Rule Exists</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Violation</th><th>Consequence</th></tr>
        </thead>
        <tbody>
          <tr><td>Orchestrator writes code</td><td>Context pollution - loses strategic view</td></tr>
          <tr><td>Orchestrator explores codebase</td><td>Context bloat - less room for coordination</td></tr>
          <tr><td>Orchestrator runs commands</td><td>Verification bypass - same agent writes and approves</td></tr>
          <tr><td>Workers spawn sub-workers</td><td>Uncontrolled recursion - exponential agent explosion</td></tr>
        </tbody>
      </table>

      <h3>Tool Ownership Division</h3>
      <p><strong>Orchestrator Uses Directly:</strong></p>
      <ul>
        <li><code>Read</code> - References, guides, agent outputs (1-2 files max)</li>
        <li><code>TaskCreate</code>, <code>TaskUpdate</code>, <code>TaskGet</code>, <code>TaskList</code> - Unlimited</li>
        <li><code>AskUserQuestion</code> - When ambiguous</li>
        <li><code>Task</code> - Spawn workers (with preamble)</li>
      </ul>

      <p><strong>Workers Use Directly:</strong></p>
      <ul>
        <li><code>Read</code>, <code>Write</code>, <code>Edit</code>, <code>Bash</code> - Full access</li>
        <li><code>Glob</code>, <code>Grep</code>, <code>WebFetch</code>, <code>WebSearch</code>, <code>LSP</code> - Full access</li>
      </ul>

      <p><strong>Workers NEVER Use:</strong> <code>TaskCreate</code>, <code>TaskUpdate</code>, <code>TaskGet</code>, <code>TaskList</code>, <code>Task</code> (no sub-worker spawning)</p>

      <blockquote style="border-left: 3px solid #c49052; padding-left: 1rem; margin: 1.5rem 0; font-style: italic; color: #5c4b3a;">
        If reading more than 2 files, spawn an agent instead. This keeps the orchestrator's context clean for strategic decisions.
      </blockquote>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Worker Preambles Section -->
    <section id="worker-preambles">
      <h2><span style="font-weight: 700;">Wor</span>ker Preambles: Anti-Recursion Safety</h2>

      <p>Worker preambles are the <strong>primary defense</strong> against recursion chaos, role confusion, and context pollution.</p>

      <h3>Standard Worker Preamble Template</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>CONTEXT: You are a WORKER agent, not an orchestrator.

RULES:
- Complete ONLY the task described below
- Use tools directly (Read, Write, Edit, Bash, etc.)
- Do NOT spawn sub-agents
- Do NOT call TaskCreate or TaskUpdate
- Report your results with absolute file paths

TASK:
[Your specific task here]</code></pre>
      </div>

      <h3>Specialized Preambles</h3>

      <details class="troubleshoot" style="border: 1px solid #2a7d7d; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #f0ebe3; padding: 1rem; cursor: pointer; color: #2a7d7d; font-weight: 600;">Codebase Explorer Preamble</summary>
        <div style="padding: 1rem;">
          <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
            <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
            <pre style="margin: 0; overflow-x: auto;"><code>CONTEXT: You are a CODEBASE EXPLORER worker.
PURPOSE: Deep investigation of code structure and patterns.

RULES:
- Use Glob and Grep extensively to map the codebase
- Build mental model of architecture from code, not assumptions
- Report findings as structured notes
- Do NOT modify any files
- Do NOT spawn sub-agents
- Include absolute file paths in all references

OUTPUT FORMAT:
- File: [absolute path]
- Purpose: [what this file/module does]
- Dependencies: [imports, calls to other modules]
- Patterns: [notable patterns or conventions used]

TASK:
[exploration task]</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #2a7d7d; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #f0ebe3; padding: 1rem; cursor: pointer; color: #2a7d7d; font-weight: 600;">Security Audit Preamble</summary>
        <div style="padding: 1rem;">
          <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
            <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
            <pre style="margin: 0; overflow-x: auto;"><code>CONTEXT: You are a SECURITY AUDIT worker.
PURPOSE: Identify security vulnerabilities in code.

RULES:
- Check for OWASP Top 10 vulnerabilities
- Scan for hardcoded secrets (API keys, passwords)
- Identify SQL injection, XSS, CSRF risks
- Review authentication/authorization patterns
- Do NOT modify code, only report
- Do NOT spawn sub-agents

OUTPUT FORMAT:
- File: [absolute path]
- Line: [line number]
- Severity: [critical/high/medium/low]
- Issue: [description]
- Recommendation: [fix suggestion]

TASK:
[security audit task]</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #2a7d7d; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #f0ebe3; padding: 1rem; cursor: pointer; color: #2a7d7d; font-weight: 600;">Testing Worker Preamble</summary>
        <div style="padding: 1rem;">
          <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
            <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
            <pre style="margin: 0; overflow-x: auto;"><code>CONTEXT: You are a TESTING worker.
PURPOSE: Write comprehensive tests for code.

RULES:
- Write comprehensive tests
- Follow existing test patterns
- Include edge cases
- Run tests and report results
- Do NOT spawn sub-agents
- Report test file locations with absolute paths

TASK:
[testing task]</code></pre>
          </div>
        </div>
      </details>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Model Escalation Section -->
    <section id="model-escalation">
      <h2><span style="font-weight: 700;">Mod</span>el Escalation Pattern</h2>

      <h3>Model Selection by Task Complexity</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Model</th><th>Use Case</th><th>Spawn Count</th><th>Cost Impact</th></tr>
        </thead>
        <tbody>
          <tr><td><strong>Haiku</strong></td><td>Errand runner: fetch files, grep, simple lookups</td><td>5-10 in parallel</td><td>Low</td></tr>
          <tr><td><strong>Sonnet</strong></td><td>Capable worker: structured implementation, following patterns</td><td>2-5 parallel</td><td>Medium</td></tr>
          <tr><td><strong>Opus</strong></td><td>Complex reasoning, architecture decisions, ambiguous tasks</td><td>1 (sequential)</td><td>High</td></tr>
        </tbody>
      </table>

      <h3>Error-Based Escalation</h3>
      <div class="ascii-diagram">
If Haiku fails on a task:
  --&gt; Retry with SONNET (add error context to preamble)

If Sonnet fails on a task:
  --&gt; Retry with OPUS (add error context to preamble)

If Opus fails on a task:
  --&gt; ESCALATE TO HUMAN via AskUserQuestion

PREAMBLE ADDITION FOR RETRY:
"PRIOR ATTEMPT FAILED: [error summary]
 AVOID: [specific pitfall identified]"
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Haiku Army Section -->
    <section id="haiku-army">
      <h2><span style="font-weight: 700;">The</span> Haiku Army Pattern</h2>

      <p>Instead of one expensive model doing 10 file operations, spawn 10 cheap Haiku workers in parallel.</p>

      <div class="ascii-diagram">
TRADITIONAL APPROACH:
--------------------
One Opus session doing 10 file reads sequentially
- Each read accumulates context
- Context pollution reduces quality
- Cost: ~$0.50-1.00
- Time: 10 sequential operations

HAIKU ARMY APPROACH:
-------------------
10 Haiku workers in parallel, each reading 1 file
- Each worker has isolated, clean context
- No context pollution
- Cost: ~$0.05-0.10
- Time: 1 parallel operation (10x faster)

RESULT: 10-20x cheaper AND 10x faster
      </div>

      <h3>When to Use Haiku Army</h3>
      <ul>
        <li>File content retrieval (5-10 parallel)</li>
        <li>Grep operations across codebase</li>
        <li>Simple transformations</li>
        <li>Documentation lookups</li>
        <li>Format checking</li>
      </ul>

      <h3>When NOT to Use Haiku Army</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Use Case</th><th>Use Instead</th></tr>
        </thead>
        <tbody>
          <tr><td>Requires cross-file reasoning</td><td>Sonnet with multiple file reads</td></tr>
          <tr><td>Complex decision making</td><td>Opus single worker</td></tr>
          <tr><td>Security-critical analysis</td><td>Opus with security preamble</td></tr>
          <tr><td>Architecture decisions</td><td>Opus sequential</td></tr>
        </tbody>
      </table>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Installation Section -->
    <section id="installation">
      <h2><span style="font-weight: 700;">Ins</span>tallation and Configuration</h2>

      <h3>Quick Start (3 Commands)</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Step 1: Create isolated variant
npx cc-mirror quick --provider mirror --name mclaude

# Step 2: Launch it
mclaude

# Step 3: In the terminal (natural language)
"Load the orchestration skill and initiate"</code></pre>
      </div>

      <p><strong>That's it.</strong> 3 steps to multi-agent orchestration.</p>

      <h3>Supported Providers</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Provider</th><th>Command</th><th>Use Case</th></tr>
        </thead>
        <tbody>
          <tr><td><strong>mirror</strong></td><td><code>--provider mirror</code></td><td>Default - Claude's internal primitives</td></tr>
          <tr><td><strong>Z.ai</strong></td><td><code>--provider z.ai</code></td><td>Advanced reasoning tasks</td></tr>
          <tr><td><strong>OpenRouter</strong></td><td><code>--provider openrouter</code></td><td>Flexible model selection (100+ models)</td></tr>
          <tr><td><strong>CCRouter</strong></td><td><code>--provider ccrouter</code></td><td>Local development (Ollama, DeepSeek)</td></tr>
        </tbody>
      </table>

      <div class="callout callout-warning">
        <div class="callout-title">Critical: Enable Auto-Compact</div>
        <p>Enable auto-compact to prevent context collapse during orchestration. Check <code>~/.cc-mirror/&lt;variant&gt;/config/settings.json</code> for <code>"auto_compact": true</code>.</p>
      </div>
    </section>

    <hr class="section-divider divider-checkpoint">

    <!-- Checkpoints Section -->
    <section id="checkpoints">
      <h2><span style="font-weight: 700;">Che</span>ckpoints: Implementation Journey</h2>

      <!-- Checkpoint 1 -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 1: Prerequisites Verified</div>
        <p><strong>What you need:</strong></p>
        <div class="code-block" style="background: #fefcf3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
          <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
          <pre style="margin: 0; overflow-x: auto;"><code>node --version   # Should be 18+
npm --version    # Should be 9+
claude --version # Should be installed
echo $ANTHROPIC_API_KEY # Should be set</code></pre>
        </div>
        <p><strong>You should see:</strong> v18.19.0+, 9.8.1+, Claude Code v2.x, and your API key</p>
      </div>

      <!-- Checkpoint 2 -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 2: CC Mirror Installed</div>
        <p><strong>Run installation:</strong></p>
        <div class="code-block" style="background: #fefcf3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
          <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
          <pre style="margin: 0; overflow-x: auto;"><code>npx cc-mirror quick --provider mirror --name mclaude</code></pre>
        </div>
        <p><strong>You should see:</strong> "Variant created successfully!"</p>
        <p><strong>Verify:</strong> <code>which mclaude</code> should show a path like <code>/Users/you/.local/bin/mclaude</code></p>
      </div>

      <!-- Checkpoint 3 -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 3: Orchestration Skill Loaded</div>
        <p><strong>Load the skill:</strong></p>
        <div class="code-block" style="background: #fefcf3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
          <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
          <pre style="margin: 0; overflow-x: auto;"><code>mclaude
"Load the orchestration skill and initiate"</code></pre>
        </div>
        <p><strong>You should see:</strong> "You are now the CONDUCTOR. What would you like to build today?"</p>
      </div>

      <!-- Checkpoint 4 -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint 4: First Multi-Agent Task</div>
        <p><strong>Give it a project:</strong></p>
        <div class="code-block" style="background: #fefcf3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
          <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
          <pre style="margin: 0; overflow-x: auto;"><code>"Build a REST API for a todo app with tests and docs"</code></pre>
        </div>
        <p><strong>Signs of healthy orchestration:</strong></p>
        <ul>
          <li>Orchestrator is NOT writing code directly</li>
          <li>Workers appear in "Async agents" list</li>
          <li>Tasks progress from running to completed</li>
          <li>Worker outputs include absolute file paths</li>
          <li>Dependencies auto-unblock</li>
        </ul>
      </div>

      <!-- Milestone -->
      <div class="milestone" style="background: linear-gradient(90deg, #6b9b7a 0%, #2a7d7d 100%); color: white; padding: 1rem 1.5rem; border-radius: 8px; text-align: center; margin: 2rem 0;">
        You are now the Conductor. Your agents play the instruments.
      </div>
    </section>

    <hr class="section-divider divider-warning">

    <!-- Troubleshooting Section -->
    <section id="troubleshooting">
      <h2><span style="font-weight: 700;">Tro</span>ubleshooting</h2>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">npx cc-mirror command not found</summary>
        <div style="padding: 1rem;">
          <p><strong>Cause:</strong> npm not installed or outdated</p>
          <p><strong>Solution:</strong></p>
          <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
            <pre style="margin: 0;"><code>npm install -g npm@latest
npm cache clean --force
npx --version</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Workers not spawning</summary>
        <div style="padding: 1rem;">
          <p><strong>Cause:</strong> Model doesn't support tool use, or all tasks are blocked</p>
          <p><strong>Solution:</strong></p>
          <ol>
            <li>Check if workers are blocked: <code>"TaskList --status=blocked"</code></li>
            <li>Try spawning worker explicitly: <code>"Assign this task to a Haiku worker: &lt;task-id&gt;"</code></li>
            <li>Verify tool permissions - workers need: Read, Write, Edit, Bash, Glob, Grep</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Context collapse - orchestrator degraded</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptoms:</strong> Orchestrator forgets task state, inconsistent decisions</p>
          <p><strong>Cause:</strong> Running too long without reset, auto-compact not enabled</p>
          <p><strong>Solution:</strong></p>
          <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
            <pre style="margin: 0;"><code># Enable auto-compact in settings.json
# "auto_compact": true

# For long sessions, proactively reset:
/compact
"Reload task state and continue"</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot" style="border: 1px solid #c97065; border-radius: 8px; margin: 1rem 0;">
        <summary style="background: #fef6f5; padding: 1rem; cursor: pointer; color: #c97065; font-weight: 600;">Multiple workers touching same files</summary>
        <div style="padding: 1rem;">
          <p><strong>Symptoms:</strong> Edits overwrite each other, corrupted output</p>
          <p><strong>Cause:</strong> Task decomposition didn't isolate file ownership</p>
          <p><strong>Solution:</strong></p>
          <ol>
            <li>Add explicit file ownership to task descriptions:
              <code>"Task: Implement auth. Ownership: src/auth/*. DO NOT MODIFY: src/components/*"</code>
            </li>
            <li>Use worktrees for true isolation:
              <code>git worktree add ../project-worker1 -b worker1</code>
            </li>
            <li>Sequence tasks with dependencies so they don't overlap</li>
          </ol>
        </div>
      </details>

      <h3>Emergency Recovery</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Kill all stuck workers
pkill -f "claude"

# Check task state
npx cc-mirror tasks list --all

# Clear stuck tasks
npx cc-mirror tasks clean --stuck

# Full reset (preserves no task state)
npx cc-mirror tasks clean --all

# Re-initialize fresh
npx cc-mirror remove mclaude
npx cc-mirror quick --provider mirror --name mclaude</code></pre>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Quick Reference -->
    <section>
      <h2><span style="font-weight: 700;">Qui</span>ck Reference</h2>

      <h3>Installation Commands</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>npx cc-mirror quick --provider mirror --name mclaude
mclaude
"Load the orchestration skill and initiate"</code></pre>
      </div>

      <h3>Model Selection</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <pre style="margin: 0; overflow-x: auto;"><code>Haiku  --&gt; Simple lookups, file fetching (5-10 parallel)
Sonnet --&gt; Implementation, patterns, tests (2-5 parallel)
Opus   --&gt; Architecture, complex reasoning (1 sequential)</code></pre>
      </div>

      <h3>Pattern Decision Matrix</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Scenario</th><th>Recommendation</th></tr>
        </thead>
        <tbody>
          <tr><td>80% of multi-agent tasks</td><td><strong>CC Mirror</strong> - native, simple, sufficient</td></tr>
          <tr><td>Factory-scale production</td><td><strong>Gas Town</strong> - named agents, roles, persistence</td></tr>
          <tr><td>Sequential iteration</td><td><strong>Ralph Loop</strong> - single-agent, fresh context</td></tr>
          <tr><td>Mission-critical reliability</td><td><strong>Standard Claude</strong> + manual coordination</td></tr>
        </tbody>
      </table>
    </section>

    <!-- Related Pages -->
    <div class="related-pages" style="margin-top: 2rem; padding: 1rem; background: #f9f6f0; border-radius: 8px;">
      <h4 style="margin-top: 0;">Related Documents</h4>
      <ul>
        <li><a href="architecture-complexity-ladder.html">Complexity Ladder</a> - Full progression from Level 0-7</li>
        <li><a href="mastery-gastown-complete.html">Gas Town Complete</a> - Level 7 factory-scale orchestration</li>
        <li><a href="mastery-multi-agent.html">Multi-Agent Architecture</a> - All orchestration patterns compared</li>
        <li><a href="compare-orchestration.html">Orchestration Comparison</a> - CC Mirror vs Gas Town vs Ralph</li>
      </ul>
      <h4>External Resources</h4>
      <ul>
        <li><a href="https://github.com/numman-ali/cc-mirror">CC Mirror Repository</a> - Installation and docs</li>
      </ul>
    </div>

    <!-- Footer Navigation -->
    <div class="footer-nav" style="display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e0d5c5;">
      <a href="mastery-multi-agent.html">Prev: Multi-Agent Architecture</a>
      <a href="mastery-gastown-complete.html">Next: Gas Town Complete</a>
    </div>

  </div>

  <script src="../js/copy-code.js"></script>
  <script src="../js/search.js"></script>
  <script src="../js/global-nav.js"></script>
  <script>
    function copyCode(button) {
      const codeBlock = button.parentElement.querySelector('code');
      navigator.clipboard.writeText(codeBlock.textContent);
      button.textContent = 'Copied!';
      setTimeout(() => button.textContent = 'Copy', 2000);
    }
  </script>
</body>
</html>
