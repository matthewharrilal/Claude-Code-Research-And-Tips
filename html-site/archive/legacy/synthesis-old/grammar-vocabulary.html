<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta data-pagefind-meta="section" content="Synthesis">
  <meta data-pagefind-meta="category" content="Grammar">
  <title>Agent Pattern Vocabulary - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/search.css">
</head>
<body>
  <!-- Search Modal -->
  <div class="search-modal" id="searchModal" aria-hidden="true">
    <div class="search-overlay" onclick="closeSearch()"></div>
    <div class="search-content">
      <div class="search-header">
        <div class="search-input-wrapper">
          <span class="search-icon-input">&#128269;</span>
          <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
          <kbd class="search-kbd">ESC</kbd>
        </div>
      </div>
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="synthesis">Synthesis</button>
        <button class="filter-btn" data-filter="extractions">Extractions</button>
        <button class="filter-btn" data-filter="journeys">Journeys</button>
      </div>
      <div class="search-results" id="searchResults">
        <div class="search-empty"><p>Start typing to search... (Press Cmd+K anytime)</p></div>
      </div>
      <div class="search-footer">
        <span>Up/Down Navigate</span><span>Enter Select</span><span>ESC Close</span>
      </div>
    </div>
  </div>

  <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
    <span class="search-icon">Cmd+K</span>
    <span class="search-text">Search</span>
  </button>

  <div class="wide-container">
    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="synthesis-index.html">Synthesis</a>
      <span>/</span>
      <a href="grammar-master.html">Grammar</a>
      <span>/</span>
      <span>Agent Pattern Vocabulary</span>
    </nav>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <h3 style="color: #2a7d7d; margin-top: 0; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px;">You Are Here</h3>
      <p style="margin-bottom: 0;"><strong>Agent Pattern Vocabulary</strong> - This is the <strong>dictionary</strong> for the Claude Code pattern language. When you encounter unfamiliar terms in other synthesis documents (like "fresh-context", "orchestrator", or "polecat"), look them up here. This document defines every primitive building block that appears across the research corpus. Start here when terminology is confusing, or use it as a reference while reading more advanced documents like <a href="grammar-syntax.html">grammar-syntax.html</a> or <a href="mastery-master.html">mastery-ralph-complete.html</a>.</p>
    </div>

    <h1><span class="b">Age</span>nt <span class="b">Pat</span>tern <span class="b">Voc</span>abulary</h1>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">Contents</div>
      <ul>
        <li><a href="#loop-constructs">1. Loop Constructs</a></li>
        <li><a href="#state-containers">2. State Containers</a></li>
        <li><a href="#quality-gates">3. Quality Gates</a></li>
        <li><a href="#agent-types">4. Agent Types</a></li>
        <li><a href="#communication-primitives">5. Communication Primitives</a></li>
        <li><a href="#isolation-mechanisms">6. Isolation Mechanisms</a></li>
        <li><a href="#control-structures">7. Control Structures</a></li>
        <li><a href="#memory-patterns">8. Memory Patterns</a></li>
        <li><a href="#monitoring-constructs">9. Monitoring Constructs</a></li>
        <li><a href="#failure-modes">10. Failure Modes</a></li>
        <li><a href="#tool-categories">11. Tool Categories</a></li>
        <li><a href="#architecture-roles">12. Architecture Roles</a></li>
        <li><a href="#execution-modes">13. Execution Modes</a></li>
        <li><a href="#vocabulary-reference-card">14. Vocabulary Reference Card</a></li>
        <li><a href="#iron-law">The Iron Law</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ul>
    </div>

    <hr class="section-divider">

    <!-- Loop Constructs -->
    <section id="loop-constructs">
      <h2><span class="b">1.</span> <span class="b">Loo</span>p <span class="b">Con</span>structs</h2>

      <h3>while-loop</h3>
      <p><strong>Definition:</strong> Bash construct for indefinite iteration until an external condition is satisfied.</p>
      <p><strong>Syntax:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>while :; do &lt;command&gt;; done</code></pre>
      </div>
      <p><strong>Use:</strong> Autonomous execution until completion signal detected.</p>
      <p><strong>Example:</strong> Original Ralph pattern - <code>while :; do cat PROMPT.md | claude ; done</code></p>
      <p><strong>Characteristics:</strong></p>
      <ul>
        <li>No inherent termination condition</li>
        <li>Requires external signal (grep for COMPLETE)</li>
        <li>Dangerous without safety bounds</li>
      </ul>

      <h3>for-loop</h3>
      <p><strong>Definition:</strong> Bounded iteration with explicit maximum iterations.</p>
      <p><strong>Syntax:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>for (( i=1; i&lt;=$MAX_ITERATIONS; i++ )); do &lt;command&gt;; done</code></pre>
      </div>
      <p><strong>Use:</strong> Safe autonomous execution with guaranteed termination.</p>
      <p><strong>Example:</strong> Ryan Carson's Ralph - <code>for (( i=1; i&lt;=25; i++ )); do claude ... ; done</code></p>
      <p><strong>Characteristics:</strong></p>
      <ul>
        <li>Predictable maximum cost</li>
        <li>Safe default for production</li>
        <li>Fails gracefully at limit</li>
      </ul>

      <h3>iteration</h3>
      <p><strong>Definition:</strong> A single pass through the Ralph loop, from fresh context to commit/exit.</p>
      <p><strong>Structure:</strong></p>
      <ol>
        <li>Read state files (prd.json, progress.txt)</li>
        <li>Pick next unpassed story</li>
        <li>Implement feature</li>
        <li>Run quality gates</li>
        <li>Commit if passing</li>
        <li>Update state files</li>
        <li>Check for COMPLETE or loop</li>
      </ol>
      <p><strong>Key Property:</strong> Each iteration spawns a NEW agent instance with NO memory of previous iterations.</p>

      <h3>fresh-context</h3>
      <p><strong>Definition:</strong> The principle that each iteration starts with zero accumulated context, relying on external state for continuity.</p>
      <p><strong>Rationale:</strong> Prevents context rot, lossy compaction, and quality degradation over long runs.</p>
      <p><strong>Contrast:</strong> Long-running sessions accumulate context until quality degrades at 85%+ usage.</p>

      <h3>stop-condition</h3>
      <p><strong>Definition:</strong> The signal that terminates the loop, indicating all work is complete.</p>
      <p><strong>Canonical Form:</strong> <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code></p>
      <p><strong>Detection:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>if grep -q "&lt;promise&gt;COMPLETE&lt;/promise&gt;" output.txt; then break; fi</code></pre>
      </div>
      <p><strong>Variants:</strong> <code>PROMISE COMPLETE HERE</code>, <code>ALL TASKS DONE</code>, custom strings</p>

      <!-- Checkpoint -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: Loop Constructs</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>The difference between <code>while-loop</code> (unbounded) and <code>for-loop</code> (bounded)</li>
          <li>What "fresh-context" means and why it matters for quality</li>
          <li>How stop-conditions terminate autonomous loops</li>
          <li>That each iteration spawns a NEW agent with NO memory</li>
        </ul>
        <p><strong>If unclear:</strong> Re-read the <code>fresh-context</code> and <code>iteration</code> definitions, or see <a href="mastery-master.html">mastery-ralph-complete.html</a> for full Ralph pattern explanation.</p>
      </div>
    </section>

    <hr class="section-divider">

    <!-- State Containers -->
    <section id="state-containers">
      <h2><span class="b">2.</span> <span class="b">Sta</span>te <span class="b">Con</span>tainers</h2>

      <h3>progress.txt</h3>
      <p><strong>Definition:</strong> Append-only session memory file that accumulates learnings across iterations.</p>
      <p><strong>Structure:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># Progress Log - Append Only

## Codebase Patterns
- [Discovered pattern 1]
- [Discovered pattern 2]

---

## [Date] - [Story ID]
- What was implemented
- Files changed
- **Learnings:**
  - Patterns discovered
  - Gotchas encountered</code></pre>
      </div>
      <p><strong>Rules:</strong></p>
      <ul>
        <li>APPEND ONLY - never edit previous entries</li>
        <li>Patterns section at TOP for cross-session learning</li>
        <li>Each iteration adds dated entry</li>
      </ul>
      <p><strong>Use:</strong> Inter-iteration memory, pattern accumulation, debugging audit trail</p>

      <h3>prd.json</h3>
      <p><strong>Definition:</strong> JSON task tracking file with machine-readable task states.</p>
      <p><strong>Structure:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>{
  "project": "ProjectName",
  "branchName": "ralph/feature-name",
  "userStories": [
    {
      "id": "US-001",
      "title": "Task description",
      "acceptanceCriteria": ["Criterion 1", "typecheck passes"],
      "priority": 1,
      "passes": false,
      "notes": ""
    }
  ]
}</code></pre>
      </div>
      <p><strong>Key Fields:</strong></p>
      <ul>
        <li><code>passes: boolean</code> - Task completion status</li>
        <li><code>priority: number</code> - Lower = first (ordering)</li>
        <li><code>acceptanceCriteria: string[]</code> - Verifiable requirements</li>
      </ul>
      <p><strong>Use:</strong> Kanban-style task management, deterministic task selection</p>

      <h3>AGENTS.md</h3>
      <p><strong>Definition:</strong> Permanent learnings document for humans and future agents.</p>
      <p><strong>Structure:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># AGENTS.md

## Patterns
- [Reusable pattern 1]
- [Reusable pattern 2]

## Gotchas
- [Known issue 1]
- [Known issue 2]

## Conventions
- [Project-specific convention 1]</code></pre>
      </div>
      <p><strong>Distinction from progress.txt:</strong></p>
      <ul>
        <li>progress.txt: Session-specific, ephemeral notes</li>
        <li>AGENTS.md: Permanent, curated, project-level documentation</li>
      </ul>

      <h3>CLAUDE.md</h3>
      <p><strong>Definition:</strong> Project context file that onboards stateless agents to the codebase.</p>
      <p><strong>Structure:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code># Project: Name

## Tech Stack
- [Technologies]

## Commands
- `npm run dev` - Description
- `npm test` - Description

## Conventions
- [Convention 1]

## Known Gotchas
- [Gotcha 1]</code></pre>
      </div>
      <p><strong>Best Practices:</strong></p>
      <ul>
        <li>Under 500 tokens</li>
        <li>Essential information only</li>
        <li>Verifiable facts over opinions</li>
      </ul>

      <h3>handoff-file</h3>
      <p><strong>Definition:</strong> JSON file enabling explicit context transfer between agents.</p>
      <p><strong>Structure:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>{
  "from": "agent-id",
  "to": "target-agent-id",
  "timestamp": "ISO-8601",
  "context": {
    "completed": ["Task 1"],
    "next_steps": ["Task 2"],
    "blockers": [],
    "notes": "Additional context"
  }
}</code></pre>
      </div>
      <p><strong>Use:</strong> Domain-isolated agents (Panopticon), file-based coordination</p>

      <!-- Checkpoint -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: State Containers</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>The purpose of <code>progress.txt</code> (session memory) vs <code>AGENTS.md</code> (permanent learnings)</li>
          <li>How <code>prd.json</code> tracks tasks with <code>passes</code> boolean and <code>priority</code> ordering</li>
          <li>Why <code>CLAUDE.md</code> should be under 500 tokens</li>
          <li>The difference between ephemeral session state and permanent project documentation</li>
        </ul>
        <p><strong>If unclear:</strong> Re-read the distinction between <code>progress.txt</code> and <code>AGENTS.md</code>.</p>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Quality Gates -->
    <section id="quality-gates">
      <h2><span class="b">3.</span> <span class="b">Qua</span>lity <span class="b">Gat</span>es</h2>

      <h3>typecheck</h3>
      <p><strong>Definition:</strong> Type system validation via static analysis.</p>
      <p><strong>Commands:</strong></p>
      <ul>
        <li>TypeScript: <code>npm run typecheck</code> or <code>tsc --noEmit</code></li>
        <li>Python: <code>mypy .</code></li>
        <li>Go: <code>go build</code> (implicit)</li>
      </ul>
      <p><strong>Use:</strong> Catch type errors before commit, mandatory acceptance criterion.</p>

      <h3>test-suite</h3>
      <p><strong>Definition:</strong> Automated test execution for functional verification.</p>
      <p><strong>Commands:</strong></p>
      <ul>
        <li><code>npm test</code></li>
        <li><code>pytest</code></li>
        <li><code>go test ./...</code></li>
      </ul>
      <p><strong>Use:</strong> Verify functionality, regression prevention, acceptance verification.</p>

      <h3>lint</h3>
      <p><strong>Definition:</strong> Code style and quality checking.</p>
      <p><strong>Commands:</strong></p>
      <ul>
        <li><code>eslint .</code></li>
        <li><code>ruff check .</code></li>
        <li><code>golint ./...</code></li>
      </ul>
      <p><strong>Use:</strong> Enforce conventions, catch common errors.</p>

      <h3>ci-green</h3>
      <p><strong>Definition:</strong> All CI pipeline checks passing, typically: typecheck + test + lint.</p>
      <p><strong>Use:</strong> Gate for commits, PR merges, deployment.</p>

      <h3>acceptance-criteria</h3>
      <p><strong>Definition:</strong> Explicit, verifiable conditions that define task completion.</p>
      <p><strong>Good Examples:</strong></p>
      <ul>
        <li>"Add email column with unique constraint"</li>
        <li>"Return 401 on invalid credentials"</li>
        <li>"npm run typecheck passes"</li>
      </ul>
      <p><strong>Bad Examples (anti-patterns):</strong></p>
      <ul>
        <li>"Works correctly"</li>
        <li>"Good UX"</li>
        <li>"Handles edge cases"</li>
      </ul>
      <p><strong>Rule:</strong> If you can't automate verification, it's not acceptance criteria.</p>

      <h3>browser-verification</h3>
      <p><strong>Definition:</strong> Visual confirmation of UI changes via screenshot or browser automation.</p>
      <p><strong>Tools:</strong> Playwright MCP, dev-browser skill, Browserbase cloud browsers</p>
      <p><strong>Use:</strong> "Not complete until verified with screenshot"</p>

      <!-- Checkpoint -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: Quality Gates</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>The three standard gates: <code>typecheck</code>, <code>test-suite</code>, <code>lint</code></li>
          <li>What makes acceptance criteria verifiable vs vague</li>
          <li>Why <code>browser-verification</code> matters for UI work</li>
        </ul>
        <p><strong>If unclear:</strong> Re-read the <code>acceptance-criteria</code> section for good vs bad examples.</p>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Agent Types -->
    <section id="agent-types">
      <h2><span class="b">4.</span> <span class="b">Age</span>nt <span class="b">Typ</span>es</h2>

      <h3>orchestrator</h3>
      <p><strong>Definition:</strong> Coordinating agent that distributes tasks but never executes.</p>
      <p><strong>Characteristics:</strong></p>
      <ul>
        <li>NEVER writes code</li>
        <li>NEVER runs bash commands</li>
        <li>NEVER explores codebases directly</li>
        <li>Uses: Read (1-2 files), Task*, AskUserQuestion</li>
      </ul>
      <p><strong>Metaphor:</strong> "The conductor. Your agents play the instruments."</p>
      <p><strong>Model Selection:</strong> Opus (complex reasoning, strategy)</p>

      <h3>worker</h3>
      <p><strong>Definition:</strong> Executing agent that implements tasks but never coordinates.</p>
      <p><strong>Characteristics:</strong></p>
      <ul>
        <li>ALWAYS writes code</li>
        <li>Uses: Read, Write, Edit, Bash, Glob, Grep, WebFetch</li>
        <li>NEVER spawns sub-agents</li>
        <li>NEVER modifies task definitions</li>
      </ul>
      <p><strong>Constraints (Worker Preamble):</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>CONTEXT: You are a WORKER agent, not an orchestrator.
RULES:
- Complete ONLY the task described below
- Use tools directly
- Do NOT spawn sub-agents
- Do NOT call TaskCreate/TaskUpdate</code></pre>
      </div>
      <p><strong>Model Selection:</strong> Sonnet (balanced cost/capability)</p>

      <h3>errand-runner</h3>
      <p><strong>Definition:</strong> Lightweight worker for simple, fast tasks.</p>
      <p><strong>Use Cases:</strong> File lookups, simple grep operations, quick transformations</p>
      <p><strong>Model Selection:</strong> Haiku (cheap, fast, parallel-friendly)</p>
      <p><strong>Pattern:</strong> Spawn 5-10 in parallel for research phases</p>

      <h3>subagent</h3>
      <p><strong>Definition:</strong> Short-lived agent spawned by parent for specific isolated task.</p>
      <p><strong>Characteristics:</strong></p>
      <ul>
        <li>Own isolated context window</li>
        <li>Returns summary to parent</li>
        <li>Context doesn't pollute parent</li>
        <li>Ephemeral - terminates after task</li>
      </ul>
      <p><strong>Invocation:</strong> <code>Task(description=..., run_in_background=True|False)</code></p>

      <h3>Gas Town Terminology</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Term</th><th>Definition</th><th>Use</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>polecat</strong></td><td>Named persistent worker with specific expertise</td><td>Assigned recurring responsibilities</td></tr>
            <tr><td><strong>crew</strong></td><td>Ephemeral workers spawned for one-off tasks</td><td>Short-lived, no persistent identity</td></tr>
            <tr><td><strong>witness</strong></td><td>Per-rig observer agent that maintains audit trail</td><td>Monitoring, logging, debugging</td></tr>
            <tr><td><strong>deacon</strong></td><td>Monitoring agent that handles handshakes between agents</td><td>Health checks, coordination</td></tr>
            <tr><td><strong>dogs</strong></td><td>Quality gate enforcement agents</td><td>Watchdog functions, blocking bad changes</td></tr>
            <tr><td><strong>refinery</strong></td><td>Task decomposition agent</td><td>PRD generation, story breakdown</td></tr>
            <tr><td><strong>mayor</strong></td><td>Town-level coordination agent</td><td>Cross-rig coordination, resource allocation</td></tr>
            <tr><td><strong>overseer</strong></td><td>The human operator with inbox-based interaction</td><td>Final authority, escalation target</td></tr>
          </tbody>
        </table>
      </div>

      <!-- Checkpoint -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: Agent Types</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>The Iron Law: orchestrators coordinate, workers execute - never mix</li>
          <li>The three model tiers: Opus (strategy), Sonnet (implementation), Haiku (lookups)</li>
          <li>Gas Town terminology: polecat, crew, witness, deacon, dogs, refinery, mayor</li>
        </ul>
        <p><strong>If unclear:</strong> Re-read the <code>orchestrator</code> and <code>worker</code> definitions.</p>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Communication Primitives -->
    <section id="communication-primitives">
      <h2><span class="b">5.</span> <span class="b">Com</span>munication <span class="b">Pri</span>mitives</h2>

      <h3>git-history</h3>
      <p><strong>Definition:</strong> The sequence of commits as long-term external memory.</p>
      <p><strong>Use:</strong> Context for new iterations, rollback capability, progress narrative</p>
      <p><strong>Access:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>git log --oneline -10
git diff main..HEAD</code></pre>
      </div>

      <h3>file-handoff</h3>
      <p><strong>Definition:</strong> JSON file-based context transfer between agents.</p>
      <p><strong>Pattern:</strong> Write to shared location, recipient reads on next iteration.</p>
      <p><strong>Use:</strong> Panopticon domain handoffs, async coordination</p>

      <h3>event-bus</h3>
      <p><strong>Definition:</strong> File-based event publishing system for agent coordination.</p>
      <p><strong>Structure:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>/tmp/agent-events/
+-- task-complete-*.json
+-- conflict-detected-*.json
+-- checkpoint-*.json</code></pre>
      </div>
      <p><strong>Use:</strong> Event-driven architectures, loose coupling</p>

      <h3>mcp-agent-mail</h3>
      <p><strong>Definition:</strong> Email-like messaging between agents via MCP protocol.</p>
      <p><strong>Characteristics:</strong> Async by default, natural agent village behavior, no special training needed</p>
      <p><strong>Source:</strong> Steve Yegge's Gas Town</p>

      <h3>task-tool</h3>
      <p><strong>Definition:</strong> Native Claude Code tool for spawning subagents.</p>
      <p><strong>Syntax:</strong> <code>Task(description=..., run_in_background=True|False)</code></p>
      <p><strong>Use:</strong> Worker delegation, parallel research, adversarial validation</p>

      <!-- Checkpoint -->
      <div class="checkpoint" style="background: #f0ebe3; border-left: 4px solid #6b9b7a; border-radius: 8px; padding: 1.5rem; margin: 2rem 0;">
        <div class="checkpoint-header" style="color: #6b9b7a; font-weight: 600;">Checkpoint: Communication Primitives</div>
        <p><strong>You should now understand:</strong></p>
        <ul>
          <li>How <code>git-history</code> serves as long-term external memory</li>
          <li>File-based coordination patterns: <code>file-handoff</code>, <code>event-bus</code></li>
          <li>When to use the <code>Task</code> tool for spawning subagents</li>
        </ul>
        <p><strong>If unclear:</strong> See <a href="architecture-primitives.html">architecture-primitives.html</a> for deeper primitive analysis.</p>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Isolation Mechanisms -->
    <section id="isolation-mechanisms">
      <h2><span class="b">6.</span> <span class="b">Iso</span>lation <span class="b">Mec</span>hanisms</h2>

      <h3>directory-isolation</h3>
      <p><strong>Definition:</strong> Each agent operates in its own filesystem directory.</p>
      <p><strong>Example (Panopticon):</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>~/nox        # Company/product
~/metrics    # Analytics
~/trades     # Finance</code></pre>
      </div>
      <p><strong>Benefit:</strong> No context pollution, clear ownership, simple coordination</p>

      <h3>branch-isolation</h3>
      <p><strong>Definition:</strong> Each agent works on its own git branch.</p>
      <p><strong>Pattern:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>git checkout -b feature-auth   # Agent 1
git checkout -b feature-pay    # Agent 2</code></pre>
      </div>
      <p><strong>Merge:</strong> Human reviews and merges via PR</p>

      <h3>worktree-isolation</h3>
      <p><strong>Definition:</strong> Git worktrees create isolated working directories sharing the same repo.</p>
      <p><strong>Setup:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>git worktree add ../wt-feature feature-branch</code></pre>
      </div>
      <p><strong>Benefit:</strong> Full directory isolation with shared git history</p>

      <h3>container-isolation</h3>
      <p><strong>Definition:</strong> Each agent runs in its own Docker container.</p>
      <p><strong>Benefits:</strong> Complete environment isolation, per-container resource limits, shared volumes for communication</p>

      <h3>context-isolation</h3>
      <p><strong>Definition:</strong> Subagents have their own context windows, isolated from parent.</p>
      <p><strong>Benefit:</strong> Expensive operations don't pollute main context</p>
    </section>

    <hr class="section-divider">

    <!-- Control Structures -->
    <section id="control-structures">
      <h2><span class="b">7.</span> <span class="b">Con</span>trol <span class="b">Str</span>uctures</h2>

      <h3>max-iterations</h3>
      <p><strong>Definition:</strong> Hard limit on loop iterations as safety mechanism.</p>
      <p><strong>Syntax:</strong> <code>./ralph.sh 25</code></p>
      <p><strong>Use:</strong> Cost control, guaranteed termination, prevent runaway loops</p>

      <h3>promise-complete</h3>
      <p><strong>Definition:</strong> The completion signal that terminates the loop.</p>
      <p><strong>Form:</strong> <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code></p>
      <p><strong>Detection:</strong> grep in output file</p>

      <h3>priority-ordering</h3>
      <p><strong>Definition:</strong> Lower priority number = execute first.</p>
      <p><strong>In prd.json:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>"priority": 1  // First
"priority": 2  // Second</code></pre>
      </div>
      <p><strong>Use:</strong> Dependency-respecting task ordering</p>

      <h3>passes-boolean</h3>
      <p><strong>Definition:</strong> Task completion flag in prd.json.</p>
      <p><strong>Values:</strong></p>
      <ul>
        <li><code>false</code> - Task incomplete, eligible for work</li>
        <li><code>true</code> - Task complete, skip</li>
      </ul>
      <p><strong>Update:</strong> Agent sets to true after verification passes</p>

      <h3>story-sizing</h3>
      <p><strong>Definition:</strong> The practice of making tasks small enough to complete in one iteration.</p>
      <p><strong>Rule of Thumb:</strong> "If you can't describe it in 2-3 sentences, it's too big."</p>
      <p><strong>Right-sized:</strong> Add a database column, implement one endpoint, create one component</p>
      <p><strong>Too big (split these):</strong> "Build the entire dashboard", "Add authentication"</p>
    </section>

    <hr class="section-divider">

    <!-- Memory Patterns -->
    <section id="memory-patterns">
      <h2><span class="b">8.</span> <span class="b">Mem</span>ory <span class="b">Pat</span>terns</h2>

      <h3>append-only</h3>
      <p><strong>Definition:</strong> Data structure that only permits additions, never modifications.</p>
      <p><strong>Example:</strong> progress.txt - only append new entries, never edit old ones</p>
      <p><strong>Benefit:</strong> Audit trail, no lossy overwrites, safe for concurrent access</p>

      <h3>external-state</h3>
      <p><strong>Definition:</strong> All persistent state stored in files, not agent memory.</p>
      <p><strong>Philosophy:</strong> "The agent remembers nothing. The filesystem remembers everything."</p>
      <p><strong>Implements:</strong> Stateless agent, stateful environment</p>

      <h3>compaction</h3>
      <p><strong>Definition:</strong> Lossy compression of context to extend working capacity.</p>
      <p><strong>Command:</strong> <code>/compact</code></p>
      <p><strong>Warning:</strong> Details get summarized - may lose critical information</p>
      <p><strong>Prefer:</strong> Fresh context via Ralph loops over repeated compaction</p>

      <h3>context-rot</h3>
      <p><strong>Definition:</strong> Degradation of agent quality as context window fills.</p>
      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Repetition of earlier statements</li>
        <li>Forgetting recent changes</li>
        <li>Instructions ignored</li>
        <li>Hallucinated files</li>
      </ul>
      <p><strong>Thresholds:</strong></p>
      <ul>
        <li>60%: Monitor closely</li>
        <li>70%: Consider compacting</li>
        <li>85%: Quality compromised</li>
        <li>90%+: Failure mode</li>
      </ul>

      <h3>hierarchical-memory</h3>
      <p><strong>Definition:</strong> Multi-layer memory architecture with different scopes.</p>
      <p><strong>Layers:</strong></p>
      <ol>
        <li>Enterprise Policy (<code>/Library/.../CLAUDE.md</code>)</li>
        <li>Project Memory (<code>./CLAUDE.md</code>)</li>
        <li>Modular Rules (<code>./.claude/rules/*.md</code>)</li>
        <li>Personal/Local (<code>~/.claude/CLAUDE.md</code>, <code>./CLAUDE.local.md</code>)</li>
      </ol>
    </section>

    <hr class="section-divider">

    <!-- Monitoring Constructs -->
    <section id="monitoring-constructs">
      <h2><span class="b">9.</span> <span class="b">Mon</span>itoring <span class="b">Con</span>structs</h2>

      <h3>claude-hud</h3>
      <p><strong>Definition:</strong> Plugin for real-time context and tool visibility.</p>
      <p><strong>Display:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>[Opus 4.5] ########.. 35% | 1 MCPs | 1m
# Read x2 | # Edit x1</code></pre>
      </div>
      <p><strong>Use:</strong> Context monitoring, tool tracking, subagent visibility</p>

      <h3>rpai</h3>
      <p><strong>Definition:</strong> TUI for monitoring multiple AI agents across tmux panes.</p>
      <p><strong>Install:</strong> <code>cargo install rpai</code></p>
      <p><strong>Use:</strong> Multi-agent status overview, quick navigation</p>

      <h3>heartbeat</h3>
      <p><strong>Definition:</strong> Periodic signal indicating agent is alive and working.</p>
      <p><strong>Use:</strong> Health monitoring, stale agent detection</p>

      <h3>audit-log</h3>
      <p><strong>Definition:</strong> Append-only record of all agent actions.</p>
      <p><strong>Format:</strong> JSON Lines (<code>.jsonl</code>)</p>
      <p><strong>Use:</strong> Debugging, accountability, pattern analysis</p>
    </section>

    <hr class="section-divider">

    <!-- Failure Modes -->
    <section id="failure-modes">
      <h2><span class="b">10.</span> <span class="b">Fai</span>lure <span class="b">Mod</span>es</h2>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Failure Mode</th><th>Definition</th><th>Prevention</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>context-overflow</strong></td><td>Context window exceeded, causing failures or quality collapse</td><td>Task sizing, fresh context, monitoring</td></tr>
            <tr><td><strong>recursion-explosion</strong></td><td>Workers spawning sub-workers creating uncontrolled nesting</td><td>Iron Law - workers NEVER spawn sub-agents</td></tr>
            <tr><td><strong>scope-creep</strong></td><td>Task expanding beyond original definition during execution</td><td>Explicit acceptance criteria, atomic stories</td></tr>
            <tr><td><strong>verification-bypass</strong></td><td>Marking tasks complete without running quality gates</td><td>Separate orchestrator (marks complete) from worker (implements)</td></tr>
            <tr><td><strong>dead-letter</strong></td><td>Tasks that repeatedly fail and are moved to holding queue</td><td>Human review required (3+ failures triggers dead-letter)</td></tr>
            <tr><td><strong>circuit-breaker</strong></td><td>Pattern that stops attempting operations after repeated failures</td><td>States: CLOSED (normal), OPEN (failing fast), HALF_OPEN (testing recovery)</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Tool Categories -->
    <section id="tool-categories">
      <h2><span class="b">11.</span> <span class="b">Too</span>l <span class="b">Cat</span>egories</h2>

      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Category</th><th>Tools</th><th>Ownership</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>reading-tools</strong></td><td>Read, Glob, Grep, WebFetch, WebSearch</td><td>Available to all agent types</td></tr>
            <tr><td><strong>writing-tools</strong></td><td>Write, Edit</td><td>Workers only, never orchestrators</td></tr>
            <tr><td><strong>execution-tools</strong></td><td>Bash</td><td>Workers only, with security gates</td></tr>
            <tr><td><strong>coordination-tools</strong></td><td>Task, TaskCreate, TaskUpdate, TaskList, TaskGet</td><td>Orchestrators only, never workers</td></tr>
            <tr><td><strong>user-tools</strong></td><td>AskUserQuestion</td><td>Primarily orchestrators</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Architecture Roles -->
    <section id="architecture-roles">
      <h2><span class="b">12.</span> <span class="b">Arc</span>hitecture <span class="b">Rol</span>es</h2>

      <h3>hub-and-spoke</h3>
      <p><strong>Definition:</strong> Central orchestrator with peripheral workers.</p>
      <div class="ascii-diagram">
       Orchestrator
           |
    +------+------+
    |      |      |
  Worker Worker Worker</div>
      <p><strong>Use:</strong> Clear decomposition, predictable workflow</p>

      <h3>peer-to-peer</h3>
      <p><strong>Definition:</strong> Agents communicate directly without central coordinator.</p>
      <div class="ascii-diagram">
Agent &lt;---&gt; Agent
  |           |
  +---Agent---+</div>
      <p><strong>Use:</strong> Emergent collaboration, resilient systems</p>

      <h3>factory-pattern</h3>
      <p><strong>Definition:</strong> System that produces specialized agents on demand.</p>
      <p><strong>Example:</strong> Gas Town - produces polecats, crew, witnesses as needed</p>
      <p><strong>Characteristics:</strong> Role-based specialization, dynamic scaling, named and ephemeral workers</p>

      <h3>kanban-pattern</h3>
      <p><strong>Definition:</strong> Single agent operates against task board, completing one at a time.</p>
      <p><strong>Flow:</strong> Pick -> Work -> Complete -> Return -> Loop</p>
      <p><strong>Implementation:</strong> prd.json as task board</p>
    </section>

    <hr class="section-divider">

    <!-- Execution Modes -->
    <section id="execution-modes">
      <h2><span class="b">13.</span> <span class="b">Exe</span>cution <span class="b">Mod</span>es</h2>

      <h3>yolo-mode</h3>
      <p><strong>Definition:</strong> Permissive mode that auto-accepts tool use.</p>
      <p><strong>Command:</strong> <code>claude --dangerously-skip-permissions</code></p>
      <p><strong>Requirement:</strong> Run on isolated VM, NEVER on local machine with sensitive data</p>

      <h3>interactive-mode</h3>
      <p><strong>Definition:</strong> Default mode requiring human approval for each tool use.</p>
      <p><strong>Use:</strong> Learning, exploration, sensitive operations</p>

      <h3>background-execution</h3>
      <p><strong>Definition:</strong> Subagent runs without blocking parent.</p>
      <p><strong>Syntax:</strong> <code>Task(..., run_in_background=True)</code></p>
      <p><strong>Use:</strong> Parallel research, long-running operations</p>

      <h3>cron-scheduled</h3>
      <p><strong>Definition:</strong> Agent invocation via system scheduler.</p>
      <p><strong>Example:</strong></p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <pre><code>0 6 * * * cd ~/trades &amp;&amp; claude "Morning brief"</code></pre>
      </div>
      <p><strong>Use:</strong> Automated reports, scheduled maintenance</p>
    </section>

    <hr class="section-divider">

    <!-- Vocabulary Reference Card -->
    <section id="vocabulary-reference-card">
      <h2><span class="b">14.</span> <span class="b">Voc</span>abulary <span class="b">Ref</span>erence <span class="b">Car</span>d</h2>

      <h3>Core Loop Terms</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Term</th><th>One-Line Definition</th></tr>
          </thead>
          <tbody>
            <tr><td><code>while-loop</code></td><td>Indefinite iteration until external signal</td></tr>
            <tr><td><code>for-loop</code></td><td>Bounded iteration with max limit</td></tr>
            <tr><td><code>iteration</code></td><td>Single pass from fresh context to commit</td></tr>
            <tr><td><code>fresh-context</code></td><td>Zero accumulated context per iteration</td></tr>
            <tr><td><code>stop-condition</code></td><td>Signal terminating the loop</td></tr>
          </tbody>
        </table>
      </div>

      <h3>State Files</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Term</th><th>One-Line Definition</th></tr>
          </thead>
          <tbody>
            <tr><td><code>progress.txt</code></td><td>Append-only learning log</td></tr>
            <tr><td><code>prd.json</code></td><td>JSON task tracking with passes boolean</td></tr>
            <tr><td><code>AGENTS.md</code></td><td>Permanent project learnings</td></tr>
            <tr><td><code>CLAUDE.md</code></td><td>Project context onboarding</td></tr>
            <tr><td><code>handoff-file</code></td><td>Inter-agent context transfer</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Agent Types</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Term</th><th>One-Line Definition</th></tr>
          </thead>
          <tbody>
            <tr><td><code>orchestrator</code></td><td>Coordinates but never executes</td></tr>
            <tr><td><code>worker</code></td><td>Executes but never coordinates</td></tr>
            <tr><td><code>errand-runner</code></td><td>Fast lightweight lookup agent</td></tr>
            <tr><td><code>subagent</code></td><td>Isolated task agent spawned by parent</td></tr>
            <tr><td><code>polecat</code></td><td>Named persistent worker (Gas Town)</td></tr>
            <tr><td><code>crew</code></td><td>Ephemeral one-off worker (Gas Town)</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Memory Patterns</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Term</th><th>One-Line Definition</th></tr>
          </thead>
          <tbody>
            <tr><td><code>append-only</code></td><td>Only additions, never modifications</td></tr>
            <tr><td><code>external-state</code></td><td>All state in files, not agent memory</td></tr>
            <tr><td><code>compaction</code></td><td>Lossy context compression</td></tr>
            <tr><td><code>context-rot</code></td><td>Quality degradation as context fills</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Failure Modes</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Term</th><th>One-Line Definition</th></tr>
          </thead>
          <tbody>
            <tr><td><code>context-overflow</code></td><td>Context window exceeded</td></tr>
            <tr><td><code>recursion-explosion</code></td><td>Uncontrolled subagent spawning</td></tr>
            <tr><td><code>scope-creep</code></td><td>Task expanding beyond definition</td></tr>
            <tr><td><code>verification-bypass</code></td><td>Skipping quality gates</td></tr>
            <tr><td><code>dead-letter</code></td><td>Repeatedly failed task queue</td></tr>
            <tr><td><code>circuit-breaker</code></td><td>Stop after repeated failures</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- The Iron Law -->
    <section id="iron-law">
      <h2><span class="b">The</span> <span class="b">Iro</span>n <span class="b">Law</span></h2>

      <div class="ascii-diagram" style="text-align: center; font-weight: bold;">
+=====================================================+
|                    THE IRON LAW                      |
+=======================-==============================+
|                                                      |
|  An agent that ORCHESTRATES must NEVER directly      |
|  EXECUTE.                                            |
|                                                      |
|  An agent that EXECUTES must NEVER directly          |
|  ORCHESTRATE.                                        |
|                                                      |
+======================================================+</div>

      <p>Mixing these roles leads to:</p>
      <ul>
        <li>Context pollution</li>
        <li>Scope creep</li>
        <li>Verification bypass</li>
        <li>Uncontrolled recursion</li>
      </ul>

      <h3>Model Selection Matrix</h3>
      <div class="table-responsive">
        <table>
          <thead>
            <tr><th>Task Type</th><th>Model</th><th>Rationale</th></tr>
          </thead>
          <tbody>
            <tr><td>Strategy, architecture, orchestration</td><td>Opus</td><td>Complex reasoning</td></tr>
            <tr><td>Implementation, testing, structured work</td><td>Sonnet</td><td>Balanced cost/capability</td></tr>
            <tr><td>Lookups, simple transforms, bulk parallel</td><td>Haiku</td><td>Cheap and fast</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <!-- Troubleshooting -->
    <section id="troubleshooting">
      <h2><span class="b">Trou</span>bleshooting</h2>

      <details class="troubleshoot">
        <summary>Term Confusion Between Similar Concepts</summary>
        <div>
          <p><strong>Symptom:</strong> Using "orchestrator" and "coordinator" interchangeably, or confusing "worker" with "subagent"</p>
          <p><strong>Cause:</strong> The vocabulary draws from multiple sources (Gas Town, Ralph, Panopticon) that sometimes use different terms for similar concepts</p>
          <p><strong>Fix:</strong></p>
          <ul>
            <li>Use this document as the canonical reference</li>
            <li>When in doubt, check the "Definition" line for each term</li>
            <li>Remember: <code>subagent</code> = short-lived spawned agent, <code>worker</code> = role constraint (no coordination), <code>polecat</code> = named persistent worker (Gas Town-specific)</li>
          </ul>
          <p><strong>Terminal verification:</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Search this file for a term
grep -A5 "### worker" synthesis/grammar-vocabulary.md</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>State File Purpose Confusion</summary>
        <div>
          <p><strong>Symptom:</strong> Putting session-specific notes in <code>AGENTS.md</code> or permanent patterns in <code>progress.txt</code></p>
          <p><strong>Cause:</strong> Both files store learnings, but have different scopes and lifecycles</p>
          <p><strong>Fix:</strong></p>
          <ul>
            <li><code>progress.txt</code>: Session-specific, append-only, ephemeral (delete after session)</li>
            <li><code>AGENTS.md</code>: Permanent, curated, project-level (persists across sessions)</li>
            <li>Rule: If a human will benefit from this in 6 months, it goes in <code>AGENTS.md</code></li>
          </ul>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Acceptance Criteria Too Vague</summary>
        <div>
          <p><strong>Symptom:</strong> Agent marks tasks "complete" that don't actually work</p>
          <p><strong>Cause:</strong> Acceptance criteria like "works correctly" or "good UX" can't be verified</p>
          <p><strong>Fix:</strong> Every criterion must be automatable:</p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Bad
- "Handles edge cases"
- "Works correctly"

# Good
- "npm run typecheck passes"
- "Returns 401 on invalid credentials"
- "Column 'email' has unique constraint"</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Context Rot Symptoms</summary>
        <div>
          <p><strong>Symptom:</strong> Agent repeats itself, forgets recent changes, ignores instructions, hallucinates files</p>
          <p><strong>Cause:</strong> Context window filled past 85% capacity</p>
          <p><strong>Fix:</strong></p>
          <ol>
            <li>Check context usage (if using Claude HUD)</li>
            <li>If above 70%, consider <code>/compact</code> or fresh session</li>
            <li>For autonomous work, use Ralph pattern (fresh context each iteration)</li>
          </ol>
          <p><strong>Terminal example (Ralph fresh context):</strong></p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Each iteration starts fresh - no context rot possible
for (( i=1; i&lt;=25; i++ )); do
    claude -p "$(cat PROMPT.md)"
done</code></pre>
          </div>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Iron Law Violation</summary>
        <div>
          <p><strong>Symptom:</strong> Orchestrator tries to write code, or worker spawns sub-agents</p>
          <p><strong>Cause:</strong> Role boundaries not enforced in prompts</p>
          <p><strong>Fix:</strong> Include explicit role constraints in agent preambles:</p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code># Worker preamble
CONTEXT: You are a WORKER agent, not an orchestrator.
RULES:
- Complete ONLY the task described below
- Use tools directly (Read, Write, Edit, Bash)
- Do NOT spawn sub-agents
- Do NOT call TaskCreate/TaskUpdate

# Orchestrator preamble
CONTEXT: You are an ORCHESTRATOR agent, not a worker.
RULES:
- Delegate all implementation to workers
- Use ONLY: Read (1-2 files), Task*, AskUserQuestion
- NEVER write code or run bash commands</code></pre>
          </div>
        </div>
      </details>
    </section>

    <hr class="section-divider">

    <!-- Sources -->
    <section id="sources">
      <h2><span class="b">Sou</span>rces</h2>
      <p>This vocabulary was synthesized from:</p>
      <ul>
        <li>Ralph Wiggum pattern (Geoffrey Huntley, @mattpocockuk, @ryancarson)</li>
        <li>CC Mirror multi-agent (@nummanali)</li>
        <li>Gas Town factory (@steve_yegge)</li>
        <li>Personal Panopticon (@mollycantillon)</li>
        <li>Infinite Orchestra (@0xSero)</li>
        <li>Claude Code official documentation</li>
        <li>40+ community research extractions</li>
      </ul>
    </section>

    <hr class="section-divider">

    <!-- Related Pages -->
    <div class="related-pages">
      <h3>Related Pages</h3>
      <ul>
        <li><a href="grammar-syntax.html">Agent Pattern Syntax Rules</a> - How to combine primitives</li>
        <li><a href="grammar-plugins.html">Plugin & Extension Grammar</a> - How plugins extend vocabulary</li>
        <li><a href="compare-orchestration.html">Orchestration Approaches Compared</a> - Ralph, CC Mirror, Gas Town</li>
      </ul>
    </div>

    <!-- Footer Navigation -->
    <nav class="footer-nav">
      <a href="grammar-syntax.html" class="nav-prev">
        <span class="nav-direction">Previous</span>
        <span class="nav-title">Agent Pattern Syntax Rules</span>
      </a>
      <a href="grammar-plugins.html" class="nav-next">
        <span class="nav-direction">Next</span>
        <span class="nav-title">Plugin & Extension Grammar</span>
      </a>
    </nav>

  </div>

  <script src="../js/search.js"></script>
  <script src="../js/sidebar.js"></script>
  <script src="../js/global-nav.js"></script>
  <script>
    function copyCode(button) {
      const codeBlock = button.parentElement.querySelector('code');
      navigator.clipboard.writeText(codeBlock.textContent);
      button.textContent = 'Copied!';
      button.classList.add('copied');
      setTimeout(() => {
        button.textContent = 'Copy';
        button.classList.remove('copied');
      }, 2000);
    }
  </script>
</body>
</html>
