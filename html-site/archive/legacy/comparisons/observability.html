<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Observability & Monitoring Patterns | Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <div class="wide-container">
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="index.html">Comparisons</a>
      <span>/</span>
      Observability
    </nav>

    <h1><span class="bionic">Obs</span>ervability & <span class="bionic">Mon</span>itoring <span class="bionic">Pat</span>terns</h1>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <strong style="color: #2a7d7d;">You Are Here:</strong> This compares tools and patterns for <strong>making agent systems visible</strong>. Unlike traditional software where you can set breakpoints, AI agents operate as black boxes. Learn how to catch failures, understand behavior, and debug issues. <em>Without observability, you're running a distributed system blind.</em>
    </div>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">On This Page</div>
      <ul>
        <li><a href="#why">Why Observability Matters</a></li>
        <li><a href="#tools">Observability Tools</a></li>
        <li><a href="#metrics">Metrics to Track</a></li>
        <li><a href="#patterns">Monitoring Patterns</a></li>
        <li><a href="#debugging">Debugging Agent Issues</a></li>
        <li><a href="#production">Production Monitoring</a></li>
        <li><a href="#anti-patterns">Anti-Patterns</a></li>
        <li><a href="#comparison">Tool Comparison</a></li>
      </ul>
    </div>

    <hr class="section-divider">

    <!-- Why Observability Matters -->
    <h2 id="why"><span class="bionic">Why</span> <span class="bionic">Obs</span>ervability <span class="bionic">Mat</span>ters</h2>

    <p>Agent systems are opaque by default. Unlike traditional software where you can set breakpoints and step through code, AI agents operate as black boxes that consume tokens, make decisions, and produce outputs with minimal visibility into their internal reasoning.</p>

    <h3>The Four Pillars of Agent Observability</h3>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Pillar</th>
            <th>Purpose</th>
            <th>Without It</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Failure Detection</strong></td>
            <td>Catch issues before they compound</td>
            <td style="color: var(--error);">Broken code accumulates silently</td>
          </tr>
          <tr>
            <td><strong>Behavior Understanding</strong></td>
            <td>Know what the agent is actually doing</td>
            <td style="color: var(--error);">"Staring into the void"</td>
          </tr>
          <tr>
            <td><strong>Performance Optimization</strong></td>
            <td>Identify bottlenecks and waste</td>
            <td style="color: var(--error);">Runaway token consumption</td>
          </tr>
          <tr>
            <td><strong>Debugging Capability</strong></td>
            <td>Trace issues to root cause</td>
            <td style="color: var(--error);">Hours lost to mysterious failures</td>
          </tr>
        </tbody>
      </table>
    </div>

    <blockquote>
      <p>"Makes the hidden control plane of Claude Code visible, which is critical for debugging long-horizon tasks."</p>
      <footer>-- @gurtej__gill_</footer>
    </blockquote>

    <div class="callout callout-warning">
      <div class="callout-title">The Hidden Control Plane Problem</div>
      <p>When running agents for hours or overnight:</p>
      <ul style="margin-bottom: 0;">
        <li>Context silently exhausts</li>
        <li>Quality degrades without warning</li>
        <li>Tasks fail in ways that aren't immediately obvious</li>
        <li>Learning compounds invisibly (good or bad)</li>
      </ul>
    </div>

    <hr class="section-divider">

    <!-- Observability Tools -->
    <h2 id="tools"><span class="bionic">Obs</span>ervability <span class="bionic">Too</span>ls</h2>

    <h3>Claude HUD - Native Session Visibility</h3>
    <p><strong>Source:</strong> @jarrodwatts | github.com/jarrodwatts/claude-hud</p>

    <p>The most direct solution for Claude Code visibility. A plugin that renders real-time session data in your terminal statusline.</p>

    <h4>Installation</h4>
    <pre><code>/plugin marketplace add jarrodwatts/claude-hud
/plugin install claude-hud
/claude-hud:setup</code></pre>

    <h4>What It Shows</h4>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Category</th>
            <th>Metrics</th>
          </tr>
        </thead>
        <tbody>
          <tr><td><strong>Session Metadata</strong></td><td>Model (e.g., Opus 4.5), plan tier, project path, git branch</td></tr>
          <tr><td><strong>Context Usage</strong></td><td>Percentage bar with color coding (green/yellow/red)</td></tr>
          <tr><td><strong>Tool Activity</strong></td><td>Spinners for running tools, checkmarks for completed</td></tr>
          <tr><td><strong>Agent Status</strong></td><td>Subagent names, descriptions, elapsed time</td></tr>
          <tr><td><strong>Todo Progress</strong></td><td>Current task status, completion counter</td></tr>
          <tr><td><strong>Configuration</strong></td><td>Count of CLAUDE.md files, rules, MCPs, hooks</td></tr>
        </tbody>
      </table>
    </div>

    <h4>Sample Output</h4>
    <div class="ascii-diagram">[Opus 4.5] ████████░░ 35% | 1 MCPs | ⏳ 1m
✓ Read x2 | ✓ WebFetch x1 | ✓ Skill x1 | ✓ Edit x1</div>

    <h4>Color-Coded Context Bar</h4>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Color</th>
            <th>Context Level</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="background: #6b9b7a; color: white; padding: 4px 8px; border-radius: 4px;">Green</td>
            <td>0-50%</td>
            <td>Full capability, continue working</td>
          </tr>
          <tr>
            <td style="background: #c49052; color: white; padding: 4px 8px; border-radius: 4px;">Yellow</td>
            <td>50-70%</td>
            <td>Monitor closely, consider compacting soon</td>
          </tr>
          <tr>
            <td style="background: #c97065; color: white; padding: 4px 8px; border-radius: 4px;">Red</td>
            <td>70-85%</td>
            <td>Compact now or wrap up current task</td>
          </tr>
          <tr>
            <td style="background: #c97065; color: white; padding: 4px 8px; border-radius: 4px; animation: pulse 1s infinite;">(Flashing)</td>
            <td>85%+</td>
            <td>Token breakdown appears, quality degrading</td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr class="section-divider" style="margin: 32px 0;">

    <h3>rpai - tmux Multi-Agent Manager</h3>
    <p><strong>Source:</strong> @radoslav11 | <code>cargo install rpai</code></p>

    <p>When running multiple agents in parallel, rpai provides a unified TUI for monitoring and navigation.</p>

    <h4>Installation</h4>
    <pre><code>cargo install rpai
# Run in any tmux session with agents
rpai</code></pre>

    <h4>What It Does</h4>
    <ol>
      <li><strong>Scans</strong> tmux panes for running AI agents (Claude, Cursor, Codex, Opencode)</li>
      <li><strong>Displays</strong> TUI with agent list, status, output previews</li>
      <li><strong>Jump</strong> to any agent with selection (mouse supported)</li>
      <li><strong>Monitor</strong> all agents from one view</li>
    </ol>

    <h4>Demo Interface</h4>
    <div class="ascii-diagram">┌─────────────────────────────────────────────┐
│  RPAI - Agent Monitor                       │
├─────────────────────────────────────────────┤
│  [1] CURSOR AGENT    ██████ running         │
│  [2] CLAUDE AGENT    ██████ running         │
│  [3] CODEX AGENT     ██████ idle            │
├─────────────────────────────────────────────┤
│  Preview: Claude is executing Python...     │
│  > import pandas as pd                      │
│  > df = pd.read_csv('data.csv')            │
└─────────────────────────────────────────────┘</div>

    <blockquote>
      <p>"Parallel agents feel like herding caffeinated cats."</p>
      <footer>-- @FutbolmeAI</footer>
    </blockquote>

    <p>rpai turns chaos into a control center.</p>

    <hr class="section-divider" style="margin: 32px 0;">

    <h3>tmux/Terminal Monitoring</h3>
    <p>For manual multi-pane setups without rpai.</p>

    <h4>Recommended tmux Layout</h4>
    <div class="ascii-diagram">┌────────────────────────────────────────────┐
│              Agent Output (main)            │
│                                             │
│  claude "Implement feature X..."            │
│                                             │
├─────────────────────┬──────────────────────┤
│    Test Watcher     │    Context HUD       │
│                     │                       │
│  npm test --watch   │  [HUD output here]   │
├─────────────────────┴──────────────────────┤
│              Git Log / Status               │
│  watch -n5 'git log --oneline -5'          │
└────────────────────────────────────────────┘</div>

    <hr class="section-divider" style="margin: 32px 0;">

    <h3>Git-Based Monitoring</h3>
    <p>Git history provides the most durable form of agent observability. Changes persist across sessions and agent resets.</p>

    <h4>Key Queries</h4>
    <pre><code># Commit frequency (agent velocity)
git log --oneline --since="1 hour ago" | wc -l

# Branch state
git branch -v

# Recent activity
git log --oneline -10

# What changed in last iteration
git diff HEAD~1

# Uncommitted changes
git status --short</code></pre>

    <hr class="section-divider">

    <!-- Metrics to Track -->
    <h2 id="metrics"><span class="bionic">Met</span>rics to <span class="bionic">Tra</span>ck</h2>

    <h3>Health Metrics</h3>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Metric</th>
            <th>Source</th>
            <th>Warning Threshold</th>
            <th>Critical Threshold</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Context Usage %</strong></td>
            <td>Claude HUD</td>
            <td style="color: var(--warning);">&gt; 60%</td>
            <td style="color: var(--error);">&gt; 85%</td>
          </tr>
          <tr>
            <td><strong>Iteration Count</strong></td>
            <td>Ralph loop output</td>
            <td>Approaching max</td>
            <td style="color: var(--error);">At max</td>
          </tr>
          <tr>
            <td><strong>Time Per Task</strong></td>
            <td>Progress log timestamps</td>
            <td style="color: var(--warning);">&gt; 10 min</td>
            <td style="color: var(--error);">&gt; 30 min</td>
          </tr>
          <tr>
            <td><strong>Failure Rate</strong></td>
            <td>Test output, git logs</td>
            <td style="color: var(--warning);">&gt; 1 consecutive</td>
            <td style="color: var(--error);">&gt; 3 consecutive</td>
          </tr>
          <tr>
            <td><strong>Token Consumption</strong></td>
            <td>Claude HUD, API logs</td>
            <td style="color: var(--warning);">&gt; 50% of budget</td>
            <td style="color: var(--error);">&gt; 80% of budget</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h3>Progress Metrics</h3>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Metric</th>
            <th>Source</th>
            <th>How to Track</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Tasks Completed</strong></td>
            <td>prd.json <code>passes: true</code> count</td>
            <td><code>jq '.userStories | map(select(.passes)) | length'</code></td>
          </tr>
          <tr>
            <td><strong>Stories Remaining</strong></td>
            <td>prd.json <code>passes: false</code> count</td>
            <td><code>jq '.userStories | map(select(.passes == false)) | length'</code></td>
          </tr>
          <tr>
            <td><strong>Velocity Trend</strong></td>
            <td>Git log timestamps</td>
            <td>Commits per hour trending</td>
          </tr>
          <tr>
            <td><strong>Blocker Rate</strong></td>
            <td>Progress.txt entries</td>
            <td>Blocked mentions per iteration</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h4>PRD Status Check Command</h4>
    <pre><code># Quick status check
cat scripts/ralph/prd.json | jq '{
  total: (.userStories | length),
  complete: (.userStories | map(select(.passes)) | length),
  remaining: (.userStories | map(select(.passes == false)) | length)
}'</code></pre>

    <h3>Quality Metrics</h3>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Metric</th>
            <th>Source</th>
            <th>How to Check</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Test Pass Rate</strong></td>
            <td>Test runner output</td>
            <td><code>npm test 2>&1 | grep -E "(passed|failed)"</code></td>
          </tr>
          <tr>
            <td><strong>Type Check Status</strong></td>
            <td>TypeScript compiler</td>
            <td><code>npm run typecheck && echo "PASS" || echo "FAIL"</code></td>
          </tr>
          <tr>
            <td><strong>Lint Violations</strong></td>
            <td>ESLint output</td>
            <td><code>npm run lint 2>&1 | tail -5</code></td>
          </tr>
          <tr>
            <td><strong>Build Status</strong></td>
            <td>Build output</td>
            <td><code>npm run build && echo "PASS"</code></td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr class="section-divider">

    <!-- Monitoring Patterns -->
    <h2 id="patterns"><span class="bionic">Mon</span>itoring <span class="bionic">Pat</span>terns</h2>

    <h3>Dashboard Setups</h3>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">

      <div class="pattern-box">
        <h4 style="margin-top: 0;">Minimal Setup (Single Monitor)</h4>
        <div class="ascii-diagram" style="font-size: 0.85em;">┌────────────────────────────┐
│        Agent + HUD         │
│  [Opus 4.5] ████░░ 45%     │
│                            │
│  claude "..."              │
└────────────────────────────┘</div>
      </div>

      <div class="pattern-box">
        <h4 style="margin-top: 0;">Standard Setup (Development)</h4>
        <div class="ascii-diagram" style="font-size: 0.85em;">┌─────────────────────────────────┐
│         Agent Output (main)     │
│  [Opus] ████████░░ 35% | 1 MCPs │
│  ✓ Read x2 | ✓ Edit x1          │
├───────────────┬─────────────────┤
│  Test Watcher │  Progress Log   │
│  ✓ 42 tests   │  [Iteration 5]  │
│  ⏱ watching...│  US-003 complete│
└───────────────┴─────────────────┘</div>
      </div>
    </div>

    <h4>Production Setup (Multi-Agent)</h4>
    <div class="ascii-diagram">┌──────────────────┬──────────────────┬──────────────────┐
│   Agent 1        │   Agent 2        │   Agent 3        │
│   (Frontend)     │   (Backend)      │   (Docs)         │
│   ████░░ 45%     │   ██████░░ 60%   │   ██░░░░ 20%     │
├──────────────────┴──────────────────┴──────────────────┤
│                    rpai TUI                            │
│   [1] claude-frontend  ██████ running                  │
│   [2] claude-backend   ██████ running                  │
│   [3] claude-docs      ██████ idle                     │
├────────────────────────────────────────────────────────┤
│   Git Status: 3 branches active | 12 commits today    │
└────────────────────────────────────────────────────────┘</div>

    <h3>Alert Triggers</h3>

    <h4>Context Alerts</h4>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Condition</th>
            <th>Action</th>
            <th>Automation</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Context &gt; 60%</td>
            <td>Monitor closely</td>
            <td>Log warning</td>
          </tr>
          <tr>
            <td style="color: var(--warning);">Context &gt; 80%</td>
            <td>Compact or prepare for fresh session</td>
            <td>Alert user</td>
          </tr>
          <tr>
            <td style="color: var(--error);">Context &gt; 90%</td>
            <td>Quality compromised</td>
            <td>Force compact or reset</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h4>Failure Alerts</h4>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Condition</th>
            <th>Action</th>
            <th>Automation</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1 test failure</td>
            <td>Continue, note in progress.txt</td>
            <td>Log</td>
          </tr>
          <tr>
            <td style="color: var(--error);">3 consecutive failures</td>
            <td>Stop and diagnose</td>
            <td>Alert + pause</td>
          </tr>
          <tr>
            <td>Build failure</td>
            <td>Block commit</td>
            <td>Prevent git commit</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h4>Progress Alerts</h4>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Condition</th>
            <th>Action</th>
            <th>Automation</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>No commit &gt; 10 min</td>
            <td>Check if stuck</td>
            <td>Warn</td>
          </tr>
          <tr>
            <td style="color: var(--warning);">No progress &gt; 20 min</td>
            <td>Likely blocked</td>
            <td>Alert</td>
          </tr>
          <tr>
            <td>Approaching max iterations</td>
            <td>Prepare for manual review</td>
            <td>Alert</td>
          </tr>
          <tr>
            <td style="color: var(--error);">Budget &gt; 80% consumed</td>
            <td>Consider stopping</td>
            <td>Alert</td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr class="section-divider">

    <!-- Debugging Agent Issues -->
    <h2 id="debugging"><span class="bionic">Deb</span>ugging <span class="bionic">Age</span>nt <span class="bionic">Iss</span>ues</h2>

    <h3>Common Failures</h3>

    <details>
      <summary>1. Context Exhaustion</summary>
      <div>
        <h4>Symptoms</h4>
        <ul>
          <li>Claude HUD shows 85%+ usage</li>
          <li>Responses become truncated</li>
          <li>Instructions ignored</li>
          <li>Hallucinated file references</li>
          <li>Repetitive statements</li>
        </ul>
        <h4>Resolution</h4>
        <pre><code># Option 1: Compact
/compact

# Option 2: Fresh session
/reset
# Or simply start new Claude instance

# Option 3: In Ralph loop - let iteration end naturally
# Fresh context on next iteration</code></pre>
      </div>
    </details>

    <details>
      <summary>2. Quality Gate Loops</summary>
      <div>
        <h4>Symptoms</h4>
        <ul>
          <li>Same test failing repeatedly</li>
          <li>Identical changes being attempted</li>
          <li>No progress in iterations</li>
          <li>Progress.txt shows repeated attempts at same task</li>
        </ul>
        <h4>Diagnosis</h4>
        <pre><code># Check recent commits
git log --oneline -5

# Look for duplicate changes
git diff HEAD~3..HEAD

# Check progress.txt for repetition
tail -50 scripts/ralph/progress.txt</code></pre>
        <h4>Resolution</h4>
        <ol>
          <li>Stop the loop (<code>Ctrl+C</code>)</li>
          <li>Analyze the failing test</li>
          <li>Either: Fix manually, provide more guidance in CLAUDE.md, split the task, or mark as blocked</li>
        </ol>
      </div>
    </details>

    <details>
      <summary>3. Worker Recursion (Multi-Agent)</summary>
      <div>
        <h4>Symptoms</h4>
        <ul>
          <li>Workers spawning workers spawning workers</li>
          <li>Token costs exploding</li>
          <li>No actual progress</li>
          <li>Many subagent entries in HUD</li>
        </ul>
        <h4>Resolution</h4>
        <p>Add to CLAUDE.md or worker preamble:</p>
        <pre><code>RULES:
- Do NOT spawn sub-agents
- Complete ONLY the task described
- If task seems too large, STOP and ask for clarification</code></pre>
      </div>
    </details>

    <details>
      <summary>4. Coordination Deadlock (Multi-Agent)</summary>
      <div>
        <h4>Symptoms</h4>
        <ul>
          <li>Multiple agents waiting on each other</li>
          <li>No progress across any agent</li>
          <li>Handoff files not being consumed</li>
          <li>Git branches diverging without merges</li>
        </ul>
        <h4>Diagnosis</h4>
        <pre><code># Check for stale handoffs
find . -name "handoff-*.json" -mmin +30

# Check branch status across worktrees
git worktree list</code></pre>
        <h4>Resolution</h4>
        <ol>
          <li>Identify the blocking dependency</li>
          <li>Either: Manually complete the blocking task, re-assign to different agent, or remove the dependency</li>
        </ol>
      </div>
    </details>

    <h3>Debug Process</h3>

    <div class="pattern-box">
      <h4 style="margin-top: 0;">Step 1: Check Context %</h4>
      <p>If using Claude HUD - look at statusline. Or check manually: Are responses getting shorter? Are instructions being ignored?</p>
    </div>

    <div class="pattern-box">
      <h4 style="margin-top: 0;">Step 2: Review progress.txt</h4>
      <pre><code>cat scripts/ralph/progress.txt | tail -30</code></pre>
      <p>Look for: Recent iteration summaries, reported blockers, patterns that might be wrong, repeated attempts at same task.</p>
    </div>

    <div class="pattern-box">
      <h4 style="margin-top: 0;">Step 3: Examine Git Log</h4>
      <pre><code>git log --oneline -10
git diff HEAD~3..HEAD --stat</code></pre>
      <p>Look for: Commit frequency (stopped = problem), commit messages (patterns in failures), files being repeatedly modified.</p>
    </div>

    <div class="pattern-box">
      <h4 style="margin-top: 0;">Step 4: Inspect Task State</h4>
      <pre><code>cat scripts/ralph/prd.json | jq '.userStories[] | select(.passes == false) | {id, title, priority}'</code></pre>
      <p>Look for: Which tasks are stuck, priority order making sense, acceptance criteria that might be impossible.</p>
    </div>

    <hr class="section-divider">

    <!-- Production Monitoring -->
    <h2 id="production"><span class="bionic">Pro</span>duction <span class="bionic">Mon</span>itoring</h2>

    <h3>Health Checks</h3>

    <h4>Periodic Health Check Script</h4>
    <pre><code>#!/bin/bash
# health-check.sh - Run every 5 minutes via cron

HEALTH_LOG="/tmp/agent-health.log"
echo "=== $(date) ===" >> $HEALTH_LOG

# Check if agent process is running
if pgrep -f "claude" > /dev/null; then
  echo "Agent: RUNNING" >> $HEALTH_LOG
else
  echo "Agent: STOPPED" >> $HEALTH_LOG
  # Alert
  curl -X POST "$SLACK_WEBHOOK" -d '{"text":"Agent process stopped"}'
fi

# Check recent commit activity
LAST_COMMIT=$(git log -1 --format='%ar')
echo "Last commit: $LAST_COMMIT" >> $HEALTH_LOG

# Check remaining tasks
REMAINING=$(cat scripts/ralph/prd.json | jq '.userStories | map(select(.passes == false)) | length')
echo "Remaining tasks: $REMAINING" >> $HEALTH_LOG</code></pre>

    <h3>Cost Tracking</h3>

    <h4>Cost Alert Thresholds</h4>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Threshold</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>50% of daily budget</td>
            <td>Log warning</td>
          </tr>
          <tr>
            <td style="color: var(--warning);">80% of daily budget</td>
            <td>Alert user</td>
          </tr>
          <tr>
            <td style="color: var(--error);">95% of daily budget</td>
            <td>Consider pausing</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h3>Simple CLI Dashboard</h3>
    <pre><code>#!/bin/bash
# dashboard.sh

while true; do
  clear
  echo "╔══════════════════════════════════════════╗"
  echo "║         Agent Dashboard                   ║"
  echo "╠══════════════════════════════════════════╣"

  # Git stats
  COMMITS_TODAY=$(git log --since="midnight" --oneline | wc -l | tr -d ' ')
  LAST_COMMIT=$(git log -1 --format='%ar' 2>/dev/null || echo "none")
  echo "║ Commits today: $COMMITS_TODAY"
  echo "║ Last commit: $LAST_COMMIT"

  # Task stats
  if [ -f scripts/ralph/prd.json ]; then
    TOTAL=$(cat scripts/ralph/prd.json | jq '.userStories | length')
    DONE=$(cat scripts/ralph/prd.json | jq '.userStories | map(select(.passes)) | length')
    echo "║ Tasks: $DONE / $TOTAL complete"
  fi

  echo "╚══════════════════════════════════════════╝"
  sleep 30
done</code></pre>

    <hr class="section-divider">

    <!-- Anti-Patterns -->
    <h2 id="anti-patterns"><span class="bionic">Obs</span>ervability <span class="bionic">Ant</span>i-Patterns</h2>

    <div class="gotcha-block">
      <div class="comparison-table" style="margin-top: 12px;">
        <table>
          <thead>
            <tr>
              <th>Anti-Pattern</th>
              <th>Problem</th>
              <th>Better Approach</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>No monitoring at all</strong></td>
              <td>Silent failures, wasted tokens</td>
              <td style="color: var(--success);">At minimum use Claude HUD</td>
            </tr>
            <tr>
              <td><strong>Polling too frequently</strong></td>
              <td>Performance overhead</td>
              <td style="color: var(--success);">10-30 second intervals sufficient</td>
            </tr>
            <tr>
              <td><strong>Ignoring context warnings</strong></td>
              <td>Quality degradation</td>
              <td style="color: var(--success);">Act on yellow, definitely on red</td>
            </tr>
            <tr>
              <td><strong>Manual-only checking</strong></td>
              <td>Miss overnight issues</td>
              <td style="color: var(--success);">Automated alerts for production</td>
            </tr>
            <tr>
              <td><strong>Logging everything</strong></td>
              <td>Log noise, storage bloat</td>
              <td style="color: var(--success);">Structured logs with levels</td>
            </tr>
            <tr>
              <td><strong>No baseline metrics</strong></td>
              <td>Can't detect anomalies</td>
              <td style="color: var(--success);">Establish normal ranges first</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <hr class="section-divider">

    <!-- Tool Comparison -->
    <h2 id="comparison"><span class="bionic">Too</span>l <span class="bionic">Com</span>parison <span class="bionic">Mat</span>rix</h2>

    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Tool</th>
            <th>Visibility Level</th>
            <th>Setup Effort</th>
            <th>Best For</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Claude HUD</strong></td>
            <td>Session-level</td>
            <td style="color: var(--success);">Quick (5 min)</td>
            <td>Single-agent development</td>
          </tr>
          <tr>
            <td><strong>rpai</strong></td>
            <td>Multi-agent</td>
            <td style="color: var(--success);">Quick (Rust install)</td>
            <td>Parallel agents in tmux</td>
          </tr>
          <tr>
            <td><strong>tmux layout</strong></td>
            <td>Terminal-level</td>
            <td>Medium</td>
            <td>Custom monitoring needs</td>
          </tr>
          <tr>
            <td><strong>Git monitoring</strong></td>
            <td>Commit-level</td>
            <td style="color: var(--success);">Low</td>
            <td>All workflows, durability</td>
          </tr>
          <tr>
            <td><strong>Custom scripts</strong></td>
            <td>Any level</td>
            <td style="color: var(--error);">High</td>
            <td>Production, automation</td>
          </tr>
          <tr>
            <td><strong>Progress.txt review</strong></td>
            <td>Semantic</td>
            <td style="color: var(--success);">None</td>
            <td>Understanding agent reasoning</td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr class="section-divider">

    <!-- Quick Reference -->
    <h2><span class="bionic">Qui</span>ck <span class="bionic">Ref</span>erence: <span class="bionic">Mon</span>itoring <span class="bionic">Che</span>cklist</h2>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">

      <div class="pattern-box">
        <h4 style="margin-top: 0;">Per-Session</h4>
        <ul style="margin-bottom: 0;">
          <li>Claude HUD installed and visible</li>
          <li>Context usage below 70%</li>
          <li>Recent commits appearing</li>
          <li>Tests passing</li>
        </ul>
      </div>

      <div class="pattern-box">
        <h4 style="margin-top: 0;">Per-Iteration (Ralph)</h4>
        <ul style="margin-bottom: 0;">
          <li>Progress.txt updated</li>
          <li>Git commit made</li>
          <li>prd.json task marked complete</li>
          <li>No repeated failures</li>
        </ul>
      </div>

      <div class="pattern-box">
        <h4 style="margin-top: 0;">Daily (Production)</h4>
        <ul style="margin-bottom: 0;">
          <li>Review progress.txt for patterns</li>
          <li>Check token/cost usage</li>
          <li>Verify test pass rates</li>
          <li>Look for stuck tasks</li>
        </ul>
      </div>

      <div class="pattern-box">
        <h4 style="margin-top: 0;">Weekly</h4>
        <ul style="margin-bottom: 0;">
          <li>Analyze learning accumulation</li>
          <li>Review error patterns</li>
          <li>Optimize based on metrics</li>
          <li>Archive completed PRDs</li>
        </ul>
      </div>
    </div>

    <hr class="section-divider">

    <!-- Mental Model -->
    <h2><span class="bionic">Men</span>tal <span class="bionic">Mod</span>el</h2>

    <p>Think of agent observability like monitoring a distributed system:</p>

    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Agent Concept</th>
            <th>Distributed System Analogy</th>
          </tr>
        </thead>
        <tbody>
          <tr><td><strong>Agents</strong></td><td>Nodes - Each has health metrics, can fail independently</td></tr>
          <tr><td><strong>Context</strong></td><td>Memory - Finite resource that degrades under pressure</td></tr>
          <tr><td><strong>Git</strong></td><td>Event log - Durable record of all meaningful actions</td></tr>
          <tr><td><strong>Progress.txt</strong></td><td>Semantic trace - Why decisions were made</td></tr>
          <tr><td><strong>Claude HUD</strong></td><td>Metrics collector - Real-time visibility</td></tr>
          <tr><td><strong>rpai</strong></td><td>Orchestration dashboard - Multi-node overview</td></tr>
        </tbody>
      </table>
    </div>

    <div class="recommendation">
      <p><strong>Without observability, you're running a distributed system blind.</strong> With it, you can debug issues in minutes instead of hours, catch problems before they compound, and optimize your agent workflows based on real data.</p>
    </div>

    <!-- Related Pages -->
    <div class="related-pages">
      <h3>Related Comparisons</h3>
      <ul>
        <li><a href="architecture.html">Agent Architecture Compared</a> - Single, Subagents, Swarm, Hierarchical</li>
        <li><a href="orchestration.html">Orchestration Approaches Compared</a> - Ralph, PRD-Ralph, CC Mirror, Gas Town</li>
        <li><a href="memory.html">Memory Approaches Compared</a> - progress.txt, Git, AGENTS.md, Claude-Mem</li>
        <li><a href="cost.html">Cost Optimization Guide</a> - Model selection, caching, budget engineering</li>
      </ul>
    </div>

    <h3>Essential Tools</h3>
    <ul>
      <li><a href="https://github.com/jarrodwatts/claude-hud">github.com/jarrodwatts/claude-hud</a> - Context monitoring</li>
      <li><code>cargo install rpai</code> - tmux multi-agent TUI</li>
      <li><a href="https://github.com/snarktank/ralph">github.com/snarktank/ralph</a> - Ralph loop implementation</li>
    </ul>

    <!-- Footer Navigation -->
    <nav class="footer-nav">
      <a href="cost.html">Previous: Cost Optimization</a>
      <a href="../index.html">Back to Home</a>
    </nav>

  </div>

  

  <style>
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  </style>
  <script src="../js/copy-code.js"></script>
</body>
</html>
