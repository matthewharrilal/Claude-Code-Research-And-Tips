<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shrivu Shankar - Enterprise Scale Architect | Practitioner Wisdom</title>
  <meta data-pagefind-meta="chapter" content="Practitioners">
  <meta data-pagefind-meta="section" content="Practitioner Profiles">
  <meta name="description" content="Shrivu Shankar's Claude Code workflow: 13KB CLAUDE.md architecture, Master-Clone pattern, and billion-token-scale enterprise methodology.">
  <meta name="keywords" content="claude code, shrivu shankar, enterprise scale, master clone, claude.md architecture">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/search.css">
  <style>
    .bionic { font-weight: 700; }

    .you-are-here {
      background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%);
      border-left: 4px solid #2a7d7d;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .checkpoint {
      background: #f0ebe3;
      border-left: 4px solid #6b9b7a;
      border-radius: 8px;
      padding: 1.5rem;
      margin: 2rem 0;
    }

    .checkpoint-header {
      color: #6b9b7a;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .troubleshoot {
      border: 1px solid #c97065;
      border-radius: 8px;
      margin: 1rem 0;
    }

    .troubleshoot summary {
      background: #fef6f5;
      padding: 1rem;
      cursor: pointer;
      color: #c97065;
      font-weight: 600;
    }

    .troubleshoot > div {
      padding: 1rem;
      background: white;
    }

    .milestone {
      background: linear-gradient(90deg, #6b9b7a 0%, #2a7d7d 100%);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      text-align: center;
      margin: 2rem 0;
    }

    .divider-procedure { border-top: 3px solid #2a7d7d; margin: 2rem 0; padding-top: 1rem; }
    .divider-checkpoint { border-top: 3px solid #6b9b7a; margin: 2rem 0; padding-top: 1rem; }
    .divider-context { border-top: 3px solid #5c4b3a; margin: 2rem 0; padding-top: 1rem; }

    .code-block {
      background: #f0ebe3;
      border-radius: 6px;
      padding: 1rem;
      position: relative;
      font-family: 'SF Mono', Monaco, monospace;
      margin: 1rem 0;
      overflow-x: auto;
    }

    .copy-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: #2a7d7d;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 0.25rem 0.5rem;
      cursor: pointer;
      font-size: 0.8rem;
    }

    .copy-btn:hover {
      background: #3a9d9d;
    }

    .pioneer-badge {
      background: linear-gradient(135deg, #c49052 0%, #2a7d7d 100%);
      color: white;
      display: inline-block;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .principle-card {
      background: white;
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1rem 0;
      transition: box-shadow 0.2s;
    }

    .principle-card:hover {
      box-shadow: 0 4px 12px rgba(92, 75, 58, 0.15);
    }

    .principle-number {
      background: var(--accent);
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      margin-right: 0.75rem;
    }

    .workflow-visual {
      background: var(--code-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 2rem;
      text-align: left;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 0.85em;
      line-height: 1.6;
      overflow-x: auto;
      white-space: pre;
    }

    .profile-card {
      background: white;
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .profile-card h4 {
      margin-top: 0;
      color: var(--heading);
    }

    .quote-highlight {
      background: linear-gradient(90deg, #f0ebe3 0%, #fefcf3 100%);
      border-left: 4px solid #c49052;
      padding: 1.5rem;
      border-radius: 8px;
      margin: 1.5rem 0;
      font-style: italic;
    }

    .quote-highlight cite {
      display: block;
      margin-top: 0.75rem;
      font-style: normal;
      font-weight: 600;
      color: var(--text-muted);
    }

    .feature-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }

    .feature-table th,
    .feature-table td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .feature-table th {
      background: var(--code-bg);
      font-weight: 600;
    }

    .technique-diagram {
      background: var(--code-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 0.8em;
      line-height: 1.4;
      overflow-x: auto;
      white-space: pre;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
<!-- Search Modal -->
<div class="search-modal" id="searchModal" aria-hidden="true">
  <div class="search-overlay" onclick="closeSearch()"></div>
  <div class="search-content">
    <div class="search-header">
      <div class="search-input-wrapper">
        <span class="search-icon-input">üîç</span>
        <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
        <kbd class="search-kbd">ESC</kbd>
      </div>
    </div>
    <div class="search-filters">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="ch1">Chapter 1</button>
      <button class="filter-btn" data-filter="ch2">Chapter 2</button>
      <button class="filter-btn" data-filter="ch3">Chapter 3</button>
      <button class="filter-btn" data-filter="ch4">Chapter 4</button>
      <button class="filter-btn" data-filter="ref">Reference</button>
    </div>
    <div class="search-results" id="searchResults">
      <div class="search-empty"><p>Start typing to search... (Press ‚åòK anytime)</p></div>
    </div>
    <div class="search-footer">
      <span>‚Üë‚Üì Navigate</span><span>‚Üµ Select</span><span>ESC Close</span>
    </div>
  </div>
</div>

  <div class="container">

    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../index.html">Home</a>
      <span>/</span>
      <a href="index.html">Practitioners</a>
      <span>/</span>
      <strong>Shrivu Shankar</strong>
      <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
        <span class="search-icon">‚åòK</span>
        <span class="search-text">Search</span>
      </button>
    </nav>

    <!-- You Are Here Context Box -->
    <div class="you-are-here">
      <strong><span class="bionic">You</span> Are <span class="bionic">Her</span>e:</strong> You're learning from a practitioner operating at <em>billion-token scale</em>. Shrivu Shankar maintains a 13KB CLAUDE.md for professional monorepos and has developed the <span class="bionic">Mas</span>ter-Clone pattern for enterprise agent coordination.
      <br><br>
      <strong><span class="bionic">Wha</span>t This <span class="bionic">Ena</span>bles:</strong> Understanding his mental model lets you scale Claude Code from hobby projects to enterprise workflows. "Shoot and forget" isn't about abandoning oversight - it's about trusting well-structured context to produce quality PRs.
    </div>

    <div class="source-note" style="background: #fff8e6; border-left: 4px solid #c49052; padding: 1rem; margin: 1rem 0; border-radius: 4px;">
      <strong>Source Note:</strong> This profile synthesizes Shrivu's public writings from <a href="https://blog.sshh.io/p/how-i-use-every-claude-code-feature">blog.sshh.io</a> and his Twitter presence. Some conceptual frameworks (like "Context is Constitutional") are editorial interpretations of his approach, not direct quotes. Verified direct quotes are marked with quotation marks.
    </div>

    <div class="pioneer-badge">ENTERPRISE SCALE ARCHITECT</div>

    <h1><span class="bionic">Shr</span>ivu <span class="bionic">Sha</span>nkar: <span class="bionic">Bil</span>lion-Token <span class="bionic">Sca</span>le</h1>

    <p class="conversational-lead">
      "<span class="bionic">Sho</span>ot and forget - to <span class="bionic">del</span>egate, set the <span class="bionic">con</span>text, and let it work. <span class="bionic">Jud</span>ging the tool by the <span class="bionic">fin</span>al PR and not how it <span class="bionic">get</span>s there." - Shrivu Shankar
    </p>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">On This Page</div>
      <ul>
        <li><a href="#who">Who Is Shrivu?</a></li>
        <li><a href="#philosophy">Core Philosophy</a></li>
        <li><a href="#techniques">Key Techniques</a></li>
        <li><a href="#workflow">The Enterprise Workflow</a></li>
        <li><a href="#implement">Implement His Patterns</a></li>
        <li><a href="#quotes">Best Quotes</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
        <li><a href="#whats-next">What's Next</a></li>
        <li><a href="#related">Related Content</a></li>
      </ul>
    </div>

    <hr class="section-divider">

    <!-- Section 1: Who Is Shrivu -->
    <section id="who">
      <h2><span class="bionic">Who</span> Is <span class="bionic">Shr</span>ivu?</h2>

      <div class="story-context">
        Shrivu Shankar represents the <span class="bionic">ent</span>erprise frontier of Claude Code usage. Part of a team consuming <strong>several billion tokens per month</strong> for code generation, he has battle-tested techniques at a scale most practitioners will never see. His insights aren't theoretical - they're forged in production at Fortune 500 scale.
      </div>

      <div class="profile-card">
        <h4><span class="bionic">Shr</span>ivu <span class="bionic">Sha</span>nkar</h4>
        <ul>
          <li><strong>Handle:</strong> <a href="https://twitter.com/ShrivuShankar">@ShrivuShankar</a> (Twitter)</li>
          <li><strong>GitHub:</strong> <a href="https://github.com/sshh12">sshh12</a></li>
          <li><strong>Blog:</strong> <a href="https://blog.sshh.io">blog.sshh.io</a></li>
          <li><strong>Scale:</strong> Several billion tokens per month for codegen</li>
          <li><strong>Key Article:</strong> "How I Use Every Claude Code Feature"</li>
          <li><strong>Reliability:</strong> HIGH - Production-scale experience, comprehensive documentation</li>
        </ul>
      </div>

      <h3><span class="bionic">Uni</span>que <span class="bionic">Con</span>tributions</h3>
      <ol>
        <li><strong>13KB CLAUDE.md Architecture</strong> - Largest documented professional monorepo configuration</li>
        <li><strong>Master-Clone Pattern</strong> - Dynamic agent spawning without context gatekeeping</li>
        <li><strong>"Shoot and Forget" Philosophy</strong> - Delegate, set context, judge by final PR</li>
        <li><strong>Enterprise GHA Integration</strong> - PR-from-anywhere with full audit logging</li>
        <li><strong>Meta-Analysis Flywheel</strong> - Mining agent logs to improve CLAUDE.md iteratively</li>
      </ol>
    </section>

    <div class="divider-context"></div>

    <!-- Section 2: Philosophy -->
    <section id="philosophy">
      <h2><span class="bionic">Cor</span>e <span class="bionic">Phil</span>osophy</h2>

      <div class="principle-card">
        <h3><span class="principle-number">1</span>"<span class="bionic">Sho</span>ot and <span class="bionic">For</span>get"</h3>
        <p>
          The goal is <span class="bionic">del</span>egation, not supervision. If your CLAUDE.md is comprehensive enough, you should be able to start a task, context switch, and return to a <span class="bionic">rev</span>iewable PR. Quality gates happen at commit/PR time, not mid-execution.
        </p>
        <div class="quote-highlight">
          "Shoot and forget - to delegate, set the context, and let it work. Judging the tool by the final PR and not how it gets there."
          <cite>- Shrivu Shankar</cite>
        </div>
      </div>

      <div class="principle-card">
        <h3><span class="principle-number">2</span><span class="bionic">Con</span>text is <span class="bionic">Con</span>stitutional</h3>
        <p>
          CLAUDE.md isn't a manual - it's a <span class="bionic">con</span>stitution. Curate ruthlessly. Every token counts against your context budget. If fewer than 30% of engineers use a tool, it doesn't belong in global context. Token budgeting with allocated "ad space" per tool.
        </p>
        <div class="quote-highlight">
          "Only tools used by 30%+ of engineers. Token budgeting with allocated 'ad space' per tool."
          <cite>- Shrivu Shankar on CLAUDE.md curation (Editorial interpretation of Shrivu's approach)</cite>
        </div>
      </div>

      <div class="principle-card">
        <h3><span class="principle-number">3</span><span class="bionic">Mas</span>ter-Clone Over <span class="bionic">Rig</span>id Subagents</h3>
        <p>
          Instead of restrictive custom agents with limited context, let the main agent (with full CLAUDE.md) spawn <span class="bionic">clo</span>nes of itself. Clones share parent context but operate independently. No gatekeeping, no forced workflows.
        </p>
        <div class="quote-highlight">
          "Custom subagents create two new problems: They Gatekeep Context and Force Human Workflows."
          <cite>- Shrivu Shankar on Master-Clone pattern</cite>
        </div>
      </div>

      <div class="principle-card">
        <h3><span class="principle-number">4</span><span class="bionic">Too</span>ls Are <span class="bionic">Con</span>verging</h3>
        <p>
          Claude Code, Gemini CLI, Cursor - the underlying models and tools are <span class="bionic">con</span>verging in capability. What differentiates outcomes is workflow architecture: your CLAUDE.md structure, your context layering strategy, your verification gates.
        </p>
        <div class="quote-highlight">
          "Tools are converging in capability‚Äîworkflow architecture is the differentiator." (paraphrased)
          <cite>- Shrivu Shankar on tool convergence</cite>
        </div>
      </div>
    </section>

    <div class="divider-procedure"></div>

    <!-- Section 3: Key Techniques -->
    <section id="techniques">
      <h2><span class="bionic">Key</span> <span class="bionic">Tech</span>niques</h2>

      <!-- Technique 1: 13KB CLAUDE.md Architecture -->
      <div class="principle-card">
        <h3><span class="principle-number">1</span><span class="bionic">13K</span>B CLAUDE.md <span class="bionic">Arc</span>hitecture</h3>

        <p>A carefully budgeted repository constitution that balances <span class="bionic">com</span>prehensiveness with token efficiency.</p>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code to clipboard">Copy</button>
# CLAUDE.md Structure (Shrivu Shankar Pattern)

## Principles
- Only document tools used by 30%+ of engineers
- Allocate "token budget" per section
- Curate guardrails, not comprehensive manuals
- Sync with AGENTS.md for multi-IDE compatibility

## Sections
1. Python environment + test commands
2. Internal CLI documentation (80% use cases only)
3. Complex usage ‚Üí pointers to separate docs
4. Repository conventions and boundaries

## Anti-Patterns to Avoid
- "@-file" embedding (loads entire files, bloats context)
- Negative-only constraints ("Never use X" causes paralysis)
- Comprehensive manuals (should be curated guardrails)
        </div>

        <div class="checkpoint">
          <div class="checkpoint-header">Key Metric</div>
          <p><strong>Baseline context:</strong> ~20k tokens (10% of available budget) for a professional monorepo. This leaves 90% for actual work.</p>
          <p><strong>You should see:</strong> Run <code>/context</code> at session start. Your base CLAUDE.md should show ~10% usage. If you're at 30%+ before writing any code, your CLAUDE.md needs curation.</p>
        </div>
      </div>

      <!-- Technique 2: Master-Clone Pattern -->
      <div class="principle-card">
        <h3><span class="principle-number">2</span><span class="bionic">Mas</span>ter-Clone <span class="bionic">Pat</span>tern</h3>

        <p>Dynamic agent spawning that preserves full context without rigid workflow constraints.</p>

        <div class="technique-diagram">
           MASTER-CLONE ARCHITECTURE

    +------------------+
    |   Main Agent     | <-- Full CLAUDE.md context (13KB)
    |   (13KB context) |
    +--------+---------+
             |
             | Task() spawns when needed
             |
    +--------+--------+-----------+
    |                 |           |
    v                 v           v
+-------+        +-------+   +-------+
| Clone |        | Clone |   | Clone |
|   A   |        |   B   |   |   C   |
+-------+        +-------+   +-------+

Key Properties:
- Clones share parent context
- Operate independently
- No gatekeeping of information
- No forced human workflows
        </div>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code to clipboard">Copy</button>
# Main agent decides when to spawn, not predefined
# Clones get full context, not restricted views

# Anti-pattern: Rigid subagent definition
# subagent "reviewer" with limited_tools

# Shrivu pattern: Task() of self with full context
# Agent spawns clones dynamically as needed
        </div>

        <details class="troubleshoot">
          <summary>Why not custom subagents?</summary>
          <div>
            <p>Custom subagents create two problems:</p>
            <ol>
              <li><strong>Context Gatekeeping:</strong> You pre-decide what information the agent "needs," often incorrectly</li>
              <li><strong>Forced Workflows:</strong> You impose human mental models onto agent execution</li>
            </ol>
            <p>Master-Clone gives the agent full context and lets it decide how to divide work.</p>
          </div>
        </details>
      </div>

      <!-- Technique 3: Context Layering Strategy -->
      <div class="principle-card">
        <h3><span class="principle-number">3</span><span class="bionic">Con</span>text <span class="bionic">Lay</span>ering Strategy</h3>

        <p>Three-tier context management with strategic restart patterns.</p>

        <div class="technique-diagram">
CONTEXT LAYERING (Three Tiers)

+---------------------------------------------+
| GLOBAL (CLAUDE.md)                          |
| - Repository constitution                    |
| - Tool documentation (30%+ usage threshold) |
| - Conventions and boundaries                 |
| - ~10% of context budget (~20k tokens)      |
+---------------------------------------------+
| PROJECT (Session-specific)                  |
| - Current feature/PR context                |
| - Loaded via /add-dir or file reads         |
| - Disposable per session                     |
+---------------------------------------------+
| SESSION (Conversation memory)               |
| - Current conversation state                 |
| - Compactable via /clear + /catchup         |
| - Most volatile layer                        |
+---------------------------------------------+
        </div>

        <h4><span class="bionic">Res</span>tart Strategies</h4>
        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code to clipboard">Copy</button>
# Simple restart (default pattern)
/clear
/catchup  # Reads git-changed files

# Complex restart (preserve planning)
# 1. Dump current plan to markdown file
# 2. /clear
# 3. Resume from plan file
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">Warning: Avoid /compact</div>
          <p>Shrivu specifically avoids <code>/compact</code> - it's opaque and error-prone. Use <code>/clear + /catchup</code> instead for predictable context management.</p>
        </div>
      </div>

      <!-- Technique 4: Enterprise GHA Integration -->
      <div class="principle-card">
        <h3><span class="principle-number">4</span><span class="bionic">Ent</span>erprise GHA <span class="bionic">Int</span>egration</h3>

        <p>GitHub Actions automation enabling "PR-from-anywhere" with full audit logging.</p>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code to clipboard">Copy</button>
# Meta-analysis flywheel: Query agent logs for failure patterns

query-claude-gha-logs --since 5d | claude -p "
  Analyze these agent logs for:
  1. Common bash errors
  2. Permission request patterns
  3. Unaligned practices

  Suggest CLAUDE.md improvements.
"
        </div>

        <h4><span class="bionic">Mul</span>ti-Agent Parallelism</h4>
        <div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code to clipboard">Copy</button>
#!/bin/bash
# Parallel agent instances, isolated by path/branch

for dir in packages/*/; do
  (
    cd "$dir"
    git checkout -b "refactor-$(basename $dir)"
    claude -p "Apply new logging pattern to this package"
  ) &amp;
done
wait
        </div>

        <div class="checkpoint">
          <div class="checkpoint-header">The Flywheel</div>
          <p>Agent logs become training data for improving CLAUDE.md. Failures inform better guardrails. This compounds over time.</p>
          <p><strong>You should see:</strong> After 2-3 weeks of logging, run the meta-analysis query. You should find 3-5 recurring patterns that become CLAUDE.md additions.</p>
        </div>
      </div>

      <!-- Technique 5: Feature Usage Philosophy -->
      <div class="principle-card">
        <h3><span class="principle-number">5</span><span class="bionic">Fea</span>ture Usage <span class="bionic">Phil</span>osophy</h3>

        <p>Strategic feature selection based on production experience.</p>

        <table class="feature-table">
          <tr>
            <th>Feature</th>
            <th>Shrivu's Usage</th>
            <th>Reasoning</th>
          </tr>
          <tr>
            <td><code>/context</code></td>
            <td>Mid-session checks</td>
            <td>Baseline ~20k tokens (10%) for monorepo</td>
          </tr>
          <tr>
            <td><code>/clear</code> + <code>/catchup</code></td>
            <td>Default reboot</td>
            <td>Simple, predictable restart pattern</td>
          </tr>
          <tr>
            <td><code>/compact</code></td>
            <td><strong>Avoid</strong></td>
            <td>Opaque, error-prone auto-compression</td>
          </tr>
          <tr>
            <td>Custom slash commands</td>
            <td>Minimal (2 total)</td>
            <td>Shortcuts, not replacements</td>
          </tr>
          <tr>
            <td>Hooks</td>
            <td>Production only</td>
            <td>Block-at-submit, not mid-write</td>
          </tr>
          <tr>
            <td>Planning Mode</td>
            <td>Complex features</td>
            <td>Alignment before execution</td>
          </tr>
          <tr>
            <td>Skills</td>
            <td>Primary agent layer</td>
            <td>Scripting formalization</td>
          </tr>
          <tr>
            <td>MCP</td>
            <td>Data gateway only</td>
            <td>Stateless tools ‚Üí CLI</td>
          </tr>
        </table>

        <div class="quote-highlight">
          "Skills are (maybe) a bigger deal than MCP - they formalize the scripting layer rather than rigid API abstraction."
          <cite>- Shrivu Shankar on Skills vs MCP</cite>
        </div>
      </div>
    </section>

    <div class="divider-checkpoint"></div>

    <!-- Section 4: Complete Workflow -->
    <section id="workflow">
      <h2>The <span class="bionic">Ent</span>erprise <span class="bionic">Work</span>flow</h2>

      <div class="workflow-visual">
SHRIVU SHANKAR ENTERPRISE WORKFLOW

+-------------------------------------------------------------+
|                    PREPARATION PHASE                         |
+-------------------------------------------------------------+
|  1. CLAUDE.md Architecture (13KB)                           |
|     - 30%+ usage threshold for tools                        |
|     - Token budgeted per section                            |
|     - Synced with AGENTS.md                                 |
|                                                              |
|  2. GHA Integration                                          |
|     - PR-from-anywhere capability                           |
|     - Audit logging for meta-analysis                       |
+-------------------------------------------------------------+
                              |
                              v
+-------------------------------------------------------------+
|                    EXECUTION PHASE                           |
+-------------------------------------------------------------+
|  3. "Shoot and Forget"                                      |
|     - Set context (CLAUDE.md + task spec)                   |
|     - Delegate to agent                                     |
|     - Context switch to other work                          |
|                                                              |
|  4. Master-Clone Spawning (if needed)                       |
|     - Agent decides when to spawn Task() clones             |
|     - Clones get full context                               |
|     - Parallel execution without coordination               |
+-------------------------------------------------------------+
                              |
                              v
+-------------------------------------------------------------+
|                    REVIEW PHASE                              |
+-------------------------------------------------------------+
|  5. Judge by Final PR                                       |
|     - Review output, not process                            |
|     - Hooks enforce validation at commit                    |
|     - Quality gates are automated                           |
+-------------------------------------------------------------+
                              |
                              v
+-------------------------------------------------------------+
|                  META-ANALYSIS PHASE                         |
+-------------------------------------------------------------+
|  6. Flywheel Improvement                                    |
|     - Query GHA logs for failure patterns                   |
|     - Extract common errors and permission requests         |
|     - Update CLAUDE.md and CLI tooling                      |
|     - Repeat                                                 |
+-------------------------------------------------------------+
      </div>

      <div class="checkpoint">
        <div class="checkpoint-header">The Key Insight</div>
        <p>This isn't about the agent working harder - it's about the <strong>system</strong> getting smarter. Each iteration of the flywheel improves CLAUDE.md, which improves every future agent session.</p>
        <p><strong>You should see:</strong> Month-over-month, your PRs require fewer iterations. Your CLAUDE.md grows by ~500-1000 tokens per month from real failures. Quality compounds.</p>
      </div>
    </section>

    <div class="divider-context"></div>

    <!-- Section 5: Implement -->
    <section id="implement">
      <h2><span class="bionic">Imp</span>lement His <span class="bionic">Pat</span>terns</h2>

      <h3><span class="bionic">Qui</span>ck Wins (< 30 minutes)</h3>
      <ol>
        <li>Audit your CLAUDE.md - is it a manual or a constitution?</li>
        <li>Check <code>/context</code> - what percentage of budget does your base config consume?</li>
        <li>Remove any "@-file" embeddings that bloat context</li>
        <li>Delete negative-only constraints ("Never use X")</li>
      </ol>

      <h3><span class="bionic">Med</span>ium Lift (2-4 hours)</h3>
      <ol>
        <li>Restructure CLAUDE.md using 30% usage threshold</li>
        <li>Set up <code>/clear + /catchup</code> as your default restart pattern</li>
        <li>Create separate detailed docs for complex tools (link from CLAUDE.md)</li>
        <li>Stop using <code>/compact</code> entirely</li>
      </ol>

      <h3><span class="bionic">Dee</span>p Investment (days)</h3>
      <ol>
        <li>Implement GHA logging for agent sessions</li>
        <li>Build the meta-analysis flywheel (query logs ‚Üí improve CLAUDE.md)</li>
        <li>Sync CLAUDE.md with AGENTS.md for multi-IDE compatibility</li>
        <li>Develop token budgets per section of your CLAUDE.md</li>
      </ol>

      <details class="troubleshoot">
        <summary>My CLAUDE.md is already 50KB+</summary>
        <div>
          <p>This is common in large orgs. The fix is brutal curation:</p>
          <ol>
            <li>Survey your team: Which tools do 30%+ actually use?</li>
            <li>Move comprehensive docs to separate files, link from CLAUDE.md</li>
            <li>Replace detailed explanations with "guardrails" - brief rules, not manuals</li>
            <li>Target 10-15KB for the base CLAUDE.md</li>
          </ol>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Master-Clone doesn't work for my use case</summary>
        <div>
          <p>Master-Clone works best when:</p>
          <ul>
            <li>Tasks are parallelizable (different packages, different features)</li>
            <li>You have a comprehensive CLAUDE.md that clones inherit</li>
            <li>You're comfortable with agents deciding their own decomposition</li>
          </ul>
          <p>If you need strict sequencing or specialized tooling per agent type, consider a hybrid approach.</p>
        </div>
      </details>
    </section>

    <div class="divider-checkpoint"></div>

    <!-- Section 6: Quotes -->
    <section id="quotes">
      <h2><span class="bionic">Bes</span>t <span class="bionic">Quo</span>tes</h2>

      <div class="quote-highlight">
        "Shoot and forget - to delegate, set the context, and let it work. Judging the tool by the final PR and not how it gets there."
        <cite>- Shrivu Shankar</cite>
      </div>

      <div class="quote-highlight">
        "Custom subagents create two new problems: They Gatekeep Context and Force Human Workflows."
        <cite>- Shrivu Shankar on Master-Clone pattern</cite>
      </div>

      <div class="quote-highlight">
        "Tools are converging in capability‚Äîworkflow architecture is the differentiator." (paraphrased)
        <cite>- Shrivu Shankar on tool convergence</cite>
      </div>

      <div class="quote-highlight">
        "Skills are (maybe) a bigger deal than MCP - they formalize the scripting layer rather than rigid API abstraction."
        <cite>- Shrivu Shankar on Skills vs MCP</cite>
      </div>

      <div class="quote-highlight">
        "Only tools used by 30%+ of engineers. Token budgeting with allocated 'ad space' per tool."
        <cite>- Shrivu Shankar on CLAUDE.md curation (Editorial interpretation of Shrivu's approach)</cite>
      </div>
    </section>

    <div class="divider-checkpoint"></div>

    <!-- Section 7: Troubleshooting -->
    <section id="troubleshooting">
      <h2><span class="bionic">Tro</span>ubleshooting</h2>

      <details class="troubleshoot">
        <summary>Problem: "Context budget exceeded in monorepo"</summary>
        <div>
          <p><strong>Symptoms:</strong> /context shows 40%+ usage before you even start working. Session degrades quickly. Agent forgets repo conventions.</p>
          <p><strong>Causes:</strong></p>
          <ul>
            <li>CLAUDE.md is a comprehensive manual, not a curated constitution</li>
            <li>@-file embeddings loading entire files</li>
            <li>Documentation for tools only 10% of engineers use</li>
          </ul>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Diagnose the problem
/context  # Check current usage

# If over 20% at start, audit CLAUDE.md:
wc -c CLAUDE.md  # Get character count
# Divide by 4 for rough token estimate

# Shrivu's fix: Apply 30% threshold
# 1. Survey team: Which tools do 30%+ actually use?
# 2. Move detailed docs to separate files
# 3. Link from CLAUDE.md instead of embedding
# 4. Replace manuals with guardrails (brief rules)

# Target: 13KB (~3,250 tokens) or less
          </div>
          <p><strong>Prevention:</strong> Token budget each section of CLAUDE.md. Treat it like advertising space - every token must earn its place.</p>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Problem: "Master-Clone pattern producing conflicts"</summary>
        <div>
          <p><strong>Symptoms:</strong> Clones modify the same files. Merge conflicts on every PR. Duplicated work across agents.</p>
          <p><strong>Causes:</strong></p>
          <ul>
            <li>No isolation strategy (all clones on same branch)</li>
            <li>Task decomposition overlaps file ownership</li>
            <li>Shared state between parallel agents</li>
          </ul>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Isolation strategies:

# 1. Branch isolation (recommended)
for package in packages/*/; do
  git checkout -b "refactor-$(basename $package)"
  claude -p "Work only in $package"
done

# 2. Directory isolation
# Add to prompt: "Only modify files in packages/auth/"

# 3. Git worktrees (best for true parallelism)
git worktree add ../project-agent1 -b agent1/feature
git worktree add ../project-agent2 -b agent2/feature
# Each agent gets its own working directory
          </div>
          <p><strong>Recovery:</strong> If conflicts already exist, pick one branch as source of truth, cherry-pick specific commits from others.</p>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Problem: "/clear + /catchup not picking up recent changes"</summary>
        <div>
          <p><strong>Symptoms:</strong> After restart, agent doesn't see recent file changes. Acts on stale code.</p>
          <p><strong>Causes:</strong></p>
          <ul>
            <li>Changes not committed (catchup reads git diff)</li>
            <li>Changes in untracked files</li>
            <li>Git index out of sync</li>
          </ul>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Before /clear + /catchup, ensure changes are tracked:
git status                    # See what's not committed
git add -A                    # Stage everything
git stash                     # Or stash if not ready to commit

# Now do the restart:
/clear
/catchup

# If you stashed:
git stash pop                 # Restore changes

# Alternative: Explicitly tell Claude what changed
/clear
> I modified src/auth/login.ts and src/utils/crypto.ts
> Read these files for current context
          </div>
          <p><strong>Prevention:</strong> Commit frequently during work. Each logical step should be a commit. This makes /catchup reliable.</p>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Problem: "GHA logs not providing useful insights"</summary>
        <div>
          <p><strong>Symptoms:</strong> Meta-analysis query returns generic errors. Can't find patterns to improve CLAUDE.md.</p>
          <p><strong>Causes:</strong></p>
          <ul>
            <li>Logging too coarse (not capturing agent reasoning)</li>
            <li>Not enough data (need 2-3 weeks minimum)</li>
            <li>Wrong query patterns</li>
          </ul>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Improve logging granularity:
# In your GHA workflow, capture:
- Full agent output (not just final result)
- Permission requests with context
- Bash commands that failed
- Files agent tried to access but couldn't

# Better meta-analysis queries:
query-logs --since 14d | claude -p "
  Group failures by category:
  1. Permission errors (what was blocked?)
  2. Tool misuse (what patterns caused errors?)
  3. Context gaps (what knowledge was missing?)

  For each category, suggest specific CLAUDE.md additions.
"

# Focus on actionable patterns:
# - Same error 3+ times = needs CLAUDE.md rule
# - Same permission request 5+ times = needs whitelist
# - Same tool confusion = needs clearer documentation
          </div>
          <p><strong>Prevention:</strong> Log everything, filter during analysis. It's cheaper to store logs than to miss patterns.</p>
        </div>
      </details>

      <details class="troubleshoot">
        <summary>Problem: "Team not following CLAUDE.md conventions"</summary>
        <div>
          <p><strong>Symptoms:</strong> Different team members get inconsistent results. Some bypass CLAUDE.md entirely. Quality varies wildly by person.</p>
          <p><strong>Causes:</strong></p>
          <ul>
            <li>CLAUDE.md not synced with AGENTS.md (different IDEs)</li>
            <li>No enforcement mechanism</li>
            <li>Conventions documented but not explained</li>
          </ul>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Sync CLAUDE.md with AGENTS.md
# (AGENTS.md is for non-Claude tools like Cursor)
cp CLAUDE.md AGENTS.md
# Or create a shared source:
# tools-context.md ‚Üí CLAUDE.md + AGENTS.md

# Add enforcement via hooks:
# .claude/hooks/pre-commit
#!/bin/bash
if ! diff CLAUDE.md AGENTS.md > /dev/null; then
  echo "ERROR: CLAUDE.md and AGENTS.md out of sync"
  exit 1
fi

# Document the "why" not just the "what":
# BAD: "Use structured logging"
# GOOD: "Use structured logging (src/utils/logger.ts)
#        because our log aggregator parses JSON format.
#        See incident-2024-03 for why this matters."
          </div>
          <p><strong>Prevention:</strong> Regular team syncs on CLAUDE.md changes. Every addition needs a "why" comment.</p>
        </div>
      </details>

      <h3><span class="bionic">Eme</span>rgency Recovery</h3>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
# Context exploded mid-session - quality degrading
/clear
/catchup
# If still bad: exit and start new session

# Master-Clone spawned too many agents, things are chaos
# 1. Kill any running background processes
pkill -f "claude"
# 2. Check what branches exist
git branch -a | grep agent
# 3. Pick winner, delete losers
git checkout main
git branch -D agent-bad-1 agent-bad-2

# CLAUDE.md changes broke everything
git log --oneline CLAUDE.md  # See what changed
git checkout HEAD~1 -- CLAUDE.md  # Revert to last good version
# Test before committing the revert

# GHA agents stuck in loop, creating endless PRs
# 1. Disable the workflow
gh workflow disable "agent-workflow.yml"
# 2. Close spam PRs
gh pr list --state open --label "agent" | xargs -I {} gh pr close {}
# 3. Fix the bug, re-enable
      </div>
    </section>

    <div class="milestone">Enterprise Scale Patterns Complete - You now understand billion-token-scale workflow architecture</div>

    <!-- Section 8: What's Next -->
    <section id="whats-next">
      <h2><span class="bionic">Wha</span>t's Next?</h2>

      <p>You now understand enterprise-scale Claude Code architecture. Here's where to go next:</p>

      <div class="principle-card">
        <h3>If You Want to Master Context Budgeting</h3>
        <p>Study <a href="ashley-ha.html"><strong>Ashley Ha's 60% rule</strong></a> - her phase-based workflow complements Shrivu's "shoot and forget" by providing structure for when you need hands-on control.</p>
      </div>

      <div class="principle-card">
        <h3>If You're Ready for Factory-Scale Operations</h3>
        <p>Explore <a href="steve-yegge.html"><strong>Steve Yegge's Gas Town</strong></a> - where Master-Clone is dynamic spawning, Gas Town is a formal factory with specialized roles.</p>
      </div>

      <div class="principle-card">
        <h3>If You Want Autonomous Iteration</h3>
        <p>Learn <a href="pocock-carson.html"><strong>Pocock & Carson's Ralph pattern</strong></a> - pairs well with enterprise workflows for overnight autonomous development.</p>
      </div>
    </section>

    <div class="divider-context"></div>

    <!-- Section 9: Related -->
    <section id="related">
      <h2><span class="bionic">Rel</span>ated <span class="bionic">Con</span>tent</h2>

      <h3>Related Practitioners</h3>
      <ul>
        <li><a href="boris-cherny.html">Boris Cherny</a> - Original Claude Code philosophy that Shrivu builds upon</li>
        <li><a href="pocock-carson.html">Matt Pocock & Ryan Carson</a> - Complementary Ralph pattern for iteration</li>
        <li><a href="molly-cantillon.html">Molly Cantillon</a> - Personal Panopticon multi-agent architecture</li>
        <li><a href="steve-yegge.html">Steve Yegge</a> - Gas Town factory pattern for comparison</li>
      </ul>

      <h3>Chapter Integration</h3>
      <ul>
        <li><a href="../patterns/mastery/context-management.html">Context Management</a> - Where his three-tier layering fits</li>
        <li><a href="../foundations/architecture/complexity-ladder.html">Complexity Ladder</a> - Level 5-6 enterprise scale</li>
        <li><a href="../patterns/orchestration/multi-agent-patterns.html">Multi-Agent Patterns</a> - Master-Clone vs other approaches</li>
        <li><a href="../reference/glossary.html">Glossary</a> - Terms like Master-Clone and context budgeting defined</li>
      </ul>

      <h3>Source Links</h3>
      <ul>
        <li><a href="https://twitter.com/ShrivuShankar">Shrivu Shankar on Twitter</a></li>
        <li><a href="https://github.com/sshh12">sshh12 on GitHub</a></li>
        <li><a href="https://blog.sshh.io/p/how-i-use-every-claude-code-feature">How I Use Every Claude Code Feature</a></li>
      </ul>
    </section>

    <!-- Footer Navigation -->
    <nav class="footer-nav">
      <a href="pocock-carson.html" class="nav-prev">
        <span class="nav-direction">Previous</span>
        <span class="nav-title">Matt Pocock & Ryan Carson</span>
      </a>
      <a href="ashley-ha.html" class="nav-next">
        <span class="nav-direction">Next</span>
        <span class="nav-title">Ashley Ha</span>
      </a>
    </nav>

  </div>

  <script>
function copyCode(button) {
  const codeBlock = button.parentElement;
  const codeText = codeBlock.innerText.replace('Copy', '').replace('Copied!', '').trim();
  navigator.clipboard.writeText(codeText).then(() => {
    const originalText = button.textContent;
    button.textContent = 'Copied!';
    setTimeout(() => button.textContent = originalText, 2000);
  }).catch(err => {
    console.error('Copy failed:', err);
  });
}
</script>
  <script src="../js/copy-code.js"></script>
  <script src="../js/search.js"></script>
</body>
</html>
