<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Decision Framework - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="stylesheet" href="../../css/sidebar.css">
</head>
<body>
  <div class="page-with-sidebar">
    <!-- Sidebar navigation -->
    <nav class="sidebar">
      <button class="sidebar-close" aria-label="Close menu">&times;</button>
      <div class="sidebar-header">
        <h1 class="sidebar-title"><a href="../../index.html">Claude Code KB</a></h1>
      </div>
      <ul class="sidebar-nav">
        <!-- Architecture section (open when on architecture pages) -->
        <li class="nav-section open">
          <div class="nav-section-title">Architecture</div>
          <ul class="nav-subsections">
            <li class="nav-page current"><a href="decision-framework.html">Decision Framework</a></li>
            <li class="nav-page"><a href="core-patterns.html">Core Patterns</a></li>
            <li class="nav-page"><a href="enterprise-swarm.html">Enterprise &amp; Swarm</a></li>
            <li class="nav-page"><a href="context-composition.html">Context &amp; Composition</a></li>
          </ul>
        </li>
        <!-- Implementation section -->
        <li class="nav-section">
          <div class="nav-section-title">Implementation</div>
          <ul class="nav-subsections">
            <li class="nav-page"><a href="../implementation/context-state.html">Context &amp; State</a></li>
            <li class="nav-page"><a href="../implementation/ralph-production.html">Ralph Production</a></li>
            <li class="nav-page"><a href="../implementation/hooks-enterprise.html">Hooks &amp; Enterprise</a></li>
          </ul>
        </li>
        <!-- Operations section -->
        <li class="nav-section">
          <div class="nav-section-title">Operations</div>
          <ul class="nav-subsections">
            <li class="nav-page"><a href="../operations/monitoring-cost.html">Monitoring &amp; Cost</a></li>
            <li class="nav-page"><a href="../operations/security-checklists.html">Security &amp; Checklists</a></li>
            <li class="nav-page"><a href="../operations/incident-response.html">Incident Response</a></li>
          </ul>
        </li>
        <!-- Mental Models section -->
        <li class="nav-section">
          <div class="nav-section-title">Mental Models</div>
          <ul class="nav-subsections">
            <li class="nav-page"><a href="../mental-models/core-models.html">Core Models</a></li>
            <li class="nav-page"><a href="../mental-models/advanced-models.html">Advanced Models</a></li>
            <li class="nav-page"><a href="../mental-models/practice-heuristics.html">Practice &amp; Heuristics</a></li>
          </ul>
        </li>
        <!-- Foundations section -->
        <li class="nav-section">
          <div class="nav-section-title">Foundations</div>
          <ul class="nav-subsections">
            <li class="nav-page"><a href="../foundations/invariants-reference.html">Invariants Reference</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Sidebar overlay for mobile -->
    <div class="sidebar-overlay"></div>

    <!-- Main content -->
    <main class="main-content">
      <!-- Breadcrumb -->
      <nav class="breadcrumb">
        <a href="../../index.html">Home</a>
        <span class="breadcrumb-separator">/</span>
        <a href="decision-framework.html">Architecture</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">Decision Framework</span>
      </nav>

      <!-- Page meta -->
      <div class="page-meta">
        <span class="page-meta-item">~18 min read</span>
      </div>

      <h1>Architecture Decision Framework</h1>

      <div class="context-box you-are-here">
        <h3>You Are Here</h3>
        <p><strong>What this covers:</strong> This is your complete guide to selecting and implementing Claude Code architecture patterns. You'll learn when to use simple loops, when to scale to multi-agent orchestration, and how to avoid the traps that derail complex systems.</p>
        <p><strong>Time estimate:</strong> 45-60 minutes for a thorough read; 15 minutes for quick reference</p>
        <p><strong>Prerequisites:</strong></p>
        <ul>
          <li>You've used Claude Code for at least one small project</li>
          <li>You understand basic git workflows (commits, branches)</li>
          <li>You're comfortable with terminal/command line basics</li>
          <li>You have a sense of your project's scope (single feature? full product? enterprise?)</li>
        </ul>
        <p><strong>Where this fits:</strong></p>
        <pre class="ascii-diagram">MASTER PLAYBOOK
    |
    +-- [Foundations / Principles]
    |
    +-- **YOU ARE HERE: Architecture Selection**
    |
    +-- [Implementation Details]
    |
    +-- [Operations &amp; Monitoring]
    |
    +-- [Mental Models &amp; Anti-Patterns]</pre>
      </div>

      <p>The fundamental question is not "which pattern is best?" but "which pattern is appropriate for my current scale, constraints, and compliance requirements?"</p>

      <p>This page provides the decision trees and ladders you need to select the right architecture for your project.</p>

      <h2>The Primary Decision Tree</h2>

      <p>Start here. Answer the questions and follow the branches to find your pattern.</p>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>                       +-------------------------------------+
                       | How many parallel work streams?     |
                       +-----------------+-------------------+
                                         |
          +------------------------------+------------------------------+
          |                              |                              |
          v                              v                              v
   +-----------+                  +-----------+                  +-----------+
   |  1 stream |                  |  2-30 work|                  |  30-100+  |
   |  (feature)|                  |  streams  |                  |  streams  |
   +-----+-----+                  +-----+-----+                  +-----+-----+
         |                              |                              |
         v                              |                              v
+------------------+                    |                   +------------------+
| Can you stay at  |                    |                   | Self-learning    |
| your keyboard?   |                    |                   | required?        |
+--------+---------+                    |                   +--------+---------+
         |                              |                         +--+--+
    +----+----+                         |                        Yes   No
    |         |                         |                         |     |
   Yes       No                         |                         v     v
    |         |                         |                   +---------++---------+
    v         v                         |                   |  SONA   ||  ENTER- |
+---------+  +---------+                |                   |  SWARM  ||  PRISE  |
| SINGLE  |  |  RALPH  |                |                   |(Level 8)||(Level 9)|
| SESSION |  |  LOOP   |                |                   +---------++---------+
|         |  |         |                |
| Vanilla |  | Automous|                v
| Claude  |  | iteration|      +--------------------------+
+---------+  +---------+      | Is human judgment        |
                              | required at each step?   |
                              +------------+-------------+
                                           |
                                 +---------+---------+
                                 |                   |
                                Yes                  No
                                 |                   |
                                 v                   v
                         +-----------+      +-----------------+
                         |   CLAUDE  |      | How many agents?|
                         |   SQUAD   |      +-------+---------+
                         |           |              |
                         | Human-    |        +-----+------+
                         | Mediated  |        |            |
                         +-----------+       2-10        10-30
                                              |            |
                                              v            v
                                       +-----------+ +-----------+
                                       | CC MIRROR | | GAS TOWN  |
                                       | Hub-and-  | | FACTORY   |
                                       | Spoke     | |           |
                                       +-----------+ +-----------+</pre>
      </div>

      <h3>Decision Tree Quick Reference</h3>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Your Situation</th>
              <th>Pattern</th>
              <th>Key Benefit</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Single feature, at keyboard</td>
              <td>Single Session</td>
              <td>Simplest, interactive</td>
            </tr>
            <tr class="recommended">
              <td>Single feature, walk away</td>
              <td>Ralph Loop</td>
              <td>Autonomous, fresh context</td>
            </tr>
            <tr>
              <td>2-10 parallel tasks, need human judgment</td>
              <td>Claude Squad</td>
              <td>Human routes all work</td>
            </tr>
            <tr>
              <td>2-10 parallel tasks, automated</td>
              <td>CC Mirror</td>
              <td>Hub-spoke orchestration</td>
            </tr>
            <tr>
              <td>10-30 agents, specialized roles</td>
              <td>Gas Town</td>
              <td>Factory hierarchy</td>
            </tr>
            <tr>
              <td>30-100+ agents, self-learning</td>
              <td>SONA Swarm</td>
              <td>Cross-agent learning</td>
            </tr>
            <tr>
              <td>100+ agents, compliance required</td>
              <td>Enterprise Stack</td>
              <td>SOC 2, HIPAA, multi-provider</td>
            </tr>
          </tbody>
        </table>
      </div>

      <details class="troubleshoot">
        <summary>Decision tree doesn't fit my situation</summary>
        <div class="troubleshoot-content">
          <p class="troubleshoot-cause">Common mismatches and how to resolve them:</p>
          <table>
            <tr>
              <th>Symptom</th>
              <th>Cause</th>
              <th>Recovery</th>
            </tr>
            <tr>
              <td>Picked Ralph but constantly interrupted</td>
              <td>Need judgment calls</td>
              <td>Switch to Claude Squad</td>
            </tr>
            <tr>
              <td>Picked CC Mirror but tasks conflict</td>
              <td>Tasks interdependent</td>
              <td>Switch to Ralph or redesign decomposition</td>
            </tr>
            <tr>
              <td>Picked Gas Town but overwhelming</td>
              <td>Scale doesn't justify</td>
              <td>Step back to CC Mirror</td>
            </tr>
            <tr>
              <td>Not sure which stream count applies</td>
              <td>Project scope unclear</td>
              <td>Start with Ralph, scale when you hit limits</td>
            </tr>
          </table>
        </div>
      </details>

      <h2>The Complexity Ladder</h2>

      <p>This ladder shows the full progression from manual coding to enterprise-scale orchestration. Each level has an UNLOCK condition. You must satisfy the unlock to graduate. Jumping levels leads to failure.</p>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>+-----------------------------------------------------------------------------+
|                      THE COMPLEXITY LADDER                                   |
|                                                                              |
|  Level   Scale      Pattern                Key Characteristic               |
|  ---------------------------------------------------------------------      |
|                                                                              |
|  9       100+       ENTERPRISE             Compliance (SOC 2, HIPAA),       |
|          agents     STACK                  Multi-provider gateway           |
|            |                                                                 |
|            | UNLOCK: SOC 2 requirement, $500+/day budget, 16-40hr setup    |
|            v                                                                 |
|  8       30-100     SONA SWARM             Self-learning, ReasoningBank     |
|          agents                            Cross-agent knowledge sharing    |
|            |                                                                 |
|            | UNLOCK: Need cross-agent learning, 84%+ quality requirement   |
|            v                                                                 |
|  7       20-30+     GAS TOWN               Agent factory, self-improving    |
|          agents     Factory                Multiple rigs, specialized roles |
|            |                                                                 |
|            | UNLOCK: $150+/day budget, 4+ hours setup, Stage 6 mastery     |
|            v                                                                 |
|  6       10-20      CC MIRROR +            Full multi-agent with            |
|          agents     Extensions             specialized workers               |
|            |                                                                 |
|            | UNLOCK: Need Playwright, specialized reviewers, cost tiering  |
|            v                                                                 |
|  5       5-10       CC MIRROR              Native orchestration             |
|          agents     Hub-and-Spoke          Task API, dependency management  |
|            |                                                                 |
|            | UNLOCK: Learn task decomposition, understand model tiers       |
|            v                                                                 |
|  4       3-10       CLAUDE SQUAD           Session multiplexer              |
|          instances  Human-Mediated         Human routes all work             |
|            |                                                                 |
|            | UNLOCK: Need parallelism + irreplaceable human judgment        |
|            v                                                                 |
|  3       2-5        PARALLEL RALPH         Git worktrees for isolation      |
|          loops      Worktree + Loop        Independent feature parallelism  |
|            |                                                                 |
|            | UNLOCK: Master single Ralph, have independent features         |
|            v                                                                 |
|  2       1          RALPH WIGGUM           Fresh context loop               |
|          loop       Loop Pattern           External state (prd.json, git)   |
|            |                                                                 |
|            | UNLOCK: Prove autonomous dev works for your workflow           |
|            v                                                                 |
|  1       1          SINGLE SESSION         Interactive conversation         |
|          session    Vanilla Claude         Context in memory only           |
|                                                                              |
|  0       0          MANUAL                 Writing code yourself            |
|                     No Agent               The baseline                      |
|                                                                              |
+-----------------------------------------------------------------------------+</pre>
      </div>

      <h3>Understanding the Unlock Conditions</h3>

      <p>Each level requires specific conditions to be met before you can effectively operate at that scale:</p>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Level</th>
              <th>Unlock Condition</th>
              <th>Daily Budget</th>
              <th>Setup Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Level 2 (Ralph)</td>
              <td>Prove autonomous dev works</td>
              <td>$5-50</td>
              <td>30 min</td>
            </tr>
            <tr>
              <td>Level 3 (Parallel Ralph)</td>
              <td>Master single Ralph</td>
              <td>$15-150</td>
              <td>1 hour</td>
            </tr>
            <tr>
              <td>Level 4 (Claude Squad)</td>
              <td>Need human judgment at each step</td>
              <td>$30-100</td>
              <td>30 min</td>
            </tr>
            <tr>
              <td>Level 5 (CC Mirror)</td>
              <td>Learn task decomposition</td>
              <td>$50-150</td>
              <td>2 hours</td>
            </tr>
            <tr>
              <td>Level 7 (Gas Town)</td>
              <td>Stage 6 mastery</td>
              <td>$150+</td>
              <td>4-8 hours</td>
            </tr>
            <tr>
              <td>Level 8 (SONA)</td>
              <td>Need cross-agent learning</td>
              <td>$100-500</td>
              <td>8-16 hours</td>
            </tr>
            <tr>
              <td>Level 9 (Enterprise)</td>
              <td>SOC 2/HIPAA requirement</td>
              <td>$500+</td>
              <td>16-40 hours</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h2>Codebase Size Decision Factor</h2>

      <p>Codebase size determines context strategy. This is a critical routing decision that many overlook.</p>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>+-----------------------------------------------------------------------------+
|                      CODEBASE SIZE ROUTING                                   |
|                                                                              |
|  Codebase Size     Context Strategy          Pattern Requirement            |
|  ==========================================================================  |
|                                                                              |
|  &lt;50K LOC          Standard context          Any Level 1-7                  |
|  50-100K LOC       Extended context + /clear  Ralph + periodic reset        |
|  100-300K LOC      FIC methodology           FIC + Ralph (mandatory)        |
|  300K+ LOC         FIC mandatory             FIC required for any pattern   |
|                                                                              |
|  DECISION POINT:                                                             |
|  +-------------------------------------+                                    |
|  | Is codebase &gt; 100K LOC?             |                                    |
|  +-----------------+-------------------+                                    |
|              +-----+-----+                                                   |
|             Yes          No                                                  |
|              |           |                                                   |
|              v           v                                                   |
|        +----------+ +----------+                                            |
|        |   FIC    | | Standard |                                            |
|        | Required | | Context  |                                            |
|        +----------+ +----------+                                            |
|                                                                              |
|  FIC = Frequent Intentional Compaction (see Context &amp; Composition page)    |
|                                                                              |
+-----------------------------------------------------------------------------+</pre>
      </div>

      <p>The HumanLayer team achieved "one week's work shipped in a single day" on their 300K+ LOC Rust codebase using FIC methodology.</p>

      <h2>When to Use Each Pattern</h2>

      <h3>Use Ralph Loop When</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>+ Single feature that takes 5-50 iterations
+ You can define clear acceptance criteria upfront
+ You want to walk away and let it run
+ Feature can be expressed in 2-3 sentences per story
+ Budget is $5-50 for the feature

x DON'T use when:
  - You need to be present for judgment calls
  - Multiple unrelated features need parallel work
  - Feature requires real-time user feedback
  - Codebase has no tests (verification impossible)</pre>
      </div>

      <h3>Use CC Mirror Hub-and-Spoke When</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>+ Project decomposes into 3-8 parallel tasks
+ Different tasks benefit from different models
+ Clear task boundaries exist (frontend/backend/tests)
+ You want cost optimization via model selection
+ Human oversight desired but not per-task

x DON'T use when:
  - Single sequential workflow (Ralph is simpler)
  - Tasks are deeply interdependent (merge nightmare)
  - Scale exceeds 10 parallel tasks (consider Gas Town)
  - All tasks are identical (no benefit from tiering)</pre>
      </div>

      <h3>Use Claude Squad Human-Mediated When</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>+ Human judgment is irreplaceable at each decision point
+ Scale is "power user" (1 human x 3-10 instances)
+ Real-time oversight required
+ Budget is limited (no coordination overhead)
+ Each instance needs different expertise

x DON'T use when:
  - Tasks can be decomposed algorithmically
  - Overnight autonomous execution needed
  - Scale exceeds 10 instances (human becomes bottleneck)
  - Work is homogeneous (orchestration is better)</pre>
      </div>

      <h3>Use Gas Town Factory When</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>+ Need 10-30+ agents running in parallel
+ Multiple workstreams across multiple projects (rigs)
+ Self-managing system desired
+ Have Stage 7+ experience and $150+/day budget
+ Can invest 4-8 hours in initial setup

x DON'T use when:
  - Fewer than 10 agents needed (overkill)
  - Single project focus (CC Mirror suffices)
  - Budget is constrained
  - Still learning multi-agent fundamentals</pre>
      </div>

      <h2>Scale-Based Selection Guide</h2>

      <p>Quick reference for matching project type to pattern:</p>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Project Type</th>
              <th>Recommended Pattern</th>
              <th>Why</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Weekend hack</td>
              <td>Ralph Loop</td>
              <td>Simplest, cheapest, good enough for single feature</td>
            </tr>
            <tr>
              <td>Solo feature (1 week)</td>
              <td>Ralph or Parallel Ralph</td>
              <td>Parallelism if feature has independent parts</td>
            </tr>
            <tr>
              <td>Team sprint (2 weeks)</td>
              <td>CC Mirror</td>
              <td>Orchestration worth the 2-hour setup</td>
            </tr>
            <tr>
              <td>Product launch</td>
              <td>CC Mirror + Extensions</td>
              <td>Speed justifies complexity</td>
            </tr>
            <tr>
              <td>Startup MVP</td>
              <td>Ralph to CC Mirror</td>
              <td>Start simple, scale when needed</td>
            </tr>
            <tr>
              <td>Enterprise migration</td>
              <td>Gas Town to Enterprise</td>
              <td>Scale justifies complexity</td>
            </tr>
            <tr>
              <td>SOC 2/HIPAA product</td>
              <td>Enterprise Stack</td>
              <td>Compliance non-negotiable</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h2>Infrastructure Layer Decision Matrix</h2>

      <p>Beyond pattern selection, you must choose infrastructure components that support your architecture. Three key repositories provide production-ready solutions.</p>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Component</th>
              <th>OpenCode</th>
              <th>LiteLLM</th>
              <th>claude-flow</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Primary Role</strong></td>
              <td>IDE-native coding agent</td>
              <td>API gateway &amp; proxy</td>
              <td>Multi-agent orchestration</td>
            </tr>
            <tr>
              <td><strong>When to Use</strong></td>
              <td>Need LSP grounding, git snapshots</td>
              <td>Need cost control, caching, failover</td>
              <td>Need 10+ coordinated agents</td>
            </tr>
            <tr>
              <td><strong>Scale</strong></td>
              <td>Single agent</td>
              <td>Any scale</td>
              <td>10-100+ agents</td>
            </tr>
            <tr>
              <td><strong>Key Features</strong></td>
              <td>Compilation feedback, permission gating</td>
              <td>Budget enforcement, semantic caching</td>
              <td>Queen/Worker hierarchy, SONA</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3>LiteLLM Decision Points</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>AGENTS   DAILY BUDGET   LITELLM REQUIREMENT
1-5      &lt;$50           Optional (nice-to-have for caching)
5-10     $50-150        Recommended (caching provides 30%+ savings)
10-30    $150-500       Required (budget enforcement prevents disasters)
30+      $500+          Mandatory (semantic caching + multi-provider failover)</pre>
      </div>

      <h3>Infrastructure Selection Flowchart</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>START: What's your primary constraint?
    |
    +-- [Cost Control] --&gt; LiteLLM first, then pattern
    |
    +-- [Code Quality] --&gt; OpenCode for LSP grounding
    |
    +-- [Scale (30+)]  --&gt; claude-flow for coordination
    |
    +-- [All three]    --&gt; Full stack: OpenCode + LiteLLM + claude-flow

INTEGRATION ORDER (recommended):
1. Start with vanilla Claude Code or OpenCode
2. Add LiteLLM when multi-agent or budget control needed
3. Add claude-flow when scale exceeds CC Mirror capacity</pre>
      </div>

      <details class="troubleshoot">
        <summary>Infrastructure selection problems</summary>
        <div class="troubleshoot-content">
          <table>
            <tr>
              <th>Symptom</th>
              <th>Cause</th>
              <th>Recovery</th>
            </tr>
            <tr>
              <td>$500 spent in 2 hours</td>
              <td>No budget enforcement</td>
              <td>Deploy LiteLLM immediately; set hard caps</td>
            </tr>
            <tr>
              <td>Type errors cascade across files</td>
              <td>No compilation feedback</td>
              <td>Enable OpenCode LSP grounding</td>
            </tr>
            <tr>
              <td>Agents duplicate work</td>
              <td>No coordination layer</td>
              <td>Add claude-flow AgentDB for task registry</td>
            </tr>
            <tr>
              <td>Provider goes down, everything stops</td>
              <td>Single provider dependency</td>
              <td>Configure LiteLLM multi-provider failover</td>
            </tr>
          </table>
        </div>
      </details>

      <h2>Comprehensive Pattern Comparison</h2>

      <p>This matrix compares all major architecture patterns across key factors.</p>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Factor</th>
              <th>Ralph</th>
              <th>Parallel Ralph</th>
              <th>Claude Squad</th>
              <th>CC Mirror</th>
              <th>Gas Town</th>
              <th>SONA Swarm</th>
              <th>Enterprise</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Agent Count</strong></td>
              <td>1</td>
              <td>2-5</td>
              <td>3-10</td>
              <td>5-10</td>
              <td>10-30+</td>
              <td>30-100</td>
              <td>100+</td>
            </tr>
            <tr>
              <td><strong>Human Involvement</strong></td>
              <td>Writes PRD, then away</td>
              <td>Merges at end</td>
              <td>Active conductor</td>
              <td>Monitors orchestrator</td>
              <td>Checks inbox</td>
              <td>Monitors dashboards</td>
              <td>Reviews reports</td>
            </tr>
            <tr>
              <td><strong>Setup Time</strong></td>
              <td>30 min</td>
              <td>1 hr</td>
              <td>1 hr</td>
              <td>2 hrs</td>
              <td>4-8 hrs</td>
              <td>8-16 hrs</td>
              <td>16-40 hrs</td>
            </tr>
            <tr>
              <td><strong>Daily Cost Range</strong></td>
              <td>$5-20</td>
              <td>$10-40</td>
              <td>$20-60</td>
              <td>$30-80</td>
              <td>$50-200</td>
              <td>$100-500</td>
              <td>$200-1000</td>
            </tr>
            <tr>
              <td><strong>Automation Level</strong></td>
              <td>High (loop)</td>
              <td>High (parallel)</td>
              <td>Low (human routes)</td>
              <td>Medium</td>
              <td>High (factory)</td>
              <td>Very High</td>
              <td>Enterprise-gated</td>
            </tr>
            <tr>
              <td><strong>Fault Tolerance</strong></td>
              <td>Loop retry</td>
              <td>Per-worktree</td>
              <td>Manual recovery</td>
              <td>Task requeue</td>
              <td>Multi-tier watchdog</td>
              <td>Byzantine FT</td>
              <td>Full redundancy</td>
            </tr>
            <tr>
              <td><strong>Self-Learning</strong></td>
              <td>No</td>
              <td>No</td>
              <td>No</td>
              <td>No</td>
              <td>Partial</td>
              <td>Yes (SONA)</td>
              <td>Yes + governance</td>
            </tr>
            <tr>
              <td><strong>Compliance Ready</strong></td>
              <td>No</td>
              <td>No</td>
              <td>No</td>
              <td>No</td>
              <td>Partial</td>
              <td>No</td>
              <td>Yes (SOC 2, HIPAA)</td>
            </tr>
            <tr>
              <td><strong>Best Use Case</strong></td>
              <td>Single feature</td>
              <td>2-3 independent features</td>
              <td>Interactive, judgment-heavy</td>
              <td>Clear decomposition</td>
              <td>Enterprise scale</td>
              <td>Self-improving systems</td>
              <td>Regulated industries</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h2>Cost Optimization Paths</h2>

      <p>Multiple strategies can reduce API costs significantly:</p>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Method</th>
              <th>Savings</th>
              <th>Implementation</th>
              <th>Applicable Patterns</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Semantic caching</td>
              <td>30%+ API cost</td>
              <td>LiteLLM Qdrant cache</td>
              <td>All</td>
            </tr>
            <tr>
              <td>Agent Booster WASM</td>
              <td>85% for simple ops</td>
              <td>claude-flow</td>
              <td>Gas Town, SONA, Enterprise</td>
            </tr>
            <tr>
              <td>Architect/Editor split</td>
              <td>40% (cheap editor)</td>
              <td>aider pattern</td>
              <td>CC Mirror, Gas Town</td>
            </tr>
            <tr>
              <td>Three-tier model routing</td>
              <td>60x cheaper (Haiku vs Opus)</td>
              <td>Task-based routing</td>
              <td>All multi-agent</td>
            </tr>
            <tr>
              <td>Fresh context (no rot)</td>
              <td>Variable (quality-driven)</td>
              <td>Ralph pattern</td>
              <td>All</td>
            </tr>
            <tr>
              <td>Two-phase separation</td>
              <td>~50% (cheap dev model)</td>
              <td>BMAD-METHOD</td>
              <td>All multi-phase</td>
            </tr>
            <tr>
              <td>Stateless reducer</td>
              <td>Reduced debugging time</td>
              <td>humanlayer/12-factor-agents</td>
              <td>All</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h2>Quick Reference</h2>

      <h3>Pattern Selection Cheat Sheet</h3>

      <div class="code-block">
        <button class="copy-btn">Copy</button>
        <pre>AGENTS NEEDED?     HUMAN IN LOOP?     AUTOMATED ROUTING?     COMPLIANCE?     -> USE THIS
------------------------------------------------------------------------------------------
1                  No (AFK)           N/A                    No              -> RALPH
2-5                No (AFK)           No (human merges)      No              -> PARALLEL RALPH
3-10               Yes (active)       No                     No              -> CLAUDE SQUAD
5-10               Monitors only      Yes                    No              -> CC MIRROR
10-30+             Checks inbox       Yes (factory)          No              -> GAS TOWN
30-100             Monitors dash      Yes (self-learning)    No              -> SONA SWARM
100+               Reviews reports    Yes (enterprise)       Yes             -> ENTERPRISE STACK</pre>
      </div>

      <h3>Model Selection Quick Reference</h3>

      <div class="decision-table">
        <table>
          <thead>
            <tr>
              <th>Task Type</th>
              <th>Model</th>
              <th>Cost Multiplier</th>
              <th>Parallel Capacity</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Lookups, simple queries</td>
              <td>Haiku</td>
              <td>1x</td>
              <td>5-10</td>
            </tr>
            <tr>
              <td>Standard implementation</td>
              <td>Sonnet</td>
              <td>12x</td>
              <td>2-5</td>
            </tr>
            <tr>
              <td>Architecture, complex reasoning</td>
              <td>Opus</td>
              <td>60x</td>
              <td>1-2</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Footer navigation -->
      <div class="footer-nav">
        <a href="../../index.html" class="nav-prev">
          <span class="nav-direction">Previous</span>
          <span class="nav-title">Knowledge Base Home</span>
        </a>
        <a href="core-patterns.html" class="nav-next">
          <span class="nav-direction">Next</span>
          <span class="nav-title">Core Patterns</span>
        </a>
      </div>

    </main>
  </div>

  <!-- Mobile toggle button -->
  <button class="sidebar-toggle" aria-label="Open navigation">&#9776;</button>

  <script src="../../js/sidebar.js"></script>
</body>
</html>
