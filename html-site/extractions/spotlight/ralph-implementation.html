<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta data-pagefind-meta="section" content="Extractions">
  <meta data-pagefind-meta="category" content="Orchestration">
  <title>Ralph Complete Implementation Guide - Claude Code Knowledge Base</title>
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="stylesheet" href="../../css/sidebar.css">
  <link rel="stylesheet" href="../../css/search.css">
</head>
<body>
  <!-- Search Modal -->
  <div class="search-modal" id="searchModal" aria-hidden="true">
    <div class="search-overlay" onclick="closeSearch()"></div>
    <div class="search-content">
      <div class="search-header">
        <div class="search-input-wrapper">
          <span class="search-icon-input">&#128269;</span>
          <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off" />
          <kbd class="search-kbd">ESC</kbd>
        </div>
      </div>
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="synthesis">Synthesis</button>
        <button class="filter-btn" data-filter="extractions">Extractions</button>
      </div>
      <div class="search-results" id="searchResults">
        <div class="search-empty"><p>Start typing to search... (Press Cmd+K anytime)</p></div>
      </div>
      <div class="search-footer">
        <span>Up/Down Navigate</span><span>Enter Select</span><span>ESC Close</span>
      </div>
    </div>
  </div>

  <button class="search-trigger" onclick="openSearch()" aria-label="Search" style="float: right; margin-bottom: 1rem;">
    <span class="search-icon">Cmd+K</span>
    <span class="search-text">Search</span>
  </button>

  <div class="wide-container">
    <!-- Breadcrumb Navigation -->
    <nav class="nav-breadcrumb">
      <a href="../../index.html">Home</a>
      <span>/</span>
      <a href="../extractions-index.html">Extractions</a>
      <span>/</span>
      <span>Spotlight</span>
      <span>/</span>
      <span>Ralph Implementation</span>
    </nav>

    <!-- You Are Here Context Box -->
    <div class="you-are-here" style="background: linear-gradient(135deg, #f0ebe3 0%, #fefcf3 100%); border-left: 4px solid #2a7d7d; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
      <h3 style="color: #2a7d7d; margin-top: 0; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px;">You Are Here</h3>
      <p style="margin-bottom: 0;">This is <strong>Ryan Carson's complete Ralph implementation guide</strong> - the production-ready version of the Ralph Wiggum autonomous coding loop. Use this when you want to set up overnight feature shipping with PRD-driven development. Start here if you want working code, not just concepts.</p>
    </div>

    <h1>Ralph Complete Implementation Guide</h1>
    <p class="subtitle" style="color: #5c4b3a; font-size: 1.1em; margin-top: -0.5rem;">Ryan Carson's Production-Ready Autonomous Coding Loop</p>

    <p class="conversational-lead">
      <strong>Source:</strong> <a href="https://x.com/ryancarson/status/2009002434740601098">@ryancarson</a> | <strong>GitHub:</strong> <a href="https://github.com/snarktank/ralph">snarktank/ralph</a> | <strong>Live Demo:</strong> <a href="https://snarktank.github.io/ralph/">snarktank.github.io/ralph</a>
    </p>

    <!-- Table of Contents -->
    <div class="toc">
      <div class="toc-title">Contents</div>
      <ul>
        <li><a href="#core-insight">Core Insight</a> - What Ralph does</li>
        <li><a href="#flowchart">The Ralph Flowchart</a> - Visual workflow</li>
        <li><a href="#file-structure">File Structure</a> - Required files</li>
        <li><a href="#ralph-script">ralph.sh</a> - The loop script</li>
        <li><a href="#prompt-md">prompt.md</a> - Agent instructions</li>
        <li><a href="#prd-json">prd.json</a> - Task tracking</li>
        <li><a href="#progress-txt">progress.txt</a> - Memory across iterations</li>
        <li><a href="#running">Running Ralph</a> - How to execute</li>
        <li><a href="#success-factors">Critical Success Factors</a> - What makes it work</li>
        <li><a href="#gotchas">Common Gotchas</a> - What breaks it</li>
        <li><a href="#monitoring">Monitoring</a> - Watching progress</li>
        <li><a href="#real-results">Real Results</a> - Production outcomes</li>
      </ul>
    </div>

    <hr class="section-divider divider-context">

    <!-- Core Insight Section -->
    <section id="core-insight">
      <h2>Core Insight</h2>

      <blockquote style="border-left: 3px solid #2a7d7d; padding-left: 1rem; margin: 1.5rem 0; font-style: italic; color: #5c4b3a; font-size: 1.1em;">
        "Ralph is an autonomous AI coding loop that ships features while you sleep."
      </blockquote>

      <p>Created by @GeoffreyHuntley, this implementation runs Claude Code (or Amp) repeatedly until all tasks are complete. Each iteration is a fresh context window. Memory persists via git history and text files.</p>

      <div class="callout callout-insight">
        <div class="callout-title">The Key Mental Model</div>
        <p>Think of autonomous coding as a <strong>Kanban-style production line with reset context per station</strong>. Instead of one giant, fragile agent conversation that bloats and forgets, treat each user story as an independent, atomic production run.</p>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Flowchart Section -->
    <section id="flowchart">
      <h2>The Ralph Flowchart</h2>

      <div class="ascii-diagram">
+---------------------+
|    You write PRD    |
|  (Define features)  |
+---------+-----------+
          |
          v
+---------------------+
| Convert to prd.json |
| (Small user stories)|
+---------+-----------+
          |
          v
+---------------------+
|    Run ralph.sh     |
| (Start autonomous)  |
+---------+-----------+
          |
          v
+---------------------+
|  Agent picks story  |
| (passes: false)     |
+---------+-----------+
          |
          v
+---------------------+
|   Implements it     |
| (Writes code/tests) |
+---------+-----------+
          |
          v
    +-----+-----+
    |Tests pass?|
    +-----+-----+
     Yes |   | No (log failure, commit anyway)
         v   v
+---------------------+
|  Commits changes    |
+---------+-----------+
          |
          v
+---------------------+
|  Updates prd.json   |
|  (passes: true)     |
+---------+-----------+
          |
          v
+---------------------+
| Logs to progress.txt|
| Updates AGENTS.md   |
+---------+-----------+
          |
          v
    +-----+-----+
    |More stories?|
    +-----+-----+
     Yes |   | No
         v   v
   [Loop]   +---------------------+
            |       Done!         |
            | &lt;promise&gt;COMPLETE&lt;/promise&gt; |
            +---------------------+
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- File Structure Section -->
    <section id="file-structure">
      <h2>File Structure</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>scripts/ralph/
├── ralph.sh      # The loop script
├── prompt.md     # Instructions for each iteration
├── prd.json      # Task list with user stories
└── progress.txt  # Learnings + patterns</code></pre>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- ralph.sh Section -->
    <section id="ralph-script">
      <h2>ralph.sh - The Loop</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>#!/bin/bash
set -e

MAX_ITERATIONS=${1:-10}
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

echo "Starting Ralph"

for i in $(seq 1 $MAX_ITERATIONS); do
  echo "=== Iteration $i ==="

  OUTPUT=$(cat "$SCRIPT_DIR/prompt.md" \
    | amp --dangerously-allow-all 2>&1 \
    | tee /dev/stderr) || true

  if echo "$OUTPUT" | grep -q "&lt;promise&gt;COMPLETE&lt;/promise&gt;"; then
    echo "Done!"
    exit 0
  fi

  sleep 2
done

echo "Max iterations reached"
exit 1</code></pre>
      </div>

      <h3>Make Executable</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>chmod +x scripts/ralph/ralph.sh</code></pre>
      </div>

      <h3>For Claude Code Instead of Amp</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Replace amp line with:
claude --dangerously-skip-permissions</code></pre>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- prompt.md Section -->
    <section id="prompt-md">
      <h2>prompt.md - Agent Instructions</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Ralph Agent Instructions

## Your Task

1. Read `scripts/ralph/prd.json`
2. Read `scripts/ralph/progress.txt` (check Codebase Patterns first)
3. Check you're on the correct branch
4. Pick highest priority story where `passes: false`
5. Implement that ONE story
6. Run typecheck and tests
7. Update AGENTS.md files with learnings
8. Commit: `feat: [ID] - [Title]`
9. Update prd.json: `passes: true`
10. Append learnings to progress.txt

## Progress Format

APPEND to progress.txt:

## [Date] - [Story ID]
- What was implemented
- Files changed
- **Learnings:**
  - Patterns discovered
  - Gotchas encountered
---

## Codebase Patterns

Add reusable patterns to the TOP of progress.txt:

## Codebase Patterns
- Migrations: Use IF NOT EXISTS
- React: useRef&lt;Timeout | null&gt;(null)

## Stop Condition

If ALL stories pass, reply:
&lt;promise&gt;COMPLETE&lt;/promise&gt;

Otherwise end normally.</code></pre>
      </div>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- prd.json Section -->
    <section id="prd-json">
      <h2>prd.json - Task List</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>{
  "branchName": "ralph/feature",
  "userStories": [
    {
      "id": "US-001",
      "title": "Add login form",
      "acceptanceCriteria": [
        "Email/password fields",
        "Validates email format",
        "typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    }
  ]
}</code></pre>
      </div>

      <h3>Key Fields</h3>
      <table class="comparison-table">
        <thead>
          <tr><th>Field</th><th>Purpose</th></tr>
        </thead>
        <tbody>
          <tr><td><code>branchName</code></td><td>Branch to use</td></tr>
          <tr><td><code>priority</code></td><td>Lower = first</td></tr>
          <tr><td><code>passes</code></td><td>Set true when done</td></tr>
          <tr><td><code>acceptanceCriteria</code></td><td>Must be explicit</td></tr>
        </tbody>
      </table>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- progress.txt Section -->
    <section id="progress-txt">
      <h2>progress.txt - Memory</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Ralph Progress Log
Started: 2024-01-15

## Codebase Patterns
- Migrations: IF NOT EXISTS
- Types: Export from actions.ts

## Key Files
- db/schema.ts
- app/auth/actions.ts
---</code></pre>
      </div>

      <p>Ralph appends after each story. <strong>Patterns accumulate across iterations.</strong></p>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Running Section -->
    <section id="running">
      <h2>Running Ralph</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>./scripts/ralph/ralph.sh 25</code></pre>
      </div>

      <p>Runs up to 25 iterations. Ralph will:</p>
      <ol>
        <li>Create the feature branch</li>
        <li>Complete stories one by one</li>
        <li>Commit after each</li>
        <li>Stop when all pass</li>
      </ol>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Success Factors Section -->
    <section id="success-factors">
      <h2>Critical Success Factors</h2>

      <h3>1. Small Stories</h3>
      <p>Must fit in one context window.</p>
      <div class="callout callout-warning">
        <div class="callout-title">Too big</div>
        <p>"Build entire auth system"</p>
      </div>
      <div class="callout callout-success">
        <div class="callout-title">Right size</div>
        <p>"Add login form" / "Add email validation" / "Add auth server action"</p>
      </div>

      <h3>2. Feedback Loops</h3>
      <p>Ralph needs fast feedback:</p>
      <ul>
        <li><code>npm run typecheck</code></li>
        <li><code>npm test</code></li>
      </ul>
      <p><strong>Without these, broken code compounds.</strong></p>

      <h3>3. Explicit Criteria</h3>
      <div class="callout callout-warning">
        <div class="callout-title">Vague</div>
        <p>"Users can log in"</p>
      </div>
      <div class="callout callout-success">
        <div class="callout-title">Explicit</div>
        <ul style="margin-bottom: 0;">
          <li>Email/password fields</li>
          <li>Validates email format</li>
          <li>Shows error on failure</li>
          <li>typecheck passes</li>
          <li>Verify at localhost:$PORT/login</li>
        </ul>
      </div>

      <h3>4. Learnings Compound</h3>
      <p>By story 10, Ralph knows patterns from stories 1-9.</p>
      <p>Two places for learnings:</p>
      <ul>
        <li><strong>progress.txt</strong> - session memory for Ralph iterations</li>
        <li><strong>AGENTS.md</strong> - permanent docs for humans and future agents</li>
      </ul>

      <h3>5. AGENTS.md Updates</h3>
      <div class="callout callout-success">
        <div class="callout-title">Good additions</div>
        <ul style="margin-bottom: 0;">
          <li>"When modifying X, also update Y"</li>
          <li>"This module uses pattern Z"</li>
          <li>"Tests require dev server running"</li>
        </ul>
      </div>
      <div class="callout callout-warning">
        <div class="callout-title">Don't add</div>
        <ul style="margin-bottom: 0;">
          <li>Story-specific details</li>
          <li>Temporary notes</li>
          <li>Info already in progress.txt</li>
        </ul>
      </div>
    </section>

    <hr class="section-divider divider-warning">

    <!-- Gotchas Section -->
    <section id="gotchas">
      <h2>Common Gotchas</h2>

      <h3>Idempotent Migrations</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>ADD COLUMN IF NOT EXISTS email TEXT;</code></pre>
      </div>

      <h3>Interactive Prompts</h3>
      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code>echo -e "\n\n\n" | npm run db:generate</code></pre>
      </div>

      <h3>Schema Changes</h3>
      <p>After editing schema, check:</p>
      <ul>
        <li>Server actions</li>
        <li>UI components</li>
        <li>API routes</li>
      </ul>

      <h3>Fixing Related Files</h3>
      <p>If typecheck requires other changes, make them. <strong>Not scope creep.</strong></p>
    </section>

    <hr class="section-divider divider-procedure">

    <!-- Monitoring Section -->
    <section id="monitoring">
      <h2>Monitoring</h2>

      <div class="code-block" style="background: #f0ebe3; border-radius: 6px; padding: 1rem; position: relative; font-family: 'SF Mono', Monaco, monospace; margin: 1rem 0;">
        <button class="copy-btn" onclick="copyCode(this)" style="position: absolute; top: 0.5rem; right: 0.5rem; background: #2a7d7d; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.5rem; cursor: pointer;">Copy</button>
        <pre style="margin: 0; overflow-x: auto;"><code># Story status
cat scripts/ralph/prd.json | jq '.userStories[] | {id, passes}'

# Learnings
cat scripts/ralph/progress.txt

# Commits
git log --oneline -10</code></pre>
      </div>
    </section>

    <hr class="section-divider divider-checkpoint">

    <!-- Real Results Section -->
    <section id="real-results">
      <h2>Real Results</h2>

      <p>Building an evaluation system:</p>
      <ul>
        <li><strong>13 user stories</strong></li>
        <li><strong>~15 iterations</strong></li>
        <li><strong>2-5 min each</strong></li>
        <li><strong>~1 hour total</strong></li>
      </ul>

      <blockquote style="border-left: 3px solid #2a7d7d; padding-left: 1rem; margin: 1.5rem 0; font-style: italic; color: #5c4b3a;">
        "Learnings compound. By story 10, Ralph knew our patterns."
      </blockquote>
    </section>

    <hr class="section-divider">

    <!-- When NOT to Use -->
    <section id="when-not">
      <h2>When NOT to Use</h2>
      <ul>
        <li>Exploratory work</li>
        <li>Major refactors without criteria</li>
        <li>Security-critical code</li>
        <li>Anything needing human review</li>
      </ul>
    </section>

    <hr class="section-divider">

    <!-- Key Principles -->
    <section id="principles">
      <h2>Key Principles</h2>
      <ol>
        <li><strong>Atomicity</strong> - smallest testable/verifiable stories</li>
        <li><strong>Fresh context</strong> - always start agents with clean windows</li>
        <li><strong>Git as memory</strong> - long-term state</li>
        <li><strong>progress.txt + AGENTS.md</strong> - short & long-term learning</li>
        <li><strong>Quality gate</strong> - tests/types/lint before commit</li>
        <li><strong>"Fail fast, commit anyway"</strong> - for recoverability</li>
      </ol>
    </section>

    <!-- Milestone -->
    <div class="milestone" style="background: linear-gradient(90deg, #6b9b7a 0%, #2a7d7d 100%); color: white; padding: 1rem 1.5rem; border-radius: 8px; text-align: center; margin: 2rem 0;">
      Given excellent upfront specification, we can already achieve meaningful unattended software production.
    </div>

    <!-- Related Pages -->
    <div class="related-pages" style="margin-top: 2rem; padding: 1rem; background: #f9f6f0; border-radius: 8px;">
      <h4 style="margin-top: 0;">Related Documents</h4>
      <ul>
        <li><a href="ralph-compounding.html">Ralph Compounding Runs</a> - Learning across sessions</li>
        <li><a href="research-ralph.html">Ralph Research Compendium</a> - Comprehensive pattern guide</li>
        <li><a href="../../synthesis/mastery-ralph-complete.html">Ralph Mastery Guide</a> - Full synthesis</li>
        <li><a href="../../synthesis/architecture-complexity-ladder.html">Complexity Ladder</a> - Where Ralph fits</li>
      </ul>
    </div>

    <!-- Footer Navigation -->
    <div class="footer-nav" style="display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e0d5c5;">
      <a href="../extractions-index.html">Back to Extractions</a>
      <a href="ralph-compounding.html">Next: Ralph Compounding</a>
    </div>

  </div>

  <script src="../../js/copy-code.js"></script>
  <script src="../../js/search.js"></script>
  <script>
    function copyCode(button) {
      const codeBlock = button.parentElement.querySelector('code');
      navigator.clipboard.writeText(codeBlock.textContent);
      button.textContent = 'Copied!';
      setTimeout(() => button.textContent = 'Copy', 2000);
    }
  </script>
<script src="../../js/global-nav.js"></script>
</body>
</html>
