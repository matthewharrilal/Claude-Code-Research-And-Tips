<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matt Pocock's Ralph Thread | Claude Code Documentation</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- GSAP for scroll-sync -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <!-- Tailwind Config with Design Tokens -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'bg-base': '#ffffff',
            'bg-subtle': '#fafafa',
            'bg-muted': '#f4f4f5',
            'text-primary': '#18181b',
            'text-secondary': '#3f3f46',
            'text-muted': '#71717a',
            'accent': '#0D9373',
            'accent-light': '#10b981',
            'accent-bg': '#ecfdf5',
            'border': '#e4e4e7',
            // Activity Zone content type colors (Original 6)
            'az-invariant': '#3b82f6',    // Blue
            'az-effect': '#f59e0b',       // Amber
            'az-composition': '#8b5cf6',  // Purple
            'az-frontier': '#ef4444',     // Red
            'az-warstory': '#10b981',     // Green
            'az-alternative': '#6b7280',  // Gray
            // Activity Zone generative content types (New 10)
            'az-inversion': '#4f46e5',    // Indigo
            'az-constraint': '#8b5cf6',   // Violet
            'az-gradient': '#f43f5e',     // Rose
            'az-horizon': '#06b6d4',      // Cyan
            'az-violation': '#f97316',    // Orange
            'az-tradeoff': '#f59e0b',     // Amber
            'az-analogy': '#d946ef',      // Fuchsia
            'az-expertise': '#10b981',    // Emerald
            'az-minimal': '#84cc16',      // Lime
            'az-inflection': '#eab308',   // Yellow
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Fira Code', 'monospace'],
          },
        },
      },
    }
  </script>

  <style>
    /* Base Styles */
    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
    }

    [id] {
      scroll-margin-top: 80px;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: #ffffff;
      color: #18181b;
      line-height: 1.7;
    }

    /* Three Panel Layout */
    .three-panel-layout {
      min-height: 100vh;
      position: relative;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: #ffffff;
      border-bottom: 1px solid #e4e4e7;
      z-index: 100;
      display: flex;
      align-items: center;
      padding: 0 24px;
    }

    /* Left Navigation - 240px fixed */
    .left-nav {
      position: fixed;
      top: 56px;
      left: 0;
      width: 240px;
      height: calc(100vh - 56px);
      border-right: 1px solid #e4e4e7;
      background: #ffffff;
      overflow-y: auto;
      padding: 16px 0;
      z-index: 40;
    }

    .nav-section {
      padding: 0 12px;
      margin-bottom: 8px;
    }

    .nav-section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      font-size: 14px;
      font-weight: 500;
      color: #3f3f46;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
    }

    .nav-section-header:hover {
      background: #f4f4f5;
    }

    .nav-section-header.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-item {
      display: block;
      padding: 6px 12px 6px 44px;
      font-size: 14px;
      color: #71717a;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.15s;
    }

    .nav-item:hover {
      color: #3f3f46;
      background: #f4f4f5;
    }

    .nav-item.active {
      color: #0D9373;
      background: #ecfdf5;
    }

    .nav-children {
      display: none;
      overflow: hidden;
    }

    .nav-children.expanded {
      display: block;
    }

    .nav-chevron {
      transition: transform 0.2s;
    }

    .nav-section.expanded .nav-chevron {
      transform: rotate(90deg);
    }

    /* Main Content - Flexible, margins for fixed sidebars */
    .main-content {
      margin-left: 240px;
      margin-right: 480px;
      margin-top: 56px;
      padding: 48px 48px;
      min-width: 400px;
    }

    /* Activity Zone - 480px fixed (proportional to main, less than main) */
    .activity-zone {
      position: fixed;
      top: 56px;
      right: 0;
      width: 480px;
      height: calc(100vh - 56px);
      border-left: 1px dashed #e4e4e7;
      background: #fafafa;
      overflow-y: auto;
      padding: 24px 20px;
      z-index: 40;
    }

    /* Responsive: Hide Activity Zone below 1400px */
    @media (max-width: 1400px) {
      .activity-zone {
        display: none;
      }
      .main-content {
        margin-right: 0;
        padding: 40px 32px;
      }
    }

    /* Responsive: Hide Left Nav below 768px */
    @media (max-width: 768px) {
      .left-nav {
        display: none;
      }
      .left-nav.open {
        display: block;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        z-index: 50;
        overflow-y: auto;
      }
      .main-content {
        margin-left: 0;
        padding: 24px 16px;
        min-width: auto;
      }
    }

    /* Resizer - Draggable divider between Main Panel and Activity Zone */
    .resizer {
      position: fixed;
      top: 56px;
      right: 480px;
      width: 6px;
      height: calc(100vh - 56px);
      cursor: col-resize;
      background: transparent;
      z-index: 50;
      transition: background 0.15s ease;
    }

    .resizer:hover {
      background: rgba(13, 147, 115, 0.15);
    }

    .resizer.active {
      background: rgba(13, 147, 115, 0.25);
    }

    /* Prevent text selection during resize */
    body.resizing {
      user-select: none;
      cursor: col-resize !important;
    }

    body.resizing * {
      cursor: col-resize !important;
    }

    /* Hide resizer when Activity Zone is hidden (responsive) */
    @media (max-width: 1400px) {
      .resizer {
        display: none;
      }
    }

    /* Activity Zone Items */
    .activity-item {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      background: #ffffff;
      border: 1px solid #e4e4e7;
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.5;
      transition: all 0.3s ease;
    }

    .activity-item.active {
      opacity: 1;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .activity-item:hover {
      opacity: 1;
    }

    .activity-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Activity Zone content type borders (Original 6) */
    .activity-item.invariant { border-left: 4px solid #3b82f6; }
    .activity-item.effect { border-left: 4px solid #f59e0b; }
    .activity-item.composition { border-left: 4px solid #8b5cf6; }
    .activity-item.frontier { border-left: 4px solid #ef4444; }
    .activity-item.warstory { border-left: 4px solid #10b981; }
    .activity-item.alternative { border-left: 4px solid #6b7280; }

    /* Activity Zone generative content types (New 10) */
    .activity-item.inversion { border-left: 4px solid #4f46e5; }
    .activity-item.constraint { border-left: 4px solid #8b5cf6; }
    .activity-item.gradient { border-left: 4px solid #f43f5e; }
    .activity-item.horizon { border-left: 4px solid #06b6d4; }
    .activity-item.violation { border-left: 4px solid #f97316; }
    .activity-item.tradeoff { border-left: 4px solid #f59e0b; }
    .activity-item.analogy { border-left: 4px solid #d946ef; }
    .activity-item.expertise { border-left: 4px solid #10b981; }
    .activity-item.minimal { border-left: 4px solid #84cc16; }
    .activity-item.inflection { border-left: 4px solid #eab308; }

    /* Main Content Components */

    /* Section titles with number */
    .section-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background: #0D9373;
      color: #ffffff;
      font-size: 14px;
      font-weight: 600;
      border-radius: 50%;
      margin-right: 12px;
    }

    .section-title {
      font-size: 24px;
      font-weight: 600;
      color: #18181b;
      margin-bottom: 20px;
      margin-top: 56px;
      display: flex;
      align-items: center;
    }

    .section-title:first-child {
      margin-top: 0;
    }

    /* Essence Box (15 words) */
    .essence-box {
      background: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 40px;
    }

    .essence-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #10b981;
      margin-bottom: 12px;
    }

    .essence-text {
      font-size: 22px;
      font-weight: 500;
      color: #ffffff;
      line-height: 1.4;
    }

    /* Source Attribution Box */
    .source-box {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 32px;
      display: flex;
      gap: 16px;
      align-items: flex-start;
    }

    .source-box-icon {
      flex-shrink: 0;
      width: 40px;
      height: 40px;
      background: #10b981;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .source-stats {
      display: flex;
      gap: 16px;
      margin-top: 8px;
      font-size: 13px;
      color: #166534;
    }

    /* Core Abstraction Box */
    .core-abstraction {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .core-philosophy {
      font-size: 16px;
      color: #3f3f46;
      margin-bottom: 16px;
      font-style: italic;
    }

    .core-code {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 16px;
      overflow-x: auto;
    }

    .core-code code {
      font-family: 'Fira Code', monospace;
      font-size: 15px;
      color: #10b981;
      white-space: nowrap;
    }

    .core-anchor {
      font-size: 14px;
      color: #71717a;
      text-align: center;
    }

    /* Design Decision Box */
    .decision-box {
      background: #ffffff;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .decision-why {
      font-size: 16px;
      font-weight: 600;
      color: #0D9373;
      margin-bottom: 12px;
    }

    .decision-reasoning {
      font-size: 14px;
      color: #3f3f46;
      margin-bottom: 16px;
    }

    .decision-implication {
      background: #f4f4f5;
      border-radius: 8px;
      padding: 16px;
    }

    .decision-implication-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: #71717a;
      margin-bottom: 8px;
    }

    /* Code Blocks */
    .code-block {
      background: #18181b;
      border-radius: 8px;
      padding: 16px 20px;
      margin-bottom: 24px;
      position: relative;
      overflow-x: auto;
    }

    .code-block pre {
      margin: 0;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: #e4e4e7;
      line-height: 1.6;
    }

    .code-block .comment { color: #6b7280; }
    .code-block .keyword { color: #c084fc; }
    .code-block .string { color: #10b981; }
    .code-block .variable { color: #60a5fa; }

    .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #3f3f46;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s;
    }

    .copy-btn:hover {
      background: #52525b;
    }

    /* Path Steps */
    .path-container {
      background: #fafafa;
      border: 1px solid #e4e4e7;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .path-step {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
    }

    .path-step:last-child {
      margin-bottom: 0;
    }

    .path-number {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      background: #0D9373;
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .path-content {
      flex: 1;
      font-size: 14px;
      color: #3f3f46;
    }

    .path-content code {
      background: #e4e4e7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
    }

    /* Gotcha Box */
    .gotcha-box {
      background: #fffbeb;
      border: 1px solid #fcd34d;
      border-left: 4px solid #f59e0b;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .gotcha-title {
      font-weight: 600;
      color: #92400e;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .gotcha-detail {
      font-size: 14px;
      color: #78350f;
      margin-bottom: 8px;
    }

    .gotcha-detail strong {
      color: #92400e;
    }

    /* What's Hard Box */
    .hard-box {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-left: 4px solid #ef4444;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .hard-title {
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hard-detail {
      font-size: 14px;
      color: #7f1d1d;
      margin-bottom: 8px;
    }

    /* When To Use Grid */
    .when-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 40px;
    }

    @media (max-width: 900px) {
      .when-grid {
        grid-template-columns: 1fr;
      }
    }

    .when-use {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 24px;
    }

    .when-not {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 24px;
    }

    .when-title {
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .when-use .when-title { color: #166534; }
    .when-not .when-title { color: #991b1b; }

    .when-item {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 14px;
    }

    .when-use .when-item { color: #166534; }
    .when-not .when-item { color: #991b1b; }

    /* Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      padding: 8px;
      background: none;
      border: none;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .mobile-menu-btn {
        display: flex;
      }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #fafafa;
    }

    ::-webkit-scrollbar-thumb {
      background: #d4d4d8;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1aa;
    }

    /* Keyboard shortcut hint */
    .kbd {
      display: inline-flex;
      align-items: center;
      padding: 2px 6px;
      background: #f4f4f5;
      border: 1px solid #e4e4e7;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: #71717a;
    }

    /* Stop Condition Box */
    .stop-condition-box {
      background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
      border: 2px solid #10b981;
      border-radius: 12px;
      padding: 24px;
      margin: 24px 0;
      text-align: center;
    }

    .stop-condition-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #059669;
      margin-bottom: 12px;
    }

    .stop-condition-code {
      font-family: 'Fira Code', monospace;
      font-size: 18px;
      color: #065f46;
      background: #d1fae5;
      padding: 8px 16px;
      border-radius: 6px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
      <i data-lucide="menu" class="w-5 h-5 text-text-secondary"></i>
    </button>
    <div class="flex items-center gap-3">
      <i data-lucide="terminal" class="w-5 h-5 text-accent"></i>
      <span class="font-semibold text-text-primary">Claude Code</span>
    </div>
    <div class="flex-1 flex justify-center">
      <button class="flex items-center gap-2 px-4 py-2 bg-bg-muted rounded-lg text-text-muted text-sm hover:bg-border transition-colors">
        <i data-lucide="search" class="w-4 h-4"></i>
        <span>Search documentation...</span>
        <span class="kbd">Cmd+K</span>
      </button>
    </div>
    <div class="flex items-center gap-4">
      <a href="#" class="text-sm text-text-muted hover:text-text-primary transition-colors">Support</a>
      <button class="p-2 hover:bg-bg-muted rounded-lg transition-colors" aria-label="Toggle theme">
        <i data-lucide="sun" class="w-4 h-4 text-text-muted"></i>
      </button>
    </div>
  </header>

  <div class="three-panel-layout">
    <!-- Left Navigation -->
    <nav class="left-nav" id="leftNav">
      <div class="nav-content"></div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Ship while you sleep: fresh context iteration loops until all PRD stories pass.</div>
        </div>

        <!-- Source Attribution -->
        <div class="source-box">
          <div class="source-box-icon">
            <i data-lucide="twitter" class="w-5 h-5 text-white"></i>
          </div>
          <div>
            <div class="font-semibold text-text-primary">@mattpocockuk (Matt Pocock)</div>
            <div class="text-sm text-text-secondary">TypeScript expert, Total TypeScript, AI Hero</div>
            <div class="source-stats">
              <span>2,440 likes</span>
              <span>193K views</span>
              <span>4,853 bookmarks</span>
            </div>
          </div>
        </div>

        <blockquote class="border-l-4 border-accent pl-4 italic text-text-secondary mb-6">
          "There's an AI coding approach that lets you run seriously long-running AI agents (hours, days) that ship code while you sleep. I've tried it, and I'm not going back."
        </blockquote>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Abstraction
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"Run a coding agent with a clean slate, again and again, until a stop condition is met."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'for i in {1..10}; do claude \"Complete next task\" ; done')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>for i in {1..10}; do claude "Complete next task" ; done</code>
          </div>

          <div class="core-anchor">That's the pattern. Everything else is scaffolding for reliability.</div>
        </div>

        <p class="text-text-secondary mb-6">
          Each iteration spawns a NEW Claude instance with zero memory of previous runs. The agent reads its context fresh from files (prd.json, progress.txt), picks ONE task, implements it, commits, and exits. The bash loop restarts with a fresh context.
        </p>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="stop-conditions">Three Stop Condition Patterns</h3>

        <div class="grid gap-4 mb-8">
          <div class="p-4 bg-bg-subtle border border-border rounded-lg">
            <div class="font-semibold text-text-primary mb-2">1. Raw Prompting</div>
            <div class="text-sm text-text-secondary mb-2">Pass a clear stop condition in the prompt:</div>
            <code class="text-sm bg-bg-muted px-2 py-1 rounded">"If no further work, reply with &lt;promise&gt;COMPLETE&lt;/promise&gt;"</code>
          </div>

          <div class="p-4 bg-bg-subtle border border-border rounded-lg">
            <div class="font-semibold text-text-primary mb-2">2. TODO List</div>
            <div class="text-sm text-text-secondary">Give agent a list, mark items complete, stop when all done.</div>
          </div>

          <div class="p-4 bg-accent-bg border border-accent rounded-lg">
            <div class="font-semibold text-accent mb-2">3. PRD Approach (Preferred)</div>
            <div class="text-sm text-text-secondary">JSON file of user stories with <code class="bg-bg-muted px-1 rounded">passes: false</code>. Agent picks highest priority, updates to <code class="bg-bg-muted px-1 rounded">passes: true</code> on completion.</div>
          </div>
        </div>

        <div class="stop-condition-box">
          <div class="stop-condition-label">Universal Stop Signal</div>
          <div class="stop-condition-code">&lt;promise&gt;COMPLETE&lt;/promise&gt;</div>
        </div>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-prd" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Design Decisions
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY PRD OVER RAW PROMPTING?</div>
          <div class="decision-reasoning">
            <strong>Two problems it solves:</strong><br>
            1. Agent picks tasks too large, runs out of context window, fails.<br>
            2. Agent doesn't know when to stop.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">The Solution</div>
            <div class="text-text-secondary text-sm">
              PRD as JSON scopes work effectively. Agent picks ONE story at a time. Uses small part of context window. Avoids "context rot."
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-append">
          <div class="decision-why">WHY "APPEND" VERB EXPLICITLY?</div>
          <div class="decision-reasoning">
            Tell the agent to "append progress to progress.txt" - use the verb "append" specifically to prevent overwriting previous entries. Models interpret "update" as "replace" by default.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Use "APPEND" in CAPS in your prompt. The capitalization matters for model attention.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-ci-green">
          <div class="decision-why">WHY CI GREEN MANDATORY?</div>
          <div class="decision-reasoning">
            Each commit MUST pass all tests and types. Prompt the agent to run typechecks and tests on each commit.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">Matt Pocock's Warning</div>
            <div class="text-text-secondary text-sm italic">
              "If you don't do this, you're hamstringing future agent runs with bad code, and they'll need to bisect to find bugs. Super nasty."
            </div>
          </div>
        </div>

        <div class="decision-box">
          <div class="decision-why">WHY COMMIT EACH STORY?</div>
          <div class="decision-reasoning">
            Git commits allow future agents to navigate via git history. The commit log becomes external memory that persists across iterations.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Commit format: <code class="bg-bg-muted px-1 rounded">feat: [ID] - [Title]</code>. Git history IS your agent's long-term memory.
            </div>
          </div>
        </div>

        <div class="decision-box">
          <div class="decision-why">WHY FINITE ITERATIONS?</div>
          <div class="decision-reasoning">
            Set up a bash for loop that runs a set number of times (e.g., 10). Finite iterations prevent infinite runs and cost explosion.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Always set MAX_ITERATIONS. Early exit on COMPLETE, hard stop on max.
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: FILE STRUCTURE -->
      <section id="file-structure" data-activity="files">
        <h2 class="section-title">
          <span class="section-number">4</span>
          The File Structure
        </h2>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>project/
<span class="comment">├── scripts/ralph/           # The Ralph system</span>
│   ├── ralph.sh             <span class="comment"># The loop engine</span>
│   ├── prompt.md            <span class="comment"># Instructions per iteration</span>
│   ├── prd.json             <span class="comment"># Task board (passes: false/true)</span>
│   └── progress.txt         <span class="comment"># Learnings log (append-only)</span>
└── CLAUDE.md                <span class="comment"># Project context (optional)</span></pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="prd-json">prd.json - The Task Board</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>{
  <span class="string">"branchName"</span>: <span class="string">"ralph/feature"</span>,
  <span class="string">"userStories"</span>: [
    {
      <span class="string">"id"</span>: <span class="string">"AUTH-001"</span>,
      <span class="string">"title"</span>: <span class="string">"Add login form"</span>,
      <span class="string">"description"</span>: <span class="string">"Create login with email/password"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Email input exists"</span>,
        <span class="string">"Password input exists"</span>,
        <span class="string">"npm run typecheck passes"</span>,
        <span class="string">"npm run test passes"</span>
      ],
      <span class="string">"priority"</span>: 1,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    }
  ]
}</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="progress-txt">progress.txt - The Learnings Log</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Ralph Progress Log</span>
Started: 2026-01-10

<span class="comment">## Codebase Patterns</span>
- [Discovered patterns go here]

---
<span class="comment">## 2026-01-10 10:00 - AUTH-001</span>
- Completed: Login form component
- Files: src/components/LoginForm.tsx
- <span class="keyword">Learnings:</span>
  - Use Tailwind mx-auto for centering
---</pre>
        </div>
      </section>

      <!-- Section 5: PATH OF A TASK -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Path of a Task
        </h2>

        <p class="text-text-secondary mb-6">
          Follow a single story through the Ralph system:
        </p>

        <div class="path-container">
          <div class="font-semibold text-accent mb-4">ITERATION 1</div>
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content">Fresh context starts - reads <code>prompt.md</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content">Reads <code>prd.json</code>: finds AUTH-001 (<code>passes: false</code>)</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content">Reads <code>progress.txt</code>: no patterns yet</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content">Works on AUTH-001 - creates LoginForm.tsx, adds route handler</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content">Verification: <code>npm run typecheck</code> PASS, <code>npm run test</code> PASS</div>
          </div>
          <div class="path-step">
            <div class="path-number">6</div>
            <div class="path-content">Commit: <code>feat: AUTH-001 - Add login form</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">7</div>
            <div class="path-content">Updates <code>prd.json</code>: AUTH-001 <code>passes: true</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">8</div>
            <div class="path-content">APPENDS learnings to <code>progress.txt</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">9</div>
            <div class="path-content">Not all stories pass - exits normally (no COMPLETE signal)</div>
          </div>

          <div class="font-semibold text-accent mb-4 mt-8">ITERATION 2</div>
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content">Fresh context (NO memory of iteration 1)</div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content">Reads <code>prd.json</code>: AUTH-001 passes, AUTH-002 <code>passes: false</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content">Reads <code>progress.txt</code>: sees patterns from AUTH-001</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content">Picks AUTH-002 and continues...</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="what-youll-see">What You'll See in Terminal</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>=== Loop iteration 1 ===

[Claude starting...]                   <span class="comment">← Fresh context begins</span>

Reading prd.json...
Found 5 tasks:
  auth_login: passes = false          <span class="comment">← Will pick this one</span>
  auth_logout: passes = false
  user_profile: passes = false

Working on: auth_login

Creating src/auth/login.ts...
Running typecheck... <span class="string">✓</span>
Running tests... <span class="string">✓</span>

Committing: feat: Add login functionality

=== Loop iteration 2 ===

[Claude starting...]                   <span class="comment">← Completely fresh context</span>

Reading prd.json...
  auth_login: passes = true           <span class="comment">← Previous work visible via file</span>
  auth_logout: passes = false         <span class="comment">← Will pick this one</span>

[...]

=== Loop iteration 4 ===

Reading prd.json...
  All tasks: passes = true!

No more tasks to complete.
<span class="string">&lt;promise&gt;COMPLETE&lt;/promise&gt;</span>         <span class="comment">← Stop signal</span>

Loop terminated - all tasks done!</pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          10 real problems you'll hit, with concrete fixes:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #1: Overwriting progress.txt
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Previous learnings lost each iteration</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Model interprets "update" as "replace"</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use "APPEND" in CAPS in prompt. Time: 0 (prevention)</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #2: CI Not Enforced
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Future iterations inherit bugs</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Tests not in acceptance criteria</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Add "npm run typecheck passes" + "npm run test passes" to every story. Time: 5 min</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #3: Tasks Too Large
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Context overflow, agent loses track</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Story too big for one context window</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Split stories smaller. Rule: 2-3 sentence descriptions. Time: Planning</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #4: Vague Stop Condition
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Agent doesn't know when done</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Subjective "done" instead of machine-readable</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use passes: false/true explicitly. Time: Planning</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #5: No Max Iterations
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Infinite run, cost explosion</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Always set MAX_ITERATIONS in bash script. Time: Config</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #6: Official Plugin Broken
          </div>
          <div class="gotcha-detail"><strong>Status:</strong> @mattpocockuk: "Sadly it's broken" (Jan 2026)</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Use manual bash script instead. Check GitHub for updates.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #7: Agent Picks Multiple Stories
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Scope creep, half-finished work</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Prompt must say "pick ONE story with highest priority". Time: Prompt</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #8: Not Committing Per Story
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Can't track progress between iterations</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Require commit in prompt with format <code>feat: [ID] - [Title]</code>. Time: Prompt</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #9: jq Not Installed
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Loop condition fails</div>
          <div class="gotcha-detail"><strong>Fix:</strong> <code>brew install jq</code> (macOS) or <code>apt install jq</code> (Linux). Time: 2 min</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            #10: Poorly Defined PRD
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Early or late stop</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Write explicit acceptance criteria. Each criterion testable. Time: Planning</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          These are fundamental tensions, not bugs to fix:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Context Has No Memory
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Agent forgets everything each iteration. Fresh context is the feature, not a bug.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Same mistakes repeated if progress.txt not read.</div>
          <div class="hard-detail"><strong>Coping strategy:</strong> progress.txt as external memory. Agent MUST read it first.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Task Scoping Is Art
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Too big = context overflow. Too small = overhead dominates.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Large tasks fail mid-implementation. Small tasks spend more time reading than doing.</div>
          <div class="hard-detail"><strong>Coping strategy:</strong> 2-3 sentence rule. If you can't describe it briefly, split it.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Stop Condition Clarity
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Subjective "done" doesn't work. Agent can't verify aesthetics.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Tasks marked complete that aren't actually complete.</div>
          <div class="hard-detail"><strong>Coping strategy:</strong> Explicit passes: true/false. Machine-readable, not human-interpreted.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Review Burden
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Many iterations = many commits to check.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Morning reveals 20+ commits to review.</div>
          <div class="hard-detail"><strong>Coping strategy:</strong> Trust CI, spot check. If tests pass, code likely correct.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Feedback Loop Dependency
          </div>
          <div class="hard-detail"><strong>The tension:</strong> No CI = broken code compounds across iterations.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> By iteration 10, codebase is corrupted.</div>
          <div class="hard-detail"><strong>Coping strategy:</strong> Non-negotiable CI enforcement. Building healthy feedback loops is CRITICAL.</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO USE -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Use / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              USE RALPH WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Feature has 3+ clear user stories (worth the setup)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Can define explicit, testable acceptance criteria</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Development stage 3-4 (learning autonomous loops)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Budget $5-25 per feature (multiple iterations)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Want to "ship while you kip"</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              DON'T USE RALPH WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Exploratory work with no clear stop condition</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>One-shot fix (setup overhead not justified)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Need parallel work (Ralph is sequential)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Security-critical code (needs human judgment)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Subjective quality goals ("make it pretty")</span>
            </div>
          </div>
        </div>

        <div class="p-4 bg-bg-subtle border border-border rounded-lg mt-8">
          <div class="font-semibold text-text-primary mb-2">Timing Expectations</div>
          <div class="grid grid-cols-2 gap-4 text-sm text-text-secondary">
            <div><strong>Simple tasks:</strong> 2-5 iterations (3-10 min)</div>
            <div><strong>Medium features:</strong> 5-15 iterations (15-30 min)</div>
            <div><strong>Complex features:</strong> 15-30 iterations (30-60 min)</div>
            <div><strong>Overnight runs:</strong> 50+ iterations possible</div>
          </div>
        </div>
      </section>

    </main>

    <!-- Resizer between Main Panel and Activity Zone -->
    <div class="resizer" data-resizer="activity-zone" aria-label="Resize activity panel"></div>

    <!-- Activity Zone - 29 Items -->
    <aside class="activity-zone" id="activityZone">
      <div class="text-xs font-semibold text-text-muted uppercase tracking-wider mb-4">Operational Intelligence</div>

      <!-- ESSENCE SECTION (4 items) -->
      <div class="activity-item invariant" data-section="essence">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">Shared DNA with Original Ralph</div>
        <div class="text-text-secondary text-sm">
          Matt Pocock popularized Geoffrey Huntley's original pattern. Same core: fresh context + external state. Matt's contribution: PRD approach for stop conditions.
        </div>
      </div>

      <div class="activity-item invariant" data-section="essence">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">Shared with Ryan Carson Implementation</div>
        <div class="text-text-secondary text-sm">
          PRD approach standardized across implementations. Ryan Carson took this further with production-grade Untangle setup.
        </div>
      </div>

      <div class="activity-item warstory" data-section="essence">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">The 2440-Like Viral Thread</div>
        <div class="text-text-secondary text-sm">
          Matt's text thread went viral: 2,440 likes, 193K views, 4,853 bookmarks. Proved the pattern had mainstream appeal. Key quote: "I've tried it, and I'm not going back."
        </div>
      </div>

      <div class="activity-item minimal" data-section="essence">
        <div class="activity-label" style="color: #84cc16;">
          <i data-lucide="minimize-2" class="w-4 h-4"></i>
          Minimal Pattern
        </div>
        <div class="font-medium text-text-primary mb-2">The Irreducible Core</div>
        <div class="text-text-secondary text-sm">
          <code style="background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;">for i in {1..10}; do claude "Complete next TODO" ; done</code><br><br>
          <strong>Essential:</strong> Loop + fresh context<br>
          <strong>Everything else:</strong> Refinement for reliability
        </div>
      </div>

      <!-- CORE SECTION (4 items) -->
      <div class="activity-item inversion" data-section="core">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if extended sessions instead of fresh?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> One long session, no restarts, no external files.<br>
          <strong>Why this fails:</strong> Context rot degrades quality over time. 80K+ tokens = amnesia.<br>
          <strong>Hidden constraint:</strong> Fresh context IS the design, not a workaround.
        </div>
      </div>

      <div class="activity-item inversion" data-section="core">
        <div class="activity-label" style="color: #4f46e5;">
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          Inversion Lens
        </div>
        <div class="font-medium text-text-primary mb-2">What if internal memory instead of files?</div>
        <div class="text-text-secondary text-sm">
          <strong>You'd design:</strong> Agent remembers across iterations internally.<br>
          <strong>Why this fails:</strong> Sessions end, all learnings lost. No persistence mechanism.<br>
          <strong>Hidden constraint:</strong> External state architecture is necessary.
        </div>
      </div>

      <div class="activity-item effect" data-section="core">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="zap" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">Pattern Accumulation</div>
        <div class="text-text-secondary text-sm">
          Patterns in progress.txt compound across iterations. By iteration 10, Claude knows your codebase patterns without being told.
        </div>
      </div>

      <div class="activity-item effect" data-section="core">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="zap" class="w-4 h-4"></i>
          Second-Order Effect
        </div>
        <div class="font-medium text-text-primary mb-2">CI Discipline Spillover</div>
        <div class="text-text-secondary text-sm">
          Enforcing CI green improves overall codebase quality. Ralph's constraint makes you write better acceptance criteria.
        </div>
      </div>

      <!-- DECISIONS SECTION (5 items) -->
      <div class="activity-item constraint" data-section="decisions">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Context windows are finite</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> 200K context limit<br>
          → Fresh context each iteration<br>
          → Requires external state files<br>
          → prd.json + progress.txt + git<br>
          → Git becomes long-term memory
        </div>
      </div>

      <div class="activity-item constraint" data-section="decisions">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="link-2" class="w-4 h-4"></i>
          Constraint Chain
        </div>
        <div class="font-medium text-text-primary mb-2">Agents can't verify "done" subjectively</div>
        <div class="text-text-secondary text-sm">
          <strong>ROOT:</strong> Machine-readable stop condition required<br>
          → passes: false/true tracking<br>
          → &lt;promise&gt;COMPLETE&lt;/promise&gt; signal<br>
          → Objective completion verification
        </div>
      </div>

      <div class="activity-item violation" data-section="decisions">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip "append" verb</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> Say "update" instead of "append"<br>
          <strong>THEN:</strong> progress.txt gets overwritten<br>
          <strong>THEN:</strong> Previous learnings lost<br>
          <strong>FINALLY:</strong> Patterns don't accumulate, each iteration starts from zero
        </div>
      </div>

      <div class="activity-item violation" data-section="decisions">
        <div class="activity-label" style="color: #f97316;">
          <i data-lucide="alert-octagon" class="w-4 h-4"></i>
          Violation Chain
        </div>
        <div class="font-medium text-text-primary mb-2">If you skip CI enforcement</div>
        <div class="text-text-secondary text-sm">
          <strong>IF:</strong> Don't run tests each commit<br>
          <strong>THEN:</strong> Broken code gets committed<br>
          <strong>THEN:</strong> Future iterations inherit bugs<br>
          <strong>FINALLY:</strong> "They'll need to bisect to find bugs. Super nasty."
        </div>
      </div>

      <div class="activity-item tradeoff" data-section="decisions">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Speed vs Review Burden</div>
        <div class="text-text-secondary text-sm">
          <strong>Pull A:</strong> More iterations = more shipped<br>
          <strong>Pull B:</strong> More iterations = more to review<br><br>
          <strong>Resolution:</strong> Trust CI, spot check commits
        </div>
      </div>

      <!-- FILES SECTION (4 items) -->
      <div class="activity-item composition" data-section="files">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Ralph + jq Loop (Maurice Kleine)</div>
        <div class="text-text-secondary text-sm">
          <code style="background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 11px;">while jq '.tasks[] | select(.passes == false)' | grep -q .</code><br><br>
          <strong>Elegant:</strong> Uses passes property directly. No need to parse Claude output for "COMPLETE".
        </div>
      </div>

      <div class="activity-item composition" data-section="files">
        <div class="activity-label" style="color: #8b5cf6;">
          <i data-lucide="layers" class="w-4 h-4"></i>
          Composition Case
        </div>
        <div class="font-medium text-text-primary mb-2">Ralph + Cursor CLI (@agrimsingh)</div>
        <div class="text-text-secondary text-sm">
          Ported PRD approach to Cursor CLI. Key insight: "Let it make mistakes, tune like a guitar." Cross-tool validation of the pattern.
        </div>
      </div>

      <div class="activity-item frontier" data-section="files">
        <div class="activity-label" style="color: #ef4444;">
          <i data-lucide="flask-conical" class="w-4 h-4"></i>
          Research Frontier
        </div>
        <div class="font-medium text-text-primary mb-2">Official Plugin Stability</div>
        <div class="text-text-secondary text-sm">
          @amorriscode found: <code>github.com/anthropics/claude-code/plugins/ralph-wiggum</code><br>
          @mattpocockuk: "Sadly broken" (Jan 2026). Check releases for updates.
        </div>
      </div>

      <div class="activity-item frontier" data-section="files">
        <div class="activity-label" style="color: #ef4444;">
          <i data-lucide="flask-conical" class="w-4 h-4"></i>
          Research Frontier
        </div>
        <div class="font-medium text-text-primary mb-2">Multi-Agent Ralph</div>
        <div class="text-text-secondary text-sm">
          Parallel worktrees exploration. Can multiple Ralph loops run simultaneously on different branches? Still experimental.
        </div>
      </div>

      <!-- PATH SECTION (3 items) -->
      <div class="activity-item horizon" data-section="path">
        <div class="activity-label" style="color: #06b6d4;">
          <i data-lucide="clock" class="w-4 h-4"></i>
          Time Horizon Shift
        </div>
        <div class="font-medium text-text-primary mb-2">At what scale is Ralph right?</div>
        <div class="text-text-secondary text-sm">
          <strong>Single task (minutes):</strong> No - setup overhead not justified<br>
          <strong>Feature (3-10 stories):</strong> YES - sweet spot<br>
          <strong>Large feature (10-25):</strong> YES - overnight shipping value<br>
          <strong>Project (50+):</strong> Maybe - consider parallel worktrees
        </div>
      </div>

      <div class="activity-item analogy" data-section="path">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">Ralph = Test-Driven Development</div>
        <div class="text-text-secondary text-sm">
          <strong>TDD:</strong> Write test first, implement, verify<br>
          <strong>Ralph:</strong> Write acceptance criteria first, implement, verify passes: true<br><br>
          <em>If you understand TDD, you understand Ralph's stop condition design.</em>
        </div>
      </div>

      <div class="activity-item gradient" data-section="path">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How Scope Creep Degrades</div>
        <div class="text-text-secondary text-sm">
          <strong>10% Degraded:</strong> Occasional large task, monitor<br>
          <strong>50% Degraded:</strong> Frequent overflow, audit PRD<br>
          <strong>90% Degraded:</strong> Every task too big, rebuild PRD<br>
          <strong>Total Failure:</strong> Pattern unusable, manual debugging
        </div>
      </div>

      <!-- GOTCHAS SECTION (4 items) -->
      <div class="activity-item inflection" data-section="gotchas">
        <div class="activity-label" style="color: #eab308;">
          <i data-lucide="activity" class="w-4 h-4"></i>
          Inflection Point
        </div>
        <div class="font-medium text-text-primary mb-2">When setup overhead flips to benefit</div>
        <div class="text-text-secondary text-sm">
          <strong>Below threshold:</strong> Setup cost > iteration value<br>
          <strong>Above threshold:</strong> Iteration value dominates<br><br>
          <strong>THE FLIP:</strong> ~3-5 stories with clear acceptance criteria
        </div>
      </div>

      <div class="activity-item gradient" data-section="gotchas">
        <div class="activity-label" style="color: #f43f5e;">
          <i data-lucide="trending-down" class="w-4 h-4"></i>
          Failure Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">How CI Skipping Degrades</div>
        <div class="text-text-secondary text-sm">
          <strong>10%:</strong> Some broken code, monitor<br>
          <strong>50%:</strong> Frequent bugs, debugging overhead<br>
          <strong>90%:</strong> Compounding failures, codebase unstable<br>
          <strong>100%:</strong> Codebase corrupted, start over
        </div>
      </div>

      <div class="activity-item warstory" data-section="gotchas">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Plugin Status Discovery</div>
        <div class="text-text-secondary text-sm">
          @amorriscode found the official plugin.<br>
          @mattpocockuk replied: "Sadly broken"<br><br>
          Lesson: Always verify tool status before depending on it.
        </div>
      </div>

      <div class="activity-item warstory" data-section="gotchas">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="user" class="w-4 h-4"></i>
          War Story
        </div>
        <div class="font-medium text-text-primary mb-2">Cursor Port Validation</div>
        <div class="text-text-secondary text-sm">
          @agrimsingh ported PRD approach to Cursor CLI. Proves the pattern is tool-agnostic. Core insight: the PRD approach works across different AI coding tools.
        </div>
      </div>

      <!-- HARD SECTION (3 items) -->
      <div class="activity-item tradeoff" data-section="hard">
        <div class="activity-label" style="color: #f59e0b;">
          <i data-lucide="scale" class="w-4 h-4"></i>
          Trade-Off Tension
        </div>
        <div class="font-medium text-text-primary mb-2">Scope vs Completeness</div>
        <div class="text-text-secondary text-sm">
          <strong>Pull A:</strong> Smaller tasks = fit context<br>
          <strong>Pull B:</strong> Smaller tasks = more overhead<br><br>
          <strong>Resolution:</strong> 2-3 sentence rule. If description > code change, you've decomposed too far.
        </div>
      </div>

      <div class="activity-item expertise" data-section="hard">
        <div class="activity-label" style="color: #10b981;">
          <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
          Expertise Gradient
        </div>
        <div class="font-medium text-text-primary mb-2">Task Decomposition Skill</div>
        <div class="text-text-secondary text-sm">
          <strong>Novice:</strong> Follow basic loop, simple stories<br>
          <strong>Intermediate:</strong> Custom PRD schemas, CI tuning<br>
          <strong>Advanced:</strong> Parallel worktrees, custom integrations<br>
          <strong>Expert:</strong> Build tools on Ralph foundation
        </div>
      </div>

      <div class="activity-item invariant" data-section="hard">
        <div class="activity-label" style="color: #3b82f6;">
          <i data-lucide="link" class="w-4 h-4"></i>
          Invariant Connection
        </div>
        <div class="font-medium text-text-primary mb-2">External State Principle</div>
        <div class="text-text-secondary text-sm">
          progress.txt + prd.json + git = external memory.<br><br>
          Core principle: "External state > internal memory" applies to ALL agent patterns, not just Ralph.
        </div>
      </div>

      <!-- WHEN SECTION (3 items) -->
      <div class="activity-item alternative" data-section="when">
        <div class="activity-label" style="color: #6b7280;">
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
          Alternative Path
        </div>
        <div class="font-medium text-text-primary mb-2">If Ralph isn't right</div>
        <div class="text-text-secondary text-sm">
          <strong>Need parallelism?</strong> → CC Mirror<br>
          <strong>Need human gates?</strong> → HOTL Ralph<br>
          <strong>One-shot fix?</strong> → Single Claude session<br>
          <strong>Security-critical?</strong> → Manual review
        </div>
      </div>

      <div class="activity-item alternative" data-section="when">
        <div class="activity-label" style="color: #6b7280;">
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
          Alternative Path
        </div>
        <div class="font-medium text-text-primary mb-2">Original Ralph vs This Thread</div>
        <div class="text-text-secondary text-sm">
          <strong>Want pure form?</strong> → See 025-ralph-original.md<br>
          <strong>Want production setup?</strong> → See Ryan Carson implementation<br>
          <strong>Want methodology?</strong> → This thread
        </div>
      </div>

      <div class="activity-item analogy" data-section="when">
        <div class="activity-label" style="color: #d946ef;">
          <i data-lucide="git-compare" class="w-4 h-4"></i>
          Analogical Bridge
        </div>
        <div class="font-medium text-text-primary mb-2">View AI Agents As...</div>
        <div class="text-text-secondary text-sm">
          <strong>Short-lived:</strong> Each iteration independent<br>
          <strong>Forgetful:</strong> No memory of previous work<br>
          <strong>Persistent:</strong> Like Ralph Wiggum, keeps trying<br><br>
          <em>"Ship while you kip" - Matt Pocock</em>
        </div>
      </div>

    </aside>
  </div>

  <script>
    /**
     * PanelResizer - Handles draggable panel dividers
     */
    class PanelResizer {
      constructor(resizerEl, config = {}) {
        this.resizer = resizerEl;
        this.config = {
          storageKey: 'panel-activity-zone-width',
          minWidth: 280,
          maxWidth: 900,
          defaultWidth: 480,
          ...config
        };

        this.isResizing = false;
        this.startX = 0;
        this.startWidth = 0;

        this.activityZone = document.querySelector('.activity-zone');
        this.mainContent = document.querySelector('.main-content');

        this.onMouseDown = this.onMouseDown.bind(this);
        this.onMouseMove = this.onMouseMove.bind(this);
        this.onMouseUp = this.onMouseUp.bind(this);

        this.init();
      }

      init() {
        this.restoreWidth();
        this.resizer.addEventListener('mousedown', this.onMouseDown);
      }

      onMouseDown(e) {
        if (e.button !== 0) return;

        this.isResizing = true;
        this.startX = e.clientX;
        this.startWidth = this.activityZone.offsetWidth;

        this.resizer.classList.add('active');
        document.body.classList.add('resizing');

        document.addEventListener('mousemove', this.onMouseMove);
        document.addEventListener('mouseup', this.onMouseUp);

        e.preventDefault();
      }

      onMouseMove(e) {
        if (!this.isResizing) return;

        const delta = this.startX - e.clientX;
        const newWidth = this.startWidth + delta;

        const constrainedWidth = Math.max(
          this.config.minWidth,
          Math.min(this.config.maxWidth, newWidth)
        );

        this.activityZone.style.width = constrainedWidth + 'px';
        this.mainContent.style.marginRight = constrainedWidth + 'px';
        this.resizer.style.right = constrainedWidth + 'px';
      }

      onMouseUp(e) {
        if (!this.isResizing) return;

        this.isResizing = false;

        this.resizer.classList.remove('active');
        document.body.classList.remove('resizing');

        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);

        this.saveWidth();
      }

      saveWidth() {
        const width = this.activityZone.offsetWidth;
        localStorage.setItem(this.config.storageKey, JSON.stringify({
          width,
          timestamp: Date.now()
        }));
      }

      restoreWidth() {
        try {
          const stored = localStorage.getItem(this.config.storageKey);
          if (stored) {
            const { width } = JSON.parse(stored);
            if (width >= this.config.minWidth && width <= this.config.maxWidth) {
              this.activityZone.style.width = width + 'px';
              this.mainContent.style.marginRight = width + 'px';
              this.resizer.style.right = width + 'px';
            }
          }
        } catch (e) {
          console.warn('Failed to restore panel width:', e);
        }
      }

      destroy() {
        this.resizer.removeEventListener('mousedown', this.onMouseDown);
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);
      }
    }

    // Auto-initialize resizers on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      const resizers = document.querySelectorAll('[data-resizer]');
      resizers.forEach(resizer => new PanelResizer(resizer));
    });

    // Initialize Lucide icons
    lucide.createIcons();

    // Navigation toggle
    function toggleSection(header) {
      const section = header.closest('.nav-section');
      section.classList.toggle('expanded');
      const children = section.querySelector('.nav-children');
      children.classList.toggle('expanded');
    }

    // Mobile menu toggle
    function toggleMobileMenu() {
      const nav = document.getElementById('leftNav');
      nav.classList.toggle('open');
    }

    // Copy functionality
    function copyCode(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> Copied!';
        lucide.createIcons();
        setTimeout(() => {
          btn.innerHTML = originalText;
          lucide.createIcons();
        }, 2000);
      });
    }

    function copyCodeBlock(btn) {
      const codeBlock = btn.closest('.code-block');
      const pre = codeBlock.querySelector('pre');
      const text = pre.textContent;
      copyCode(btn, text);
    }

    // Scroll-sync with GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    const sections = document.querySelectorAll('[data-activity]');
    const activityItems = document.querySelectorAll('.activity-item');

    sections.forEach(section => {
      ScrollTrigger.create({
        trigger: section,
        start: 'top 40%',
        end: 'bottom 40%',
        onEnter: () => activateSection(section.dataset.activity),
        onEnterBack: () => activateSection(section.dataset.activity),
      });
    });

    function activateSection(sectionName) {
      activityItems.forEach(item => {
        if (item.dataset.section === sectionName) {
          item.classList.add('active');
          gsap.to(item, {
            opacity: 1,
            y: -2,
            boxShadow: '0 4px 12px rgba(0,0,0,0.08)',
            duration: 0.3,
            ease: 'power2.out'
          });
        } else {
          item.classList.remove('active');
          gsap.to(item, {
            opacity: 0.5,
            y: 0,
            boxShadow: 'none',
            duration: 0.3,
            ease: 'power2.out'
          });
        }
      });

      // Update nav active state
      document.querySelectorAll('.nav-section-header').forEach(header => {
        header.classList.remove('active');
      });
      const activeNav = document.querySelector(`[data-section="${sectionName}"] .nav-section-header`);
      if (activeNav) {
        activeNav.classList.add('active');
      }
    }

    // Initialize first section as active
    activateSection('essence');

    // Smooth scroll for nav links
    document.querySelectorAll('.nav-item').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const target = document.querySelector(link.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.nav-item').forEach(l => l.classList.remove('active'));
          link.classList.add('active');
        }
      });
    });

    // Brushing interaction - hover activity item highlights related content
    activityItems.forEach(item => {
      item.addEventListener('mouseenter', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = 'rgba(13, 147, 115, 0.05)';
          relatedSection.style.transition = 'background-color 0.3s ease';
        }
      });

      item.addEventListener('mouseleave', () => {
        const sectionName = item.dataset.section;
        const relatedSection = document.querySelector(`[data-activity="${sectionName}"]`);
        if (relatedSection) {
          relatedSection.style.backgroundColor = '';
        }
      });
    });
  </script>
<script src="../../js/global-nav.js"></script>
</body>
</html>
