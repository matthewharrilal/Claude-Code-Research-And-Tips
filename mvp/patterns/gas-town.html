<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gas Town Pattern - Claude Code Patterns</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
<main>
  <header class="pattern-header">
    <h1>Gas Town</h1>
    <div class="pattern-meta">
      <span class="meta-item">Type: Agent Factory</span>
      <span class="meta-item">Problem: Factory-scale orchestration</span>
      <span class="meta-item">Complexity: Level 6-7</span>
      <span class="meta-item">Creator: Steve Yegge</span>
    </div>
  </header>

  <section class="why-matters">
    <h2 style="border:none; padding:0; margin:0 0 1rem;">Why This Matters</h2>
    <p>Gas Town transforms the paradigm: you become the Product Manager, agents become your engineering team, code becomes an output rather than an activity.</p>
    <blockquote>"Claude Code is the world's biggest fuckin' ant. Everyone is focused on making their ant run longer... when nature prefers colonies."</blockquote>
    <p><strong>Prerequisite:</strong> Stage 7+ on Yegge's evolution (10+ agents, hand-managed). If you're not there, "you'll get your face ripped off by superintelligent chimpanzees."</p>
  </section>

  <section id="architecture">
    <h2>Architecture</h2>
    <pre class="ascii-diagram">HUMAN LEVEL
  [OVERSEER (YOU)] - Product Manager, Decision Maker

TOWN LEVEL (Global - One each)
  [MAYOR]     [DEACON]    [DOGS]
  Concierge   Heartbeat   Maintenance
      |           |
      v           v
RIG LEVEL (Per-Project)
  [REFINERY]  [WITNESS]   [POLECAT x3-30]
  Merge Queue  Monitor     Workers
                              |
                              v
                          [CREW]
                     Personal Agents</pre>
    <p>Gas Town separates concerns across 8 roles spanning human, town, rig, and personal levels. The Mayor is your primary interface; Polecats are your implementation army.</p>
  </section>

  <section id="how-it-works">
    <h2>How It Works</h2>
    <ol class="how-steps">
      <li><strong>Overseer</strong> defines features via inbox to Mayor</li>
      <li><strong>Mayor</strong> analyzes, decomposes, creates "convoys" (issue bundles)</li>
      <li><strong>Mayor</strong> spawns Polecats to implement in parallel</li>
      <li><strong>Polecats</strong> write code, run tests, submit PRs</li>
      <li><strong>Refinery</strong> merges PRs sequentially, resolves conflicts</li>
      <li><strong>Witness</strong> monitors Polecats, unsticks blocked workers</li>
      <li><strong>Deacon</strong> broadcasts "Do Your Job" signals every 2 minutes</li>
    </ol>
    <h3>Component Roles</h3>
    <table>
      <tr><th>Component</th><th>Role</th><th>Model</th></tr>
      <tr><td>Mayor</td><td>Concierge, task decomposition, convoy creation</td><td>Opus</td></tr>
      <tr><td>Deacon</td><td>Town heartbeat, patrol loop, DYFJ broadcasts</td><td>Sonnet</td></tr>
      <tr><td>Dogs</td><td>Maintenance, branch cleanup, Deacon support</td><td>Sonnet</td></tr>
      <tr><td>Refinery</td><td>Intelligent merge queue, conflict resolution</td><td>Opus</td></tr>
      <tr><td>Witness</td><td>Polecat monitoring, unsticking blocked agents</td><td>Haiku</td></tr>
      <tr><td>Polecat</td><td>Ephemeral workers, PR generation</td><td>Sonnet</td></tr>
      <tr><td>Crew</td><td>Personal agents for sustained design work</td><td>Sonnet</td></tr>
    </table>
  </section>

  <section id="key-decisions">
    <h2>Key Decisions</h2>
    <table>
      <tr><th>Decision</th><th>Guidance</th></tr>
      <tr><td>Start with Mayor only?</td><td>Yes - Mayor alone is viable for learning. Add roles as pain points emerge.</td></tr>
      <tr><td>How many Polecats?</td><td>Start with 3. Scale based on budget ($5-10/hr each) and merge queue capacity.</td></tr>
      <tr><td>Enable Deacon?</td><td>Wait for v0.4.0. v0.3.x has bugs that can "spree-kill" other workers.</td></tr>
      <tr><td>When add Refinery?</td><td>When 3+ Polecats generate concurrent PRs with merge conflicts.</td></tr>
      <tr><td>Crew vs Polecats?</td><td>Crew for design/collaboration. Polecats for parallelizable implementation.</td></tr>
    </table>
  </section>

  <section id="entry-points">
    <h2>Entry Points</h2>
    <ol class="entry-files">
      <li><code>gt init</code> - Initialize your town configuration</li>
      <li><code>~/.gastown/town.yaml</code> - Town configuration file</li>
      <li><code>gt mayor up</code> - Start with Mayor only (recommended)</li>
      <li><code>gt rig add &lt;repo-path&gt;</code> - Add your first project</li>
      <li><a href="https://github.com/steveyegge/gastown">github.com/steveyegge/gastown</a> - Official repository</li>
    </ol>
  </section>

  <section id="copy-paste">
    <h2>Copy-Paste Templates</h2>
    <h3>Installation</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code>go install github.com/steveyegge/gastown/cmd/gt@latest</code></pre>
    </div>
    <h3>Initialize Town</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code>gt init
gt rig add /path/to/your/repo</code></pre>
    </div>
    <h3>Launch Minimal Setup</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code>gt mayor up
gt polecat up myrig alice
gt polecat up myrig bob
gt polecat up myrig carol</code></pre>
    </div>
    <h3>Daily Workflow</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code># Morning
gt status
gt inbox

# Work
gt inbox send myrig "Build user authentication"
gt inbox respond 12 --approve

# Evening
gt crew purge myrig</code></pre>
    </div>
  </section>

  <section id="whats-unusual">
    <h2>What's Unusual</h2>
    <ul class="unusual-list">
      <li><strong>100% vibe-coded</strong> - Steve has never looked at the code. ~225K lines of Go.</li>
      <li><strong>"Expensive as hell"</strong> - Multiple Claude accounts required. Budget $100-300/day for production.</li>
      <li><strong>Deacon can kill workers</strong> - v0.3.x bug. Run without Deacon until v0.4.0.</li>
      <li><strong>Human names for Polecats</strong> - alice, bob, carol. Mental model clarity over machine IDs.</li>
      <li><strong>GUPP principle</strong> - "If work on hook, MUST RUN IT." Agents resume work automatically on restart.</li>
    </ul>
  </section>

  <section id="see-also">
    <h2>See Also</h2>
    <div class="see-also">
      <a href="https://github.com/steveyegge/beads">Beads - Git-backed agent memory (~225K lines Go)</a>
      <a href="https://github.com/Dicklesworthstone/mcp_agent_mail">MCP Agent Mail - Inter-agent communication</a>
      <a href="https://github.com/TRIBE-INC/gtgui">GTGUI - Age of Empires style GUI</a>
      <a href="https://steve-yegge.medium.com/welcome-to-gas-town-4f25ee16dd04">Welcome to Gas Town (blog post)</a>
    </div>
  </section>
</main>

<script>
function copyCode(btn) {
  const code = btn.nextElementSibling.querySelector('code').textContent;
  navigator.clipboard.writeText(code).then(() => {
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}
</script>
</body>
</html>
