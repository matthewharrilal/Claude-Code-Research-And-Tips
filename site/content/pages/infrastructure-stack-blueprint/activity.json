{
  "items": [
    {
      "id": "inv-1",
      "type": "inversion",
      "linkedSection": "essence",
      "title": "What if you didn't need infrastructure?",
      "content": "<strong>You'd design:</strong> Everything runs on your laptop, no cloud costs, no deployment complexity.<br>\n          <strong>Why this fails:</strong> Your laptop sleeps, crashes, lacks resources for 30+ agents, can't be accessed by your team.<br>\n          <strong>Hidden constraint revealed:</strong> Infrastructure IS the answer to \"how do I run this when I'm not here?\""
    },
    {
      "id": "min-2",
      "type": "minimal",
      "linkedSection": "essence",
      "title": "The simplest production deployment",
      "content": "<code style=\"background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;\">./roughneck new my-factory &amp;&amp; ./roughneck ssh my-factory</code><br>\n          <strong>Essential:</strong> One VM with Gas Town installed.<br>\n          <strong>Everything else:</strong> NATS, multi-region, Discord are refinements."
    },
    {
      "id": "war-3",
      "type": "warstory",
      "linkedSection": "essence",
      "title": "Cost optimization: $4/mo vs $150/mo",
      "content": "Teams using Hetzner cx21 for dev and AWS t3.xlarge for prod report 6x cost reduction without performance impact. The key: match instance size to workload priority."
    },
    {
      "id": "ana-4",
      "type": "analogy",
      "linkedSection": "core",
      "title": "The Factory Construction Metaphor",
      "content": "<strong>Land</strong> = Cloud provider account<br>\n          <strong>Building contractor</strong> = Roughneck CLI<br>\n          <strong>Blueprints</strong> = Terraform modules<br>\n          <strong>Interior setup</strong> = Ansible playbooks<br>\n          <strong>Factory floor</strong> = Gas Town<br>\n          <strong>Workers</strong> = Polecats (AI agents)<br>\n          <strong>Communication system</strong> = NATS/Station"
    },
    {
      "id": "con-5",
      "type": "constraint",
      "linkedSection": "core",
      "title": "Why 5 layers, not 3 or 10?",
      "content": "<strong>ROOT:</strong> Single responsibility principle<br>\n          Layer 1: Where compute lives (cloud)<br>\n          Layer 2: How compute is provisioned (IaC)<br>\n          Layer 3: How services communicate (messaging)<br>\n          Layer 4: How agents coordinate (orchestration)<br>\n          Layer 5: How humans interact (UI)<br>\n          <em>Each layer can be swapped independently.</em>"
    },
    {
      "id": "inv-6",
      "type": "invariant",
      "linkedSection": "core",
      "title": "Same pattern as Kubernetes",
      "content": "<strong>Cluster</strong> = Gas Town HQ<br>\n          <strong>Node</strong> = Rig (project)<br>\n          <strong>kubelet</strong> = Witness<br>\n          <strong>Pod</strong> = Polecat (agent)<br>\n          <strong>kube-scheduler</strong> = Mayor<br>\n          <strong>etcd</strong> = Beads / JetStream<br>\n          <em>If you know Kubernetes, you already understand this stack.</em>"
    },
    {
      "id": "exp-7",
      "type": "expertise",
      "linkedSection": "core",
      "title": "Scaling tier selection",
      "content": "<strong>Beginner:</strong> \"Which instance size?\" - Start with Tier 1 (cx21)<br>\n          <strong>Intermediate:</strong> \"When to upgrade?\" - When agents queue for resources<br>\n          <strong>Advanced:</strong> \"Multi-region?\" - When latency or compliance requires it<br>\n          <strong>Staff:</strong> \"Federated Gas Towns?\" - Domain-specialized factories"
    },
    {
      "id": "trade-8",
      "type": "tradeoff",
      "linkedSection": "decisions",
      "title": "The provider selection dilemma",
      "content": "<strong>Hetzner:</strong> Cheap but EU-only, limited integrations<br>\n          <strong>DigitalOcean:</strong> Simple but mid-tier pricing<br>\n          <strong>AWS:</strong> Everything but expensive and complex<br><br>\n          <em>Heuristic: Hetzner for personal/dev, AWS for enterprise/compliance.</em>"
    },
    {
      "id": "vio-9",
      "type": "violation",
      "linkedSection": "decisions",
      "title": "If you skip deployment isolation",
      "content": "<strong>IF:</strong> Share Terraform state between environments<br>\n          <strong>THEN:</strong> Destroy staging accidentally destroys production<br>\n          <strong>THEN:</strong> Infrastructure inconsistencies accumulate<br>\n          <strong>FINALLY:</strong> \"Works in dev, broken in prod\" constantly<br><br>\n          <em>The fix: Each deployment gets its own directory with independent state.</em>"
    },
    {
      "id": "hor-10",
      "type": "horizon",
      "linkedSection": "decisions",
      "title": "Infrastructure investment payoff",
      "content": "<strong>Week 1:</strong> \"This is overkill, I could just SSH manually\"<br>\n          <strong>Month 1:</strong> \"Nice to have repeatable deploys\"<br>\n          <strong>Month 3:</strong> \"Thank god I can spin up new environments in 5 minutes\"<br>\n          <strong>Month 6:</strong> \"Can't imagine doing this without IaC\""
    },
    {
      "id": "comp-11",
      "type": "composition",
      "linkedSection": "decisions",
      "title": "Roughneck + Station + Kimaki",
      "content": "<strong>Works:</strong> Full stack - provision, coordinate, interface all covered.<br>\n          <strong>Synergy:</strong> Roughneck provisions NATS, Station connects to it, Kimaki exposes to Discord.<br>\n          <strong>Watch for:</strong> Complexity. Don't add all three unless you need them."
    },
    {
      "id": "grad-12",
      "type": "gradient",
      "linkedSection": "roughneck",
      "title": "How Roughneck deployments fail",
      "content": "<strong>Phase 1:</strong> Terraform init fails (network, version issues)<br>\n          <strong>Phase 2:</strong> Apply fails (credentials, quotas, regions)<br>\n          <strong>Phase 3:</strong> Ansible fails (SSH, firewall, timing)<br>\n          <strong>Phase 4:</strong> Services fail to start (config, dependencies)<br><br>\n          <em>Each phase has distinct failure modes. Debug in order.</em>"
    },
    {
      "id": "war-13",
      "type": "warstory",
      "linkedSection": "roughneck",
      "title": "The 2-minute wait gotcha",
      "content": "\"Terraform succeeds but Ansible fails immediately\" - The VM exists but isn't ready. Cloud providers take 60-180 seconds to fully boot a VM. Roughneck should wait, but if it doesn't, manually wait 2-3 minutes and re-run provision."
    },
    {
      "id": "inv-14",
      "type": "inversion",
      "linkedSection": "roughneck",
      "title": "What if Terraform didn't exist?",
      "content": "You'd manually click through cloud UIs, note down IPs, SSH in, run 50+ commands...<br>\n          <strong>Why IaC wins:</strong> Repeatable, auditable, version-controlled infrastructure.<br>\n          <strong>The constraint:</strong> You pay in complexity upfront to save time forever."
    },
    {
      "id": "alt-15",
      "type": "alternative",
      "linkedSection": "roughneck",
      "title": "If Roughneck isn't right for you",
      "content": "<strong>Need Kubernetes?</strong> - Use Terraform + Helm directly<br>\n          <strong>Prefer Pulumi?</strong> - Rewrite modules in TypeScript<br>\n          <strong>Docker-only?</strong> - Use docker-compose with Railway/Render<br>\n          <strong>Serverless?</strong> - AWS Lambda + API Gateway (no VMs)"
    },
    {
      "id": "ana-16",
      "type": "analogy",
      "linkedSection": "nats",
      "title": "NATS = Nervous System",
      "content": "<strong>Synapses</strong> = Pub/sub subjects<br>\n          <strong>Reflexes</strong> = Request/reply patterns<br>\n          <strong>Memory</strong> = JetStream persistence<br>\n          <strong>Neurons</strong> = Stations<br>\n          <strong>Brain</strong> = Orchestrator<br>\n          <em>The mesh network is literally how your agents sense and respond to each other.</em>"
    },
    {
      "id": "inf-17",
      "type": "inflection",
      "linkedSection": "nats",
      "title": "When to add NATS",
      "content": "<strong>Single VM:</strong> Don't need NATS - direct process communication is fine<br>\n          <strong>2-3 VMs:</strong> NATS starts helping coordination<br>\n          <strong>5+ VMs:</strong> NATS is essential for discovery and coordination<br>\n          <strong>10+ VMs:</strong> Can't function without it<br><br>\n          <strong>THE INFLECTION:</strong> ~3 machines"
    },
    {
      "id": "fron-18",
      "type": "frontier",
      "linkedSection": "nats",
      "title": "UNSOLVED: Optimal JetStream retention",
      "content": "How long should events be retained? 7 days? 30 days? Forever? Depends on audit requirements, storage costs, replay needs. No universal answer yet."
    },
    {
      "id": "con-19",
      "type": "constraint",
      "linkedSection": "nats",
      "title": "Why JetStream matters",
      "content": "<strong>ROOT:</strong> Messages can be lost (network, crashes)<br>\n          - Need acknowledgment (at-least-once)<br>\n          - Need deduplication (exactly-once)<br>\n          - Need replay (audit, debugging)<br>\n          - Need persistence (survive restarts)<br>\n          <strong>JetStream provides all of these.</strong>"
    },
    {
      "id": "eff-20",
      "type": "effect",
      "linkedSection": "nats",
      "title": "NATS enables event sourcing",
      "content": "With JetStream, all state changes become events in a stream. You can:<br>\n          - Replay history to reconstruct state<br>\n          - Query temporal ranges for debugging<br>\n          - Never lose data (append-only)<br>\n          <em>This transforms debugging from \"what happened?\" to \"let me replay it.\"</em>"
    },
    {
      "id": "vio-21",
      "type": "violation",
      "linkedSection": "gotchas",
      "title": "If you ignore firewall rules",
      "content": "<strong>IF:</strong> Skip firewall configuration<br>\n          <strong>THEN:</strong> Ports 4222, 8585 exposed to internet<br>\n          <strong>THEN:</strong> Anyone can connect to your NATS<br>\n          <strong>FINALLY:</strong> Agents receive malicious commands<br><br>\n          <em>The fix: Always configure firewall rules + NATS authentication.</em>"
    },
    {
      "id": "exp-22",
      "type": "expertise",
      "linkedSection": "gotchas",
      "title": "Debugging infrastructure issues",
      "content": "<strong>Beginner:</strong> \"Something's broken\" - Check if services are running<br>\n          <strong>Intermediate:</strong> \"SSH works but...\" - Check firewall, ports, DNS<br>\n          <strong>Advanced:</strong> \"Intermittent failures\" - Check resource limits, networking<br>\n          <strong>Staff:</strong> \"Works locally, fails in prod\" - Check environment differences"
    },
    {
      "id": "inv-23",
      "type": "inversion",
      "linkedSection": "gotchas",
      "title": "Why wait 2-3 minutes?",
      "content": "<strong>What if VMs booted instantly?</strong><br>\n          Terraform + Ansible could run in one seamless flow.<br>\n          <strong>Why they don't:</strong> Cloud providers need time for networking, disk mounting, SSH daemon startup.<br>\n          <strong>The workaround IS the interface:</strong> Build in wait times or retry logic."
    },
    {
      "id": "war-24",
      "type": "warstory",
      "linkedSection": "gotchas",
      "title": "The PATH gotcha",
      "content": "\"Ansible installed everything but commands don't work\" - The PATH is updated in .bashrc but your SSH session doesn't reload it. Always run <code>source ~/.bashrc</code> or reconnect after provisioning."
    },
    {
      "id": "trade-25",
      "type": "tradeoff",
      "linkedSection": "hard",
      "title": "Simplicity vs. Resilience",
      "content": "<strong>Simple (single VM):</strong> Easy to manage, single point of failure<br>\n          <strong>Resilient (multi-VM):</strong> High availability, complex to coordinate<br><br>\n          <strong>WHY NO PERFECT ANSWER:</strong><br>\n          Most teams don't need HA until they do. Over-engineering early wastes resources. Under-engineering when you scale causes outages.<br>\n          <em>Start simple. Add resilience when downtime becomes expensive.</em>"
    },
    {
      "id": "hor-26",
      "type": "horizon",
      "linkedSection": "hard",
      "title": "IaC investment over time",
      "content": "<strong>Day 1:</strong> \"Terraform is harder than clicking buttons\"<br>\n          <strong>Week 1:</strong> \"At least I can version control this\"<br>\n          <strong>Month 1:</strong> \"I can recreate my entire stack in 10 minutes\"<br>\n          <strong>Year 1:</strong> \"I can't believe I ever did this manually\""
    },
    {
      "id": "grad-27",
      "type": "gradient",
      "linkedSection": "hard",
      "title": "How multi-region fails",
      "content": "<strong>100% → 90%:</strong> Latency increases (acceptable)<br>\n          <strong>90% → 70%:</strong> Network partitions (agents can't coordinate)<br>\n          <strong>70% → 50%:</strong> Split brain (conflicting state)<br>\n          <strong>50% → CLIFF:</strong> Data loss (unrecoverable)<br><br>\n          <em>Multi-region is hard. Don't do it unless you must.</em>"
    },
    {
      "id": "fron-28",
      "type": "frontier",
      "linkedSection": "hard",
      "title": "UNSOLVED: Optimal region placement",
      "content": "Where should orchestrator vs workers live? Colocate for latency? Distribute for resilience? What about edge deployments? No consensus yet."
    },
    {
      "id": "alt-29",
      "type": "alternative",
      "linkedSection": "when",
      "title": "If this stack isn't right for you",
      "content": "<strong>Just need Ralph?</strong> - Run locally, no infra needed<br>\n          <strong>Want managed?</strong> - Railway, Render, Fly.io<br>\n          <strong>Already on K8s?</strong> - Use Helm charts instead<br>\n          <strong>Serverless?</strong> - AWS Lambda + Step Functions"
    },
    {
      "id": "inv-30",
      "type": "inversion",
      "linkedSection": "when",
      "title": "What if you used this for simple tasks?",
      "content": "\"I just want to run one Claude session\"<br>\n          - You'd provision a VM, configure networking, install tools...<br>\n          - For a task that takes 5 minutes locally<br><br>\n          <strong>Why this fails:</strong> Massive overhead for simple tasks.<br>\n          <em>This stack is for Level 6-7 complexity. Level 0-3 should stay local.</em>"
    },
    {
      "id": "comp-31",
      "type": "composition",
      "linkedSection": "when",
      "title": "Integration Pattern Matrix",
      "content": "<strong>Roughneck + Gas Town:</strong> Single factory in cloud (Medium complexity)<br>\n          <strong>Station + Ralph:</strong> Message-driven continuous loops<br>\n          <strong>Agentic-Flow + Gas Town:</strong> Factory-scale with enterprise features<br>\n          <strong>Full Stack (All):</strong> Complete enterprise deployment (Very High)"
    },
    {
      "id": "inf-32",
      "type": "inflection",
      "linkedSection": "when",
      "title": "When infrastructure becomes mandatory",
      "content": "<strong>Laptop-only:</strong> 1-5 agents, single developer, daytime only<br>\n          <strong>INFLECTION:</strong> When you need overnight runs, team access, or 10+ agents<br>\n          <strong>Cloud-required:</strong> Production workloads, SLAs, compliance<br><br>\n          <em>Cross the inflection when laptop limitations block progress.</em>"
    },
    {
      "id": "exp-33",
      "type": "expertise",
      "linkedSection": "when",
      "title": "Infrastructure journey",
      "content": "<strong>Beginner:</strong> \"Do I need this?\" - Probably not yet<br>\n          <strong>Intermediate:</strong> \"My laptop can't handle this\" - Time to consider<br>\n          <strong>Advanced:</strong> \"I need prod/dev isolation\" - Roughneck is ready<br>\n          <strong>Staff:</strong> \"Multi-region, federated factories\" - Full stack deployment<br>\n          <strong>Expert:</strong> \"Custom orchestration topology\" - Extend the patterns"
    }
  ]
}