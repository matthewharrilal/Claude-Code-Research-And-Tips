{
  "items": [
    {
      "id": "inv-1",
      "type": "inversion",
      "linkedSection": "essence",
      "title": "What if LLMs DID have persistent memory?",
      "content": "<strong>You'd design:</strong> Single long session per project, no files, no restarts.<br>\n          <strong>Why this fails:</strong> Training data has a cutoff date. You'd lose all project-specific context.<br>\n          <strong>Hidden constraint revealed:</strong> External state isn't a workaround—it's the only path."
    },
    {
      "id": "min-2",
      "type": "minimal",
      "linkedSection": "essence",
      "title": "The irreducible memory pattern",
      "content": "<code style=\"background: #f4f4f5; padding: 2px 6px; border-radius: 4px; font-size: 12px;\">echo \"context\" &gt; CLAUDE.md</code><br>\n          <strong>Essential:</strong> A file that persists.<br>\n          <strong>Everything else:</strong> Refinement for scale, teams, automation."
    },
    {
      "id": "ana-3",
      "type": "analogy",
      "linkedSection": "essence",
      "title": "Memory patterns = Human note-taking",
      "content": "CLAUDE.md → Your reference cheat sheet<br>\n          progress.txt → Your lab notebook<br>\n          prd.json → Your todo list<br>\n          Git → Your version history<br><br>\n          <em>If you know why humans write things down, you understand why LLMs need files.</em>"
    },
    {
      "id": "grad-4",
      "type": "gradient",
      "linkedSection": "core",
      "title": "How context degrades (invisibly)",
      "content": "<strong>100% → 90%</strong> (0-40K): Full performance<br>\n          <strong>90% → 80%</strong> (40-60K): Subtle drift, you won't notice<br>\n          <strong>80% → 60%</strong> (60-80K): Repetition, compression<br>\n          <strong>60% → CLIFF</strong> (80K+): Instructions forgotten, hallucinations<br><br>\n          <em>Critical: The gradient is invisible until the cliff.</em>"
    },
    {
      "id": "inv-5",
      "type": "invariant",
      "linkedSection": "core",
      "title": "INV-003: External state > internal memory",
      "content": "Ralph, Gas Town, CC Mirror, Panopticon—all share this invariant.<br><br>\n          <strong>Why it matters:</strong> The same constraint forces the same architectural choice across ALL patterns. Understand this invariant, understand them all."
    },
    {
      "id": "war-6",
      "type": "warstory",
      "linkedSection": "core",
      "title": "Boris Cherny: The CLAUDE.md philosophy",
      "content": "\"Everything Claude needs should be in the prompt.\" The creator of Claude Code designed CLAUDE.md as the canonical way to persist project knowledge. Every pattern since builds on this foundation."
    },
    {
      "id": "con-7",
      "type": "constraint",
      "linkedSection": "decisions",
      "title": "One constraint → SIX decisions",
      "content": "<strong>ROOT:</strong> No persistent memory across sessions<br>\n          → State must persist externally (files)<br>\n          → Files must be readable at session start<br>\n          → Context window is finite (must choose what to load)<br>\n          → Hierarchy needed for different scopes<br>\n          → Fresh context beats extended sessions<br>\n          → Compaction needed as files grow"
    },
    {
      "id": "vio-8",
      "type": "violation",
      "linkedSection": "decisions",
      "title": "If you rely on \"Claude remembering\"",
      "content": "<strong>IF:</strong> You rely on memory instead of files<br>\n          <strong>THEN:</strong> Next session has no knowledge of previous<br>\n          <strong>THEN:</strong> Same mistakes repeated<br>\n          <strong>THEN:</strong> No velocity increase over time<br>\n          <strong>FINALLY:</strong> Session 20 is as slow as session 1<br><br>\n          <em>The fix: \"If it's not in a file, it doesn't exist.\"</em>"
    },
    {
      "id": "trade-9",
      "type": "tradeoff",
      "linkedSection": "decisions",
      "title": "The Context vs. Quality Dilemma",
      "content": "<strong>Extended sessions:</strong> Rich context, but quality degrades<br>\n          <strong>Fresh context:</strong> Peak quality, but must reconstruct state<br>\n          <strong>Hybrid:</strong> Balanced, but complexity overhead<br><br>\n          <em>Heuristic: If quality matters, choose fresh + files over extended.</em>"
    },
    {
      "id": "exp-10",
      "type": "expertise",
      "linkedSection": "decisions",
      "title": "Memory understanding by level",
      "content": "<strong>Beginner:</strong> \"What's CLAUDE.md?\" → A file Claude reads<br>\n          <strong>Intermediate:</strong> \"Why files?\" → LLMs have no memory<br>\n          <strong>Advanced:</strong> \"What's minimal?\" → One file + one principle<br>\n          <strong>Staff:</strong> \"When scale?\" → progress.txt, prd.json, Claude-Mem<br>\n          <strong>Expert:</strong> \"Cross-pattern?\" → All share INV-003"
    },
    {
      "id": "comp-11",
      "type": "composition",
      "linkedSection": "patterns",
      "title": "CLAUDE.md + progress.txt + prd.json",
      "content": "<strong>Works:</strong> The Ralph Complete Stack. Each file serves ONE purpose.<br>\n          <strong>Danger:</strong> Over-engineering for simple projects.<br>\n          <strong>Recommendation:</strong> Start with CLAUDE.md only. Add others when needed."
    },
    {
      "id": "eff-12",
      "type": "effect",
      "linkedSection": "patterns",
      "title": "At iteration 50+, reading costs more than thinking",
      "content": "progress.txt compounds. What started as useful memory becomes drag. The pattern that helps at iteration 5 hurts at iteration 50.<br><br>\n          <strong>Threshold:</strong> ~20KB progress.txt, ~50 iterations"
    },
    {
      "id": "war-13",
      "type": "warstory",
      "linkedSection": "patterns",
      "title": "Molly Cantillon: Panopticon filesystem memory",
      "content": "8 parallel agents managing life domains. Each agent owns its directory: ~/nox, ~/trades, ~/health. Filesystem IS the memory. Cron jobs trigger overnight processing. Morning: synthesized briefs ready."
    },
    {
      "id": "fron-14",
      "type": "frontier",
      "linkedSection": "patterns",
      "title": "UNSOLVED: Optimal retrieval strategies",
      "content": "<strong>The question:</strong> How to decide what context to load? Semantic search? Recency? Importance weighting?<br>\n          <strong>Why hard:</strong> Optimal varies by task type, project phase, and team dynamics.<br>\n          <strong>Current best:</strong> 3-layer retrieval (Claude-Mem style)."
    },
    {
      "id": "ana-15",
      "type": "analogy",
      "linkedSection": "patterns",
      "title": "Ralph files = Gas Town components",
      "content": "<strong>prd.json</strong> = Gas Town Inbox (work queue)<br>\n          <strong>progress.txt</strong> = Refinery (persistent memory)<br>\n          <strong>Git</strong> = Beads (git-backed data plane)<br>\n          <strong>CLAUDE.md</strong> = HQ policies (town-level management)"
    },
    {
      "id": "hor-16",
      "type": "horizon",
      "linkedSection": "path",
      "title": "How memory perception evolves",
      "content": "<strong>Session 1:</strong> \"Why do I need these files?\"<br>\n          <strong>Session 5:</strong> \"Oh, Claude forgot what we discussed\"<br>\n          <strong>Session 10:</strong> \"These files are why it's working\"<br>\n          <strong>Session 30:</strong> \"This IS institutional memory\"<br><br>\n          <em>Don't judge memory patterns by session 1.</em>"
    },
    {
      "id": "vio-17",
      "type": "violation",
      "linkedSection": "path",
      "title": "If you EDIT progress.txt (instead of APPEND)",
      "content": "<strong>IF:</strong> You edit/overwrite progress.txt<br>\n          <strong>THEN:</strong> Prior learnings lost<br>\n          <strong>THEN:</strong> Next iteration repeats solved mistakes<br>\n          <strong>THEN:</strong> No compound learning effect<br>\n          <strong>FINALLY:</strong> Iteration 20 makes iteration 5's mistakes<br><br>\n          <em>The rule: APPEND ONLY. Capitalize it in prompts.</em>"
    },
    {
      "id": "inv-18",
      "type": "invariant",
      "linkedSection": "path",
      "title": "INV-004: Fresh context > extended sessions",
      "content": "Ralph, Boris's vanilla workflow, CC Mirror—all spawn fresh instances rather than extending sessions.<br><br>\n          <strong>Why:</strong> Context rot at 80K tokens is physics, not preference."
    },
    {
      "id": "inf-19",
      "type": "inflection",
      "linkedSection": "gotchas",
      "title": "When progress.txt flips from help to hurt",
      "content": "<strong>0-10KB:</strong> Pure benefit (learnings compound)<br>\n          <strong>10-20KB:</strong> Diminishing returns (more to read)<br>\n          <strong>20-30KB:</strong> Neutral (reading cost = thinking benefit)<br>\n          <strong>30KB+:</strong> Net negative (context wasted on history)<br><br>\n          <strong>THE INFLECTION:</strong> ~20KB<br>\n          <em>Detection: Late iterations worse? Check file size.</em>"
    },
    {
      "id": "inv-20",
      "type": "inversion",
      "linkedSection": "gotchas",
      "title": "What if CLAUDE.md could be infinite?",
      "content": "<strong>You'd design:</strong> Put everything in CLAUDE.md. No need for hierarchy.<br>\n          <strong>Why this fails:</strong> Context window is finite. 500+ line CLAUDE.md degrades quality.<br>\n          <strong>Hidden constraint:</strong> Hierarchy exists BECAUSE context is expensive."
    },
    {
      "id": "war-21",
      "type": "warstory",
      "linkedSection": "gotchas",
      "title": "Ryan Carson: \"Learnings compound\"",
      "content": "14 iterations on Untangle Legal Agent. By story 10, Ralph knew their patterns. The progress.txt paid off in later iterations. Key insight: Early overhead becomes late velocity."
    },
    {
      "id": "grad-22",
      "type": "gradient",
      "linkedSection": "gotchas",
      "title": "How Claude-Mem degrades",
      "content": "<strong>100% hit rate:</strong> Precise queries, good tags<br>\n          <strong>70% hit rate:</strong> Broad queries, some noise<br>\n          <strong>40% hit rate:</strong> Wrong type filters, stale data<br>\n          <strong>Failure:</strong> Corrupted Chroma DB<br><br>\n          <em>Fix: Specific type filters. Batch ID fetches. Check DB health.</em>"
    },
    {
      "id": "trade-23",
      "type": "tradeoff",
      "linkedSection": "hard",
      "title": "Compression vs. Fidelity",
      "content": "<strong>THE DILEMMA:</strong><br>\n          • Full transcripts: Complete, but context explodes<br>\n          • Semantic compression: Efficient, but loses nuance<br>\n          • No persistence: Simple, but no learning<br><br>\n          <strong>WHY NO PERFECT ANSWER:</strong> Information theory limits prevent lossless compression to useful sizes.<br><br>\n          <em>Accept that some loss is the cost of scale.</em>"
    },
    {
      "id": "con-24",
      "type": "constraint",
      "linkedSection": "hard",
      "title": "Multi-agent coordination cascade",
      "content": "<strong>ROOT:</strong> Multiple agents need shared state<br>\n          → Isolation prevents conflicts<br>\n          → But isolation prevents coordination<br>\n          → Handoff protocols needed<br>\n          → Handoffs need timing<br>\n          → Timing needs verification<br>\n          → Verification needs files"
    },
    {
      "id": "exp-25",
      "type": "expertise",
      "linkedSection": "hard",
      "title": "Compaction understanding",
      "content": "<strong>Beginner:</strong> \"Why archive?\" → File gets too big<br>\n          <strong>Intermediate:</strong> \"When?\" → ~20KB threshold<br>\n          <strong>Advanced:</strong> \"What to keep?\" → Recent, patterns, permanent<br>\n          <strong>Staff:</strong> \"Automate?\" → Not yet, no good heuristics<br>\n          <strong>Expert:</strong> \"Cross-system?\" → Move to CLAUDE.md, Beads"
    },
    {
      "id": "fron-26",
      "type": "frontier",
      "linkedSection": "hard",
      "title": "UNSOLVED: Optimal compaction window",
      "content": "<strong>The question:</strong> After N iterations? After K bytes? After time T?<br>\n          <strong>Why hard:</strong> Optimal varies by project, team, task type.<br>\n          <strong>Current best:</strong> Manual when quality degrades. No automation yet."
    },
    {
      "id": "alt-27",
      "type": "alternative",
      "linkedSection": "when",
      "title": "If external state isn't right for you",
      "content": "<strong>One-off question?</strong> → Default Claude (no files)<br>\n          <strong>Simple project?</strong> → Just CLAUDE.md<br>\n          <strong>Multi-session feature?</strong> → Ralph pattern (progress.txt + prd.json)<br>\n          <strong>Team coordination?</strong> → CC Mirror<br>\n          <strong>Life automation?</strong> → Panopticon<br>\n          <strong>Factory scale?</strong> → Gas Town"
    },
    {
      "id": "inv-28",
      "type": "inversion",
      "linkedSection": "when",
      "title": "What if you used Gas Town for a one-off question?",
      "content": "• Days of setup for a 5-minute task<br>\n          • 225K lines of Go for a simple prompt<br>\n          • Overhead exceeds benefit by 1000x<br><br>\n          <strong>Why this fails:</strong> Pattern complexity must match task complexity.<br>\n          <em>Match the tool to the job.</em>"
    },
    {
      "id": "ana-29",
      "type": "analogy",
      "linkedSection": "when",
      "title": "Memory patterns = Database scaling",
      "content": "<strong>None</strong> → In-memory (volatile)<br>\n          <strong>CLAUDE.md</strong> → SQLite (single file)<br>\n          <strong>Ralph stack</strong> → PostgreSQL (structured)<br>\n          <strong>Claude-Mem</strong> → Vector DB (semantic)<br>\n          <strong>Gas Town</strong> → Distributed system (enterprise)<br><br>\n          <em>Scale your memory like you scale your database.</em>"
    },
    {
      "id": "hor-30",
      "type": "horizon",
      "linkedSection": "when",
      "title": "Pattern value over time",
      "content": "<strong>Day 1:</strong> \"CLAUDE.md is enough\"<br>\n          <strong>Week 1:</strong> \"I need progress.txt for learnings\"<br>\n          <strong>Month 1:</strong> \"I need prd.json for task tracking\"<br>\n          <strong>Month 3:</strong> \"I need Claude-Mem for cross-project memory\"<br>\n          <strong>Year 1:</strong> \"I need Gas Town for team scale\"<br><br>\n          <em>Pattern needs grow with project maturity.</em>"
    }
  ]
}