<!--
═══════════════════════════════════════════════════════════════════════════════
INLINE THREADING HEADER — Phase 2B
File: docs-spa/content/pages/transform-single-to-autonomous/content.html
Tier: C | Batch: 13 | Generated: 2026-02-06

1. WHY THIS EXISTS
Rendered HTML content page for the transform-single-to-autonomous synthesis document.

3. STATUS
ACTIVE

5. BUILT ON
Extracted from synthesis/transform-single-to-autonomous.md by content extraction scripts.

8. CONSUMED BY
docs-spa/app/(docs)/synthesis/transform-single-to-autonomous/page.tsx renders this content via dangerouslySetInnerHTML.

═══════════════════════════════════════════════════════════════════════════════
END INLINE THREADING HEADER
═══════════════════════════════════════════════════════════════════════════════
-->

      <!-- Section 1: ESSENCE -->
      <section id="essence" data-activity="essence">
        <div class="essence-box">
          <div class="essence-label">Essence (15 words)</div>
          <div class="essence-text">Transform human-babysitting-AI into AI-working-while-human-sleeps through fresh context and external state.</div>
        </div>

        <p class="text-text-secondary mb-6">
          <strong>The Paradigm Shift:</strong> From 90 minutes of active engagement watching context degrade, to 30 minutes of setup then walking away while work completes overnight.
        </p>

        <p class="text-text-secondary mb-6">
          This transformation unlocks Level 2+ on the complexity ladder. It's the difference between using Claude as a pair programmer who gets tired, and using Claude as a factory worker who never forgets the plan because the plan lives in files, not context.
        </p>
      </section>

      <!-- Section 2: CORE ABSTRACTION + IMPLEMENTATION -->
      <section id="core-abstraction" data-activity="core">
        <h2 class="section-title">
          <span class="section-number">2</span>
          The Core Shift
        </h2>

        <div class="core-abstraction">
          <div class="core-philosophy">"Context degrades. Files persist. Fresh instances win."</div>

          <div class="core-code">
            <button class="copy-btn" onclick="copyCode(this, 'BEFORE: You ↔ Claude (continuous, context fills, quality drops)\nAFTER: You → PRD → [Fresh Claude]₁ → [Fresh Claude]₂ → ... → Complete')">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copy
            </button>
            <code>BEFORE: You <span class="comment">↔</span> Claude <span class="comment">(continuous, context fills, quality drops)</span><br>
AFTER:  You <span class="comment">→</span> PRD <span class="comment">→</span> [Fresh Claude]<span class="variable">₁</span> <span class="comment">→</span> [Fresh Claude]<span class="variable">₂</span> <span class="comment">→</span> ... <span class="comment">→</span> Complete</code>
          </div>

          <div class="core-anchor">The transformation: Replace "continuous conversation" with "loop of fresh instances + external state".</div>
        </div>

        <!-- Before/After Visual Comparison -->
        <div class="before-after-box">
          <div class="before-panel">
            <div class="panel-title">Before: Single Session</div>
            <ul class="text-sm text-red-900 space-y-2">
              <li>You prompt iteratively</li>
              <li>Context fills over 90 minutes</li>
              <li>Quality degrades at 60-70%</li>
              <li>Earlier decisions forgotten</li>
              <li>Human must stay engaged</li>
              <li>Session dies = state lost</li>
            </ul>
          </div>
          <div class="after-panel">
            <div class="panel-title">After: Autonomous Loop</div>
            <ul class="text-sm text-green-900 space-y-2">
              <li>PRD defines all tasks upfront</li>
              <li>Fresh context each iteration</li>
              <li>Quality maintained throughout</li>
              <li>Decisions persist in files</li>
              <li>Human can walk away</li>
              <li>Crash = resume from git</li>
            </ul>
          </div>
        </div>

        <p class="text-text-secondary mb-6">
          Each iteration spawns a <strong>new Claude instance with zero memory</strong> of previous work. The agent reads prd.json to know what's done and what's next. It reads progress.txt to learn patterns from past iterations. It does ONE task, verifies, commits, logs learnings, and exits. The bash loop restarts it fresh.
        </p>

        <!-- Context Degradation Visualization -->
        <h3 class="font-semibold text-lg mb-4">Context Degradation in Single Sessions</h3>

        <div class="degradation-chart">
          <div class="degradation-row">
            <div class="degradation-label">0-50%</div>
            <div class="degradation-bar">
              <div class="degradation-fill good" style="width: 100%;"></div>
            </div>
            <span class="ml-3 text-green-400">Full capability</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">50-70%</div>
            <div class="degradation-bar">
              <div class="degradation-fill warning" style="width: 75%;"></div>
            </div>
            <span class="ml-3 text-yellow-400">Slight degradation</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">70-85%</div>
            <div class="degradation-bar">
              <div class="degradation-fill warning" style="width: 50%;"></div>
            </div>
            <span class="ml-3 text-yellow-400">Noticeable loss</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">85-95%</div>
            <div class="degradation-bar">
              <div class="degradation-fill danger" style="width: 25%;"></div>
            </div>
            <span class="ml-3 text-red-400">Instructions forgotten</span>
          </div>
          <div class="degradation-row">
            <div class="degradation-label">95%+</div>
            <div class="degradation-bar">
              <div class="degradation-fill danger" style="width: 10%;"></div>
            </div>
            <span class="ml-3 text-red-400">Hallucinations, amnesia</span>
          </div>
        </div>

        <p class="text-text-secondary mb-6">
          This is why iteration 20 in a single session produces worse code than iteration 5. The solution isn't debugging—it's restarting with fresh context.
        </p>
      </section>

      <!-- Section 3: DESIGN DECISIONS -->
      <section id="why-context-degrades" data-activity="decisions">
        <h2 class="section-title">
          <span class="section-number">3</span>
          Why Transform?
        </h2>

        <div class="decision-box">
          <div class="decision-why">WHY CONTEXT DEGRADES</div>
          <div class="decision-reasoning">
            Transformer attention has finite capacity. At 200K tokens, the model must compress. At 80K+ tokens, quality visibly degrades—earlier instructions get lost, the model contradicts itself, "context rot" sets in. This isn't a bug; it's physics.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Don't fight context degradation—embrace fresh context. If quality drops, the fix is restart, not debug. The transformation moves you from fighting this constraint to leveraging it.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-external-state">
          <div class="decision-why">WHY EXTERNAL STATE</div>
          <div class="decision-reasoning">
            If each iteration is a fresh Claude with no memory, how does progress persist? Through files. Git commits are the audit trail. prd.json tracks what's done. progress.txt accumulates learnings. The filesystem IS the memory.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              Never rely on "Claude remembering" something from a previous iteration. If it's not written to a file, it doesn't exist. Every decision, every learning, every blocker must be persisted externally.
            </div>
          </div>
        </div>

        <div class="decision-box" id="why-atomic-tasks">
          <div class="decision-why">WHY ATOMIC TASKS</div>
          <div class="decision-reasoning">
            Each task must complete in ONE iteration (one context window). If a task spans multiple iterations, there's no way to persist the "partial state" of thinking. Large tasks = Claude loses track mid-task = broken code.
          </div>
          <div class="decision-implication">
            <div class="decision-implication-label">What this means for you</div>
            <div class="text-text-secondary text-sm">
              If you can't describe a task in 2-3 sentences, split it. "Build auth system" becomes 7 atomic stories: add schema, add middleware, add form, add server action, wire them up, test validation, test action. Each is one iteration.
            </div>
          </div>
        </div>

        <div class="checkpoint-box">
          <div class="checkpoint-title">
            <i data-lucide="check-circle" class="w-4 h-4"></i>
            Checkpoint: Is Transformation Right For This Task?
          </div>
          <div class="checkpoint-content">
            <strong>Ask yourself:</strong><br>
            - Does task have 3+ discrete steps? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Will it take &gt; 30 min total? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Do you have clear "done" criteria? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Can each step be verified programmatically? <span class="text-emerald-700">(Yes = transform)</span><br>
            - Are you okay walking away? <span class="text-emerald-700">(Yes = transform)</span><br><br>
            If all yes: proceed with transformation. If any no: consider single session or HOTL Ralph.
          </div>
        </div>
      </section>

      <!-- Section 4: FILE STRUCTURE -->
      <section id="file-structure" data-activity="files">
        <h2 class="section-title">
          <span class="section-number">4</span>
          The Implementation
        </h2>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>project/
<span class="comment">├── scripts/ralph/           # The autonomous system</span>
│   ├── ralph.sh             <span class="comment"># The loop engine</span>
│   ├── prd.json             <span class="comment"># Task board (external state)</span>
│   └── progress.txt         <span class="comment"># Learnings log (append-only)</span>
└── CLAUDE.md                <span class="comment"># Project context</span></pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="prd-json">prd.json - The Task Board</h3>

        <p class="text-text-secondary mb-4">
          This is the transformation in action. Your single "build auth feature" request becomes 7 atomic, verifiable stories.
        </p>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre>{
  <span class="string">"project"</span>: <span class="string">"UserAuth"</span>,
  <span class="string">"branchName"</span>: <span class="string">"feat/user-auth"</span>,
  <span class="string">"description"</span>: <span class="string">"User authentication with login form, validation, and tests"</span>,
  <span class="string">"userStories"</span>: [
    {
      <span class="string">"id"</span>: <span class="string">"US-001"</span>,
      <span class="string">"title"</span>: <span class="string">"Create login form component with email/password fields"</span>,
      <span class="string">"description"</span>: <span class="string">"Basic login form UI with styled inputs"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"LoginForm component exists in components/auth/"</span>,
        <span class="string">"Has email input with type='email'"</span>,
        <span class="string">"Has password input with type='password'"</span>,
        <span class="string">"Has submit button"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 1,
      <span class="string">"passes"</span>: <span class="keyword">false</span>,
      <span class="string">"notes"</span>: <span class="string">""</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-002"</span>,
      <span class="string">"title"</span>: <span class="string">"Add Zod schema for login validation"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"loginSchema defined with email and password fields"</span>,
        <span class="string">"Email validates format with .email()"</span>,
        <span class="string">"Password requires minimum 8 characters"</span>,
        <span class="string">"Schema exported from lib/validations/auth.ts"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 2,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-003"</span>,
      <span class="string">"title"</span>: <span class="string">"Integrate validation into login form"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Form uses react-hook-form with zodResolver"</span>,
        <span class="string">"Validation errors display below inputs"</span>,
        <span class="string">"Submit disabled when form invalid"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 3,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-004"</span>,
      <span class="string">"title"</span>: <span class="string">"Create auth server action"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"loginAction in app/auth/actions.ts"</span>,
        <span class="string">"Accepts email and password"</span>,
        <span class="string">"Uses bcrypt for password comparison"</span>,
        <span class="string">"Returns success/error response"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 4,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-005"</span>,
      <span class="string">"title"</span>: <span class="string">"Wire form to server action"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Form calls loginAction on submit"</span>,
        <span class="string">"Loading state during submission"</span>,
        <span class="string">"Error messages from server displayed"</span>,
        <span class="string">"Redirect on success"</span>,
        <span class="string">"npm run typecheck passes"</span>
      ],
      <span class="string">"priority"</span>: 5,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-006"</span>,
      <span class="string">"title"</span>: <span class="string">"Write unit tests for validation schema"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Tests in __tests__/auth/validation.test.ts"</span>,
        <span class="string">"Tests valid email formats"</span>,
        <span class="string">"Tests invalid email rejection"</span>,
        <span class="string">"Tests password length requirements"</span>,
        <span class="string">"npm run test passes"</span>
      ],
      <span class="string">"priority"</span>: 6,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    },
    {
      <span class="string">"id"</span>: <span class="string">"US-007"</span>,
      <span class="string">"title"</span>: <span class="string">"Write unit tests for server action"</span>,
      <span class="string">"acceptanceCriteria"</span>: [
        <span class="string">"Tests in __tests__/auth/actions.test.ts"</span>,
        <span class="string">"Tests successful login"</span>,
        <span class="string">"Tests invalid credentials"</span>,
        <span class="string">"Tests missing user"</span>,
        <span class="string">"Mocks database calls"</span>,
        <span class="string">"npm run test passes"</span>
      ],
      <span class="string">"priority"</span>: 7,
      <span class="string">"passes"</span>: <span class="keyword">false</span>
    }
  ]
}</pre>
        </div>

        <p class="text-text-secondary mb-6">
          <strong>Why this structure works:</strong> Each story is atomic (one context window). Dependencies are ordered by priority. Acceptance criteria are verifiable. <code>passes: true/false</code> tracks completion state externally.
        </p>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="ralph-sh">ralph.sh - The Automation Loop</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment">#!/bin/bash</span>
<span class="keyword">set</span> -e

<span class="variable">MAX_ITERATIONS</span>=<span class="variable">${1:-25}</span>
<span class="variable">SCRIPT_DIR</span>="$(cd "$(dirname "${BASH_SOURCE[0]}")" &amp;&amp; pwd)"
<span class="variable">PROJECT_ROOT</span>="$(cd "$SCRIPT_DIR/../.." &amp;&amp; pwd)"

<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"  Ralph - Autonomous Development Loop"</span>
<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"Max iterations: $MAX_ITERATIONS"</span>
<span class="keyword">echo</span> <span class="string">"Project root: $PROJECT_ROOT"</span>

cd "$PROJECT_ROOT"

<span class="keyword">for</span> i <span class="keyword">in</span> $(seq 1 $MAX_ITERATIONS); <span class="keyword">do</span>
  <span class="keyword">echo</span> <span class="string">""</span>
  <span class="keyword">echo</span> <span class="string">"════════════════════════════════════════"</span>
  <span class="keyword">echo</span> <span class="string">"  Iteration $i of $MAX_ITERATIONS"</span>
  <span class="keyword">echo</span> <span class="string">"════════════════════════════════════════"</span>
  <span class="keyword">echo</span> <span class="string">""</span>

  <span class="comment"># Run Claude with fresh context each iteration</span>
  OUTPUT=$(claude --dangerously-skip-permissions &lt;&lt;'PROMPT' 2&gt;&amp;1 | tee /dev/stderr) || true
<span class="comment"># Ralph Agent Instructions</span>

<span class="comment">## Your Context</span>
You are one iteration in an autonomous development loop.
You have NO memory of previous iterations.
Your memory comes from: git history, prd.json, and progress.txt.

<span class="comment">## Your Task</span>

1. Read `scripts/ralph/prd.json` to see all user stories
2. Read `scripts/ralph/progress.txt` for learnings from previous iterations
3. Verify you're on the correct git branch (create if needed)
4. Find the highest priority story where `passes: false`
5. Implement that ONE story completely
6. Run verification: `npm run typecheck` and `npm run test`
7. If passing:
   - Commit with message: `feat: [US-XXX] - [title]`
   - Update prd.json: set `passes: true` for this story
   - APPEND learnings to progress.txt
8. If failing:
   - Fix the issues
   - Try again (up to 3 attempts)
   - If still failing, log the blocker and move on

<span class="comment">## Progress Log Format</span>

APPEND to progress.txt (never edit previous entries):

---
## Iteration [N] - [Story ID] - [Date/Time]
- **Completed:** [what was done]
- **Files changed:** [list]
- **Learnings:** [patterns, gotchas discovered]
- **Blockers:** [any issues for next iteration]
---

<span class="comment">## Stop Condition</span>

If ALL stories in prd.json have `passes: true`, output exactly:
&lt;promise&gt;COMPLETE&lt;/promise&gt;

Otherwise, end your response normally after completing one story.
PROMPT

  <span class="comment"># Check for completion signal</span>
  <span class="keyword">if</span> <span class="keyword">echo</span> "$OUTPUT" | grep -q "&lt;promise&gt;COMPLETE&lt;/promise&gt;"; <span class="keyword">then</span>
    <span class="keyword">echo</span> <span class="string">""</span>
    <span class="keyword">echo</span> <span class="string">"========================================"</span>
    <span class="keyword">echo</span> <span class="string">"  ALL STORIES COMPLETE!"</span>
    <span class="keyword">echo</span> <span class="string">"========================================"</span>
    <span class="keyword">echo</span> <span class="string">""</span>

    <span class="comment"># Summary</span>
    <span class="keyword">echo</span> <span class="string">"Final status:"</span>
    cat scripts/ralph/prd.json | jq '.userStories[] | {id, title, passes}'

    <span class="keyword">exit</span> 0
  <span class="keyword">fi</span>

  <span class="comment"># Brief pause between iterations</span>
  sleep 2
<span class="keyword">done</span>

<span class="keyword">echo</span> <span class="string">""</span>
<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"  Max iterations reached"</span>
<span class="keyword">echo</span> <span class="string">"========================================"</span>
<span class="keyword">echo</span> <span class="string">"Some stories may be incomplete. Check prd.json for status."</span>
<span class="keyword">exit</span> 1</pre>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8" id="progress-txt">progress.txt - The Learning Log</h3>

        <div class="code-block">
          <button class="copy-btn" onclick="copyCodeBlock(this)">
            <i data-lucide="copy" class="w-3 h-3"></i>
            Copy
          </button>
          <pre><span class="comment"># Ralph Progress Log</span>
Project: UserAuth
Started: 2026-01-09

<span class="comment">## Codebase Patterns</span>
(Ralph updates this section with reusable patterns)

<span class="comment">## Key Files</span>
- components/auth/LoginForm.tsx
- lib/validations/auth.ts
- app/auth/actions.ts
- __tests__/auth/

---

<span class="comment">## Iteration 1 - US-001 - 2026-01-09 02:15</span>
- <span class="keyword">Completed:</span> Created LoginForm component
- <span class="keyword">Files changed:</span> components/auth/LoginForm.tsx
- <span class="keyword">Learnings:</span> Project uses Tailwind, shadcn/ui components available
- <span class="keyword">Blockers:</span> None

---

<span class="comment">## Iteration 2 - US-002 - 2026-01-09 02:18</span>
- <span class="keyword">Completed:</span> Added Zod validation schema
- <span class="keyword">Files changed:</span> lib/validations/auth.ts
- <span class="keyword">Learnings:</span> Use .optional() for nullable fields in Zod
- <span class="keyword">Blockers:</span> None

---
<span class="comment">(Ralph continues appending...)</span></pre>
        </div>

        <div class="checkpoint-box">
          <div class="checkpoint-title">
            <i data-lucide="check-circle" class="w-4 h-4"></i>
            Checkpoint: Verify Setup
          </div>
          <div class="checkpoint-content">
            <code>ls -la scripts/ralph/</code> should show ralph.sh (executable), prd.json, progress.txt<br>
            <code>jq '.userStories | length' scripts/ralph/prd.json</code> should return your story count<br>
            <code>bash -n scripts/ralph/ralph.sh &amp;&amp; echo "Syntax OK"</code> should pass<br>
            <code>which claude</code> should return the Claude CLI path
          </div>
        </div>
      </section>

      <!-- Section 5: PATH OF TRANSFORMATION -->
      <section id="path" data-activity="path">
        <h2 class="section-title">
          <span class="section-number">5</span>
          The Transformation Path
        </h2>

        <p class="text-text-secondary mb-6">
          Follow the transformation from "build auth feature" through to "wake up to completed feature":
        </p>

        <div class="path-container">
          <div class="path-step">
            <div class="path-number">1</div>
            <div class="path-content"><strong>You decompose</strong> "build auth feature" into 7 atomic user stories in <code>prd.json</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">2</div>
            <div class="path-content"><strong>You create</strong> <code>ralph.sh</code> with the loop and embedded prompt</div>
          </div>
          <div class="path-step">
            <div class="path-number">3</div>
            <div class="path-content"><strong>You initialize</strong> <code>progress.txt</code> with project context and empty log</div>
          </div>
          <div class="path-step">
            <div class="path-number">4</div>
            <div class="path-content"><strong>You run</strong> <code>./scripts/ralph/ralph.sh 25</code> and walk away</div>
          </div>
          <div class="path-step">
            <div class="path-number">5</div>
            <div class="path-content"><strong>Iteration 1:</strong> Fresh Claude spawns, reads prd.json, finds US-001, implements LoginForm, commits, updates prd.json, appends to progress.txt, exits</div>
          </div>
          <div class="path-step">
            <div class="path-number">6</div>
            <div class="path-content"><strong>Iteration 2:</strong> Fresh Claude spawns (NO MEMORY), reads prd.json (sees US-001 done), reads progress.txt (learns Tailwind/shadcn), implements US-002, commits, exits</div>
          </div>
          <div class="path-step">
            <div class="path-number">7</div>
            <div class="path-content"><strong>Iterations 3-6:</strong> Pattern repeats. Each iteration has fresh context. Learnings compound in progress.txt.</div>
          </div>
          <div class="path-step">
            <div class="path-number">8</div>
            <div class="path-content"><strong>Iteration 7:</strong> Fresh Claude reads prd.json, sees all <code>passes: true</code>, outputs <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code></div>
          </div>
          <div class="path-step">
            <div class="path-number">9</div>
            <div class="path-content"><strong>Script exits.</strong> You wake up to 7 commits, all tests passing, complete authentication feature.</div>
          </div>
        </div>

        <h3 class="font-semibold text-lg mb-4 mt-8">What Happens Under the Hood</h3>

        <div class="code-block">
          <pre><span class="comment">Iteration 1 (2:00 AM)</span>
├── Fresh Claude instance spawns
├── Reads: prd.json, progress.txt, CLAUDE.md
├── Picks: US-001 (highest priority, passes: false)
├── Implements: LoginForm.tsx
├── Verifies: npm run typecheck (passes)
├── Commits: "feat: US-001 - Create login form component"
├── Updates: prd.json (US-001.passes = true)
├── Appends: progress.txt with learnings
└── <span class="keyword">Exits (context cleared)</span>

<span class="comment">Iteration 2 (2:05 AM)</span>
├── Fresh Claude instance spawns (<span class="keyword">NO MEMORY</span>)
├── Reads: prd.json (sees US-001 done)
├── Reads: progress.txt (learns about Tailwind/shadcn)
├── Picks: US-002 (next priority)
├── Implements: Zod schema
├── Verifies: npm run typecheck (passes)
├── Commits: "feat: US-002 - Add Zod schema"
└── <span class="keyword">Exits (context cleared)</span>

<span class="comment">... (pattern repeats) ...</span>

<span class="comment">Iteration 7 (2:35 AM)</span>
├── Fresh Claude instance spawns
├── Reads: prd.json (<span class="string">all passes: true!</span>)
├── Outputs: &lt;promise&gt;COMPLETE&lt;/promise&gt;
└── <span class="keyword">Script exits with success</span>

<span class="string">You wake up at 7:00 AM to a complete feature.</span></pre>
        </div>
      </section>

      <!-- Section 6: GOTCHAS -->
      <section id="gotchas" data-activity="gotchas">
        <h2 class="section-title">
          <span class="section-number">6</span>
          Gotchas
        </h2>

        <p class="text-text-secondary mb-6">
          Real problems you'll hit during the transformation, with concrete numbers and fixes:
        </p>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Ralph exits after first iteration
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Script runs once, then stops. Only 1 commit in git log.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> <code>&lt;promise&gt;COMPLETE&lt;/promise&gt;</code> emitted incorrectly, or all stories marked <code>passes: true</code> by mistake.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Check prd.json: <code>jq '.userStories | map(select(.passes==true)) | length' scripts/ralph/prd.json</code>. If all marked true but shouldn't be, reset with <code>jq '.userStories |= map(.passes = false)'</code>.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Same story keeps failing (stuck loop)
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Same task attempted 3+ times with no progress. Iteration count climbing.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Task has impossible acceptance criteria, or verification failing for external reasons.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Check progress.txt for blocker patterns. Split the story or add missing dependency. Reset <code>passes: false</code> and run again.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            progress.txt grows unbounded
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> After ~50 iterations, Claude spends more tokens reading than thinking.</div>
          <div class="gotcha-detail"><strong>Threshold:</strong> &gt;20KB progress.txt starts degrading quality.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Truncate to last 10 entries between runs. Move permanent learnings to CLAUDE.md or AGENTS.md.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Tests pass but story marked failed
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> <code>npm test</code> shows green but prd.json still has <code>passes: false</code>.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Claude didn't update prd.json after verification passed (incomplete prompt following).</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Manually verify tests pass, then update prd.json with <code>jq '.userStories |= map(if .id == "US-XXX" then .passes = true else . end)'</code>.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Context too large for single story
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Iteration completes but work is incomplete. Output mentions "running out of space."</div>
          <div class="gotcha-detail"><strong>Threshold:</strong> Stories with &gt;5 acceptance criteria often hit this.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Split the story: US-002 (8 criteria) becomes US-002a (4 criteria) + US-002b (4 criteria). Add dependencies.</div>
        </div>

        <div class="gotcha-box">
          <div class="gotcha-title">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Git commits not appearing
          </div>
          <div class="gotcha-detail"><strong>Symptom:</strong> Work is done in progress.txt but <code>git log</code> shows no new commits.</div>
          <div class="gotcha-detail"><strong>Cause:</strong> Claude didn't commit, or commits are on wrong branch.</div>
          <div class="gotcha-detail"><strong>Fix:</strong> Check current branch with <code>git branch --show-current</code>. Check expected branch from prd.json. Stash and move if needed.</div>
        </div>
      </section>

      <!-- Section 7: WHAT'S HARD -->
      <section id="hard" data-activity="hard">
        <h2 class="section-title">
          <span class="section-number">7</span>
          What's Hard
        </h2>

        <p class="text-text-secondary mb-6">
          These are fundamental tensions in the transformation, not bugs to fix:
        </p>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Context Rot vs. Memory Loss
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Fresh context avoids rot but loses learnings. progress.txt helps but grows unbounded. No perfect solution exists.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Quality drops in late iterations (rot), OR early iterations repeat mistakes from archived runs (memory loss).</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Keep progress.txt under 20KB. Start fresh runs from AGENTS.md (permanent), not progress.txt (session). Accept that some re-learning is the cost of fresh context.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Verification Dependency
          </div>
          <div class="hard-detail"><strong>The tension:</strong> The transformation only works if acceptance criteria are verifiable. But not everything can be verified automatically.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Tasks marked "complete" that aren't actually complete. Garbage compounding across iterations.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Don't transform subjective tasks. Use HOTL (Human On The Loop) variant for tasks requiring judgment. Accept that some domains (design, UX) aren't suitable for full autonomous transformation.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            Task Decomposition Skill
          </div>
          <div class="hard-detail"><strong>The tension:</strong> The transformation's success depends on your ability to decompose features into iteration-sized tasks. This is a skill, not a formula.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Tasks too big = context overflow. Tasks too small = overhead dominates. Wrong order = broken dependencies.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Start with HOTL to learn task sizing. Review progress.txt after runs to see what worked. Expect to get better over time. If task description &gt; code change, you've decomposed too far.</div>
        </div>

        <div class="hard-box">
          <div class="hard-title">
            <i data-lucide="flame" class="w-4 h-4"></i>
            The Upfront Investment
          </div>
          <div class="hard-detail"><strong>The tension:</strong> Transformation requires upfront work (PRD creation, script setup, acceptance criteria) that single sessions don't.</div>
          <div class="hard-detail"><strong>Symptoms:</strong> Feeling like the setup takes longer than just doing it manually. Temptation to skip transformation for "quick" tasks.</div>
          <div class="hard-detail"><strong>Mitigation:</strong> Only transform tasks &gt;30 minutes. The break-even is ~3 stories. Below that, single session wins. Above that, transformation compounds.</div>
        </div>
      </section>

      <!-- Section 8: WHEN TO TRANSFORM -->
      <section id="when" data-activity="when">
        <h2 class="section-title">
          <span class="section-number">8</span>
          When to Transform / When Not
        </h2>

        <div class="when-grid">
          <div class="when-use">
            <div class="when-title">
              <i data-lucide="check" class="w-5 h-5"></i>
              TRANSFORM WHEN
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Task has 3+ discrete steps (decomposition worthwhile)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Total work exceeds 30 minutes (overhead justified)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Clear "done" criteria exist (verifiable completion)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You have test/typecheck infrastructure (verification layer)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>You're okay walking away (autonomous execution acceptable)</span>
            </div>
            <div class="when-item">
              <i data-lucide="check" class="w-4 h-4 flex-shrink-0"></i>
              <span>Overnight execution is fine (fresh context needs time)</span>
            </div>
          </div>

          <div class="when-not">
            <div class="when-title">
              <i data-lucide="x" class="w-5 h-5"></i>
              DON'T TRANSFORM WHEN
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Task takes &lt;30 min total (single session faster)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Subjective quality goals ("make it pretty") (use human judgment)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Exploratory work with no defined end (use single session)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Security-critical code (use HOTL with human gates)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Need real-time parallelism (use CC Mirror instead)</span>
            </div>
            <div class="when-item">
              <i data-lucide="x" class="w-4 h-4 flex-shrink-0"></i>
              <span>Legacy code without tests (add tests first)</span>
            </div>
          </div>
        </div>

        <!-- Summary Comparison Table -->
        <h3 class="font-semibold text-lg mb-4 mt-8">Side-by-Side Comparison</h3>

        <table class="comparison-table">
          <thead>
            <tr>
              <th>Aspect</th>
              <th class="before-col">Before (Single Session)</th>
              <th class="after-col">After (Autonomous)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Context</strong></td>
              <td class="before-col">Degrades over 90 min</td>
              <td class="after-col">Fresh each 5-min iteration</td>
            </tr>
            <tr>
              <td><strong>Human</strong></td>
              <td class="before-col">Must stay engaged entire time</td>
              <td class="after-col">Can leave after setup</td>
            </tr>
            <tr>
              <td><strong>Quality</strong></td>
              <td class="before-col">Drops after 60% context</td>
              <td class="after-col">Maintained throughout</td>
            </tr>
            <tr>
              <td><strong>Duration</strong></td>
              <td class="before-col">90 min + human present</td>
              <td class="after-col">30 min setup + human asleep</td>
            </tr>
            <tr>
              <td><strong>Memory</strong></td>
              <td class="before-col">Lost when session ends</td>
              <td class="after-col">Persists in git + files</td>
            </tr>
            <tr>
              <td><strong>Recoverability</strong></td>
              <td class="before-col">Start over if session dies</td>
              <td class="after-col">Resume from last commit</td>
            </tr>
            <tr>
              <td><strong>Verification</strong></td>
              <td class="before-col">Manual after each step</td>
              <td class="after-col">Automated (typecheck/test)</td>
            </tr>
            <tr>
              <td><strong>Errors</strong></td>
              <td class="before-col">Compound in context</td>
              <td class="after-col">Isolated to one iteration</td>
            </tr>
          </tbody>
        </table>

        <div class="checkpoint-box" style="margin-top: 32px;">
          <div class="checkpoint-title">
            <i data-lucide="trophy" class="w-4 h-4"></i>
            Transformation Complete
          </div>
          <div class="checkpoint-content">
            <strong>You've achieved:</strong><br>
            - AI works while you sleep<br>
            - Quality maintained throughout long tasks<br>
            - Progress compounding across iterations<br>
            - Recoverable state in git + files<br>
            - Human bottleneck removed<br><br>
            <strong>Next steps:</strong> Combine with other patterns (Compounding, Parallel, CC Mirror) to reach Level 4+ on the complexity ladder.
          </div>
        </div>
      </section>

    